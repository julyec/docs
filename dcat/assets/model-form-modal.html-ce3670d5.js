import{_ as t}from"./MZIdO6PrwR-cc63eaeb.js";import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o,c,b as s,d as n,e as i,w as l,a as u}from"./app-98225aba.js";const r="/dcat/assets/bFfeudPwvS-ebecc1c1.png",d={},k=u(`<h1 id="表单弹窗" tabindex="-1"><a class="header-anchor" href="#表单弹窗" aria-hidden="true">#</a> 表单弹窗</h1><h2 id="数据表单弹窗" tabindex="-1"><a class="header-anchor" href="#数据表单弹窗" aria-hidden="true">#</a> 数据表单弹窗</h2><p>通过<code>Form::dialog</code>方法可以快速构建一个基于数据表单的表单弹窗，仅需增加数行代码。</p><blockquote><p>{tip} 表单弹窗的实现原理是：通过<code>create</code>和<code>edit</code>页面获取构建好的表单<code>HTML</code>字符，然后使用弹窗插件把这部分<code>HTML</code>字符渲染出来。 如果期间需要加载新的<code>js</code>脚本，则会等待脚本加载完毕再执行表单初始化<code>js</code>代码。</p></blockquote><h3 id="简单示例" tabindex="-1"><a class="header-anchor" href="#简单示例" aria-hidden="true">#</a> 简单示例</h3><h4 id="开启表单弹窗" tabindex="-1"><a class="header-anchor" href="#开启表单弹窗" aria-hidden="true">#</a> 开启表单弹窗</h4><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Controllers<span class="token punctuation">\\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Form</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Layout<span class="token punctuation">\\</span>Content</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ModalFormController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Content</span> <span class="token variable">$content</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$content</span>
            <span class="token operator">-&gt;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Modal Form&#39;</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;新增角色&#39;</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.create-form&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 绑定点击按钮</span>
            <span class="token operator">-&gt;</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;auth/roles/create&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 表单页面链接，此参数会被按钮中的 “data-url” 属性替换。。</span>
            <span class="token operator">-&gt;</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;700px&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 指定弹窗宽度，可填写百分比，默认 720px</span>
            <span class="token operator">-&gt;</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;650px&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 指定弹窗高度，可填写百分比，默认 690px</span>
            <span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Dcat.reload()&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 新增成功后刷新页面</span>

        <span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
            <span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Dcat.reload()&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 编辑成功后刷新页面</span>

        <span class="token comment">// 当需要在同个“class”的按钮中绑定不同的链接时，把链接放到按钮的“data-url”属性中即可</span>
        <span class="token variable">$editPage</span> <span class="token operator">=</span> <span class="token function">admin_base_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;auth/roles/1/edit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token string double-quoted-string">&quot;
&lt;div style=&#39;padding:30px 0&#39;&gt;
    &lt;span class=&#39;btn btn-success create-form&#39;&gt; 新增表单弹窗 &lt;/span&gt; &amp;nbsp;&amp;nbsp;
    &lt;span class=&#39;btn btn-blue edit-form&#39; data-url=&#39;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$editPage</span><span class="token punctuation">}</span></span>&#39;&gt; 编辑表单弹窗 &lt;/span&gt;
&lt;/div&gt;
&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="表单构建以及保存数据" tabindex="-1"><a class="header-anchor" href="#表单构建以及保存数据" aria-hidden="true">#</a> 表单构建以及保存数据</h4><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Repositories<span class="token punctuation">\\</span>Role</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Controllers<span class="token punctuation">\\</span>HasResourceActions</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Form</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Layout<span class="token punctuation">\\</span>Content</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Admin</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">RoleController</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HasResourceActions</span><span class="token punctuation">;</span>
    
    <span class="token doc-comment comment">/**
         * Edit interface.
         *
         * <span class="token keyword">@param</span> <span class="token class-name"><span class="token keyword">mixed</span></span>   <span class="token parameter">$id</span>
         * <span class="token keyword">@param</span> <span class="token class-name">Content</span> <span class="token parameter">$content</span>
         *
         * <span class="token keyword">@return</span> <span class="token class-name">Content</span>
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">edit</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Content</span> <span class="token variable">$content</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$content</span>
                <span class="token operator">-&gt;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.roles&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.edit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">edit</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token doc-comment comment">/**
         * Create interface.
         *
         * <span class="token keyword">@param</span> <span class="token class-name">Content</span> <span class="token parameter">$content</span>
         *
         * <span class="token keyword">@return</span> <span class="token class-name">Content</span>
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">create</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Content</span> <span class="token variable">$content</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$content</span>
                <span class="token operator">-&gt;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.roles&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.create&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
    <span class="token doc-comment comment">/**
     * Make a form builder.
     *
     * <span class="token keyword">@return</span> <span class="token class-name">Form</span>
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">form</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Role</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Form</span> <span class="token variable">$form</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;id&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;ID&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;slug&#39;</span><span class="token punctuation">,</span> <span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.slug&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">prepareForSave</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token variable">$value</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
            <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">tree</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;permissions&#39;</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">nodes</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$permissionModel</span> <span class="token operator">=</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.database.permissions_model&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token variable">$permissionModel</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$permissionModel</span><span class="token punctuation">;</span>
    
                    <span class="token keyword">return</span> <span class="token variable">$permissionModel</span><span class="token operator">-&gt;</span><span class="token function">allNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token operator">-&gt;</span><span class="token function">customFormat</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
                    <span class="token keyword">return</span> <span class="token function">array_column</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
            <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;created_at&#39;</span><span class="token punctuation">,</span> <span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.created_at&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$form</span><span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;updated_at&#39;</span><span class="token punctuation">,</span> <span class="token function">trans</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;admin.updated_at&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="效果" tabindex="-1"><a class="header-anchor" href="#效果" aria-hidden="true">#</a> 效果</h4><p><img src="`+r+`" alt="" loading="lazy"></p><h3 id="功能接口" tabindex="-1"><a class="header-anchor" href="#功能接口" aria-hidden="true">#</a> 功能接口</h3><p>表单弹窗必须绑定一个可点击的页面元素，通过点击这个元素弹出弹窗。</p><h4 id="设置弹窗标题" tabindex="-1"><a class="header-anchor" href="#设置弹窗标题" aria-hidden="true">#</a> 设置弹窗标题</h4><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$modal</span> <span class="token operator">=</span> <span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;标题&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="绑定点击按钮" tabindex="-1"><a class="header-anchor" href="#绑定点击按钮" aria-hidden="true">#</a> 绑定点击按钮</h4><p>通过<code>ModalForm::click</code>方法可以绑定点击按钮，绑定后当点击该按钮时会弹出弹窗</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;标题&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;#click-button&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="设置url" tabindex="-1"><a class="header-anchor" href="#设置url" aria-hidden="true">#</a> 设置URL</h4><p>如果是创建类型的表单，则可以通过以下方法设置获取表单模板的url</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;新增角色&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.create-form&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;auth/roles/create&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果是编辑类型的表单，则需要多个url，因为点击每个按钮弹出弹窗的表单内容是不同的，所以每个按钮的链接也不同。</p><p>这个时候通过<code>ModalForm::url</code>方法设置的一个链接已经无法满足需求了，因而需要在点击按钮的<code>data-url</code>属性上保存url：</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Dcat.reload()&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 编辑成功后刷新页面</span>

    <span class="token comment">// 当需要在同个“class”的按钮中绑定不同的链接时，把链接放到按钮的“data-url”属性中即可</span>
    <span class="token variable">$editPage1</span> <span class="token operator">=</span> <span class="token function">admin_base_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;auth/roles/1/edit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$editPage2</span> <span class="token operator">=</span> <span class="token function">admin_base_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;auth/roles/2/edit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token string double-quoted-string">&quot;
&lt;div style=&#39;padding:30px 0&#39;&gt;
    &lt;span class=&#39;btn btn-blue edit-form&#39; data-url=&#39;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$editPage1</span><span class="token punctuation">}</span></span>&#39;&gt; 编辑表单弹窗1 &lt;/span&gt;
    &lt;span class=&#39;btn btn-blue edit-form&#39; data-url=&#39;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$editPage2</span><span class="token punctuation">}</span></span>&#39;&gt; 编辑表单弹窗2 &lt;/span&gt;
&lt;/div&gt;
&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="表单保存成功回调" tabindex="-1"><a class="header-anchor" href="#表单保存成功回调" aria-hidden="true">#</a> 表单保存成功回调</h4><p>通过<code>success</code>方法可以设置表单保存成功之后执行的<code>js</code>代码，在这段<code>js</code>代码作用域内有一个<code>response</code>变量，通过这个变量可以获取服务端返回的<code>json</code>数据。</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
   <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
   <span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span>
       <span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token constant">JS</span>
<span class="token comment">// 打印服务端响应数据             </span>
console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 提示成功信息</span>
Dcat<span class="token operator">.</span><span class="token function">success</span><span class="token punctuation">(</span>response<span class="token operator">.</span><span class="token class-name">message</span> <span class="token operator">||</span> <span class="token string single-quoted-string">&#39;保存成功&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 保存成功之后刷新页面</span>
Dcat<span class="token operator">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">JS</span>        
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="表单保存失败回调" tabindex="-1"><a class="header-anchor" href="#表单保存失败回调" aria-hidden="true">#</a> 表单保存失败回调</h4><p>通过<code>error</code>方法可以设置表单保存失败之后执行的<code>js</code>代码，在这段<code>js</code>代码作用域内有一个<code>response</code>变量，通过这个变量可以获取服务端返回的<code>json</code>数据。</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
   <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
   <span class="token operator">-&gt;</span><span class="token function">error</span><span class="token punctuation">(</span>
       <span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token constant">JS</span>
<span class="token comment">// 打印服务端响应数据       </span>
console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">JS</span>        
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="表单保存之后回调" tabindex="-1"><a class="header-anchor" href="#表单保存之后回调" aria-hidden="true">#</a> 表单保存之后回调</h4><p>通过<code>saved</code>方法可以设置表单保存之后执行的<code>js</code>代码，在这段<code>js</code>代码作用域内有两个<code>js</code>变量：</p><ul><li><code>success</code> 值为真表示保存成功，否则失败</li><li><code>response</code> 服务端返回的<code>json</code>数据</li></ul><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
   <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
   <span class="token operator">-&gt;</span><span class="token function">saved</span><span class="token punctuation">(</span>
       <span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span><span class="token constant">JS</span>
<span class="token comment">// 打印服务端响应数据       </span>
console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;保存成功&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;保存失败&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token constant">JS</span>        
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="强制刷新" tabindex="-1"><a class="header-anchor" href="#强制刷新" aria-hidden="true">#</a> 强制刷新</h4><p>每次点击按钮都重新从服务端拉取新的模板数据</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">forceRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="设置弹窗宽高" tabindex="-1"><a class="header-anchor" href="#设置弹窗宽高" aria-hidden="true">#</a> 设置弹窗宽高</h4><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">dimensions</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;50%&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;400px&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token comment">// 或</span>
<span class="token class-name static-context">Form</span><span class="token operator">::</span><span class="token function">dialog</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;编辑角色&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;.edit-form&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;50%&#39;</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;400px&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="工具表单弹窗" tabindex="-1"><a class="header-anchor" href="#工具表单弹窗" aria-hidden="true">#</a> 工具表单弹窗</h2>`,40),v=s("p",null,[s("img",{src:t,alt:"",loading:"lazy"})],-1);function m(g,b){const a=p("RouterLink");return o(),c("div",null,[k,s("p",null,[n("数据表单的弹窗功能通常需要结合一个资源控制器去实现，相对会比较复杂一点，所以系统也内置了另外一种更简便的表单弹窗功能，使用方法请参考"),i(a,{to:"/zh/guide/widgets-form.html#modal"},{default:l(()=>[n("工具表单-弹窗")]),_:1}),n("。")]),v])}const y=e(d,[["render",m],["__file","model-form-modal.html.vue"]]);export{y as default};
