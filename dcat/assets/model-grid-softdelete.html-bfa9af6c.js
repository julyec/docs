import{_ as c}from"./plugin-vue_export-helper-c27b6911.js";import{r as a,o as l,c as i,b as s,d as n,e as t,w as u,a as p}from"./app-98225aba.js";const k="data:image/png;base64,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",r={},d=s("h1",{id:"数据软删除",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#数据软删除","aria-hidden":"true"},"#"),n(" 数据软删除")],-1),v=s("code",null,"Laravel",-1),m={href:"https://learnku.com/docs/laravel/6.x/eloquent/5176#soft-deleting",target:"_blank",rel:"noopener noreferrer"},b=p(`<div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\\</span>Models</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Database<span class="token punctuation">\\</span>Eloquent<span class="token punctuation">\\</span>Model</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Database<span class="token punctuation">\\</span>Eloquent<span class="token punctuation">\\</span>SoftDeletes</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">SoftDeletes</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样在<code>grid</code>列表中显示的数据都是未被删除的数据</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token class-name static-context">Grid</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Grid</span> <span class="token variable">$grid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;ID&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Title&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">created_at</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Created at&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">updated_at</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Updated at&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="回收站入口" tabindex="-1"><a class="header-anchor" href="#回收站入口" aria-hidden="true">#</a> 回收站入口</h2>`,4),g=s("code",null,"model-grid",-1),f=p(`<div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// 范围过滤器，调用模型的\`onlyTrashed\`方法，查询出被软删除的数据。</span>
    <span class="token variable">$filter</span><span class="token operator">-&gt;</span><span class="token function">scope</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;trashed&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;回收站&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">onlyTrashed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在表头的筛选按钮的下拉菜单中就会出现一个<code>回收站</code>按钮，点击它，就会调用模型的<code>onlyTrashed</code>方法，从表中查询出被删除的数据，也就是回收站中的数据。</p><p><img src="`+k+`" alt="" loading="lazy"></p><h2 id="行恢复操作" tabindex="-1"><a class="header-anchor" href="#行恢复操作" aria-hidden="true">#</a> 行恢复操作</h2><p>按照下面的方法，我们可以在回收站中的每一行数据加上一个恢复操作，方便恢复数据</p><p>先定义操作类<code>app/Admin/Actions/Post/Restore.php</code>：</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Actions<span class="token punctuation">\\</span>Post</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Grid<span class="token punctuation">\\</span>RowAction</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Request</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Restore</span> <span class="token keyword">extends</span> <span class="token class-name">RowAction</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;恢复&#39;</span><span class="token punctuation">;</span>
        
	<span class="token keyword">protected</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
	
	<span class="token comment">// 注意构造方法的参数必须要有默认值</span>
	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> 
	<span class="token punctuation">{</span>
		<span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">model</span> <span class="token operator">=</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">handle</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;model&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token variable">$model</span><span class="token operator">::</span><span class="token function">withTrashed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;已恢复&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;确定恢复吗？&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">parameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;model&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">model</span><span class="token punctuation">,</span>    
		<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>添加到行操作:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\\</span>Models<span class="token punctuation">\\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Actions<span class="token punctuation">\\</span>Post<span class="token punctuation">\\</span>Restore</span><span class="token punctuation">;</span>

<span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">actions</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration">Grid<span class="token punctuation">\\</span>Displayers<span class="token punctuation">\\</span>Actions</span> <span class="token variable">$actions</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;_scope_&#39;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string single-quoted-string">&#39;trashed&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$actions</span><span class="token operator">-&gt;</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Restore</span><span class="token punctuation">(</span><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="批量恢复操作" tabindex="-1"><a class="header-anchor" href="#批量恢复操作" aria-hidden="true">#</a> 批量恢复操作</h2><p>先定义操作类<code>app/Admin/Actions/Post/BatchRestore.php</code>：</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Actions<span class="token punctuation">\\</span>Post</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Dcat<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Grid<span class="token punctuation">\\</span>BatchAction</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Request</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">BatchRestore</span> <span class="token keyword">extends</span> <span class="token class-name">BatchAction</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;恢复&#39;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">protected</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 注意构造方法的参数必须要有默认值</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">model</span> <span class="token operator">=</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">handle</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$model</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;model&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token variable">$model</span><span class="token operator">::</span><span class="token function">withTrashed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">findOrFail</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
        
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;已恢复&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;确定恢复吗？&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">parameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">[</span>
			<span class="token string single-quoted-string">&#39;model&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">model</span><span class="token punctuation">,</span>    
		<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>添加到批量操作:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\\</span>Models<span class="token punctuation">\\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\\</span>Admin<span class="token punctuation">\\</span>Actions<span class="token punctuation">\\</span>Post<span class="token punctuation">\\</span>BatchRestore</span><span class="token punctuation">;</span>

<span class="token variable">$grid</span><span class="token operator">-&gt;</span><span class="token function">batchActions</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration">Grid<span class="token punctuation">\\</span>Tools<span class="token punctuation">\\</span>BatchActions</span> <span class="token variable">$batch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;_scope_&#39;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string single-quoted-string">&#39;trashed&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token variable">$batch</span><span class="token operator">-&gt;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BatchRestore</span><span class="token punctuation">(</span><span class="token class-name static-context">Post</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14);function y(h,A){const e=a("ExternalLinkIcon"),o=a("RouterLink");return l(),i("div",null,[d,s("p",null,[n("先参考"),v,n("文档实现模型的"),s("a",m,[n("软删除"),t(e)]),n(":")]),b,s("p",null,[n("接下来需要增加一个入口，能让我们看到被软删除的数据，这里可以使用"),g,n("的"),t(o,{to:"/zh/guide/model-grid-filters.html#scope"},{default:u(()=>[n("范围过滤器")]),_:1}),n("来实现")]),f])}const I=c(r,[["render",y],["__file","model-grid-softdelete.html.vue"]]);export{I as default};
