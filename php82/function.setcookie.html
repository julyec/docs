<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>发送 Cookie</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.pfsockopen.html">? pfsockopen</a></li>
      <li style="float: right;"><a href="function.setrawcookie.html">setrawcookie ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.network.html">网络 函数</a></li>
    <li>发送 Cookie</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.setcookie" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">setcookie</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">setcookie</span> &mdash; <span class="dc-title">发送 Cookie</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.setcookie-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>setcookie</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$name</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$value</code><span class="initializer"> = &quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$expires_or_options</code><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code><span class="initializer"> = &quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$domain</code><span class="initializer"> = &quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$secure</code><span class="initializer"> = <strong><code>false</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$httponly</code><span class="initializer"> = <strong><code>false</code></strong></span></span><br>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">自 PHP 7.3.0 起可用的替代签名（不支持命名参数）：</p>
  <div class="methodsynopsis dc-description"><span class="methodname"><strong>setcookie</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$name</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$value</code><span class="initializer"> = &quot;&quot;</span></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = []</span></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>setcookie()</strong></span> 定义了
   Cookie，会和剩下的消息头一起发送给客户端。和其他消息头一样，必须在脚本产生任意输出<em class="emphasis">之前</em>发送
   Cookie（由于协议的限制）。请在产生任何输出之前（包括 <code class="literal">&lt;html&gt;</code> 和 <code class="literal">&lt;head&gt;</code> 或者空格）调用本函数。
  </p>
  <p class="para">
   一旦设置 Cookie 后，下次打开页面时可以使用 <var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE</a></var>
   读取。Cookie 值同样也存在于 <var class="varname"><a href="reserved.variables.request.html" class="classname">$_REQUEST</a></var>。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.setcookie-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <a href="http://www.faqs.org/rfcs/rfc6265" class="link external" title="Link : http://www.faqs.org/rfcs/rfc6265">&raquo;&nbsp;RFC 6265</a> 提供了 <span class="function"><strong>setcookie()</strong></span> 每个参数的参考标准。
   <dl>
    
     <dt>
<code class="parameter">name</code></dt>

     <dd>

      <p class="para">
       Cookie 名称。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       Cookie 值。这个值储存于用户的电脑里，请勿储存敏感信息。比如
       <code class="parameter">name</code> 是 <code class="literal">&#039;cookiename&#039;</code>，可通过
       <var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE['cookiename']</a></var> 获取它的值。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">expires_or_options</code></dt>

     <dd>

      <p class="para">
       Cookie 的过期时间。这是 Unix 时间戳，即纪元以来的秒数。一种设置此值的方式是将
       cookie 过期前的秒数与调用 <span class="function"><a href="function.time.html" class="function">time()</a></span>
       的结果相加。例如，<code class="literal">time()+60*60*24*30</code>
       就是设置 Cookie 30 天后过期。还有一种选择就是使用 <span class="function"><a href="function.mktime.html" class="function">mktime()</a></span>
       函数。如果设置为 <code class="literal">0</code> 或者忽略，Cookie 会在会话结束时过期（关掉浏览器时）。
      </p>
      <p class="para">
       <blockquote class="note"><p><strong class="note">Note</strong>: 
        <p class="para">
         可能会注意到，<code class="parameter">expires_or_options</code> 使用 Unix 时间戳而非 <code class="literal">Wdy, DD-Mon-YYYY
         HH:MM:SS GMT</code> 这样的日期格式，是因为 PHP 内部作了转换。
        </p>
       </p></blockquote>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">path</code></dt>

     <dd>

      <p class="para">
       Cookie 有效的服务器路径。设置成 <code class="literal">&#039;/&#039;</code> 时，Cookie 对整个域名
       <code class="parameter">domain</code> 有效。如果设置成 <code class="literal">&#039;/foo/&#039;</code>，Cookie
       仅仅对 <code class="parameter">domain</code> 中 <code class="literal">/foo/</code>
       目录及其子目录有效（比如 <code class="literal">/foo/bar/</code>）。默认值是设置 Cookie 时的当前目录。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">domain</code></dt>

     <dd>

      <p class="para">
       Cookie 的有效域名/子域名。设置成子域名（例如 <code class="literal">&#039;www.example.com&#039;</code>），会使
       Cookie 对这个子域名和它的三级域名有效（例如 w2.www.example.com）。要让 Cookie
       对整个域名有效（包括它的全部子域名），只要设置成域名就可以了（这个例子里是 <code class="literal">&#039;example.com&#039;</code>）。
      </p>
      <p class="para">
       旧版浏览器仍然在使用废弃的 <a href="http://www.faqs.org/rfcs/rfc2109" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2109">&raquo;&nbsp;RFC 2109</a>，需要一个前置的点
       <code class="literal">.</code> 来匹配所有子域名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">secure</code></dt>

     <dd>

      <p class="para">
       设置这个 Cookie 是否仅仅通过安全的 HTTPS 连接传给客户端。设置成 <strong><code>true</code></strong> 时，只有安全连接存在时才会设置
       Cookie。如果是在服务器端处理这个需求，程序员需要仅仅在安全连接上发送此类 Cookie（通过
       <var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER["HTTPS"]</a></var> 判断）。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">httponly</code></dt>

     <dd>

      <p class="para">
       设置成 <strong><code>true</code></strong>，Cookie 仅可通过 HTTP 协议访问。这意思就是 Cookie 无法通过类似 JavaScript
       这样的脚本语言访问。要有效减少 XSS 攻击时的身份窃取行为，可建议用此设置（虽然不是所有浏览器都支持），不过这个说法经常有争议。
       <strong><code>true</code></strong> 或 <strong><code>false</code></strong>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       关联 <span class="type">array</span>，可能会存在以下键
       <code class="literal">expires</code>、<code class="literal">path</code>、<code class="literal">domain</code>、<code class="literal">secure</code>、<code class="literal">httponly</code> 和
       <code class="literal">samesite</code>。如果存在其它的键，会生成 <strong><code>E_WARNING</code></strong>
       级别的错误。这些值的含义跟同名参数的描述相同。<code class="literal">samesite</code> 元素的值应该是
       <code class="literal">None</code>、<code class="literal">Lax</code> 或
       <code class="literal">Strict</code>。如果没有指定任何允许的选项，它们的默认值与显式参数的默认值相同。如果省略
       <code class="literal">samesite</code> 元素，则不设置 SameSite cookie 属性。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.setcookie-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   如果在调用本函数以前就产生了输出，<span class="function"><strong>setcookie()</strong></span> 会失败并返回 <strong><code>false</code></strong>。如果
   <span class="function"><strong>setcookie()</strong></span> 成功运行，返回 <strong><code>true</code></strong>。当然，它的意思并非用户是否已接受 Cookie。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.setcookie-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>8.2.0</td>
       <td>
        Cookie 的日期格式现在为 <code class="literal">&#039;D, d M Y H:i:s \G\M\T&#039;</code>；
        以前是 <code class="literal">&#039;D, d-M-Y H:i:s T&#039;</code>。
       </td>
      </tr>

      <tr>
       <td>7.3.0</td>
       <td>
        新增对替代签名 <code class="parameter">options</code> 数组的支持。此签名还支持 SameSite cookie 属性的设置。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.setcookie-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   发送 cookie 的几个例子：
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>setcookie()</strong></span> 发送例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$value </span><span style="color: #007700">= </span><span style="color: #DD0000">'something from somewhere'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">, </span><span style="color: #0000BB">time</span><span style="color: #007700">()+</span><span style="color: #0000BB">3600</span><span style="color: #007700">);  </span><span style="color: #FF8000">/* 1 小时过期  */<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">, </span><span style="color: #0000BB">time</span><span style="color: #007700">()+</span><span style="color: #0000BB">3600</span><span style="color: #007700">, </span><span style="color: #DD0000">"/~rasmus/"</span><span style="color: #007700">, </span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   注意：在发送 Cookie 时，值的部分会被自动 urlencode 编码。收到 Cookie 时，会自动解码，并赋值到可变的
   Cookie 名称上。如果不想被编码，可以使用 <span class="function"><a href="function.setrawcookie.html" class="function">setrawcookie()</a></span>
   代替。在脚本里查看我们的测试 Cookie 的内容，使用下面的一个例子：
  </p>
  <p class="para">
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// 打印一个单独的 Cookie<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">];<br /><br /></span><span style="color: #FF8000">//  debug/test 查看所有 Cookie 的另一种方式<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #2 <span class="function"><strong>setcookie()</strong></span> 删除例子</strong></p>
    <div class="example-contents"><p>
     要删除一个 Cookie，应该设置过期时间为过去，以触发浏览器的删除机制。下面的例子展示了如何删除上个例子里的 Cookie：
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// 设置过期时间为一个小时前<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">, </span><span style="color: #DD0000">""</span><span style="color: #007700">, </span><span style="color: #0000BB">time</span><span style="color: #007700">() - </span><span style="color: #0000BB">3600</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"TestCookie"</span><span style="color: #007700">, </span><span style="color: #DD0000">""</span><span style="color: #007700">, </span><span style="color: #0000BB">time</span><span style="color: #007700">() - </span><span style="color: #0000BB">3600</span><span style="color: #007700">, </span><span style="color: #DD0000">"/~rasmus/"</span><span style="color: #007700">, </span><span style="color: #DD0000">"example.com"</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #3 <span class="function"><strong>setcookie()</strong></span> 和数组</strong></p>
    <div class="example-contents"><p>
     通过带 array 标记的 Cookie 名称，也可以把 Cookie 设置成数组。如果有数组元素，可以把它放进 Cookie
     里；脚本接收到时，Cookie 名称里的值会是一个数组：
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// 设置 Cookie<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"cookie[three]"</span><span style="color: #007700">, </span><span style="color: #DD0000">"cookiethree"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"cookie[two]"</span><span style="color: #007700">, </span><span style="color: #DD0000">"cookietwo"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #DD0000">"cookie[one]"</span><span style="color: #007700">, </span><span style="color: #DD0000">"cookieone"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 网页刷新后，打印出以下内容<br /></span><span style="color: #007700">if (isset(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'cookie'</span><span style="color: #007700">])) {<br />    foreach (</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'cookie'</span><span style="color: #007700">] as </span><span style="color: #0000BB">$name </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$value</span><span style="color: #007700">) {<br />        </span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br />        </span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />        echo </span><span style="color: #DD0000">"</span><span style="color: #0000BB">$name</span><span style="color: #DD0000"> : </span><span style="color: #0000BB">$value</span><span style="color: #DD0000"> &lt;br /&gt;\n"</span><span style="color: #007700">;<br />    }<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
three : cookiethree
two : cookietwo
one : cookieone
</pre></div>
    </div>
   </div>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <span class="simpara">
     使用 <code class="literal">[</code> 和 <code class="literal">]</code> 分隔符作为 cookie 名称的一部分不符合
     RFC 6265 第 4 节。但根据 RFC 6265 第 5 节应该由 user agent 支持。
    </span>
   </p></blockquote>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.setcookie-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    要在调用本函数前输出内容，可以使用输出缓冲，让输出的内容在服务器里缓冲起来，直至真正发送给浏览器。可在脚本里调用
    <span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span> 和 <span class="function"><a href="function.ob-end-flush.html" class="function">ob_end_flush()</a></span>，或设置
    <code class="literal">output_buffering</code> <var class="filename">php.ini</var> 或服务器配置文件里的配置指令。
   </p>
  </p></blockquote>
  <p class="para">
   注意避坑：
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      在页面（Cookie 可见的页面）下次刷新前，Cookie 不会生效。
      测试 Cookie 是否已经成功设置，需要在下次页面加载时、Cookie 过期前检测。
      过期时间是通过 <code class="parameter">expires_or_options</code> 参数设置的。
      直接调用 <code class="literal">print_r($_COOKIE);</code> 调试检测 Cookie 是个很好的方式。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      为同一个参数再次设置 Cookie 前，必须先把它删掉。
      如果参数的值是空 string，并且其他参数和上次调用 setcookie 仍旧一样，
      则指定的名称会被远程客户端删除。
      内部的实现是：将值设置成 <code class="literal">&#039;deleted&#039;</code>，且过去的过期时间。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      因为设置值成 <strong><code>false</code></strong> 会导致 Cookie 被删除，所以要避免使用布尔值。
      代替方式：<em class="emphasis">0</em> 是 <strong><code>false</code></strong>，<em class="emphasis">1</em> 是 <strong><code>true</code></strong>。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Cookie 名称可以设置成数组名称，PHP 脚本里会是数组，
      但用户系统里储存的是单独分开的 Cookie。 
      可以考虑使用 <span class="function"><a href="function.explode.html" class="function">explode()</a></span> 为一个 Cookie 设置多个名称和值。
      不建议将 <span class="function"><a href="function.serialize.html" class="function">serialize()</a></span> 用于此处，因为它会导致安全漏洞。
     </span>
    </li>
   </ul>
  </p>
  <p class="simpara">
   多次调用 <span class="function"><strong>setcookie()</strong></span> 会按调用顺序执行。
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.setcookie-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.header.html" class="function" rel="rdfs-seeAlso">header()</a> - 发送原生 HTTP 头</span></li>
    <li class="member"><span class="function"><a href="function.setrawcookie.html" class="function" rel="rdfs-seeAlso">setrawcookie()</a> - 发送未经 URL 编码的 cookie</span></li>
    <li class="member"><a href="features.cookies.html" class="link">Cookie 章节</a></li>
    <li class="member"><a href="http://www.faqs.org/rfcs/rfc6265" class="link external" title="Link : http://www.faqs.org/rfcs/rfc6265">&raquo;&nbsp;RFC 6265</a></li>
    <li class="member"><a href="http://www.faqs.org/rfcs/rfc2109" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2109">&raquo;&nbsp;RFC 2109</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="128616""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#128616" class="date">15-Jun-2023 09:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of Chrome release M104 (August 2022) cookies can no longer set an expiration date more than 400 days in the future.&nbsp;&nbsp; <br />
https://developer.chrome.com/blog/cookie-max-age-expires/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125413""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#125413" class="date">04-Oct-2020 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Chrome versions prior to version 67 reject samesite=none cookies. And starting in Chrome version 84 samesite=none cookies without the secure attribute are also rejected. But that doesn't mean you can't set cookies on an unencrypted connection. The simple way around it is to use browser sniffing to detect samesite=none compatible browsers:<br />
<br />
$cookie_string = 'set-cookie: name=value';<br />
<br />
if (!preg_match('/Chrom[^ \/]+\/([0-9]+)[\.0-9]* /', $_SERVER['HTTP_USER_AGENT'], $matches) || $matches[1]&gt;66 &amp;&amp; $matches[1]&lt;84) {// match samesite=none compatible browsers<br />
&nbsp;&nbsp;&nbsp; $cookie_string.= '; samesite=none';<br />
}<br />
<br />
header($cookie_string, false);// set cookie</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125242""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#125242" class="date">04-Aug-2020 04:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just an example to clarify the use of the array options, especially since Mozilla is going to deprecate / penalise the use of SameSite = none,&nbsp; which is used by default if not using array options. <br />
<br />
<span class="default">&lt;?php<br />
$arr_cookie_options </span><span class="keyword">= array (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'expires' </span><span class="keyword">=&gt; </span><span class="default">time</span><span class="keyword">() + </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">30</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'path' </span><span class="keyword">=&gt; </span><span class="string">'/'</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'domain' </span><span class="keyword">=&gt; </span><span class="string">'.example.com'</span><span class="keyword">, </span><span class="comment">// leading dot for compatibility or use subdomain<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'secure' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,&nbsp; &nbsp;&nbsp; </span><span class="comment">// or false<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'httponly' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,&nbsp; &nbsp; </span><span class="comment">// or false<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'samesite' </span><span class="keyword">=&gt; </span><span class="string">'None' </span><span class="comment">// None || Lax&nbsp; || Strict<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'TestCookie'</span><span class="keyword">, </span><span class="string">'The Cookie Value'</span><span class="keyword">, </span><span class="default">$arr_cookie_options</span><span class="keyword">);&nbsp; &nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125241""></a>
  <div class="note">
   <strong class="user">synnus at gmail dot com</strong>
   <a href="#125241" class="date">03-Aug-2020 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The " PHPSESSID " cookie will soon be rejected because its " sameSite " attribute is set to " none " or an invalid value, and without " secure " attribute. To learn more about the "sameSite" attribute, visit https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie/SameSite.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;ini_set</span><span class="keyword">(</span><span class="string">"session.cookie_secure"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">my PHP code </span><span class="keyword">.... <br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125028""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#125028" class="date">19-May-2020 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To add the "samesite" attribute, you can concatenate it to the path option until it gets implemented/documented properly<br />
Eg:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; setcookie</span><span class="keyword">(</span><span class="string">'cookie_name'</span><span class="keyword">, </span><span class="string">'cookie_value'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="string">'/; SameSite=strict'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124644""></a>
  <div class="note">
   <strong class="user">user at example.com</strong>
   <a href="#124644" class="date">23-Jan-2020 07:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 7.3.0 the setcookie() method supports the SameSite attribute in its options and will accept None as a valid value.<br />
<br />
For earlier versions of PHP,&nbsp; you can set the header() directly:<br />
<br />
header('Set-Cookie: cross-site-cookie=bar; SameSite=None; Secure');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123567""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#123567" class="date">30-Jan-2019 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I haven't seen this mentioned here and had a lot of issues (and created a lot of stupid hacks) before I figured this out.<br />
<br />
If you have a couple of environments for example, and are trying to set cookies on two domains:<br />
<br />
example.com (main site)<br />
dev.example.com (dev site)<br />
<br />
In this case your (same named) cookies will interfere with each other if you're trying to set cookies with the domain parameter.&nbsp; <br />
<br />
Simply use an empty string for the domain parameter and the cookies will refer to each host separately.<br />
<br />
If you use the subdomain www. on the main site this won't be an issue, but without a subdomain you'll have issues with reading each others' cookies.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120794""></a>
  <div class="note">
   <strong class="user">nacho at casinelli dot com</strong>
   <a href="#120794" class="date">12-Mar-2017 11:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's worth a mention: you should avoid dots on cookie names.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// this will actually set 'ace_fontSize' name:<br />
</span><span class="default">setcookie</span><span class="keyword">( </span><span class="string">'ace.fontSize'</span><span class="keyword">, </span><span class="default">18 </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120491""></a>
  <div class="note">
   <strong class="user">lferro9000 at gmail dot com</strong>
   <a href="#120491" class="date">20-Jan-2017 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Of notice, the cookie when set with a zero expire or ommited WILL not expire when the browser closes.<br />
<br />
What happens is that the browser, when closes the window, if it is a well behaved browser, will delete the cookie from the cookie store.<br />
<br />
However, the cookie will survive in the server until the garbage collector removes the session, which will happen only when it kicks in and checks the specified session is out of bounds of the setting stated in:<br />
<br />
<a href="http://php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime" rel="nofollow" target="_blank">http://php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime</a><br />
<br />
Please check also:<br />
<br />
<a href="http://php.net/manual/en/session.security.ini.php" rel="nofollow" target="_blank">http://php.net/manual/en/session.security.ini.php</a><br />
<br />
And in case of doubt, PHP runs on the webserver and has no way whatsoever to interact with a browser apart from receiving requests and answering with responses, so assuming that a cookie will be removed from a browser is just an "hint" for the browser. There is no warranty that such will happen as instructed.<br />
<br />
That is one of the reasons why the cookie values sent to browsers by some platforms are encrypted and timestamped, to ensure that they are actual and not tampered.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119640""></a>
  <div class="note">
   <strong class="user">byz</strong>
   <a href="#119640" class="date">23-Jul-2016 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
exmaple with test.com；<br />
<br />
setcookie('empty_domain','value',time()+3600,'')&nbsp; <br />
&nbsp;equal&nbsp; &nbsp; &nbsp;&nbsp; test.com<br />
<br />
setcookie('test_com_domain','value',time()+3600,'','test.com')&nbsp;&nbsp; <br />
equal&nbsp; &nbsp; &nbsp;&nbsp; .test.com<br />
<br />
setcookie('dot_test_com_domain','value',time()+3600,'','.test.com')&nbsp; <br />
&nbsp;equal&nbsp; &nbsp; &nbsp;&nbsp; .test.com<br />
<br />
ps:&nbsp;&nbsp; .test.com&nbsp;&nbsp; has its self&nbsp; &nbsp; and child domain</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117526""></a>
  <div class="note">
   <strong class="user">dmitry dot koterov at gmail dot com</strong>
   <a href="#117526" class="date">24-Jun-2015 05:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that at least in PHP 5.5 setcookie() removes previously set cookies with the same name (even if you've set them via header()), so previously fired Set-Cookie headers with e.g. PHPSESSID name are not flushed to the browser. Even headers_list() doesn't see them after session_start():<br />
<br />
header("Set-Cookie: PHPSESSID=abc; path=/; domain=.sub.domain.com");<br />
header("Set-Cookie: PHPSESSID=abc; path=/; domain=.domain.com");<br />
print_r(headers_list()); // here you see two Set-Cookie headers with domains for PHPSESSID<br />
session_id('abc');<br />
session_start();<br />
print_r(headers_list()); // here you don't; you see only one Set-Cookie produced by session_start()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115356""></a>
  <div class="note">
   <strong class="user">ellert at vankoperen dot nl</strong>
   <a href="#115356" class="date">10-Jul-2014 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Caveat: if you use URL RewriteRules to get stuff like this: domain.com/bla/stuf/etc into parameters, you might run into a hickup when setting cookies.<br />
At least in my setup a change in one of the parameters resulted in the cookie not being 'there' anymore.<br />
The fix is simple: specify the domain. '/' will usualy do fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110193""></a>
  <div class="note">
   <strong class="user">walterquez</strong>
   <a href="#110193" class="date">28-Sep-2012 04:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instead of this:
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">( </span><span class="string">"TestCookie"</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+(</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">30</span><span class="keyword">) ); </span><span class="default">?&gt;
<br />
</span>
<br />
You can this:
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">( </span><span class="string">"TestCookie"</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">strtotime</span><span class="keyword">( </span><span class="string">'+30 days' </span><span class="keyword">) ); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109173""></a>
  <div class="note">
   <strong class="user">Bachsau</strong>
   <a href="#109173" class="date">26-Jun-2012 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Want to remove a cookie?<br />
<br />
Many people do it the complicated way:<br />
setcookie('name', 'content', time()-3600);<br />
<br />
But why do you make it so complicated and risk it not working, when the client's time is wrong? Why fiddle around with time();<br />
<br />
Here's the easiest way to unset a cookie:<br />
setcookie('name', 'content', 1);<br />
<br />
Thats it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105120""></a>
  <div class="note">
   <strong class="user">mkmohsinali at gmail dot com</strong>
   <a href="#105120" class="date">28-Jul-2011 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
#cookies.php<br />
/*This code will demonstrate use of cookies with PHP<br />
It is very easy to understand and is better for beginner to<br />
understand and get idea about power of cookies when used<br />
with PHP.Here we give user a form to choose colors he/she<br />
likes for website and when he/she visits site again within one<br />
hour his/her settings are saved and read from cookie <br />
and he/she doesn't have to set the page color and page<br />
text color again.You can change time from 3600<br />
seconds to whatever you deem appropriate in your case.<br />
if you don't understand anything please email me*/<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">#checking if form has been submitted<br />
</span><span class="keyword">if (isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'submitted'</span><span class="keyword">])){<br />
</span><span class="comment">#if yes (form is submitted) assign values from POST array to variables<br />
</span><span class="default">$newbgColor</span><span class="keyword">=</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'bgColor'</span><span class="keyword">];<br />
</span><span class="default">$newtxtColor</span><span class="keyword">=</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'txtColor'</span><span class="keyword">];<br />
</span><span class="comment">#set cookies<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"bgColor"</span><span class="keyword">,</span><span class="default">$newbgColor</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"txtColor"</span><span class="keyword">,</span><span class="default">$newtxtColor</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+</span><span class="default">3600</span><span class="keyword">);<br />
<br />
}<br />
</span><span class="comment">#in case user has come for first time and cookies are not set then<br />
</span><span class="keyword">if ((!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'bgColor'</span><span class="keyword">]) ) &amp;&amp; (!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'txtColor'</span><span class="keyword">]))){<br />
</span><span class="default">$bgColor </span><span class="keyword">= </span><span class="string">"Black"</span><span class="keyword">;<br />
</span><span class="default">$txtColor</span><span class="keyword">=</span><span class="string">"White"</span><span class="keyword">;<br />
}<br />
</span><span class="comment">#if cookies are set then use them<br />
</span><span class="keyword">else{<br />
</span><span class="default">$bgColor </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'bgColor'</span><span class="keyword">];<br />
</span><span class="default">$txtColor </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'txtColor'</span><span class="keyword">];<br />
}<br />
</span><span class="default">?&gt;<br />
</span>&lt;!-- HTML Page--&gt;<br />
&lt;html&gt;<br />
&lt;body bgcolor="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$bgColor ?&gt;</span>" text="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$txtColor ?&gt;</span>"&gt; <br />
&lt;form action= "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">]; </span><span class="default">?&gt;</span>" method ="POST"&gt;<br />
&lt;p&gt;Body Color:&lt;/p&gt;<br />
&lt;select name=bgColor&gt;<br />
&lt;option value ="Red"&gt;Red&lt;/option&gt;<br />
&lt;option value ="Green" selected&gt;Green&lt;/option&gt;<br />
&lt;option value ="Blue"&gt;Blue&lt;/option&gt;<br />
&lt;option value ="Yellow"&gt;Yellow&lt;/option&gt;<br />
&lt;option value ="Black"&gt;Black&lt;/option&gt;<br />
&lt;option value ="Brown"&gt;Brown&lt;/option&gt;<br />
&lt;option value ="White"&gt;White&lt;/option&gt;<br />
&lt;/select&gt;<br />
&lt;p&gt;Text Color:&lt;/p&gt;<br />
&lt;select name=txtColor&gt;<br />
&lt;tion value ="Red"&gt;Red&lt;/option&gt;<br />
&lt;option value ="Green" selected&gt;Green&lt;/option&gt;<br />
&lt;option value ="Blue"&gt;Blue&lt;/option&gt;<br />
&lt;option value ="Yellow"&gt;Yellow&lt;/option&gt;<br />
&lt;option value ="Black"&gt;Black&lt;/option&gt;<br />
&lt;option value ="Brown"&gt;Brown&lt;/option&gt;<br />
&lt;option value ="White"&gt;White&lt;/option&gt;<br />
&lt;/select&gt;<br />
&lt;input type ="hidden" name="submitted" value="true"&gt;&lt;/br&gt;<br />
&lt;input type="submit" value="remind"&gt;<br />
&lt;/form&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104885""></a>
  <div class="note">
   <strong class="user">MrXCol</strong>
   <a href="#104885" class="date">13-Jul-2011 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're having problem with IE not accepting session cookies this could help:<br />
<br />
It seems the IE (6, 7, 8 and 9) do not accept the part 'Expire=0' when setting a session cookie. To fix it just don't put any expire at all. The default behavior when the 'Expire' is not set is to set the cookie as a session one. <br />
<br />
(Firefox doesn't complains, btw.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104198""></a>
  <div class="note">
   <strong class="user">chris at styl dot ee</strong>
   <a href="#104198" class="date">31-May-2011 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was searching for a simple example of creating a cookie, storing a random number and updating it on refresh. I couldn't find one so I had to figure it out on my own....<br />
<br />
- - - - <br />
One thing to *NOTE* is technically you can't update a cookie, you can only overwrite it with a new one with the same name.<br />
<br />
- - - -<br />
<br />
This creates a random number, stores it in a cookie, then references it on refresh, checks for duplicates and does necessary correction, then stores it again, rinse and repeat...<br />
<br />
<span class="default">&lt;?php<br />
ob_start</span><span class="keyword">();<br />
</span><span class="default">$MaxCount </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;</span><span class="comment">// set the max of the counter, in my tests "4" = (0,1,2,3) I adjusted below (+1) to get a "real" 4 (0,1,2,3,4) this is in reality 5 keys to humans, you can adjust script to eliminate "0", but my script makes use of the "0"<br />
<br />
</span><span class="default">$random </span><span class="keyword">=(</span><span class="default">rand</span><span class="keyword">()%(</span><span class="default">$MaxCount</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">));</span><span class="comment">//give me a random number limited by the max, adding "1" because computers start counting at "0"<br />
<br />
</span><span class="keyword">if(!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'random'</span><span class="keyword">])){</span><span class="comment">// check if random number cookie is not set<br />
&nbsp;&nbsp;&nbsp; //echo"not set";<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'random'</span><span class="keyword">, </span><span class="default">$random</span><span class="keyword">);</span><span class="comment">//set the cookie for the first time<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastRandom</span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'random'</span><span class="keyword">]; </span><span class="comment">//hold the last number if it was set before<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$lastRandom </span><span class="keyword">== </span><span class="default">$random</span><span class="keyword">){</span><span class="comment">//some logic to avoid repeats<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">$random </span><span class="keyword">&lt; </span><span class="default">$MaxCount</span><span class="keyword">){</span><span class="comment">//if below max, add 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$random</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "under the max, adding 1, ";&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}elseif(</span><span class="default">$random </span><span class="keyword">&gt;= (</span><span class="default">$MaxCount</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)){</span><span class="comment">// if for some reason the random number is more than max or equal to it -1, and an additional -1 for max count in initial var (so in reality this -1 from intial max var, and -1 from $random which should be the same number)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$random</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "hit the max, subtracting 1, ";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$random</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "no case match, adding 1, ";&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo "(".$lastRandom.", ".$random. "), they matched initally - was it fixed?";<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo "(".$lastRandom.", ".$random. "), they DO NOT match";<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'random'</span><span class="keyword">, </span><span class="default">$random</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo"is set: {$_COOKIE['random']}";<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">ob_end_flush</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103629""></a>
  <div class="note">
   <strong class="user">bocian941 at pawno dot pl</strong>
   <a href="#103629" class="date">24-Apr-2011 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My 2 functions to use "live cookies":
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">SetCookieLive</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$expire </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">, </span><span class="default">$httponly</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">RemoveCookieLive</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102352""></a>
  <div class="note">
   <strong class="user">jdknock (at) gMaIl (dot) com</strong>
   <a href="#102352" class="date">09-Feb-2011 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IE7 can have trouble with settings cookies that are embedded in an iframe. The problem lies with a W3C standard called Platform for Privacy Preferences or P3P for short.
<br />

<br />
To overcome, include the header:
<br />

<br />
header('P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"');
<br />

<br />
before setting the cookie.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99845""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#99845" class="date">10-Sep-2010 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A period in a cookie name (like user.name) seems to show up in the $_COOKIE array as an underscore (so user_name). This means that for example $_COOKIE["user_name"] must be used to read a cookie that has been set with setcookie("user.name" ...), which is already rather confusing. <br />
<br />
Furthermore the variable $_COOKIE["user_name"] will retain the value set by setcookie("user.name" ...) and no amount of calling setcookie("user_name" ...) will alter this value. This is rather trivially fixed by clearing the "user.name" cookie, but it can take a while to realize this since there's only "user_name" in $_COOKIE.<br />
<br />
Hope this saves someone some time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97944""></a>
  <div class="note">
   <strong class="user">jay at w3prodigy dot com</strong>
   <a href="#97944" class="date">17-May-2010 12:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can also delete cookies by supplying setcookie an empty value.<br />
<br />
setcookie("w3p_cookie", "");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94390""></a>
  <div class="note">
   <strong class="user">Eric</strong>
   <a href="#94390" class="date">01-Nov-2009 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The server my php code is running on has sessions disabled so I am forced to store a fair bit of arbitrary data in cookies.&nbsp; Using array names was impractical and problematic, so I implemented a splitting routine.&nbsp; I do not serialize any class instances, just arrays and simple objects.
<br />

<br />
In a nutshell, when setting a cookie value, I serialize it, gzcompress it, base64 encode it, break it into pieces and store it as a set of cookies.&nbsp; To fetch the cookie value I get the named piece then iterate through piece names rebuilding the base64 data, then reverse the rest of the process.&nbsp; The only other trick is deleting the pieces correctly.
<br />

<br />
Sessions are better, but if they are not available this is a viable alternative.&nbsp; I chose gz over bz for compression because it looked faster with only slightly worse ratios.
<br />

<br />
Here is a simplified version of my implementation.&nbsp; This is a good starting point but is not suitable for most uses.&nbsp; For example, the domain and path are hard coded and no return values are checked for validity.
<br />

<br />
<span class="default">&lt;?php
<br />
define</span><span class="keyword">( </span><span class="string">'COOKIE_PORTIONS' </span><span class="keyword">, </span><span class="string">'_piece_' </span><span class="keyword">);
<br />

<br />
function </span><span class="default">clearpieces</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$inFirst </span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$expire </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">()-</span><span class="default">3600</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$index </span><span class="keyword">= </span><span class="default">$inFirst </span><span class="keyword">; </span><span class="default">array_key_exists</span><span class="keyword">( </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">, </span><span class="default">$_COOKIE </span><span class="keyword">) ; </span><span class="default">$index </span><span class="keyword">+= </span><span class="default">1 </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">( </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">$expire </span><span class="keyword">, </span><span class="string">'/' </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index</span><span class="keyword">] );
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
function </span><span class="default">clearcookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">clearpieces</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">3600 </span><span class="keyword">, </span><span class="string">'/' </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; unset( </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">] );
<br />
}
<br />

<br />
function </span><span class="default">storecookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$inValue </span><span class="keyword">, </span><span class="default">$inExpire </span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">( </span><span class="default">$inValue </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">gzcompress</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$split </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">, </span><span class="default">4000 </span><span class="keyword">);</span><span class="comment">//4k pieces
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">( </span><span class="default">$split </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$index </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$index </span><span class="keyword">&lt; </span><span class="default">$count </span><span class="keyword">; </span><span class="default">$index </span><span class="keyword">+= </span><span class="default">1 </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">setcookie</span><span class="keyword">( ( </span><span class="default">$index </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">) ? </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">: </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$split</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] , </span><span class="default">$inExpire </span><span class="keyword">, </span><span class="string">'/' </span><span class="keyword">, </span><span class="string">'' </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">clearpieces</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">, </span><span class="default">$count </span><span class="keyword">);
<br />
}
<br />

<br />
function </span><span class="default">fetchcookie</span><span class="keyword">( </span><span class="default">$inKey </span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$index </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">; </span><span class="default">array_key_exists</span><span class="keyword">( </span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index </span><span class="keyword">, </span><span class="default">$_COOKIE </span><span class="keyword">) ; </span><span class="default">$index </span><span class="keyword">+= </span><span class="default">1 </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">.= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$inKey</span><span class="keyword">.</span><span class="default">COOKIE_PORTIONS</span><span class="keyword">.</span><span class="default">$index</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">base64_decode</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$decode </span><span class="keyword">= </span><span class="default">gzuncompress</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">$decode </span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91140""></a>
  <div class="note">
   <strong class="user">laffen</strong>
   <a href="#91140" class="date">27-May-2009 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the $_COOKIE variable not will hold multiple cookies with the same name. It is legitimate to set two cookies with the same name to the same host where the sub domain is different. <br />
<span class="default">&lt;?php<br />
setcookie</span><span class="keyword">(</span><span class="string">"testcookie"</span><span class="keyword">, </span><span class="string">"value1hostonly"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">(), </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">".example.com"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"testcookie"</span><span class="keyword">, </span><span class="string">"value2subdom"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">(), </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">"subdom.example.com"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>The next request from the browser will have both cookies in the $_SERVER['HTTP_COOKIE'] variable, but only one of them will be found in the $_COOKIE variable. Requests to subdom.example.com will have both cookies, while browser request to example.com or www.example.com only sends the cookie with the "value1hostonly" value.<br />
<br />
<span class="default">&lt;?php<br />
$kaker </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">";"</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">]);<br />
foreach(</span><span class="default">$kaker </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) . </span><span class="string">" =&gt; " </span><span class="keyword">. </span><span class="default">$k</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// output<br />
</span><span class="default">testcookie </span><span class="keyword">=&gt; </span><span class="default">value1hostonly<br />
testcookie </span><span class="keyword">=&gt; </span><span class="default">value2subdom<br />
<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81398""></a>
  <div class="note">
   <strong class="user">isooik at gmail-antispam dot com</strong>
   <a href="#81398" class="date">26-Feb-2008 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a more advanced version of the php setcookie() alternative function:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * A better alternative (RFC 2109 compatible) to the php setcookie() function
<br />
&nbsp;&nbsp; &nbsp; *
<br />
&nbsp;&nbsp; &nbsp; * @param string Name of the cookie
<br />
&nbsp;&nbsp; &nbsp; * @param string Value of the cookie
<br />
&nbsp;&nbsp; &nbsp; * @param int Lifetime of the cookie
<br />
&nbsp;&nbsp; &nbsp; * @param string Path where the cookie can be used
<br />
&nbsp;&nbsp; &nbsp; * @param string Domain which can read the cookie
<br />
&nbsp;&nbsp; &nbsp; * @param bool Secure mode?
<br />
&nbsp;&nbsp; &nbsp; * @param bool Only allow HTTP usage?
<br />
&nbsp;&nbsp; &nbsp; * @return bool True or false whether the method has successfully run
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">createCookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$maxage</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$secure</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$HTTPOnly</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'output_buffering'</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Abort the method if headers have already been sent, except when output buffering has been enabled
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">headers_sent</span><span class="keyword">() &amp;&amp; (bool) </span><span class="default">$ob </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$ob</span><span class="keyword">) == </span><span class="string">'off' </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( !empty(</span><span class="default">$domain</span><span class="keyword">) )
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Fix the domain to accept domains with and without 'www.'.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">strtolower</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">) ) == </span><span class="string">'www.' </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add the dot prefix to ensure compatibility with subdomains
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) != </span><span class="string">'.' </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove port information.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$port </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">) </span><span class="default">$domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Prevent "headers already sent" error with utf8 support (BOM)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //if ( utf8_support ) header('Content-Type: text/html; CHARSET=gb2312');
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: '</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">).</span><span class="string">'='</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Domain='</span><span class="keyword">.</span><span class="default">$domain</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$maxage</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Max-Age='</span><span class="keyword">.</span><span class="default">$maxage</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(empty(</span><span class="default">$path</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Path='</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$secure </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; Secure'</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; .(!</span><span class="default">$HTTPOnly </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Regards,
<br />
Isaak</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77276""></a>
  <div class="note">
   <strong class="user">cwillard at fastmail dot fm</strong>
   <a href="#77276" class="date">22-Aug-2007 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're looking to set multiple values in your cookie (rather than setting multiple cookies) you might find these useful.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">build_cookie</span><span class="keyword">(</span><span class="default">$var_array</span><span class="keyword">) {<br />
&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$var_array</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$var_array </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">.= (</span><span class="default">$data</span><span class="keyword">!=</span><span class="string">""</span><span class="keyword">) ? </span><span class="default">$index</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">$data</span><span class="keyword">.</span><span class="string">"|" </span><span class="keyword">: </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">,</span><span class="string">"|"</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">break_cookie </span><span class="keyword">(</span><span class="default">$cookie_string</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$array</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"|"</span><span class="keyword">,</span><span class="default">$cookie_string</span><span class="keyword">);<br />
&nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$stuff</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$stuff</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$stuff</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$stuff</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]]=</span><span class="default">$stuff</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Hopefully someone finds these useful.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76395""></a>
  <div class="note">
   <strong class="user">bluewaterbob</strong>
   <a href="#76395" class="date">12-Jul-2007 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you are having problems seeing cookies sometimes or deleting cookies sometimes, despite following the advice below, make sure you are setting the cookie with the domain argument. Set it with the dot before the domain as the examples show: ".example.com".&nbsp; I wasn't specifying the domain, and finally realized I was setting the cookie when the browser url had the <a href="http://www.example.com and later trying to delete it when the url didn" rel="nofollow" target="_blank">http://www.example.com and later trying to delete it when the url didn</a>'t have the www. ie. <a href="http://example.com. This also caused the page to be unable to find the cookie when the www. wasn" rel="nofollow" target="_blank">http://example.com. This also caused the page to be unable to find the cookie when the www. wasn</a>'t in the domain.&nbsp; (When you add the domain argument to the setcookie code that creates the cookie, make sure you also add it to the code that deletes the cookie.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75343""></a>
  <div class="note">
   <strong class="user">jonathan dot bergeron at rve dot ulaval dot ca</strong>
   <a href="#75343" class="date">24-May-2007 12:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About the delete part, I found that Firefox only remove the cookie when you submit the same values for all parameters, except the date, which sould be in the past. Submiting blank values didn't work for me.
<br />

<br />
Example :
<br />
- set -
<br />

<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">( </span><span class="string">"name"</span><span class="keyword">, </span><span class="string">"value"</span><span class="keyword">, </span><span class="string">"future_timestamp"</span><span class="keyword">, </span><span class="string">"path"</span><span class="keyword">, </span><span class="string">"domain" </span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
- delete -
<br />
<span class="default">&lt;?php setcookie</span><span class="keyword">( </span><span class="string">"name"</span><span class="keyword">, </span><span class="string">"value"</span><span class="keyword">, </span><span class="string">"past_timestamp"</span><span class="keyword">, </span><span class="string">"path"</span><span class="keyword">, </span><span class="string">"domain" </span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
Jonathan</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73484""></a>
  <div class="note">
   <strong class="user">gabe at fijiwebdesign dot com</strong>
   <a href="#73484" class="date">25-Feb-2007 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to delete all cookies on your domain, you may want to use the value of:<br />
<br />
<span class="default">&lt;?php $_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">] </span><span class="default">?&gt;<br />
</span><br />
rather than:<br />
<br />
<span class="default">&lt;?php $_COOKIE ?&gt;<br />
</span><br />
to dertermine the cookie names. <br />
If cookie names are in Array notation, eg: user[username] <br />
Then PHP will automatically create a corresponding array in $_COOKIE. Instead use $_SERVER['HTTP_COOKIE'] as it mirrors the actual HTTP Request header. <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// unset cookies<br />
</span><span class="keyword">if (isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">])) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cookies </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">';'</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_COOKIE'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$cookies </span><span class="keyword">as </span><span class="default">$cookie</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$cookie</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$parts</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">1000</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()-</span><span class="default">1000</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73107""></a>
  <div class="note">
   
   <a href="#73107" class="date">08-Feb-2007 05:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
something that wasn't made clear to me here and totally confused me for a while was that domain names must contain at least two dots (.), hence 'localhost' is invalid and the browser will refuse to set the cookie! instead for localhost you should use false.<br />
<br />
to make your code work on both localhost and a proper domain, you can do this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$domain </span><span class="keyword">= (</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">] != </span><span class="string">'localhost'</span><span class="keyword">) ? </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">] : </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'cookiename'</span><span class="keyword">, </span><span class="string">'data'</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">()+</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">365</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$domain</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72456""></a>
  <div class="note">
   <strong class="user">ahmetantmen at msn dot com</strong>
   <a href="#72456" class="date">19-Jan-2007 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can be sure about the cookie files contents weren't changed.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$Seperator </span><span class="keyword">= </span><span class="string">'--'</span><span class="keyword">;<br />
</span><span class="default">$uniqueID </span><span class="keyword">= </span><span class="string">'Ju?hG&amp;F0yh9?=/6*GVfd-d8u6f86hp'</span><span class="keyword">;<br />
</span><span class="default">$Data </span><span class="keyword">= </span><span class="string">'Ahmet '</span><span class="keyword">.</span><span class="default">md5</span><span class="keyword">(</span><span class="string">'123456789'</span><span class="keyword">);<br />
<br />
</span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'VerifyUser'</span><span class="keyword">, </span><span class="default">$Data</span><span class="keyword">.</span><span class="default">$Seperator</span><span class="keyword">.</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$Data</span><span class="keyword">.</span><span class="default">$uniqueID</span><span class="keyword">));<br />
<br />
if (</span><span class="default">$_COOKIE</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$Cut </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$Seperator</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'VerifyUser'</span><span class="keyword">]);<br />
&nbsp;&nbsp; if (</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$Cut</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">].</span><span class="default">$uniqueID</span><span class="keyword">) === </span><span class="default">$Cut</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'VerifyUser'</span><span class="keyword">] = </span><span class="default">$Cut</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; die(</span><span class="string">'Cookie data is invalid!!!'</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'VerifyUser'</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Create a unique id for your site and create a hash with md5($Data.$uniqueID). Attacker can understant that it must be re-hash after change cookie content.<br />
But doesn't. Because cannot guess your unique id. Seperate your hash and data with seperator and send that cookie. Control that hash of returned value and your unique id's is same returned hash. Otherwise you have to stop attack. Sorry for my poor english!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72313""></a>
  <div class="note">
   <strong class="user">stovenator at gmail dot com</strong>
   <a href="#72313" class="date">12-Jan-2007 06:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having issues with IE7 and setcookie(), be sure to verify that the cookie is set via http for http sites, and https for https site. <br />
<br />
Also, if the time is incorrect on your server, IE7 will also disallow those cookies from being set.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71591""></a>
  <div class="note">
   <strong class="user">paul nospam AT nospam sitepoint dot com</strong>
   <a href="#71591" class="date">06-Dec-2006 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note when setting "array cookies" that a separate cookie is set for each element of the array.<br />
<br />
On high traffic sites, this can substantially increase the size of subsequent HTTP requests from clients (including requests for static content on the same domain).<br />
<br />
More importantly though, the cookie specification says that browsers need only accept 20 cookies per domain.&nbsp; This limit is increased to 50 by Firefox, and to 30 by Opera, but IE6 and IE7 enforce the limit of 20 cookie per domain.&nbsp; Any cookies beyond this limit will either knock out an older cookie or be ignored/rejected by the browser.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70959""></a>
  <div class="note">
   <strong class="user">hansel at gretel dot com</strong>
   <a href="#70959" class="date">06-Nov-2006 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following code snippet combines abdullah's and Charles Martin's examples into a powerful combination function (and fixes at least one bug in the process):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">set_cookie_fix_domain</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">, </span><span class="default">$Value </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Expires </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$Path </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Domain </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$Secure </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$HTTPOnly </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$Domain</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Fix the domain to accept domains with and without 'www.'.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">)) == </span><span class="string">'www.'</span><span class="keyword">)&nbsp; </span><span class="default">$Domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Domain </span><span class="keyword">= </span><span class="string">'.' </span><span class="keyword">. </span><span class="default">$Domain</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove port information.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Port </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$Port </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">)&nbsp; </span><span class="default">$Domain </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Domain</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$Port</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Set-Cookie: ' </span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">) . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$Value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Expires</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; expires=' </span><span class="keyword">. </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">'D, d-M-Y H:i:s'</span><span class="keyword">, </span><span class="default">$Expires</span><span class="keyword">) . </span><span class="string">' GMT'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Path</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; path=' </span><span class="keyword">. </span><span class="default">$Path</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (empty(</span><span class="default">$Domain</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; domain=' </span><span class="keyword">. </span><span class="default">$Domain</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (!</span><span class="default">$Secure </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; secure'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; . (!</span><span class="default">$HTTPOnly </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'; HttpOnly'</span><span class="keyword">), </span><span class="default">false</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Basically, if the domain parameter is supplied, it is converted to support a broader range of domains.&nbsp; This behavior may or may not be desireable (e.g. could be a security problem depending on the server) but it makes cookie handling oh-so-much-nicer (IMO).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67191""></a>
  <div class="note">
   <strong class="user">gareth at gw126 dot com</strong>
   <a href="#67191" class="date">05-Jun-2006 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use cookies to prevent a browser refresh repeating some action from a form post... (providing the client is cookie enabled!)
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//Flag up repeat actions (like credit card transaction, etc)
<br />
</span><span class="keyword">if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastpost</span><span class="keyword">= isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'lastpost'</span><span class="keyword">]) ? </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'lastpost'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$lastpost</span><span class="keyword">!=</span><span class="default">md5</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">))) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'lastpost'</span><span class="keyword">, </span><span class="default">md5</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">)));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'_REPEATED'</span><span class="keyword">]=</span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'_REPEATED'</span><span class="keyword">]=</span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
</span><span class="comment">//At this point, if $_POST['_REPEATED']==1, then&nbsp; the user
<br />
//has hit the refresh button; so don't do any actions that you don't
<br />
//want to repeat!
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Hope that helps :)
<br />

<br />
Gareth</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51705""></a>
  <div class="note">
   <strong class="user">Carl V</strong>
   <a href="#51705" class="date">07-Apr-2005 08:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to delete all the cookies set by your domain, you may run the following:<br />
<br />
<span class="default">&lt;?php<br />
$cookiesSet </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$_COOKIE</span><span class="keyword">);<br />
for (</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$cookiesSet</span><span class="keyword">);</span><span class="default">$x</span><span class="keyword">++) </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">$cookiesSet</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">],</span><span class="string">""</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()-</span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Very useful when doing logout scripts and the cookie name may have changed (long story).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36202""></a>
  <div class="note">
   <strong class="user">J?rg Aldinger</strong>
   <a href="#36202" class="date">30-Sep-2003 04:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using your cookies on a webserver that is not on the standard port 80, you should NOT include the :[port] in the "Cookie domain" parameter, since this would not be recognized correctly.
<br />
I had the issue working on a project that runs on multiple servers (development, production, etc.). One of the servers is running on a different port (together with other websites that run on the same server but on different ports).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
