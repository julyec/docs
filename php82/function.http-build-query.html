<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>生成 URL-encode 之后的请求字符串</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.get-meta-tags.html">? get_meta_tags</a></li>
      <li style="float: right;"><a href="function.parse-url.html">parse_url ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.url.html">URL 函数</a></li>
    <li>生成 URL-encode 之后的请求字符串</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.http-build-query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">http_build_query</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">http_build_query</span> &mdash; <span class="dc-title">生成 URL-encode 之后的请求字符串</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.http-build-query-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>http_build_query</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">object</span></span> <code class="parameter">$data</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$numeric_prefix</code><span class="initializer"> = &quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$arg_separator</code><span class="initializer"> = <strong><code>null</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$encoding_type</code><span class="initializer"> = <strong><code>PHP_QUERY_RFC1738</code></strong></span></span><br>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   使用给出的关联（或下标）数组生成一个经过
   URL-encode 的请求字符串。
  </p>
 </div>

 
  <div class="refsect1 parameters" id="refsect1-function.http-build-query-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       可以是数组或包含属性的对象。
      </p>
      <p class="para">
       如果 <code class="parameter">data</code> 是数组，可以是一维结构，也可以是由数组组成的数组（其依次可以包含其它数组）。
      </p>
      <p class="para">
       如果 <code class="parameter">data</code> 是一个对象，只有 public 的属性会加入结果。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">numeric_prefix</code></dt>

     <dd>

      <p class="para">
       如果在基础数组中使用了数字下标同时给出了该参数，此参数值将会作为基础数组中的数字下标元素的前缀。
      </p>
      <p class="para">
       这是为了让
   PHP 或其它 CGI
   程序在稍后对数据进行解码时获取合法的变量名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arg_separator</code></dt>

     <dd>

      <p class="para">
       参数分隔符。如果未设置或为 <strong><code>null</code></strong>，<a href="ini.core.html#ini.arg-separator.output" class="link">arg_separator.output</a>
       用于分隔参数。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">encoding_type</code></dt>

     <dd>

      <p class="para">
       默认使用 <strong><code>PHP_QUERY_RFC1738</code></strong>。
      </p>
      <p class="para">
       如果 <code class="parameter">encoding_type</code> 是 <strong><code>PHP_QUERY_RFC1738</code></strong>，则编码将会以
       <a href="http://www.faqs.org/rfcs/rfc1738" class="link external" title="Link : http://www.faqs.org/rfcs/rfc1738">&raquo;&nbsp;RFC 1738</a> 标准和 <code class="literal">application/x-www-form-urlencoded</code>
       媒体类型进行编码，空格会被编码成加号（<code class="literal">+</code>）。
      </p>
      <p class="para">
       如果 <code class="parameter">encoding_type</code> 是 <strong><code>PHP_QUERY_RFC3986</code></strong>，将根据
       <a href="http://www.faqs.org/rfcs/rfc3986" class="link external" title="Link : http://www.faqs.org/rfcs/rfc3986">&raquo;&nbsp;RFC 3986</a> 编码，空格会被百分号编码（<code class="literal">%20</code>）。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
  <div class="refsect1 returnvalues" id="refsect1-function.http-build-query-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回一个 URL 编码后的字符串。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.http-build-query-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">arg_separator</code> 现在可为 null。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.http-build-query-examples">
  <h3 class="title">示例</h3>
  <div class="example" id="">
   <p><strong>Example #1 <span class="function"><strong>http_build_query()</strong></span> 使用示例</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$data </span><span style="color: #007700">= array(<br />    </span><span style="color: #DD0000">'foo' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'bar'</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'baz' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'boom'</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'cow' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'milk'</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'null' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">null</span><span style="color: #007700">,<br />    </span><span style="color: #DD0000">'php' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'hypertext processor'<br /></span><span style="color: #007700">);<br /><br />echo </span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">) . </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />echo </span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">, </span><span style="color: #DD0000">''</span><span style="color: #007700">, </span><span style="color: #DD0000">'&amp;amp;'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>以上示例会输出：</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
foo=bar&amp;baz=boom&amp;cow=milk&amp;php=hypertext+processor
foo=bar&amp;amp;baz=boom&amp;amp;cow=milk&amp;amp;php=hypertext+processor
</pre></div>
   </div>
  </div>

  <div class="example" id="">
   <p><strong>Example #2 <span class="function"><strong>http_build_query()</strong></span> 使用数字下标的元素</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$data </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'foo'</span><span style="color: #007700">, </span><span style="color: #DD0000">'bar'</span><span style="color: #007700">, </span><span style="color: #DD0000">'baz'</span><span style="color: #007700">, </span><span style="color: #0000BB">null</span><span style="color: #007700">, </span><span style="color: #DD0000">'boom'</span><span style="color: #007700">, </span><span style="color: #DD0000">'cow' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'milk'</span><span style="color: #007700">, </span><span style="color: #DD0000">'php' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'hypertext processor'</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">) . </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />echo </span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">, </span><span style="color: #DD0000">'myvar_'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>以上示例会输出：</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
0=foo&amp;1=bar&amp;2=baz&amp;4=boom&amp;cow=milk&amp;php=hypertext+processor
myvar_0=foo&amp;myvar_1=bar&amp;myvar_2=baz&amp;myvar_4=boom&amp;cow=milk&amp;php=hypertext+processor
</pre></div>
   </div>
  </div>
  <div class="example" id="">
   <p><strong>Example #3 <span class="function"><strong>http_build_query()</strong></span> 使用复杂的数组</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$data </span><span style="color: #007700">= array(<br />    </span><span style="color: #DD0000">'user' </span><span style="color: #007700">=&gt; array(<br />        </span><span style="color: #DD0000">'name' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'Bob Smith'</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'age'  </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">47</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'sex'  </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'M'</span><span style="color: #007700">,<br />        </span><span style="color: #DD0000">'dob'  </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'5/12/1956'<br />    </span><span style="color: #007700">),<br />    </span><span style="color: #DD0000">'pastimes' </span><span style="color: #007700">=&gt; array(</span><span style="color: #DD0000">'golf'</span><span style="color: #007700">, </span><span style="color: #DD0000">'opera'</span><span style="color: #007700">, </span><span style="color: #DD0000">'poker'</span><span style="color: #007700">, </span><span style="color: #DD0000">'rap'</span><span style="color: #007700">),<br />    </span><span style="color: #DD0000">'children' </span><span style="color: #007700">=&gt; array(<br />        </span><span style="color: #DD0000">'bobby' </span><span style="color: #007700">=&gt; array(</span><span style="color: #DD0000">'age'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">12</span><span style="color: #007700">, </span><span style="color: #DD0000">'sex'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'M'</span><span style="color: #007700">),<br />        </span><span style="color: #DD0000">'sally' </span><span style="color: #007700">=&gt; array(</span><span style="color: #DD0000">'age'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">8</span><span style="color: #007700">, </span><span style="color: #DD0000">'sex'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'F'</span><span style="color: #007700">)<br />    ),<br />    </span><span style="color: #DD0000">'CEO'<br /></span><span style="color: #007700">);<br /><br />echo </span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">, </span><span style="color: #DD0000">'flags_'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>
    上面的例子将输出：（为了可读性，字已经换行了）
   </p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
user%5Bname%5D=Bob+Smith&amp;user%5Bage%5D=47&amp;user%5Bsex%5D=M&amp;
user%5Bdob%5D=5%2F12%2F1956&amp;pastimes%5B0%5D=golf&amp;pastimes%5B1%5D=opera&amp;
pastimes%5B2%5D=poker&amp;pastimes%5B3%5D=rap&amp;children%5Bbobby%5D%5Bage%5D=12&amp;
children%5Bbobby%5D%5Bsex%5D=M&amp;children%5Bsally%5D%5Bage%5D=8&amp;
children%5Bsally%5D%5Bsex%5D=F&amp;flags_0=CEO
</pre></div>
   </div>
   <div class="example-contents"><p>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     <p class="para">
      只有基础数组中的数字下标元素"CEO"才获取了前缀，其它数字下标元素（如
      pastimes 下的元素）则不需要为了合法的变量名而加上前缀。
     </p>
    </p></blockquote>
   </p></div>
  </div>

  <div class="example" id="">
   <p><strong>Example #4 <span class="function"><strong>http_build_query()</strong></span> 使用对象</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">parentClass </span><span style="color: #007700">{<br />    public    </span><span style="color: #0000BB">$pub      </span><span style="color: #007700">= </span><span style="color: #DD0000">'publicParent'</span><span style="color: #007700">;<br />    protected </span><span style="color: #0000BB">$prot     </span><span style="color: #007700">= </span><span style="color: #DD0000">'protectedParent'</span><span style="color: #007700">;<br />    private   </span><span style="color: #0000BB">$priv     </span><span style="color: #007700">= </span><span style="color: #DD0000">'privateParent'</span><span style="color: #007700">;<br />    public    </span><span style="color: #0000BB">$pub_bar  </span><span style="color: #007700">= </span><span style="color: #0000BB">null</span><span style="color: #007700">;<br />    protected </span><span style="color: #0000BB">$prot_bar </span><span style="color: #007700">= </span><span style="color: #0000BB">null</span><span style="color: #007700">;<br />    private   </span><span style="color: #0000BB">$priv_bar </span><span style="color: #007700">= </span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /><br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(){<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">pub_bar  </span><span style="color: #007700">= new </span><span style="color: #0000BB">childClass</span><span style="color: #007700">();<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prot_bar </span><span style="color: #007700">= new </span><span style="color: #0000BB">childClass</span><span style="color: #007700">();<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">priv_bar </span><span style="color: #007700">= new </span><span style="color: #0000BB">childClass</span><span style="color: #007700">();<br />    }<br />}<br /><br />class </span><span style="color: #0000BB">childClass </span><span style="color: #007700">{<br />    public    </span><span style="color: #0000BB">$pub  </span><span style="color: #007700">= </span><span style="color: #DD0000">'publicChild'</span><span style="color: #007700">;<br />    protected </span><span style="color: #0000BB">$prot </span><span style="color: #007700">= </span><span style="color: #DD0000">'protectedChild'</span><span style="color: #007700">;<br />    private   </span><span style="color: #0000BB">$priv </span><span style="color: #007700">= </span><span style="color: #DD0000">'privateChild'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">$parent </span><span style="color: #007700">= new </span><span style="color: #0000BB">parentClass</span><span style="color: #007700">();<br /><br />echo </span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$parent</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>以上示例会输出：</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
pub=publicParent&amp;pub_bar%5Bpub%5D=publicChild
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.http-build-query-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.parse-str.html" class="function" rel="rdfs-seeAlso">parse_str()</a> - 将字符串解析成多个变量</span></li>
    <li class="member"><span class="function"><a href="function.parse-url.html" class="function" rel="rdfs-seeAlso">parse_url()</a> - 解析 URL，返回其组成部分</span></li>
    <li class="member"><span class="function"><a href="function.urlencode.html" class="function" rel="rdfs-seeAlso">urlencode()</a> - 编码 URL 字符串</span></li>
    <li class="member"><span class="function"><a href="function.array-walk.html" class="function" rel="rdfs-seeAlso">array_walk()</a> - 使用用户自定义函数对数组中的每个元素做回调处理</span></li>
   </ul>
  </p>
 </div>

 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125076""></a>
  <div class="note">
   <strong class="user">drewdeveloperthomas at gmail dot com</strong>
   <a href="#125076" class="date">03-Jun-2020 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's not mentioned in the documentation, but when calling http_build_query on an object, public null fields are ignored.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">int $publicNotNull</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public ?</span><span class="default">int $publicNull</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">string $privateNotNull</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">publicNotNull </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">privateNotNull </span><span class="keyword">= </span><span class="string">"Test"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$a </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br />
echo </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">); </span><span class="comment">// publicNotNull=2<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123906""></a>
  <div class="note">
   <strong class="user">Sergei S.</strong>
   <a href="#123906" class="date">06-Jun-2019 08:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Number to string conversion occured in <span class="default">&lt;?php http_build_query</span><span class="keyword">() </span><span class="default">?&gt;</span> is affected by locale settings, which might not be obvious.<br />
<br />
<span class="default">&lt;?php<br />
$params </span><span class="keyword">= [</span><span class="string">"v" </span><span class="keyword">=&gt; </span><span class="default">5.63</span><span class="keyword">];<br />
<br />
</span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'us_En'</span><span class="keyword">);<br />
</span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) </span><span class="comment">// v=5.63<br />
<br />
</span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'ru_RU'</span><span class="keyword">);<br />
</span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) </span><span class="comment">// v=5,63 mind the comma<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123357""></a>
  <div class="note">
   <strong class="user">rishad at kaluma dot com</strong>
   <a href="#123357" class="date">20-Nov-2018 03:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using http_build_query($args) where $args is an array; note that there is a limit to the size of array. See max_input_vars in your php.ini to increase this size.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122368""></a>
  <div class="note">
   <strong class="user">shaun at slickdesign dot com dot au</strong>
   <a href="#122368" class="date">08-Feb-2018 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While http_build_query can also be used to encode most classes, into a query string, SimpleXML Elements with &lt;![CDATA[]]&gt; values are picked up as empty arrays, and therefore aren't included naturally.<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">( </span><span class="string">'&lt;wrapper&gt;&lt;key&gt;&lt;![CDATA[value]]&gt;&lt;/key&gt;&lt;key2&gt;value2&lt;/key2&gt;&lt;/wrapper&gt;' </span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">$xml</span><span class="keyword">, </span><span class="default">http_build_query</span><span class="keyword">( </span><span class="default">$xml </span><span class="keyword">) );<br />
</span><span class="comment">/* Outputs:<br />
object(SimpleXMLElement)#1 (2) {<br />
&nbsp; ["key"]=&gt;<br />
&nbsp; object(SimpleXMLElement)#2 (0) {<br />
&nbsp; }<br />
&nbsp; ["key2"]=&gt;<br />
&nbsp; string(6) "value2"<br />
}<br />
string(11) "key2=value2"<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122232""></a>
  <div class="note">
   <strong class="user">flavio at agenciaeme dot com dot br</strong>
   <a href="#122232" class="date">05-Jan-2018 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you send boolean values it transform in integer :<br />
<br />
$a = [teste1= true,teste2=false];<br />
echo http_build_query($a)<br />
<br />
//result will be teste1=1&amp;teste2=0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121556""></a>
  <div class="note">
   <strong class="user">chat dot noir at arcor dot de</strong>
   <a href="#121556" class="date">23-Aug-2017 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need the inverse functionality, and (like me) you cannot use pecl_http, you may want to use something akin to the following.<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">function </span><span class="default">http_parse_query</span><span class="keyword">(</span><span class="default">$Query</span><span class="keyword">) {<br />
<br />
</span><span class="comment">// mimic the behavior of $_GET, see also RFC 1738 and 3986.<br />
</span><span class="default">$Delimiter </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'arg_separator.input'</span><span class="keyword">);<br />
</span><span class="default">$Params&nbsp; &nbsp; </span><span class="keyword">= array();<br />
<br />
foreach (</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$Delimiter</span><span class="keyword">, </span><span class="default">$Query</span><span class="keyword">) as </span><span class="default">$NameValue</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/^(?P&lt;name&gt;[^=\[]*)(?P&lt;indices_present&gt;\[(?P&lt;indices&gt;[^\]]*(\]\[[^\]]*)*)\]?)?(?P&lt;value_present&gt;=(?P&lt;value&gt;.*))?$/'</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NameValue</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NameValueParts<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$NameValueParts</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param </span><span class="keyword">=&amp; </span><span class="default">$Params</span><span class="keyword">[</span><span class="default">$NameValueParts</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$NameValueParts</span><span class="keyword">[</span><span class="string">'indices_present'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Indices </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">']['</span><span class="keyword">, </span><span class="default">$NameValueParts</span><span class="keyword">[</span><span class="string">'indices'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$Indices </span><span class="keyword">as </span><span class="default">$Index</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$Param</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$Index </span><span class="keyword">=== </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param</span><span class="keyword">[] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">end</span><span class="keyword">(</span><span class="default">$Param</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param </span><span class="keyword">=&amp; </span><span class="default">$Param</span><span class="keyword">[</span><span class="default">key</span><span class="keyword">(</span><span class="default">$Param</span><span class="keyword">)];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">ctype_digit</span><span class="keyword">(</span><span class="default">$Index</span><span class="keyword">)) { </span><span class="default">$Index&nbsp; </span><span class="keyword">= (int) </span><span class="default">$Index</span><span class="keyword">;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$Index</span><span class="keyword">, </span><span class="default">$Param</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param</span><span class="keyword">[</span><span class="default">$Index</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param </span><span class="keyword">=&amp; </span><span class="default">$Param</span><span class="keyword">[</span><span class="default">$Index</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$NameValueParts</span><span class="keyword">[</span><span class="string">'value_present'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$NameValueParts</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Param </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
return </span><span class="default">$Params</span><span class="keyword">;<br />
<br />
}</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120673""></a>
  <div class="note">
   <strong class="user">rmaslo at archa dot cz</strong>
   <a href="#120673" class="date">20-Feb-2017 12:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: Different arrays may return the same result<br />
<br />
&lt;CODE&gt;<br />
$a1 = array('x[y]' =&gt; array('a'=&gt;1));<br />
$a2 = array('x' =&gt; array('y' =&gt; array('a'=&gt;1)));<br />
$q1 = http_build_query($a1);<br />
$q2 = http_build_query($a2);<br />
var_dump($a1);<br />
echo '&lt;BR&gt;';<br />
var_dump($a2);<br />
echo '&lt;BR&gt;';<br />
echo $q1;<br />
echo '&lt;BR&gt;';<br />
echo $q2;<br />
echo '&lt;BR&gt;';<br />
&lt;/CODE&gt;<br />
<br />
Result:<br />
array(1) { ["x[y]"]=&gt; array(1) { ["a"]=&gt; int(1) } }<br />
array(1) { ["x"]=&gt; array(1) { ["y"]=&gt; array(1) { ["a"]=&gt; int(1) } } }<br />
x%5By%5D%5Ba%5D=1<br />
x%5By%5D%5Ba%5D=1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118760""></a>
  <div class="note">
   <strong class="user">joelhy</strong>
   <a href="#118760" class="date">01-Feb-2016 03:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Params with false value will be changed to zero in result string.<br />
<br />
<span class="default">&lt;?php<br />
$arr </span><span class="keyword">= [</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="default">false</span><span class="keyword">];<br />
echo </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
will produce:<br />
<br />
foo=0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118321""></a>
  <div class="note">
   <strong class="user">itsadok at gmail dot com</strong>
   <a href="#118321" class="date">17-Nov-2015 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Passing null to $arg_separator is the same as passing an empty string, which is probably not what you want. <br />
<br />
If you need to change the enc_type, use this:<br />
<br />
&nbsp;&nbsp;&nbsp; http_build_query($query, null, '&amp;', PHP_QUERY_RFC3986);<br />
<br />
Or possibly this:<br />
<br />
&nbsp;&nbsp;&nbsp; http_build_query($query, null, ini_get('arg_separator.output'), PHP_QUERY_RFC3986);<br />
<br />
But not this:<br />
<br />
&nbsp;&nbsp;&nbsp; // BAD CODE!<br />
&nbsp;&nbsp;&nbsp; http_build_query($query, null, null, PHP_QUERY_RFC3986);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117656""></a>
  <div class="note">
   <strong class="user">james at dimensionengineering dot com</strong>
   <a href="#117656" class="date">15-Jul-2015 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful about Example 1 -- it is exactly how *not* to implement things.<br />
<br />
&amp; as a separator is the URL encoding.<br />
&amp;amp; is HTML encoding.<br />
<br />
You should HTML encode your URL if embedding it in a web page. This is more involved than just replacing &amp; with &amp;amp;. Doing as this example suggests is a security hole waiting to happen.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117457""></a>
  <div class="note">
   <strong class="user">joey dot qiang at innomative dot com</strong>
   <a href="#117457" class="date">12-Jun-2015 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Not recommending to eliminate the numeric indices like:<br />
'arg[0]' --&gt; 'arg[]'<br />
<br />
The reason is this function will not include null values in the result string:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $data = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'arg' =&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; null,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 2,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 3<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo http_build_query($data);<br />
<br />
The output is something like "arg[1]=2&amp;arg[2]=3";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116791""></a>
  <div class="note">
   <strong class="user">Mark Simon</strong>
   <a href="#116791" class="date">01-Mar-2015 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted, this function omits keys with null values. This could break some code which treats the key as boolean, and so has no value, or other code expecting the array to be populated regardless of value.<br />
<br />
A workaround for this is to replace the null values with an empty string:<br />
<br />
&nbsp;&nbsp;&nbsp; $data=array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'a'=&gt;'apple',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'b'=&gt;2,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'c'=&gt;null,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'd'=&gt;'...',<br />
&nbsp;&nbsp;&nbsp; );<br />
<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp; Compensate for fact that http_build_query omits null values<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($data as &amp;$datum) if($datum===null) $datum='';<br />
<br />
Losing the null-ness of the original is no real loss if it's supposed to be a real query string. If the null is important, you could use a dummy value instead.<br />
<br />
Mark</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113859""></a>
  <div class="note">
   <strong class="user">jakub dot lopuszanski at nasza-klasa dot pl</strong>
   <a href="#113859" class="date">10-Dec-2013 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While this is not documented, this http_build_query can return FALSE on some inputs:<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">//gives bool(false)<br />
&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">http_build_query</span><span class="keyword">(</span><span class="string">'whatever'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112721""></a>
  <div class="note">
   <strong class="user">Kirils Solovjovs</strong>
   <a href="#112721" class="date">16-Jul-2013 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
instead of some other suggestions that did not work for me, I found that the best way to build POST content (e.g. for stream_context_create) is urldecode(http_build_query($query))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112024""></a>
  <div class="note">
   <strong class="user">Vitaly Dyatlov</strong>
   <a href="#112024" class="date">23-Apr-2013 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Correct implementation of coding the array of params without indexes (valdikks fixed code - didnt work for inner arrays):<br />
<br />
&lt;code&gt;<br />
function cr_post($a,$b='',$c=0)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!is_array($a)) return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach ((array)$a as $k=&gt;$v)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($c)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( is_numeric($k) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $k=$b."[]";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $k=$b."[$k]";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {&nbsp;&nbsp; if (is_int($k))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $k=$b.$k;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_array($v)||is_object($v))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $r[]=cr_post($v,$k,1);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $r[]=urlencode($k)."=".urlencode($v);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return implode("&amp;",$r);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&lt;/code&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111819""></a>
  <div class="note">
   <strong class="user">eric dot muyser at gmail dot com</strong>
   <a href="#111819" class="date">01-Apr-2013 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function makes like this<br />
<br />
files[0]=1&amp;files[1]=2&amp;...<br />
<br />
To do it like this:<br />
<br />
files[]=1&amp;files[]=2&amp;...<br />
<br />
Do this:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $query = http_build_query($query);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $query = preg_replace('/%5B[0-9]+%5D/simU', '%5B%5D', $query);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111533""></a>
  <div class="note">
   <strong class="user">stocki dot r at gmail dot com</strong>
   <a href="#111533" class="date">01-Mar-2013 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need only key+value pairs, you can use this:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $array </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"type" </span><span class="keyword">=&gt; </span><span class="string">"welcome"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"message" </span><span class="keyword">=&gt; </span><span class="string">"Hello World!"<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">';'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Result: type=welcome;message=Hello World!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109466""></a>
  <div class="note">
   <strong class="user">anonymous</strong>
   <a href="#109466" class="date">19-Jul-2012 03:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Is it worth noting that if query_data is an associative array and a value is itself an empty array, or an array of nothing but empty array (or arrays containing only empty arrays etc.), the corresponding key will not appear in the resulting query string?<br />
E.g.<br />
<br />
$post_data = array('name'=&gt;'miller', 'address'=&gt;array('address_lines'=&gt;array()), 'age'=&gt;23);<br />
echo http_build_query($post_data);<br />
<br />
will print<br />
name=miller&amp;age=23</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102324""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#102324" class="date">08-Feb-2011 12:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted before, with php5.3 the separator is &amp;amp; on some servers it seems. Normally if posting to another php5.3 machine this will not be a problem.<br />
<br />
But if you post to a tomcat java server or something else the &amp;amp; might not be handled properly.<br />
<br />
To overcome this specify:<br />
<br />
http_build_query($array, '', '&amp;');<br />
<br />
and NOT<br />
<br />
http_build_query($array); //gives &amp;amp; to some servers</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96692""></a>
  <div class="note">
   <strong class="user">v0idnull[try_to_spam_me_now] at gee-mail dot co</strong>
   <a href="#96692" class="date">11-Mar-2010 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
on my install of PHP 5.3, http_build_query() seems to use &amp;amp; as the default separator. Kind of interesting when combined with stream_context_create() for a POST request, and getting $_POST['amp;fieldName'] on the receiving end.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95784""></a>
  <div class="note">
   <strong class="user">irish [-@-] ytdj [-dot-] ca</strong>
   <a href="#95784" class="date">21-Jan-2010 01:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using the http_build_query function to create a URL query from an array for use in something like curl_setopt($ch, CURLOPT_POSTFIELDS, $post_url), be careful about the url encoding.
<br />

<br />
In my case, I simply wanted to pass on the received $_POST data to a CURL's POST data, which requires it to be in the URL format.&nbsp; If something like a space [ ] goes into the http_build_query, it comes out as a +. If you're then sending this off for POST again, you won't get the expected result.&nbsp; This is good for GET but not POST.
<br />

<br />
Instead you can make your own simple function if you simply want to pass along the data:
<br />

<br />
<span class="default">&lt;?php
<br />
$post_url </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
foreach (</span><span class="default">$_POST </span><span class="keyword">AS </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$post_url </span><span class="keyword">.= </span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'&amp;'</span><span class="keyword">;
<br />
</span><span class="default">$post_url </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$post_url</span><span class="keyword">, </span><span class="string">'&amp;'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
You can then use this to pass along POST data in CURL.
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; $ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$some_url</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$post_url</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Note that at the final page that processes the POST data, you should be properly filtering/escaping it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93172""></a>
  <div class="note">
   <strong class="user">netrox at aol dot com</strong>
   <a href="#93172" class="date">26-Aug-2009 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I noticed that even with the magic quotes disabled, http_build_query() automagically adds slashes to strings. <br />
<br />
So, I had to add "stripslashes" to every string variable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77377""></a>
  <div class="note">
   <strong class="user">valdikss at gmail dot com</strong>
   <a href="#77377" class="date">27-Aug-2007 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is wrong for http!<br />
arrays in http is like this:<br />
<br />
files[]=1&amp;files[]=2&amp;...<br />
<br />
but function makes like this<br />
<br />
files[0]=1&amp;files[1]=2&amp;...<br />
<br />
Here is normal function:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">cr_post</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">=\</span><span class="string">'\',$c=0){<br />
if (!is_array($a)) return false;<br />
foreach ((array)$a as $k=&gt;$v){<br />
if ($c) $k=$b.\"[]\"; elseif (is_int($k)) $k=$b.$k;<br />
if (is_array($v)||is_object($v)) {$r[]=cr_post($v,$k,1);continue;}<br />
$r[]=urlencode($k).\"=\".urlencode($v);}return implode(\"&amp;\",$r);}<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60523""></a>
  <div class="note">
   <strong class="user">Ilya Rudenko</strong>
   <a href="#60523" class="date">09-Jan-2006 11:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Params with null value do not present in result string.
<br />

<br />
<span class="default">&lt;?php
<br />
$arr </span><span class="keyword">= array(</span><span class="string">'test' </span><span class="keyword">=&gt; </span><span class="default">null</span><span class="keyword">, </span><span class="string">'test2' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">);
<br />
echo </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
will produce:
<br />

<br />
test2=1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
