<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>存储一个元素</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="memcached.resetserverlist.html">? Memcached::resetServerList</a></li>
      <li style="float: right;"><a href="memcached.setbykey.html">Memcached::setByKey ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.memcached.html">Memcached</a></li>
    <li>存储一个元素</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="memcached.set" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Memcached::set</h1>
  <p class="verinfo">(PECL memcached &gt;= 0.1.0)</p><p class="refpurpose"><span class="refname">Memcached::set</span> &mdash; <span class="dc-title">存储一个元素</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-memcached.set-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>Memcached::set</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$key</code></span>, <span class="methodparam"><span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$expiration</code><span class="initializer"> = ?</span></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>Memcached::set()</strong></span> 将 <code class="parameter">value</code>
   存储在一个 memcached 服务器上的 <code class="parameter">key</code> 下。<code class="parameter">expiration</code> 参数
   用于控制值的过期时间。
  </p>
  <p class="para">
  值可以是任何有效的非资源型 php 类型，因为资源类型不能被序列化存储。如果 <strong><code>Memcached::OPT_COMPRESSION</code></strong>
  选项开启，序列化的值同样会被压缩存储。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-memcached.set-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">key</code></dt>

     <dd>

      <p class="para">
       用于存储值的键名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       存储的值。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">expiration</code></dt>

     <dd>

      <p class="para">
       到期时间，默认为 0。 更多信息请参见<a href="memcached.expiration.html" class="link">到期时间</a>。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-memcached.set-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>true</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
   如需要则使用 <span class="methodname"><a href="memcached.getresultcode.html" class="methodname">Memcached::getResultCode()</a></span>。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-memcached.set-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>Memcached::set()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$m </span><span style="color: #007700">= new </span><span style="color: #0000BB">Memcached</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">, </span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #DD0000">'int'</span><span style="color: #007700">, </span><span style="color: #0000BB">99</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #DD0000">'string'</span><span style="color: #007700">, </span><span style="color: #DD0000">'a simple string'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #DD0000">'array'</span><span style="color: #007700">, array(</span><span style="color: #0000BB">11</span><span style="color: #007700">, </span><span style="color: #0000BB">12</span><span style="color: #007700">));<br /></span><span style="color: #FF8000">/* 'object' 这个 key 将在 5 分钟后过期 */<br /></span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #DD0000">'object'</span><span style="color: #007700">, new </span><span style="color: #0000BB">stdClass</span><span style="color: #007700">, </span><span style="color: #0000BB">time</span><span style="color: #007700">() + </span><span style="color: #0000BB">300</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'int'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'string'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'array'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'object'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
int(99)
string(15) &quot;a simple string&quot;
array(2) {
  [0]=&gt;
  int(11)
  [1]=&gt;
  int(12)
}
object(stdClass)#1 (0) {
}
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-memcached.set-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="methodname"><a href="memcached.setbykey.html" class="methodname" rel="rdfs-seeAlso">Memcached::setByKey()</a> - 将元素存储到指定的服务器上</span></li>
    <li class="member"><span class="methodname"><a href="memcached.add.html" class="methodname" rel="rdfs-seeAlso">Memcached::add()</a> - 向新 key 添加元素</span></li>
    <li class="member"><span class="methodname"><a href="memcached.replace.html" class="methodname" rel="rdfs-seeAlso">Memcached::replace()</a> - 替换已存在 key 下的元素</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119288""></a>
  <div class="note">
   <strong class="user">HaxxxxaH</strong>
   <a href="#119288" class="date">05-May-2016 05:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@PeterN<br />
<br />
You said that this was wrong:<br />
$m-&gt;set('object', new stdclass, time() + 300);<br />
<br />
And instead this is the correct way:<br />
$m-&gt;set('object', new stdclass, 300);<br />
<br />
When actually, they are both correct. Expiration looks at the time given, if the number is less than or equal to 30 days(60 * 60 * 24 * 30 = 2,592,000), then it expires in that many seconds. If the number is greater than 30 days, then it expires at that UNIX time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118157""></a>
  <div class="note">
   <strong class="user">PeterN</strong>
   <a href="#118157" class="date">16-Oct-2015 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the example it shows:<br />
<br />
/* expire 'object' key in 5 minutes */<br />
$m-&gt;set('object', new stdclass, time() + 300);<br />
<br />
But this is wrong.<br />
It will not expire, at least, not for a long long time.<br />
So instead of time() + seconds, you use:<br />
$m-&gt;set('object', new stdclass, 300);<br />
And it will correctly expire after 5 minutes.<br />
<br />
Note: Using memcached 2.1.0 stable through PECL.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114651""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#114651" class="date">18-Mar-2014 03:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
00 = MEMCACHED_SUCCESS<br />
01 = MEMCACHED_FAILURE<br />
02 = MEMCACHED_HOST_LOOKUP_FAILURE // getaddrinfo() and getnameinfo() only<br />
03 = MEMCACHED_CONNECTION_FAILURE<br />
04 = MEMCACHED_CONNECTION_BIND_FAILURE // DEPRECATED see MEMCACHED_HOST_LOOKUP_FAILURE<br />
05 = MEMCACHED_WRITE_FAILURE<br />
06 = MEMCACHED_READ_FAILURE<br />
07 = MEMCACHED_UNKNOWN_READ_FAILURE<br />
08 = MEMCACHED_PROTOCOL_ERROR<br />
09 = MEMCACHED_CLIENT_ERROR<br />
10 = MEMCACHED_SERVER_ERROR // Server returns "SERVER_ERROR"<br />
11 = MEMCACHED_ERROR // Server returns "ERROR"<br />
12 = MEMCACHED_DATA_EXISTS<br />
13 = MEMCACHED_DATA_DOES_NOT_EXIST<br />
14 = MEMCACHED_NOTSTORED<br />
15 = MEMCACHED_STORED<br />
16 = MEMCACHED_NOTFOUND<br />
17 = MEMCACHED_MEMORY_ALLOCATION_FAILURE<br />
18 = MEMCACHED_PARTIAL_READ<br />
19 = MEMCACHED_SOME_ERRORS<br />
20 = MEMCACHED_NO_SERVERS<br />
21 = MEMCACHED_END<br />
22 = MEMCACHED_DELETED<br />
23 = MEMCACHED_VALUE<br />
24 = MEMCACHED_STAT<br />
25 = MEMCACHED_ITEM<br />
26 = MEMCACHED_ERRNO<br />
27 = MEMCACHED_FAIL_UNIX_SOCKET // DEPRECATED<br />
28 = MEMCACHED_NOT_SUPPORTED<br />
29 = MEMCACHED_NO_KEY_PROVIDED /* Deprecated. Use MEMCACHED_BAD_KEY_PROVIDED! */<br />
30 = MEMCACHED_FETCH_NOTFINISHED<br />
31 = MEMCACHED_TIMEOUT<br />
32 = MEMCACHED_BUFFERED<br />
33 = MEMCACHED_BAD_KEY_PROVIDED<br />
34 = MEMCACHED_INVALID_HOST_PROTOCOL<br />
35 = MEMCACHED_SERVER_MARKED_DEAD<br />
36 = MEMCACHED_UNKNOWN_STAT_KEY<br />
37 = MEMCACHED_E2BIG<br />
38 = MEMCACHED_INVALID_ARGUMENTS<br />
39 = MEMCACHED_KEY_TOO_BIG<br />
40 = MEMCACHED_AUTH_PROBLEM<br />
41 = MEMCACHED_AUTH_FAILURE<br />
42 = MEMCACHED_AUTH_CONTINUE<br />
43 = MEMCACHED_PARSE_ERROR<br />
44 = MEMCACHED_PARSE_USER_ERROR<br />
45 = MEMCACHED_DEPRECATED<br />
46 = MEMCACHED_IN_PROGRESS<br />
47 = MEMCACHED_SERVER_TEMPORARILY_DISABLED<br />
48 = MEMCACHED_SERVER_MEMORY_ALLOCATION_FAILURE<br />
49 = MEMCACHED_MAXIMUM_RETURN /* Always add new error code before */<br />
11 = MEMCACHED_CONNECTION_SOCKET_CREATE_FAILURE = MEMCACHED_ERROR</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113677""></a>
  <div class="note">
   <strong class="user">Matthew Minix</strong>
   <a href="#113677" class="date">14-Nov-2013 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Unlike Memcache, Memcached will not replace spaces in keys with underscores for you, and will instead send the key as provided which will cause an error that can result in keys and values being mismatched.&nbsp; You can avoid this problem by removing/replacing spaces before storage or setting the option Memcached::OPT_BINARY_PROTOCOL to true.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92259""></a>
  <div class="note">
   <strong class="user">miha at hribar dot info</strong>
   <a href="#92259" class="date">16-Jul-2009 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The method correctly returns false if you set the value to false. This means that in order to have proper fault checking mechanism in place you need to check the result code.<br />
<br />
<span class="default">&lt;?php<br />
$Memcached </span><span class="keyword">= new </span><span class="default">Memcached</span><span class="keyword">();<br />
</span><span class="default">$Memcached</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);<br />
</span><span class="default">$Memcached</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">'key'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$Memcached</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="string">'key'</span><span class="keyword">));&nbsp; &nbsp; &nbsp; </span><span class="comment">// boolean false<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$Memcached</span><span class="keyword">-&gt;</span><span class="default">getResultCode</span><span class="keyword">()); </span><span class="comment">// int 0 which is&nbsp; Memcached::RES_SUCCESS&nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
