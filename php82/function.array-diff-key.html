<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>使用键名比较计算数组的差集</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.array-diff-assoc.html">? array_diff_assoc</a></li>
      <li style="float: right;"><a href="function.array-diff-uassoc.html">array_diff_uassoc ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.array.html">数组 函数</a></li>
    <li>使用键名比较计算数组的差集</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.array-diff-key" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">array_diff_key</h1>
    <p class="verinfo">(PHP 5 &gt;= 5.1.0, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">array_diff_key</span> &mdash; <span class="dc-title">使用键名比较计算数组的差集</span></p>

   </div>
 <div class="refsect1 description" id="refsect1-function.array-diff-key-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>array_diff_key</strong></span>(<span class="methodparam"><span class="type">array</span> <code class="parameter">$array</code></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">...$arrays</code></span>): <span class="type">array</span></div>

    <p class="para rdfs-comment">
     根据 <code class="parameter">array</code> 中的键名和 <code class="parameter">arrays</code> 进行比较，返回不同键名的项。
     本函数和
     <span class="function"><a href="function.array-diff.html" class="function">array_diff()</a></span> 相同只除了比较是根据键名而不是值来进行的。
    </p>
   </div>


 <div class="refsect1 parameters" id="refsect1-function.array-diff-key-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">array</code></dt>

     <dd>

      <p class="para">
       从这个数组进行比较
      </p>
     </dd>

    

    
     <dt>
<code class="parameter">arrays</code></dt>

     <dd>

      <p class="para">
       要进行比较的数组
      </p>
     </dd>

    

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.array-diff-key-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回一个数组，该数组包含了所有出现在 <code class="parameter">array</code> 中但是未出现在任何其它数组中的键名的值。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.array-diff-key-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
  <td>8.0.0</td>
  <td>
  现在可以仅使用一个参数调用此函数。以前，至少需要两个参数。
  </td>
</tr>

     </tbody>
    
   </table>

  </p>
 </div>




 <div class="refsect1 examples" id="refsect1-function.array-diff-key-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>array_diff_key()</strong></span> 例</strong></p>
    <div class="example-contents"><p>
      在 <code class="literal">key =&gt; value</code> 对中的两个键名仅在
     <code class="literal">(string) $key1 === (string) $key2 </code>
     时被认为相等。换句话说，执行的是严格类型检查，因此字符串的表达必须完全一样。
    </p></div>
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$array1 </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'blue' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #DD0000">'red' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">2</span><span style="color: #007700">, </span><span style="color: #DD0000">'green' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">3</span><span style="color: #007700">, </span><span style="color: #DD0000">'purple' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">4</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$array2 </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'green' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">5</span><span style="color: #007700">, </span><span style="color: #DD0000">'yellow' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">7</span><span style="color: #007700">, </span><span style="color: #DD0000">'cyan' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">8</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">array_diff_key</span><span style="color: #007700">(</span><span style="color: #0000BB">$array1</span><span style="color: #007700">, </span><span style="color: #0000BB">$array2</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [&quot;blue&quot;]=&gt;
  int(1)
  [&quot;red&quot;]=&gt;
  int(2)
  [&quot;purple&quot;]=&gt;
  int(4)
}
</pre></div>
    </div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$array1 </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'blue' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #DD0000">'red'  </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">2</span><span style="color: #007700">, </span><span style="color: #DD0000">'green' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">3</span><span style="color: #007700">, </span><span style="color: #DD0000">'purple' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">4</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$array2 </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'green' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">5</span><span style="color: #007700">, </span><span style="color: #DD0000">'yellow' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">7</span><span style="color: #007700">, </span><span style="color: #DD0000">'cyan' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">8</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$array3 </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'blue' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">6</span><span style="color: #007700">, </span><span style="color: #DD0000">'yellow' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">7</span><span style="color: #007700">, </span><span style="color: #DD0000">'mauve' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">8</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">array_diff_key</span><span style="color: #007700">(</span><span style="color: #0000BB">$array1</span><span style="color: #007700">, </span><span style="color: #0000BB">$array2</span><span style="color: #007700">, </span><span style="color: #0000BB">$array3</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(2) {
  [&quot;red&quot;]=&gt;
  int(2)
  [&quot;purple&quot;]=&gt;
  int(4)
}
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.array-diff-key-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
      注意本函数只检查了多维数组中的一维。当然，可以用
      <code class="literal">array_diff_key($array1[0], $array2[0]);</code>
      来检查更深的维度。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.array-diff-key-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.array-diff.html" class="function" rel="rdfs-seeAlso">array_diff()</a> - 计算数组的差集</span></li>
    <li class="member"><span class="function"><a href="function.array-udiff.html" class="function" rel="rdfs-seeAlso">array_udiff()</a> - 用回调函数比较数据来计算数组的差集</span></li>
    <li class="member"><span class="function"><a href="function.array-diff-assoc.html" class="function" rel="rdfs-seeAlso">array_diff_assoc()</a> - 带索引检查计算数组的差集</span></li>
    <li class="member"><span class="function"><a href="function.array-diff-uassoc.html" class="function" rel="rdfs-seeAlso">array_diff_uassoc()</a> - 用用户提供的回调函数做索引检查来计算数组的差集</span></li>
    <li class="member"><span class="function"><a href="function.array-udiff-assoc.html" class="function" rel="rdfs-seeAlso">array_udiff_assoc()</a> - 带索引检查计算数组的差集，用回调函数比较数据</span></li>
    <li class="member"><span class="function"><a href="function.array-udiff-uassoc.html" class="function" rel="rdfs-seeAlso">array_udiff_uassoc()</a> - 带索引检查计算数组的差集，用回调函数比较数据和索引</span></li>
    <li class="member"><span class="function"><a href="function.array-diff-ukey.html" class="function" rel="rdfs-seeAlso">array_diff_ukey()</a> - 用回调函数对键名比较计算数组的差集</span></li>
    <li class="member"><span class="function"><a href="function.array-intersect.html" class="function" rel="rdfs-seeAlso">array_intersect()</a> - 计算数组的交集</span></li>
    <li class="member"><span class="function"><a href="function.array-intersect-assoc.html" class="function" rel="rdfs-seeAlso">array_intersect_assoc()</a> - 带索引检查计算数组的交集</span></li>
    <li class="member"><span class="function"><a href="function.array-intersect-uassoc.html" class="function" rel="rdfs-seeAlso">array_intersect_uassoc()</a> - 带索引检查计算数组的交集，用回调函数比较索引</span></li>
    <li class="member"><span class="function"><a href="function.array-intersect-key.html" class="function" rel="rdfs-seeAlso">array_intersect_key()</a> - 使用键名比较计算数组的交集</span></li>
    <li class="member"><span class="function"><a href="function.array-intersect-ukey.html" class="function" rel="rdfs-seeAlso">array_intersect_ukey()</a> - 在键名上使用回调函数来比较计算数组的交集</span></li>
   </ul>
  </p>
 </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115725""></a>
  <div class="note">
   <strong class="user">rhallsey at yahoo dot com</strong>
   <a href="#115725" class="date">13-Sep-2014 12:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple function that returns true if all keys in the first array are found in the second array, and false if they aren't.<br />
<br />
function same_keys ($a1, $a2) {<br />
&nbsp;&nbsp;&nbsp; $same = false;<br />
&nbsp;&nbsp;&nbsp; if (!array_diff_key($a1, $a2)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $same = true;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($a1 as $k =&gt; $v) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_array($v) &amp;&amp; !same_keys($v, $a2[$k])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $same = false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $same;<br />
}<br />
<br />
To check if two arrays have the same structure, ignoring values, execute the function twice, the second time with the arguments reversed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112558""></a>
  <div class="note">
   <strong class="user">gk at anuary dot com</strong>
   <a href="#112558" class="date">29-Jun-2013 03:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Improved recursive version.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* @author Gajus Kuizinas &lt;gk@anuary.com&gt;<br />
&nbsp;* @version 1.0.0 (2013 03 19)<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">array_diff_key_recursive </span><span class="keyword">(array </span><span class="default">$arr1</span><span class="keyword">, array </span><span class="default">$arr2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">array_diff_key</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">, </span><span class="default">$arr2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$intersect </span><span class="keyword">= </span><span class="default">array_intersect_key</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">, </span><span class="default">$arr2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$intersect </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]) &amp;&amp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">array_diff_key_recursive</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$arr2</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$d</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$diff</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$d</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$diff</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
An up to date version is maintained at https://github.com/gajus/flow/blob/master/flow.inc.php#L337.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86109""></a>
  <div class="note">
   <strong class="user">division-par-zero at zilon dot net</strong>
   <a href="#86109" class="date">03-Oct-2008 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can use this function for return the difference of two array !
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">array_unique_diff_key </span><span class="keyword">(</span><span class="default">$array1</span><span class="keyword">, </span><span class="default">$array2</span><span class="keyword">)
<br />
{
<br />
&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array1</span><span class="keyword">) &amp;&amp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array2</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">array_diff_key</span><span class="keyword">(</span><span class="default">$array1</span><span class="keyword">, </span><span class="default">$array2</span><span class="keyword">) + </span><span class="default">array_diff_key</span><span class="keyword">(</span><span class="default">$array2</span><span class="keyword">, </span><span class="default">$array1</span><span class="keyword">);
<br />
&nbsp; else if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array1</span><span class="keyword">)) return </span><span class="default">$array1</span><span class="keyword">;
<br />
&nbsp; else if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array2</span><span class="keyword">)) return </span><span class="default">$array2</span><span class="keyword">;
<br />
&nbsp; else return array();
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82257""></a>
  <div class="note">
   <strong class="user">Ashton</strong>
   <a href="#82257" class="date">02-Apr-2008 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To return the unique elements (those with a key that exists only once in either array but not in both) try:<br />
function array_unique_diff ($array1, $array2)<br />
{<br />
&nbsp; array_merge(array_diff_key($array1, $array2), array_diff_key($array2, $array1));<br />
}<br />
<br />
Example:<br />
$array1 = array('blue'&nbsp; =&gt; 1, 'red'&nbsp; =&gt; 2, 'green'&nbsp; =&gt; 3, 'purple' =&gt; 4);<br />
$array2 = array('green' =&gt; 5, 'blue' =&gt; 6, 'yellow' =&gt; 7, 'cyan'&nbsp;&nbsp; =&gt; 8);<br />
<br />
&nbsp; array_diff_key($array1, $array2)<br />
<br />
returns<br />
<br />
&nbsp; array ( 'red' =&gt; 2, 'purple' =&gt; 4 ) <br />
<br />
&nbsp; array_diff_key($array2, $array1)<br />
<br />
returns<br />
<br />
&nbsp; array ( 'yellow' =&gt; 7, 'cyan' =&gt; 8, )<br />
<br />
&nbsp; array_unique_diff($array1, $array2);<br />
&nbsp; <br />
returns<br />
<br />
&nbsp; array ( 'red' =&gt; 2, 'purple' =&gt; 4, 'yellow' =&gt; 7, 'cyan' =&gt; 8, )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81456""></a>
  <div class="note">
   <strong class="user">sjungwirth at matrix-consultants dot com</strong>
   <a href="#81456" class="date">28-Feb-2008 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed something a little different where maybe even the keys in multidimensional arrays don't match up. Setting $assoc to false will cause only to check for missing keys, otherwise it compares values as well. This was also based on '2ge at 2ge dot us' function<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">n_array_diff_assoc </span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">, </span><span class="default">$assoc</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">))):<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$a1 </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$a2</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">])):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">n_array_diff</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$a2</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$assoc</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$diff</span><span class="keyword">)):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$diff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; endif;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; endif;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; endforeach;<br />
&nbsp;&nbsp;&nbsp; else:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">$assoc </span><span class="keyword">? </span><span class="default">array_diff_assoc</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">) : </span><span class="default">array_diff_key</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; endif;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81172""></a>
  <div class="note">
   <strong class="user">coder at gs dot com</strong>
   <a href="#81172" class="date">16-Feb-2008 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The PHP4 version below works only unidirectionally. If you switch the arrays around i.e. (ar2, ar1) you get different results than (ar1, ar2).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79483""></a>
  <div class="note">
   <strong class="user">AiFiLTr0 [at host] invyl [dot] ath.cx</strong>
   <a href="#79483" class="date">29-Nov-2007 05:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The recursive function suggested by '2ge at 2ge dot us' will provide you with empty arrays if there's no diff. <br />
This variant of the function cleans up empty arrays and fixes a bug in the first suggested version. It works 100%<br />
.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">array_diff_key_recursive </span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$a1 </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//$r[$k] = is_array($v) ? $this-&gt;array_diff_key_recursive($a1[$k], $a2[$k]) : array_diff_key($a1, $a2);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]=</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">array_diff_key_recursive</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$a2</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">=</span><span class="default">array_diff_key</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">])==</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62704""></a>
  <div class="note">
   <strong class="user">2ge at 2ge dot us</strong>
   <a href="#62704" class="date">07-Mar-2006 11:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello, if you need diff key of n-dimensional arrays here is nice solution:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">n_array_diff </span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$a1 </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">) ? </span><span class="default">n_array_diff</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">], </span><span class="default">$a2</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]) : </span><span class="default">array_diff_key</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$a2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>it will print everything, what is missing in $a2.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60675""></a>
  <div class="note">
   <strong class="user">vlad_mustafin at ukr dot net</strong>
   <a href="#60675" class="date">13-Jan-2006 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One more alternative variant :)<br />
&lt;?<br />
if (!function_exists('array_diff_key')) {<br />
&nbsp;&nbsp;&nbsp; function array_diff_key() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $argCount&nbsp;&nbsp; = func_num_args();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $diff_arg_prefix = 'diffArg';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $diff_arg_names = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($i=0; $i &lt; $argCount; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $diff_arg_names[$i] = 'diffArg'.$i;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $$diff_arg_names[$i] = array_keys((array)func_get_arg($i));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $diffArrString = '';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!empty($diff_arg_names)) $diffArrString =&nbsp; '$'.implode(', $', $diff_arg_names);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; eval("\$result = array_diff(".$diffArrString.");");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $result;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59087""></a>
  <div class="note">
   <strong class="user">ampf at egp dot up dot pt</strong>
   <a href="#59087" class="date">25-Nov-2005 12:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Well, you could implement in the code something more powerfull: <br />
<br />
<a href="http://www.php.net/manual/en/function.array-diff.php#31364" rel="nofollow" target="_blank">http://www.php.net/manual/en/function.array-diff.php#31364</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53283""></a>
  <div class="note">
   <strong class="user">maxence at pontapreta dot net</strong>
   <a href="#53283" class="date">27-May-2005 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Seems to be a great function, especially for n-dimensions arrays. The only problem is that I cannot find it in php 5.0.3 and 5.0.4. Does it really exist ?! :(<br />
<br />
[20:27:05][maxence@conurb] ~/test2/php-5.0.4$ grep PHP_FUNCTION * -r | grep -i array_diff_key <br />
[20:27:09][maxence@conurb] ~/test2/php-5.0.4$</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
