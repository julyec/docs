<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>do-while</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="control-structures.while.html">? while</a></li>
      <li style="float: right;"><a href="control-structures.for.html">for ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.control-structures.html">流程控制</a></li>
    <li>do-while</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="control-structures.do.while" class="sect1">
 <h2 class="title">do-while</h2>
 <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p>
 <p class="simpara">
  <code class="literal">do-while</code> 循环和 <code class="literal">while</code>
  循环非常相似，区别在于表达式的值是在每次循环结束时检查而不是开始时。和一般的
  <code class="literal">while</code> 循环主要的区别是 <code class="literal">do-while</code>
  的循环语句保证会执行一次（表达式的真值在每次循环结束后检查），然而在一般的
  <code class="literal">while</code> 循环中就不一定了（表达式真值在循环开始时检查，如果一开始就为
  <strong><code>false</code></strong> 则整个循环立即终止）。
 </p>
 <p class="para">
  <code class="literal">do-while</code> 循环只有一种语法：
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$i </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />do {<br />   echo </span><span style="color: #0000BB">$i</span><span style="color: #007700">;<br />} while (</span><span style="color: #0000BB">$i </span><span style="color: #007700">&gt; </span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  以上循环将正好运行一次，因为经过第一次循环后，当检查表达式的真值时，其值为
  <strong><code>false</code></strong>（<var class="varname">$i</var> 不大于 0）而导致循环终止。
 </p>
 <p class="para">
  资深的 C 语言用户可能熟悉另一种不同的 <code class="literal">do-while</code>
  循环用法，把语句放在 <code class="literal">do-while</code>(0) 之中，在循环内部用
  <a href="control-structures.break.html" class="link"><code class="literal">break</code></a>
  语句来结束执行循环。以下代码片段示范了此方法：
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">do {<br />    if (</span><span style="color: #0000BB">$i </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">5</span><span style="color: #007700">) {<br />        echo </span><span style="color: #DD0000">"i is not big enough"</span><span style="color: #007700">;<br />        break;<br />    }<br />    </span><span style="color: #0000BB">$i </span><span style="color: #007700">*= </span><span style="color: #0000BB">$factor</span><span style="color: #007700">;<br />    if (</span><span style="color: #0000BB">$i </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">$minimum_limit</span><span style="color: #007700">) {<br />        break;<br />    }<br />    echo </span><span style="color: #DD0000">"i is ok"</span><span style="color: #007700">;<br /><br />    </span><span style="color: #FF8000">/* process i */<br /><br /></span><span style="color: #007700">} while(</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
   可以使用 <a href="control-structures.goto.html" class="link"><code class="literal">goto</code></a> 跳出循环，取代这种 hack 的方式。
 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125920""></a>
  <div class="note">
   <strong class="user">mparsa1372 at gmail dot com</strong>
   <a href="#125920" class="date">12-Mar-2021 03:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The example below first sets a variable $x to 1 ($x = 1). Then, the do while loop will write some output, and then increment the variable $x with 1. Then the condition is checked (is $x less than, or equal to 5?), and the loop will continue to run as long as $x is less than, or equal to 5:<br />
<br />
<span class="default">&lt;?php<br />
$x </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
<br />
do {<br />
&nbsp; echo </span><span class="string">"The number is: </span><span class="default">$x</span><span class="string"> &lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$x</span><span class="keyword">++;<br />
} while (</span><span class="default">$x </span><span class="keyword">&lt;= </span><span class="default">5</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124351""></a>
  <div class="note">
   <strong class="user">M. H. S.</strong>
   <a href="#124351" class="date">29-Oct-2019 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;!-- if you write with WHILE: --&gt;<br />
<span class="default">&lt;?php<br />
$i </span><span class="keyword">= </span><span class="default">100<br />
</span><span class="keyword">while (</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) :<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"\$i is </span><span class="default">$i</span><span class="string">."</span><span class="keyword">;<br />
endwhile;<br />
</span><span class="default">?&gt;<br />
</span>&lt;!-- returning: --&gt;<br />
<br />
&lt;!-- if you write with DO/WHILE: --&gt;<br />
<span class="default">&lt;?php<br />
$i </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
do {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"\$i is </span><span class="default">$i</span><span class="string">."</span><span class="keyword">;<br />
} while (</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>&lt;!-- returning: --&gt;<br />
$i is 100.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122343""></a>
  <div class="note">
   <strong class="user">iamjeffjack at gmail dot com</strong>
   <a href="#122343" class="date">01-Feb-2018 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you put multiple conditions in the while check, a do-while loop checks these conditions in order and runs again once it encounters a condition that returns true. This can be helpful to know when troubleshooting why a do-while loop isn't finishing. An (illustrative-only) example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $numberOne </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$numberOne</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$numberOne</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; } while( </span><span class="default">$numberOne </span><span class="keyword">&lt; </span><span class="default">5 </span><span class="keyword">|| </span><span class="default">incrementNumberTwo</span><span class="keyword">() );<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">incrementNumberTwo</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"function incrementNumberTwo called"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// outputs "01234function incrementNumberTwo called"<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117186""></a>
  <div class="note">
   <strong class="user">Martin</strong>
   <a href="#117186" class="date">28-Apr-2015 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do-while loops can also be used inside other loops, for example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// generating an array with random even numbers between 1 and 1000<br />
<br />
</span><span class="default">$numbers </span><span class="keyword">= array();<br />
</span><span class="default">$array_size </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">;<br />
<br />
</span><span class="comment">// for loop runs as long as 2nd condition evaluates to true<br />
</span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$array_size</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) { <br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// always executes (as long as the for-loop runs)<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">do { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$random </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">1000</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// if the random number is even (condition below is false), the do-while-loop execution ends<br />
&nbsp;&nbsp; &nbsp; // if it's uneven (condition below is true), the loop continues by generating a new random number<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">} while ((</span><span class="default">$random </span><span class="keyword">% </span><span class="default">2</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// even random number is written to array and for-loop continues iteration until original condition is met<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$numbers</span><span class="keyword">[] = </span><span class="default">$random</span><span class="keyword">; <br />
}<br />
<br />
</span><span class="comment">// sorting array by alphabet<br />
<br />
</span><span class="default">asort</span><span class="keyword">(</span><span class="default">$numbers</span><span class="keyword">);<br />
<br />
</span><span class="comment">// printing array<br />
<br />
</span><span class="keyword">echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$numbers</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85739""></a>
  <div class="note">
   <strong class="user">andrew at NOSPAM dot devohive dot com</strong>
   <a href="#85739" class="date">15-Sep-2008 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm guilty of writing constructs without curly braces sometimes... writing the do--while seemed a bit odd without the curly braces ({ and }), but just so everyone is aware of how this is written with a do--while...<br />
<br />
a normal while:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">while ( </span><span class="default">$isValid </span><span class="keyword">) </span><span class="default">$isValid </span><span class="keyword">= </span><span class="default">doSomething</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
a do--while:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">do </span><span class="default">$isValid </span><span class="keyword">= </span><span class="default">doSomething</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp; while ( </span><span class="default">$isValid </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Also, a practical example of when to use a do--while when a simple while just won't do (lol)... copying multiple 2nd level nodes from one document to another using the DOM XML extension<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="comment"># open up/create the documents and grab the root element<br />
&nbsp;&nbsp; </span><span class="default">$fileDoc&nbsp; </span><span class="keyword">= </span><span class="default">domxml_open_file</span><span class="keyword">(</span><span class="string">'example.xml'</span><span class="keyword">); </span><span class="comment">// existing xml we want to copy<br />
&nbsp;&nbsp; </span><span class="default">$fileRoot </span><span class="keyword">= </span><span class="default">$fileDoc</span><span class="keyword">-&gt;</span><span class="default">document_element</span><span class="keyword">();<br />
&nbsp;&nbsp; </span><span class="default">$newDoc&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">domxml_new_doc</span><span class="keyword">(</span><span class="string">'1.0'</span><span class="keyword">); </span><span class="comment">// new document we want to copy to<br />
&nbsp;&nbsp; </span><span class="default">$newRoot&nbsp; </span><span class="keyword">= </span><span class="default">$newDoc</span><span class="keyword">-&gt;</span><span class="default">create_element</span><span class="keyword">(</span><span class="string">'rootnode'</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$newRoot&nbsp; </span><span class="keyword">= </span><span class="default">$newDoc</span><span class="keyword">-&gt;</span><span class="default">append_child</span><span class="keyword">(</span><span class="default">$newRoot</span><span class="keyword">); </span><span class="comment">// this is the node we want to copy to<br />
<br />
&nbsp;&nbsp; # loop through nodes and clone (using deep)<br />
&nbsp;&nbsp; </span><span class="default">$child </span><span class="keyword">= </span><span class="default">$fileRoot</span><span class="keyword">-&gt;</span><span class="default">first_child</span><span class="keyword">(); </span><span class="comment">// first_child must be called once and can only be called once<br />
&nbsp;&nbsp; </span><span class="keyword">do </span><span class="default">$newRoot</span><span class="keyword">-&gt;</span><span class="default">append_child</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">clone_node</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)); </span><span class="comment">// do first, so that the result from first_child is appended<br />
&nbsp;&nbsp; </span><span class="keyword">while ( </span><span class="default">$child </span><span class="keyword">= </span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">next_sibling</span><span class="keyword">() ); </span><span class="comment">// we have to use next_sibling for everything after first_child<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74419""></a>
  <div class="note">
   <strong class="user">jayreardon at gmail dot com</strong>
   <a href="#74419" class="date">10-Apr-2007 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is one major difference you should be aware of when using the do--while loop vs. using a simple while loop:&nbsp; And that is when the check condition is made.&nbsp; <br />
<br />
In a do--while loop, the test condition evaluation is at the end of the loop.&nbsp; This means that the code inside of the loop will iterate once through before the condition is ever evaluated.&nbsp; This is ideal for tasks that need to execute once before a test is made to continue, such as test that is dependant upon the results of the loop.&nbsp; <br />
<br />
Conversely, a plain while loop evaluates the test condition at the begining of the loop before any execution in the loop block is ever made. If for some reason your test condition evaluates to false at the very start of the loop, none of the code inside your loop will be executed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
