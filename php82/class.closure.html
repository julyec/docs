<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Closure 类</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="serializable.unserialize.html">? Serializable::unserialize</a></li>
      <li style="float: right;"><a href="closure.construct.html">Closure::__construct ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="reserved.interfaces.html">预定义接口和类</a></li>
    <li>Closure 类</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.closure" class="reference">

 <h1 class="title">Closure 类</h1>
 

 <div class="partintro"><p class="verinfo">(PHP 5 &gt;= 5.3.0, PHP 7, PHP 8)</p>


  <div class="section" id="closure.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    用于代表 <a href="functions.anonymous.html" class="link">匿名函数</a>
    的类.
   </p>

   <p class="para">
    匿名函数会产生这种类型的对象。这个类带有一些方法允许在匿名函数创建后对其进行更多的控制。
   </p>

   <p class="para">
    除了此处列出的方法，还有一个
    <code class="literal">__invoke</code> 方法。这是为了与其他实现了
    <a href="language.oop5.magic.html#language.oop5.magic.invoke" class="link">__invoke()魔术方法</a>
    的对象保持一致性，但调用匿名函数的过程与它无关。
   </p>

  </div>


  <div class="section" id="closure.synopsis">
   <h2 class="title">类摘要</h2>


   <div class="classsynopsis">
    <span class="ooclass">
     <strong class="classname"></strong>
    </span>

    <div class="classsynopsisinfo">
     <span class="ooclass">
      <span class="modifier">final</span>
      <span class="modifier">class</span> <strong class="classname">Closure</strong>
     </span>
     {</div>
    
    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 方法 */</div>
    <div class="constructorsynopsis dc-description">
   <span class="modifier">private</span> <span class="methodname"><a href="closure.construct.html" class="methodname">__construct</a></span>()</div>

    <div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="modifier">static</span> <span class="methodname"><a href="closure.bind.html" class="methodname">bind</a></span>(<span class="methodparam"><span class="type"><a href="class.closure.html" class="type Closure">Closure</a></span> <code class="parameter">$closure</code></span>, <span class="methodparam"><span class="type">?</span><span class="type"><span class="type">object</span><span class="type"></span></span> <code class="parameter">$newThis</code></span>, <span class="methodparam"><span class="type"><span class="type">object</span>|<span class="type">string</span>|<span class="type">null</span></span> <code class="parameter">$newScope</code><span class="initializer"> = &quot;static&quot;</span></span>): <span class="type"><span class="type">?</span><span class="type"><a href="class.closure.html" class="type Closure">Closure</a></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="closure.bindto.html" class="methodname">bindTo</a></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">object</span><span class="type"></span></span> <code class="parameter">$newThis</code></span>, <span class="methodparam"><span class="type"><span class="type">object</span>|<span class="type">string</span>|<span class="type">null</span></span> <code class="parameter">$newScope</code><span class="initializer"> = &quot;static&quot;</span></span>): <span class="type"><span class="type">?</span><span class="type"><a href="class.closure.html" class="type Closure">Closure</a></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="closure.call.html" class="methodname">call</a></span>(<span class="methodparam"><span class="type">object</span> <code class="parameter">$newThis</code></span>, <span class="methodparam"><span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span> <code class="parameter">...$args</code></span>): <span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="modifier">static</span> <span class="methodname"><a href="closure.fromcallable.html" class="methodname">fromCallable</a></span>(<span class="methodparam"><span class="type"><a href="language.types.callable.html" class="type callable">callable</a></span> <code class="parameter">$callback</code></span>): <span class="type"><a href="class.closure.html" class="type Closure">Closure</a></span></div>

   }</div>


  </div>

 </div>

 







 


 




 







 






 







<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="closure.construct.html">Closure::__construct</a> &mdash; 用于禁止实例化的构造函数</li><li><a href="closure.bind.html">Closure::bind</a> &mdash; 用特定的绑定对象和类作用域复制闭包。</li><li><a href="closure.bindto.html">Closure::bindTo</a> &mdash; 用特定的绑定对象和类作用域复制闭包。</li><li><a href="closure.call.html">Closure::call</a> &mdash; 绑定并调用闭包</li><li><a href="closure.fromcallable.html">Closure::fromCallable</a> &mdash; 将 callable 转换为闭包</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="126949""></a>
  <div class="note">
   <strong class="user">info at ensostudio dot ru</strong>
   <a href="#126949" class="date">21-Mar-2022 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
compare closures:<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">(string) new </span><span class="default">ReflectionFunction</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">) === (string) new </span><span class="default">ReflectionFunction</span><span class="keyword">(</span><span class="default">$fn2</span><span class="keyword">)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119135""></a>
  <div class="note">
   <strong class="user">joe dot scylla at gmail dot com</strong>
   <a href="#119135" class="date">08-Apr-2016 08:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Small little trick. You can use a closures in itself via reference.<br />
<br />
Example to delete a directory with all subdirectories and files:<br />
<br />
<span class="default">&lt;?php<br />
$deleteDirectory </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$deleteDirectory </span><span class="keyword">= function(</span><span class="default">$path</span><span class="keyword">) use (&amp;</span><span class="default">$deleteDirectory</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$resource </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$item </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$item </span><span class="keyword">!== </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$item </span><span class="keyword">!== </span><span class="string">".."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">$item</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$deleteDirectory</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">$item</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">$item</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
};<br />
</span><span class="default">$deleteDirectory</span><span class="keyword">(</span><span class="string">"path/to/directoy"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117469""></a>
  <div class="note">
   <strong class="user">luk4z_7 at hotmail dot com</strong>
   <a href="#117469" class="date">14-Jun-2015 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Scope<br />
A closure encapsulates its scope, meaning that it has no access to the scope in which it is defined or executed. It is, however, possible to inherit variables from the parent scope (where the closure is defined) into the closure with the use keyword:<br />
<br />
function createGreeter($who) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return function() use ($who) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "Hello $who";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
}<br />
<br />
$greeter = createGreeter("World");<br />
$greeter(); // Hello World<br />
<br />
This inherits the variables by-value, that is, a copy is made available inside the closure using its original name.<br />
font: Zend Certification Study Guide.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117427""></a>
  <div class="note">
   <strong class="user">chuck at bajax dot us</strong>
   <a href="#117427" class="date">09-Jun-2015 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This caused me some confusion a while back when I was still learning what closures were and how to use them, but what is referred to as a closure in PHP isn't the same thing as what they call closures in other languages (E.G. JavaScript).<br />
<br />
In JavaScript, a closure can be thought of as a scope, when you define a function, it silently inherits the scope it's defined in, which is called its closure, and it retains that no matter where it's used.&nbsp; It's possible for multiple functions to share the same closure, and they can have access to multiple closures as long as they are within their accessible scope.<br />
<br />
In PHP,&nbsp; a closure is a callable class, to which you've bound your parameters manually.<br />
<br />
It's a slight distinction but one I feel bears mentioning.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
