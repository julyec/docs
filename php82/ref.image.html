<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>GD 和图像处理 函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="image.examples.merged-watermark.html">? 使用 imagecopymerge 函数创建半透明水印</a></li>
      <li style="float: right;"><a href="function.gd-info.html">gd_info ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.image.html">GD</a></li>
    <li>GD 和图像处理 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.image" class="reference">
 <h1 class="title">GD 和图像处理 函数</h1>

 

























































































































































































































































































































































































































































































































































































































































































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.gd-info.html">gd_info</a> &mdash; 取得当前安装的 GD 库的信息</li><li><a href="function.getimagesize.html">getimagesize</a> &mdash; 取得图像大小</li><li><a href="function.getimagesizefromstring.html">getimagesizefromstring</a> &mdash; 从字符串中获取图像尺寸信息</li><li><a href="function.image-type-to-extension.html">image_type_to_extension</a> &mdash; 取得图像类型的文件后缀</li><li><a href="function.image-type-to-mime-type.html">image_type_to_mime_type</a> &mdash; 取得 getimagesize、exif_read_data、exif_thumbnail、exif_imagetype 所返回的图像类型的 MIME 类型</li><li><a href="function.image2wbmp.html">image2wbmp</a> &mdash; 输出图象到浏览器或文件。</li><li><a href="function.imageaffine.html">imageaffine</a> &mdash; 返回经过仿射变换后的图像，剪切区域可选</li><li><a href="function.imageaffinematrixconcat.html">imageaffinematrixconcat</a> &mdash; Concatenate two affine transformation matrices</li><li><a href="function.imageaffinematrixget.html">imageaffinematrixget</a> &mdash; Get an affine transformation matrix</li><li><a href="function.imagealphablending.html">imagealphablending</a> &mdash; 设定图像的混色模式</li><li><a href="function.imageantialias.html">imageantialias</a> &mdash; 是否使用抗锯齿（antialias）功能</li><li><a href="function.imagearc.html">imagearc</a> &mdash; 画弧线</li><li><a href="function.imageavif.html">imageavif</a> &mdash; 输出图象到浏览器或文件。</li><li><a href="function.imagebmp.html">imagebmp</a> &mdash; Output a BMP image to browser or file</li><li><a href="function.imagechar.html">imagechar</a> &mdash; 水平地绘制一个字符</li><li><a href="function.imagecharup.html">imagecharup</a> &mdash; 垂直地绘制一个字符</li><li><a href="function.imagecolorallocate.html">imagecolorallocate</a> &mdash; 为图像分配颜色</li><li><a href="function.imagecolorallocatealpha.html">imagecolorallocatealpha</a> &mdash; 为图像分配颜色</li><li><a href="function.imagecolorat.html">imagecolorat</a> &mdash; 取得某像素的颜色索引值</li><li><a href="function.imagecolorclosest.html">imagecolorclosest</a> &mdash; 取得与指定的颜色最接近的颜色索引值</li><li><a href="function.imagecolorclosestalpha.html">imagecolorclosestalpha</a> &mdash; 获取最接近指定颜色 + alpha 的颜色索引</li><li><a href="function.imagecolorclosesthwb.html">imagecolorclosesthwb</a> &mdash; 取得与给定颜色最接近的色度的黑白色的索引</li><li><a href="function.imagecolordeallocate.html">imagecolordeallocate</a> &mdash; 取消图像颜色的分配</li><li><a href="function.imagecolorexact.html">imagecolorexact</a> &mdash; 取得指定颜色的索引值</li><li><a href="function.imagecolorexactalpha.html">imagecolorexactalpha</a> &mdash; 取得指定的颜色加透明度的索引值</li><li><a href="function.imagecolormatch.html">imagecolormatch</a> &mdash; 使一个图像中调色板版本的颜色与真彩色版本更能匹配</li><li><a href="function.imagecolorresolve.html">imagecolorresolve</a> &mdash; 取得指定颜色的索引值或有可能得到的最接近的替代值</li><li><a href="function.imagecolorresolvealpha.html">imagecolorresolvealpha</a> &mdash; 取得指定颜色 + alpha 或其最接近的替代值</li><li><a href="function.imagecolorset.html">imagecolorset</a> &mdash; 给指定调色板索引设定颜色</li><li><a href="function.imagecolorsforindex.html">imagecolorsforindex</a> &mdash; 获取索引的颜色</li><li><a href="function.imagecolorstotal.html">imagecolorstotal</a> &mdash; 取得图像调色板中的颜色数量</li><li><a href="function.imagecolortransparent.html">imagecolortransparent</a> &mdash; 将颜色定义为透明</li><li><a href="function.imageconvolution.html">imageconvolution</a> &mdash; 用系数 div 和 offset 申请一个 3x3 的卷积矩阵</li><li><a href="function.imagecopy.html">imagecopy</a> &mdash; 拷贝图像的一部分</li><li><a href="function.imagecopymerge.html">imagecopymerge</a> &mdash; 拷贝并合并图像的一部分</li><li><a href="function.imagecopymergegray.html">imagecopymergegray</a> &mdash; 用灰度复制并合并图像的一部分</li><li><a href="function.imagecopyresampled.html">imagecopyresampled</a> &mdash; 重采样拷贝部分图像并调整大小</li><li><a href="function.imagecopyresized.html">imagecopyresized</a> &mdash; 拷贝部分图像并调整大小</li><li><a href="function.imagecreate.html">imagecreate</a> &mdash; 创建新的基于调色板的图像</li><li><a href="function.imagecreatefromavif.html">imagecreatefromavif</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefrombmp.html">imagecreatefrombmp</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromgd2.html">imagecreatefromgd2</a> &mdash; 从 GD2 文件或 URL 新建一图像</li><li><a href="function.imagecreatefromgd2part.html">imagecreatefromgd2part</a> &mdash; 从指定的 GD2 文件或 URL 的部分创建新图像</li><li><a href="function.imagecreatefromgd.html">imagecreatefromgd</a> &mdash; 从 GD 文件或 URL 新建一图像</li><li><a href="function.imagecreatefromgif.html">imagecreatefromgif</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromjpeg.html">imagecreatefromjpeg</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefrompng.html">imagecreatefrompng</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromstring.html">imagecreatefromstring</a> &mdash; 从字符串的图像流中新建图像</li><li><a href="function.imagecreatefromtga.html">imagecreatefromtga</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromwbmp.html">imagecreatefromwbmp</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromwebp.html">imagecreatefromwebp</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromxbm.html">imagecreatefromxbm</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatefromxpm.html">imagecreatefromxpm</a> &mdash; 由文件或 URL 创建一个新图象。</li><li><a href="function.imagecreatetruecolor.html">imagecreatetruecolor</a> &mdash; 新建真彩色图像</li><li><a href="function.imagecrop.html">imagecrop</a> &mdash; Crop an image to the given rectangle</li><li><a href="function.imagecropauto.html">imagecropauto</a> &mdash; Crop an image automatically using one of the available modes</li><li><a href="function.imagedashedline.html">imagedashedline</a> &mdash; 绘制虚线</li><li><a href="function.imagedestroy.html">imagedestroy</a> &mdash; 销毁图像</li><li><a href="function.imageellipse.html">imageellipse</a> &mdash; 画椭圆</li><li><a href="function.imagefill.html">imagefill</a> &mdash; 漫水填充</li><li><a href="function.imagefilledarc.html">imagefilledarc</a> &mdash; 绘制部分弧形并填充</li><li><a href="function.imagefilledellipse.html">imagefilledellipse</a> &mdash; 绘制椭圆并填充</li><li><a href="function.imagefilledpolygon.html">imagefilledpolygon</a> &mdash; 绘制多边形并填充</li><li><a href="function.imagefilledrectangle.html">imagefilledrectangle</a> &mdash; 绘制矩形并填充</li><li><a href="function.imagefilltoborder.html">imagefilltoborder</a> &mdash; 漫水填充特定颜色</li><li><a href="function.imagefilter.html">imagefilter</a> &mdash; 对图像使用过滤器</li><li><a href="function.imageflip.html">imageflip</a> &mdash; Flips an image using a given mode</li><li><a href="function.imagefontheight.html">imagefontheight</a> &mdash; 获取字体高度</li><li><a href="function.imagefontwidth.html">imagefontwidth</a> &mdash; 获取字体宽度</li><li><a href="function.imageftbbox.html">imageftbbox</a> &mdash; 通过 freetype2 使用字体给出文本的边界框</li><li><a href="function.imagefttext.html">imagefttext</a> &mdash; 使用 FreeType 2 字体将文本写入图像</li><li><a href="function.imagegammacorrect.html">imagegammacorrect</a> &mdash; 对 GD 图像应用伽玛校正</li><li><a href="function.imagegd2.html">imagegd2</a> &mdash; 将 GD2 图像输出到浏览器或文件</li><li><a href="function.imagegd.html">imagegd</a> &mdash; 将 GD 图像输出到浏览器或文件</li><li><a href="function.imagegetclip.html">imagegetclip</a> &mdash; Get the clipping rectangle</li><li><a href="function.imagegetinterpolation.html">imagegetinterpolation</a> &mdash; Get the interpolation method</li><li><a href="function.imagegif.html">imagegif</a> &mdash; 输出图象到浏览器或文件。</li><li><a href="function.imagegrabscreen.html">imagegrabscreen</a> &mdash; Captures the whole screen</li><li><a href="function.imagegrabwindow.html">imagegrabwindow</a> &mdash; Captures a window</li><li><a href="function.imageinterlace.html">imageinterlace</a> &mdash; 启用或禁用隔行扫描</li><li><a href="function.imageistruecolor.html">imageistruecolor</a> &mdash; 检查图像是否为真彩色图像</li><li><a href="function.imagejpeg.html">imagejpeg</a> &mdash; 输出图象到浏览器或文件。</li><li><a href="function.imagelayereffect.html">imagelayereffect</a> &mdash; 设定 alpha 混合标志以使用分层效果</li><li><a href="function.imageline.html">imageline</a> &mdash; 绘制直线</li><li><a href="function.imageloadfont.html">imageloadfont</a> &mdash; 载入新字体</li><li><a href="function.imageopenpolygon.html">imageopenpolygon</a> &mdash; Draws an open polygon</li><li><a href="function.imagepalettecopy.html">imagepalettecopy</a> &mdash; 将调色板从一个图像复制到另一个</li><li><a href="function.imagepalettetotruecolor.html">imagepalettetotruecolor</a> &mdash; Converts a palette based image to true color</li><li><a href="function.imagepng.html">imagepng</a> &mdash; 将 PNG 图像输出到浏览器或文件</li><li><a href="function.imagepolygon.html">imagepolygon</a> &mdash; 绘制多边形</li><li><a href="function.imagerectangle.html">imagerectangle</a> &mdash; 绘制矩形</li><li><a href="function.imageresolution.html">imageresolution</a> &mdash; Get or set the resolution of the image</li><li><a href="function.imagerotate.html">imagerotate</a> &mdash; 用给定角度旋转图像</li><li><a href="function.imagesavealpha.html">imagesavealpha</a> &mdash; 保存图像时是否保留完整的 alpha 通道信息</li><li><a href="function.imagescale.html">imagescale</a> &mdash; Scale an image using the given new width and height</li><li><a href="function.imagesetbrush.html">imagesetbrush</a> &mdash; 为线条设置笔刷图像</li><li><a href="function.imagesetclip.html">imagesetclip</a> &mdash; Set the clipping rectangle</li><li><a href="function.imagesetinterpolation.html">imagesetinterpolation</a> &mdash; Set the interpolation method</li><li><a href="function.imagesetpixel.html">imagesetpixel</a> &mdash; 设置单个像素</li><li><a href="function.imagesetstyle.html">imagesetstyle</a> &mdash; 设定线条的样式</li><li><a href="function.imagesetthickness.html">imagesetthickness</a> &mdash; 设定画线的粗细</li><li><a href="function.imagesettile.html">imagesettile</a> &mdash; 设置要填充的平铺图像</li><li><a href="function.imagestring.html">imagestring</a> &mdash; 水平绘制字符串</li><li><a href="function.imagestringup.html">imagestringup</a> &mdash; 垂直绘制字符串</li><li><a href="function.imagesx.html">imagesx</a> &mdash; 取得图像宽度</li><li><a href="function.imagesy.html">imagesy</a> &mdash; 取得图像高度</li><li><a href="function.imagetruecolortopalette.html">imagetruecolortopalette</a> &mdash; 将真彩色图像转换为调色板图像</li><li><a href="function.imagettfbbox.html">imagettfbbox</a> &mdash; 取得使用 TrueType 字体的文本的边界框</li><li><a href="function.imagettftext.html">imagettftext</a> &mdash; 用 TrueType 字体向图像写入文本</li><li><a href="function.imagetypes.html">imagetypes</a> &mdash; 返回 PHP 内置支持的图像类型</li><li><a href="function.imagewbmp.html">imagewbmp</a> &mdash; 输出图象到浏览器或文件。</li><li><a href="function.imagewebp.html">imagewebp</a> &mdash; 将 WebP 格式的图像输出到浏览器或文件</li><li><a href="function.imagexbm.html">imagexbm</a> &mdash; 输出 XBM 图像到浏览器或文件</li><li><a href="function.iptcembed.html">iptcembed</a> &mdash; 嵌入二进制 IPTC 数据到 JPEG 图像中</li><li><a href="function.iptcparse.html">iptcparse</a> &mdash; 将二进制 IPTC 块解析为单个标签</li><li><a href="function.jpeg2wbmp.html">jpeg2wbmp</a> &mdash; 将 JPEG 图像文件转换为 WBMP 图像文件</li><li><a href="function.png2wbmp.html">png2wbmp</a> &mdash; 将 PNG 图像文件转换为 WBMP 图像文件</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120217""></a>
  <div class="note">
   <strong class="user">delabahan at gmail dot com</strong>
   <a href="#120217" class="date">24-Nov-2016 05:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an example of get high resolution images.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;</span><span class="comment">/**<br />
&nbsp;* Class name&nbsp; &nbsp; &nbsp; : resizeImage<br />
&nbsp;* Created by&nbsp;&nbsp; : wang<br />
&nbsp;* Description&nbsp;&nbsp; : This class is to resize the image from original size to new size <br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">resizeImage<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_img<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $origimg variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $newimg variable is the new image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public&nbsp; function </span><span class="default">resize_img</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">,</span><span class="default">$newimg</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">,</span><span class="default">$h</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mime&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'mime'</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Make sure that the requested file is actually an image<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$mime</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">) != </span><span class="string">'image/'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'HTTP/1.1 400 Bad Request'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'Error: requested file is not an accepted type: ' </span><span class="keyword">.</span><span class="default">$origimg</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Check they extention of image<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$extension </span><span class="keyword">= </span><span class="default">image_type_to_extension</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$extension</span><span class="keyword">) == </span><span class="string">'.png'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize_imagepng</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$newimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$extension</span><span class="keyword">) == </span><span class="string">'.jpeg'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize_imagejpeg</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$newimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$extension </span><span class="keyword">== </span><span class="string">'.gif'</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize_imagegif</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagegif</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$newimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_img<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_imagepng<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize png image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $file variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">resize_imagepng</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$dst</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_imagepng<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_imagejpeg<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize jpeg image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $file variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">resize_imagejpeg</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$dst</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_imagejpeg<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_imagegif<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize gif image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $file variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">resize_imagegif</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefromgif</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$dst</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_imagegif<br />
&nbsp;&nbsp; &nbsp; */<br />
</span><span class="keyword">}<br />
</span><span class="comment">/**<br />
* End class name : resizeImage<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120139""></a>
  <div class="note">
   <strong class="user">mpyw</strong>
   <a href="#120139" class="date">10-Nov-2016 08:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an example of black-and-white imagebmp() implementation. <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Output a black-and-white BMP image to either the browser or a file.<br />
&nbsp;* <br />
&nbsp;* @param resource $image<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An image resource, returned by one of the image creation functions,<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; such as imagecreatetruecolor().<br />
&nbsp;*<br />
&nbsp;* @param string|null $to<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The path or an open stream resource<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (which is automatically being closed after this function returns)<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to save the file to.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If not set or NULL, the raw image stream will be outputted directly.<br />
&nbsp;*<br />
&nbsp;* @param float $threshold<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The number in the range of 0.0 to 1.0.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Brighter for larger, or darker for smaller.<br />
&nbsp;*<br />
&nbsp;* @return bool Returns TRUE on success or FALSE on failure.<br />
&nbsp;* <br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">imagebwbmp</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$to </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$threshold </span><span class="keyword">= </span><span class="default">0.5</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">func_num_args</span><span class="keyword">() &lt; </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fmt </span><span class="keyword">= </span><span class="string">"imagebwbmp() expects a least 1 parameters, %d given"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$fmt</span><span class="keyword">, </span><span class="default">func_num_args</span><span class="keyword">()), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fmt </span><span class="keyword">= </span><span class="string">"imagebwbmp() expects parameter 1 to be resource, %s given"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$fmt</span><span class="keyword">, </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">)), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$threshold</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fmt </span><span class="keyword">= </span><span class="string">"imagebwbmp() expects parameter 3 to be float, %s given"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$fmt</span><span class="keyword">, </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$threshold</span><span class="keyword">)), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">get_resource_type</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">) !== </span><span class="string">'gd'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="string">"imagebwbmp(): supplied resource is not a valid gd resource"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; switch (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$to </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">) &amp;&amp; </span><span class="default">get_resource_type</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">) === </span><span class="string">'stream'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">) &amp;&amp; </span><span class="default">$to </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">'wb'</span><span class="keyword">):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/[waxc+]/'</span><span class="keyword">, </span><span class="default">stream_get_meta_data</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">)[</span><span class="string">'mode'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="string">"imagebwbmp(): Invalid 2nd parameter, it must a writable filename or a writable stream"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$to </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$to </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://output'</span><span class="keyword">, </span><span class="string">'wb'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biWidth </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biHeight </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biSizeImage </span><span class="keyword">= ((int)</span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$biWidth </span><span class="keyword">/ </span><span class="default">32</span><span class="keyword">) * </span><span class="default">32 </span><span class="keyword">/ </span><span class="default">8 </span><span class="keyword">* </span><span class="default">$biHeight</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfOffBits </span><span class="keyword">= </span><span class="default">54 </span><span class="keyword">+ </span><span class="default">4 </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">; </span><span class="comment">// Use two colors (black and white)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfSize </span><span class="keyword">= </span><span class="default">$bfOffBits </span><span class="keyword">+ </span><span class="default">$biSizeImage</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">'BM'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'VvvV'</span><span class="keyword">, </span><span class="default">$bfSize</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$bfOffBits</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'VVVvvVVVVVV'</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">, </span><span class="default">$biWidth</span><span class="keyword">, </span><span class="default">$biHeight</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$biSizeImage</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">"\xff\xff\xff\x00"</span><span class="keyword">); </span><span class="comment">// white<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">"\x00\x00\x00\x00"</span><span class="keyword">); </span><span class="comment">// black<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">$biHeight </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">; --</span><span class="default">$y</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$byte </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$biWidth</span><span class="keyword">; ++</span><span class="default">$x</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= (</span><span class="default">0.299 </span><span class="keyword">* </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] + </span><span class="default">0.587 </span><span class="keyword">* </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] + </span><span class="default">0.114 </span><span class="keyword">* </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">]) / </span><span class="default">0xff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= (int)(</span><span class="default">$value </span><span class="keyword">&gt; </span><span class="default">$threshold</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$byte </span><span class="keyword">= (</span><span class="default">$byte </span><span class="keyword">&lt;&lt; </span><span class="default">1</span><span class="keyword">) | </span><span class="default">$color</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">% </span><span class="default">8 </span><span class="keyword">=== </span><span class="default">7</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'C'</span><span class="keyword">, </span><span class="default">$byte</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$byte </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">% </span><span class="default">8</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'C'</span><span class="keyword">, </span><span class="default">$byte </span><span class="keyword">&lt;&lt; (</span><span class="default">8 </span><span class="keyword">- </span><span class="default">$x </span><span class="keyword">% </span><span class="default">8</span><span class="keyword">)));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">% </span><span class="default">32</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"\x00"</span><span class="keyword">, (int)((</span><span class="default">32 </span><span class="keyword">- </span><span class="default">$x </span><span class="keyword">% </span><span class="default">32</span><span class="keyword">) / </span><span class="default">8</span><span class="keyword">)));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106150""></a>
  <div class="note">
   <strong class="user">ingo at jache dot de</strong>
   <a href="#106150" class="date">14-Oct-2011 03:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I know this might look somewhat superfluous to others, but i once came across a situation where i needed a *strong* blur on an image without having ImageMagick installed. Executing the convolution-filter several times on the same image is awfully slow and still doesn't give a good blur.<br />
<br />
The function below accepts a truecolor-image and a blur-factor between 0.0 and 1.0. Beware: It's still quite slow.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">blurImage</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">$blur</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blur </span><span class="keyword">= </span><span class="default">$blur</span><span class="keyword">*</span><span class="default">$blur</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blur </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">min</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$blur</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$srcw </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$srch </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dstimg </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$srcw</span><span class="keyword">,</span><span class="default">$srch</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f1a </span><span class="keyword">= </span><span class="default">$blur</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f1b </span><span class="keyword">= </span><span class="default">1.0 </span><span class="keyword">- </span><span class="default">$blur</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$cg </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$cb </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$ng </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$nb </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // first line is a special case<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$srcw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$srch</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$x</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//horizontal blurren<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cr </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cg </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cb </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= (</span><span class="default">$cr </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$or </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ng </span><span class="keyword">= (</span><span class="default">$cg </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$og </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nb </span><span class="keyword">= (</span><span class="default">$cb </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$ob </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);&nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= </span><span class="default">$ng</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">$nb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,(</span><span class="default">$nr </span><span class="keyword">&lt;&lt; </span><span class="default">16</span><span class="keyword">) | (</span><span class="default">$ng </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">) | (</span><span class="default">$nb</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//-------------------------------------------------<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // now process the entire picture<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$srch</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$y</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$srcw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$x</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//horizontal <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cr </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cg </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cb </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= (</span><span class="default">$cr </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$or </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ng </span><span class="keyword">= (</span><span class="default">$cg </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$og </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nb </span><span class="keyword">= (</span><span class="default">$cb </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$ob </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= </span><span class="default">$ng</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">$nb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//vertical <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vr </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vg </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vb </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= (</span><span class="default">$nr </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$vr </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ng </span><span class="keyword">= (</span><span class="default">$ng </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$vg </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nb </span><span class="keyword">= (</span><span class="default">$nb </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$vb </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vr </span><span class="keyword">= </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vg </span><span class="keyword">= </span><span class="default">$ng</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vb </span><span class="keyword">= </span><span class="default">$nb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,(</span><span class="default">$nr </span><span class="keyword">&lt;&lt; </span><span class="default">16</span><span class="keyword">) | (</span><span class="default">$ng </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">) | (</span><span class="default">$nb</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$dstimg</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$srcimg </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">"test.jpg"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dstimg </span><span class="keyword">= </span><span class="default">blurImage</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">0.2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/jpeg'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo( </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; exit();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87238""></a>
  <div class="note">
   <strong class="user">chuckstudios at gmail dot com</strong>
   <a href="#87238" class="date">25-Nov-2008 09:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a simple function to convert an image resource to PGM (portable graymap) in order to feed it to an OCR program. It works just like the rest of the image output functions, and will convert to grayscale for you:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">imagepgm</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$filename </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pgm </span><span class="keyword">= </span><span class="string">"P5 "</span><span class="keyword">.</span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">).</span><span class="string">" "</span><span class="keyword">.</span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">).</span><span class="string">" 255\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); </span><span class="default">$y</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); </span><span class="default">$x</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$colors </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pgm </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0.3 </span><span class="keyword">* </span><span class="default">$colors</span><span class="keyword">[</span><span class="string">"red"</span><span class="keyword">] + </span><span class="default">0.59 </span><span class="keyword">* </span><span class="default">$colors</span><span class="keyword">[</span><span class="string">"green"</span><span class="keyword">] + </span><span class="default">0.11 </span><span class="keyword">* </span><span class="default">$colors</span><span class="keyword">[</span><span class="string">"blue"</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$filename </span><span class="keyword">!= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$pgm</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$pgm</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79996""></a>
  <div class="note">
   <strong class="user">ph_corp at yahoo dot fr</strong>
   <a href="#79996" class="date">23-Dec-2007 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
HSL/RGB conversion functions<br />
very useful for a lot of applications<br />
**/<br />
<br />
</span><span class="keyword">function </span><span class="default">RBGtoHSL </span><span class="keyword">( </span><span class="default">$R</span><span class="keyword">, </span><span class="default">$G</span><span class="keyword">, </span><span class="default">$B </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_R </span><span class="keyword">= ( </span><span class="default">$R </span><span class="keyword">/ </span><span class="default">255 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_G </span><span class="keyword">= ( </span><span class="default">$G </span><span class="keyword">/ </span><span class="default">255 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_B </span><span class="keyword">= ( </span><span class="default">$B </span><span class="keyword">/ </span><span class="default">255 </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_Min </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">( </span><span class="default">$var_R</span><span class="keyword">, </span><span class="default">$var_G</span><span class="keyword">, </span><span class="default">$var_B </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_Max </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">( </span><span class="default">$var_R</span><span class="keyword">, </span><span class="default">$var_G</span><span class="keyword">, </span><span class="default">$var_B </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$del_Max </span><span class="keyword">= </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_Min<br />
<br />
&nbsp;&nbsp;&nbsp; $L </span><span class="keyword">= ( </span><span class="default">$var_Max </span><span class="keyword">+ </span><span class="default">$var_Min </span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$del_Max </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$H </span><span class="keyword">= </span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; $S </span><span class="keyword">= </span><span class="default">0<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$L </span><span class="keyword">&lt; </span><span class="default">0.5 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$S </span><span class="keyword">= </span><span class="default">$del_Max </span><span class="keyword">/ ( </span><span class="default">$var_Max </span><span class="keyword">+ </span><span class="default">$var_Min </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$S </span><span class="keyword">= </span><span class="default">$del_Max </span><span class="keyword">/ ( </span><span class="default">2 </span><span class="keyword">- </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_Min </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$del_R </span><span class="keyword">= ( ( ( </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_R </span><span class="keyword">) / </span><span class="default">6 </span><span class="keyword">) + ( </span><span class="default">$del_Max </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">) ) / </span><span class="default">$del_Max</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$del_G </span><span class="keyword">= ( ( ( </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_G </span><span class="keyword">) / </span><span class="default">6 </span><span class="keyword">) + ( </span><span class="default">$del_Max </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">) ) / </span><span class="default">$del_Max</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$del_B </span><span class="keyword">= ( ( ( </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_B </span><span class="keyword">) / </span><span class="default">6 </span><span class="keyword">) + ( </span><span class="default">$del_Max </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">) ) / </span><span class="default">$del_Max</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$var_R </span><span class="keyword">== </span><span class="default">$var_Max </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">= </span><span class="default">$del_B </span><span class="keyword">- </span><span class="default">$del_G</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if ( </span><span class="default">$var_G </span><span class="keyword">== </span><span class="default">$var_Max </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">= ( </span><span class="default">1 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) + </span><span class="default">$del_R </span><span class="keyword">- </span><span class="default">$del_B</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if ( </span><span class="default">$var_B </span><span class="keyword">== </span><span class="default">$var_Max </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">= ( </span><span class="default">2 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) + </span><span class="default">$del_G </span><span class="keyword">- </span><span class="default">$del_R</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$H </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$H </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">-= </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return array( </span><span class="default">$H</span><span class="keyword">, </span><span class="default">$S</span><span class="keyword">, </span><span class="default">$L </span><span class="keyword">);<br />
<br />
}<br />
<br />
function </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$v1</span><span class="keyword">, </span><span class="default">$v2</span><span class="keyword">, </span><span class="default">$vH </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$vH </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vH </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$vH </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vH </span><span class="keyword">-= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( ( </span><span class="default">6 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$v1 </span><span class="keyword">+ ( </span><span class="default">$v2 </span><span class="keyword">- </span><span class="default">$v1 </span><span class="keyword">) * </span><span class="default">6 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( ( </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$v2 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( ( </span><span class="default">3 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">) &lt; </span><span class="default">2 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$v1 </span><span class="keyword">+ ( </span><span class="default">$v2 </span><span class="keyword">- </span><span class="default">$v1 </span><span class="keyword">) * ( ( </span><span class="default">2 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) - </span><span class="default">$vH </span><span class="keyword">) * </span><span class="default">6 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return ( </span><span class="default">$v1 </span><span class="keyword">)<br />
}<br />
<br />
function </span><span class="default">HSLtoRGB </span><span class="keyword">( </span><span class="default">$H</span><span class="keyword">, </span><span class="default">$S</span><span class="keyword">, </span><span class="default">$L </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$S </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$R </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* </span><span class="default">255</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$G </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* </span><span class="default">255</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$B </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* </span><span class="default">255</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$L </span><span class="keyword">&lt; </span><span class="default">0.5 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var_2 </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* ( </span><span class="default">1 </span><span class="keyword">+ </span><span class="default">$S </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var_2 </span><span class="keyword">= ( </span><span class="default">$L </span><span class="keyword">+ </span><span class="default">$S </span><span class="keyword">) - ( </span><span class="default">$S </span><span class="keyword">* </span><span class="default">$L </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var_1 </span><span class="keyword">= </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$L </span><span class="keyword">- </span><span class="default">$var_2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$R </span><span class="keyword">= </span><span class="default">255 </span><span class="keyword">* </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$var_1</span><span class="keyword">, </span><span class="default">$var_2</span><span class="keyword">, </span><span class="default">$H </span><span class="keyword">+ ( </span><span class="default">1 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$G </span><span class="keyword">= </span><span class="default">255 </span><span class="keyword">* </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$var_1</span><span class="keyword">, </span><span class="default">$var_2</span><span class="keyword">, </span><span class="default">$H </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$B </span><span class="keyword">= </span><span class="default">255 </span><span class="keyword">* </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$var_1</span><span class="keyword">, </span><span class="default">$var_2</span><span class="keyword">, </span><span class="default">$H </span><span class="keyword">- ( </span><span class="default">1 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return array( </span><span class="default">$R</span><span class="keyword">, </span><span class="default">$G</span><span class="keyword">, </span><span class="default">$B </span><span class="keyword">);<br />
<br />
}<br />
<br />
function </span><span class="default">distance </span><span class="keyword">( </span><span class="default">$R1</span><span class="keyword">, </span><span class="default">$G1</span><span class="keyword">, </span><span class="default">$B1</span><span class="keyword">, </span><span class="default">$R2</span><span class="keyword">, </span><span class="default">$G2</span><span class="keyword">, </span><span class="default">$B2 </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">sqrt </span><span class="keyword">( ( </span><span class="default">$R1 </span><span class="keyword">- </span><span class="default">$R2 </span><span class="keyword">)*( </span><span class="default">$R1 </span><span class="keyword">- </span><span class="default">$R2 </span><span class="keyword">) + ( </span><span class="default">$G1 </span><span class="keyword">- </span><span class="default">$G2 </span><span class="keyword">)*( </span><span class="default">$G1 </span><span class="keyword">- </span><span class="default">$G2 </span><span class="keyword">) + ( </span><span class="default">$B1 </span><span class="keyword">- </span><span class="default">$B2 </span><span class="keyword">)*( </span><span class="default">$B1 </span><span class="keyword">- </span><span class="default">$B2 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; return ( </span><span class="default">$result </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63689""></a>
  <div class="note">
   <strong class="user">shd at earthling dot net</strong>
   <a href="#63689" class="date">28-Mar-2006 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you happen to need a way to output a Windows BMP file (e.g. when using the PEAR ExcelWriter), feel free to use the following code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagebmp </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$fn </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$im</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fn </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) </span><span class="default">$fn </span><span class="keyword">= </span><span class="string">'php://output'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$f</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Image dimensions<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biWidth </span><span class="keyword">= </span><span class="default">imagesx </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biHeight </span><span class="keyword">= </span><span class="default">imagesy </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biBPLine </span><span class="keyword">= </span><span class="default">$biWidth </span><span class="keyword">* </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biStride </span><span class="keyword">= (</span><span class="default">$biBPLine </span><span class="keyword">+ </span><span class="default">3</span><span class="keyword">) &amp; ~</span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biSizeImage </span><span class="keyword">= </span><span class="default">$biStride </span><span class="keyword">* </span><span class="default">$biHeight</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfOffBits </span><span class="keyword">= </span><span class="default">54</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfSize </span><span class="keyword">= </span><span class="default">$bfOffBits </span><span class="keyword">+ </span><span class="default">$biSizeImage</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//BITMAPFILEHEADER<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="string">'BM'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'VvvV'</span><span class="keyword">, </span><span class="default">$bfSize</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$bfOffBits</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//BITMAPINFO (BITMAPINFOHEADER)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'VVVvvVVVVVV'</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">, </span><span class="default">$biWidth</span><span class="keyword">, </span><span class="default">$biHeight</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">24</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$biSizeImage</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$numpad </span><span class="keyword">= </span><span class="default">$biStride </span><span class="keyword">- </span><span class="default">$biBPLine</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">$biHeight </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">; --</span><span class="default">$y</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$biWidth</span><span class="keyword">; ++</span><span class="default">$x</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col </span><span class="keyword">= </span><span class="default">imagecolorat </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">, </span><span class="default">$col</span><span class="keyword">), </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$numpad</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'C'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It works the same way as regular imagejpeg/imagepng do and only supports GD2.0 true colour bitmaps (which is what's required by ExcelWriter).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63064""></a>
  <div class="note">
   <strong class="user">felipensp at gmail dot com</strong>
   <a href="#63064" class="date">12-Mar-2006 09:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Representation decimal of a color in hexadecimal for use on functions of library GD.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Representation hexadecimal<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var </span><span class="keyword">= </span><span class="string">'#FFFFFF'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">getRgbFromGd</span><span class="keyword">(</span><span class="default">$color_hex</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'hexdec'</span><span class="keyword">, </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'|'</span><span class="keyword">, </span><span class="default">wordwrap</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$color_hex</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">, </span><span class="string">'|'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)));<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">getRgbFromGd</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Output: Array ( [0] =&gt; 255 [1] =&gt; 255 [2] =&gt; 255 )<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57909""></a>
  <div class="note">
   <strong class="user">michal-ok at o2 dot pl</strong>
   <a href="#57909" class="date">18-Oct-2005 02:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The image sharpen function (by Alex R. Austin) provided below seems to be very resource hungry and I couldn't make it work on two different servers - trying to sharpen a 413 x 413 image I ended up with "Fatal error: Allowed memory size of 8388608 bytes exhausted" or "Internal Server Error" or the script terminated without notice. Because I had no priviliges to change the default memory limit on these servers I started looking for other sharpen functions. I have come across a php Unsharp Mask function which works like a charm on both of the servers I dealt with. It can be found at <a href="http://vikjavev.no/hovudsida/umtestside.php." rel="nofollow" target="_blank">http://vikjavev.no/hovudsida/umtestside.php.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37131""></a>
  <div class="note">
   <strong class="user">jeff at lushmedia dot com</strong>
   <a href="#37131" class="date">04-Nov-2003 08:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote an online overview of the image functions that people might find useful. In addition to a general overview of the various function categories and code samples, I have included many interactive examples of the functions, allowing viewers to experiment with the parameters, and seeing the results in real time. The presentation is located at New York PHP<br />
<a href="http://www.nyphp.org/content/presentations/GDintro/" rel="nofollow" target="_blank">http://www.nyphp.org/content/presentations/GDintro/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
