<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>标记分割字符串</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.strstr.html">? strstr</a></li>
      <li style="float: right;"><a href="function.strtolower.html">strtolower ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.strings.html">字符串 函数</a></li>
    <li>标记分割字符串</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.strtok" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">strtok</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">strtok</span> &mdash; <span class="dc-title">标记分割字符串</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.strtok-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>strtok</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$token</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="simpara">可选 token （不支持命名参数）：</p>
  <div class="methodsynopsis dc-description"><span class="methodname"><strong>strtok</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$token</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>strtok()</strong></span> 将字符串 <code class="parameter">string</code> 分割为若干子字符串，每个子字符串以
   <code class="parameter">token</code> 中的字符分割。这也就意味着，如果有个字符串是 &quot;This is an example string&quot;，
   你可以使用空格字符作为 <code class="parameter">token</code>，将这句话分割成独立的单词。
  </p>
  <p class="para">
   注意，仅第一次调用 strtok 函数时才使用 <code class="parameter">string</code> 参数。
   随后每次调用 strtok 都将只使用 <code class="parameter">token</code> 参数，因为它会记住它在当前字符串中的位置。
   如果要重新开始分割一个新的字符串，你需要再次使用 <code class="parameter">string</code> 参数来调用 strtok 函数来对其进行初始化。
   注意，可以在 <code class="parameter">token</code> 参数中使用多个字符。字符串将被 <code class="parameter">token</code> 参数中任何一个字符分割。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    这个函数的行为可能与熟悉 <span class="function"><a href="function.explode.html" class="function">explode()</a></span> 的人期望略有不同。
    首先，在解析的字符串中，两个或多个连续的 <code class="parameter">token</code> 的
    字符被认为是单一的分隔符。
    此外，位于字符串开始或结束处的 <code class="parameter">token</code> 将被忽略。
    例如，如果使用一个字符串 <code class="literal">&quot;;aaa;;bbb;&quot;</code> ，连续调用 <span class="function"><strong>strtok()</strong></span>
    并将 <code class="literal">&quot;;&quot;</code> 作为一个 <code class="parameter">token</code>
    将返回字符串 &quot;aaa&quot; 和 &quot;bbb&quot;，然后返回 <strong><code>false</code></strong> 。
    因此，字符串将仅被拆分为两个元素，而 <code class="literal">explode(&quot;;&quot;, $string)</code> 将返回一个包含 5 个元素的数组。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.strtok-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       被分成若干子字符串的原始<span class="type"><span class="type 字符串">字符串</span></span>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">token</code></dt>

     <dd>

      <p class="para">
       分割 <code class="parameter">string</code> 时使用的分界字符。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.strtok-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   标记后的<span class="type"><span class="type 字符串">字符串</span></span>，如果没有更多标记可用，则返回 <strong><code>false</code></strong> 。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.strtok-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>strtok()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$string </span><span style="color: #007700">= </span><span style="color: #DD0000">"This is\tan example\nstring"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">/* 使用制表符和换行符作为分界符 */<br /></span><span style="color: #0000BB">$tok </span><span style="color: #007700">= </span><span style="color: #0000BB">strtok</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">, </span><span style="color: #DD0000">" \n\t"</span><span style="color: #007700">);<br /><br />while (</span><span style="color: #0000BB">$tok </span><span style="color: #007700">!== </span><span style="color: #0000BB">false</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"Word=</span><span style="color: #0000BB">$tok</span><span style="color: #DD0000">&lt;br /&gt;"</span><span style="color: #007700">;<br />    </span><span style="color: #0000BB">$tok </span><span style="color: #007700">= </span><span style="color: #0000BB">strtok</span><span style="color: #007700">(</span><span style="color: #DD0000">" \n\t"</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #2 当 <span class="function"><strong>strtok()</strong></span> 找不到标记时的反应</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$first_token  </span><span style="color: #007700">= </span><span style="color: #0000BB">strtok</span><span style="color: #007700">(</span><span style="color: #DD0000">'/something'</span><span style="color: #007700">, </span><span style="color: #DD0000">'/'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$second_token </span><span style="color: #007700">= </span><span style="color: #0000BB">strtok</span><span style="color: #007700">(</span><span style="color: #DD0000">'/'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$first_token</span><span style="color: #007700">, </span><span style="color: #0000BB">$second_token</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
    string(9) &quot;something&quot;
    bool(false)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #3 <span class="function"><strong>strtok()</strong></span> 和 <span class="function"><a href="function.explode.html" class="function">explode()</a></span> 的不同点</strong></p>
    <div class="example-contents">
     <div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$string </span><span style="color: #007700">= </span><span style="color: #DD0000">";aaa;;bbb;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$parts </span><span style="color: #007700">= [];<br /></span><span style="color: #0000BB">$tok </span><span style="color: #007700">= </span><span style="color: #0000BB">strtok</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">, </span><span style="color: #DD0000">";"</span><span style="color: #007700">);<br />while (</span><span style="color: #0000BB">$tok </span><span style="color: #007700">!== </span><span style="color: #0000BB">false</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$parts</span><span style="color: #007700">[] = </span><span style="color: #0000BB">$tok</span><span style="color: #007700">;<br />    </span><span style="color: #0000BB">$tok </span><span style="color: #007700">= </span><span style="color: #0000BB">strtok</span><span style="color: #007700">(</span><span style="color: #DD0000">";"</span><span style="color: #007700">);<br />}<br />echo </span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">),</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$parts </span><span style="color: #007700">= </span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">";"</span><span style="color: #007700">, </span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />echo </span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$parts</span><span style="color: #007700">),</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
     <div class="cdata"><pre>
[&quot;aaa&quot;,&quot;bbb&quot;]
[&quot;&quot;,&quot;aaa&quot;,&quot;&quot;,&quot;bbb&quot;,&quot;&quot;]
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.strtok-notes">
  <h3 class="title">注释</h3>
  
  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">此函数可能返回布尔值
<strong><code>false</code></strong>，但也可能返回等同于 <strong><code>false</code></strong> 的非布尔值。请阅读 <a href="language.types.boolean.html" class="link">布尔类型</a>章节以获取更多信息。应使用
<a href="language.operators.comparison.html" class="link">===
运算符</a>来测试此函数的返回值。</p></div>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.strtok-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.explode.html" class="function" rel="rdfs-seeAlso">explode()</a> - 使用一个字符串分割另一个字符串</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="128402""></a>
  <div class="note">
   <strong class="user">voojj3054 at gmail dot com</strong>
   <a href="#128402" class="date">17-Apr-2023 08:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello, portuguese documentation of strtok is wrong, at this part which the example(2) is wrong.<br />
<br />
Exemplo #2 Comportamento antigo da strtok()<br />
<span class="default">&lt;?php<br />
$first_token&nbsp; </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'/something'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">$second_token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">var_dump </span><span class="keyword">(</span><span class="default">$first_token</span><span class="keyword">, </span><span class="default">$second_token</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
O exemplo acima produzirá:<br />
<br />
&nbsp;&nbsp;&nbsp; string(0) ""<br />
&nbsp;&nbsp;&nbsp; string(9) "something"<br />
<br />
(this example above, should be inverted as this:)<br />
<br />
Correct: <br />
&nbsp;&nbsp;&nbsp; string(9) "something"<br />
&nbsp;&nbsp;&nbsp; string(0) ""<br />
<br />
(exemple 3 is correct)<br />
Exemplo #3 Novo comportamento da strtok()<br />
<span class="default">&lt;?php<br />
$first_token&nbsp; </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'/something'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">$second_token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">var_dump </span><span class="keyword">(</span><span class="default">$first_token</span><span class="keyword">, </span><span class="default">$second_token</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
O exemplo acima produzirá:<br />
<br />
&nbsp;&nbsp;&nbsp; string(9) "something"<br />
&nbsp;&nbsp;&nbsp; bool(false)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125793""></a>
  <div class="note">
   <strong class="user">David Spector</strong>
   <a href="#125793" class="date">07-Feb-2021 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After obtaining zero or more tokens with calls to strtok, you can obtain the remainder of the input string by calling strtok with an empty string as the delimiter.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124067""></a>
  <div class="note">
   <strong class="user">heiangus at hotmail dot com</strong>
   <a href="#124067" class="date">24-Jul-2019 06:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found this useful for parsing user entered links in text fields.<br />
<br />
e.g. This is a link &lt;<a href="http://example.com&gt;" rel="nofollow" target="_blank">http://example.com&gt;</a><br />
<br />
&nbsp;&nbsp;&nbsp; function parselink($link) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $bit1 = trim(strtok($link, '&lt;'));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $bit2 = trim(strtok('&gt;')); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $html = '&lt;a href="'.$bit2.'"&gt;'.$bit1.'&lt;/a&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $html; // &lt;a href="<a href="http://example.com" rel="nofollow" target="_blank">http://example.com</a>"&gt;This is a link&lt;/a&gt;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120170""></a>
  <div class="note">
   <strong class="user">charlie dot ded at orange dot fr</strong>
   <a href="#120170" class="date">15-Nov-2016 01:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@maisuma you invert paramaters of explode() and strtok() functions, your code does not do what you expect.<br />
You expect to read the input string token after token so equivalent code for strtok() is&nbsp; arra_filter(explode()) because explode() return lines of empty string when several delimiters are contiguous in the read string, for example&nbsp; 2 whitespaces between.<br />
<br />
In fact strtok() is much faster (x2 at least) than arra_filter(explode()) if the read string contains several contiguous delimiters , <br />
&nbsp;it is slower if the read string contains one and only one delimiter between tokens.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$repeat </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">;<br />
</span><span class="default">$delimiter </span><span class="keyword">= </span><span class="string">':'</span><span class="keyword">;<br />
</span><span class="default">$str</span><span class="keyword">=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">'foo:'</span><span class="keyword">,</span><span class="default">$repeat</span><span class="keyword">);<br />
<br />
</span><span class="default">$timeStrtok</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$delimiter</span><span class="keyword">);<br />
while(</span><span class="default">$token</span><span class="keyword">!==</span><span class="default">FALSE</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo $token . ',';<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$token</span><span class="keyword">=</span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">); <br />
}<br />
</span><span class="default">$timeStrtok </span><span class="keyword">-=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
<br />
</span><span class="default">$timeExplo</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$arr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delimiter</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
</span><span class="comment">//$arr = array_filter($arr);<br />
</span><span class="default">$timeExplo </span><span class="keyword">-=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
<br />
</span><span class="comment">//print_r($arr);<br />
<br />
</span><span class="default">$X </span><span class="keyword">= </span><span class="default">1000000</span><span class="keyword">; </span><span class="default">$unit </span><span class="keyword">= </span><span class="string">'microsec'</span><span class="keyword">;<br />
<br />
echo </span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="string">' explode() : ' </span><span class="keyword">. -</span><span class="default">$timeExplo </span><span class="keyword">. </span><span class="string">' ' </span><span class="keyword">.</span><span class="default">$unit </span><span class="keyword">.</span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="string">' strtok() :&nbsp;&nbsp; ' </span><span class="keyword">. -</span><span class="default">$timeStrtok </span><span class="keyword">. </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$unit </span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="default">$timeExplo</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(-</span><span class="default">$timeExplo</span><span class="keyword">*</span><span class="default">$X</span><span class="keyword">);<br />
</span><span class="default">$timeStrtok</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(-</span><span class="default">$timeStrtok</span><span class="keyword">*</span><span class="default">$X</span><span class="keyword">);<br />
<br />
echo </span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="string">' explode() : ' </span><span class="keyword">. </span><span class="default">$timeExplo </span><span class="keyword">. </span><span class="string">' ' </span><span class="keyword">.</span><span class="default">$unit </span><span class="keyword">.</span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="string">' strtok() :&nbsp;&nbsp; ' </span><span class="keyword">. </span><span class="default">$timeStrtok </span><span class="keyword">. </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$unit </span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
echo </span><span class="string">' ratio explode / strtok : ' </span><span class="keyword">. </span><span class="default">round</span><span class="keyword">(</span><span class="default">$timeExplo </span><span class="keyword">/ </span><span class="default">$timeStrtok</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116458""></a>
  <div class="note">
   <strong class="user">eep2004 at ukr dot net</strong>
   <a href="#116458" class="date">06-Jan-2015 08:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remove GET variables from the URL<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'<a href="http://example.com/index.php?foo=1&amp;bar=2" rel="nofollow" target="_blank">http://example.com/index.php?foo=1&amp;bar=2</a>'</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Result:<br />
<a href="http://example.com/index.php" rel="nofollow" target="_blank">http://example.com/index.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115872""></a>
  <div class="note">
   <strong class="user">eep2004 at ukr dot net</strong>
   <a href="#115872" class="date">07-Oct-2014 10:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remove GET variables from the URL<br />
<span class="default">&lt;?php<br />
$url </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'<a href="http://php.net/manual/en/ref.strings.php?foo=1&amp;bar=2" rel="nofollow" target="_blank">http://php.net/manual/en/ref.strings.php?foo=1&amp;bar=2</a>'</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">);<br />
</span><span class="comment">// $url = '<a href="http://php.net/manual/en/ref.strings.php" rel="nofollow" target="_blank">http://php.net/manual/en/ref.strings.php</a>'</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115124""></a>
  <div class="note">
   <strong class="user">info at maisuma dot jp</strong>
   <a href="#115124" class="date">30-May-2014 08:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to tokenize by only one letter, explode() is much faster compared to strtok().<br />
<br />
<span class="default">&lt;?php<br />
$str</span><span class="keyword">=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">'foo '</span><span class="keyword">,</span><span class="default">10000</span><span class="keyword">);<br />
<br />
</span><span class="comment">//explode()<br />
</span><span class="default">$time</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$arr</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">);<br />
</span><span class="default">$time</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">)-</span><span class="default">$time</span><span class="keyword">;<br />
echo </span><span class="string">"explode():</span><span class="default">$time</span><span class="string"> sec."</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="comment">//strtok()<br />
</span><span class="default">$time</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">$ret</span><span class="keyword">=</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br />
while(</span><span class="default">$ret</span><span class="keyword">!==</span><span class="default">FALSE</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret</span><span class="keyword">=</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">);<br />
}<br />
</span><span class="default">$time</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">)-</span><span class="default">$time</span><span class="keyword">;<br />
echo </span><span class="string">"strtok():</span><span class="default">$time</span><span class="string"> sec."</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The result is : (PHP 5.3.3 on CentOS)<br />
<br />
explode():0.001317024230957 sec.<br />
strtok():0.0058917999267578 sec.<br />
<br />
explode() is about five times fast in short strings, too.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114349""></a>
  <div class="note">
   <strong class="user">Axeia</strong>
   <a href="#114349" class="date">11-Feb-2014 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Might be pointing out the obvious but if you'd rather use a for loop rather than a while (to keep the token strings on the same line for readability for example), it can be done. Added bonus, it doesn't put a $tok variable outside the loop itself either.<br />
Downside however is that you're not able to manually free up the memory used using the technique mentioned by elarlang.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">for(</span><span class="default">$tok </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">' _-.'</span><span class="keyword">); </span><span class="default">$tok</span><span class="keyword">!==</span><span class="default">false</span><span class="keyword">; </span><span class="default">$tok </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">' _-.'</span><span class="keyword">))<br />
{<br />
&nbsp; echo </span><span class="string">"</span><span class="default">$tok</span><span class="string"> &lt;/br&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113256""></a>
  <div class="note">
   <strong class="user">eep2004 at ukr dot net</strong>
   <a href="#113256" class="date">18-Sep-2013 04:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">// strtok example<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="string">'Hello to all of Ukraine'</span><span class="keyword">;<br />
echo </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">).</span><span class="string">' '</span><span class="keyword">.</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">).</span><span class="string">' '</span><span class="keyword">.</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Result:<br />
Hello to all</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109415""></a>
  <div class="note">
   <strong class="user">gilthans at NOSPAM dot gmail dot com</strong>
   <a href="#109415" class="date">15-Jul-2012 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that strtok may receive different tokens each time. Therefore, if, for example, you wish to extract several words and then the rest of the sentence:<br />
<br />
<span class="default">&lt;?php<br />
$text </span><span class="keyword">= </span><span class="string">"13 202 5 This is a long message explaining the error codes."</span><span class="keyword">;<br />
</span><span class="default">$error1 </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="string">" "</span><span class="keyword">); </span><span class="comment">//13<br />
</span><span class="default">$error2 </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">); </span><span class="comment">//202<br />
</span><span class="default">$error3 </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">); </span><span class="comment">//5<br />
</span><span class="default">$error_message </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">); </span><span class="comment">//Notice the different token parameter<br />
</span><span class="keyword">echo </span><span class="default">$error_message</span><span class="keyword">; </span><span class="comment">//This is a long message explaining the error codes.<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103962""></a>
  <div class="note">
   <strong class="user">pradador at me dot com</strong>
   <a href="#103962" class="date">13-May-2011 12:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple class that allows you to iterate through string tokens using a foreach loop.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* The TokenIterator class allows you to iterate through string tokens using
<br />
&nbsp;* the familiar foreach control structure.
<br />
&nbsp;* 
<br />
&nbsp;* Example:
<br />
&nbsp;* &lt;code&gt;
<br />
&nbsp;* &lt;?php
<br />
&nbsp;* $string = 'This is a test.';
<br />
&nbsp;* $delimiters = ' ';
<br />
&nbsp;* $ti = new TokenIterator($string, $delimiters);
<br />
&nbsp;* 
<br />
&nbsp;* foreach ($ti as $count =&gt; $token) {
<br />
&nbsp;*&nbsp; &nbsp;&nbsp; echo sprintf("%d, %s\n", $count, $token); 
<br />
&nbsp;* }
<br />
&nbsp;* 
<br />
&nbsp;* // Prints the following output:
<br />
&nbsp;* // 0. This
<br />
&nbsp;* // 1. is
<br />
&nbsp;* // 2. a
<br />
&nbsp;* // 3. test.
<br />
&nbsp;* &lt;/code&gt;
<br />
&nbsp;*/
<br />
</span><span class="keyword">class </span><span class="default">TokenIterator </span><span class="keyword">implements </span><span class="default">Iterator
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * The string to tokenize.
<br />
&nbsp;&nbsp; &nbsp; * @var string
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$_string</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * The token delimiters.
<br />
&nbsp;&nbsp; &nbsp; * @var string
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$_delims</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * Stores the current token.
<br />
&nbsp;&nbsp; &nbsp; * @var mixed
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$_token</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * Internal token counter.
<br />
&nbsp;&nbsp; &nbsp; * @var int
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$_counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * Constructor.
<br />
&nbsp;&nbsp; &nbsp; * 
<br />
&nbsp;&nbsp; &nbsp; * @param string $string The string to tokenize.
<br />
&nbsp;&nbsp; &nbsp; * @param string $delims The token delimiters.
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$delims</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_string </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_delims </span><span class="keyword">= </span><span class="default">$delims</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$delims</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * @see Iterator::current()
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">current</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_token</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * @see Iterator::key()
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">key</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_counter</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * @see Iterator::next()
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">next</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_delims</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">valid</span><span class="keyword">()) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ++</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_counter</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * @see Iterator::rewind()
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">rewind</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_token&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_string</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_delims</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**
<br />
&nbsp;&nbsp; &nbsp; * @see Iterator::valid()
<br />
&nbsp;&nbsp; &nbsp; */
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">valid</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_token </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103051""></a>
  <div class="note">
   <strong class="user">elarlang at gmail dot com</strong>
   <a href="#103051" class="date">22-Mar-2011 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have memory-usage critical solution, you should keep in mind, that strtok function holds input string parameter (or reference to it?) in memory after usage.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">tokenize</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== </span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do something here...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$token_symbols</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Test-cases with handling ~10MB plain-text file:<br />
Case #1 - unset $str variable<br />
<span class="default">&lt;?php<br />
$token_symbols </span><span class="keyword">= </span><span class="string">" \t\n"</span><span class="keyword">;<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'10MB.txt'</span><span class="keyword">); </span><span class="comment">// mem usage 9.75383758545 MB (memory_get_usage() / 1024 / 1024)); <br />
</span><span class="default">tokenize</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">); </span><span class="comment">// mem usage 9.75400161743 MB<br />
</span><span class="keyword">unset(</span><span class="default">$str</span><span class="keyword">); </span><span class="comment">// 9.75395584106 MB<br />
</span><span class="default">?&gt;<br />
</span>Case #1 result: memory is still used<br />
<br />
Case #2 - call strtok again<br />
<span class="default">&lt;?php<br />
$token_symbols </span><span class="keyword">= </span><span class="string">" \t\n"</span><span class="keyword">;<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'10MB.txt'</span><span class="keyword">); </span><span class="comment">// 9.75401306152 MB<br />
</span><span class="default">tokenize</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">); </span><span class="comment">// 9.75417709351<br />
</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">); </span><span class="comment">// 9.75421524048<br />
</span><span class="default">?&gt;<br />
</span>Case #2 result: memory is still used<br />
<br />
Case #3 - call strtok again AND unset $str variable<br />
<span class="default">&lt;?php<br />
$token_symbols </span><span class="keyword">= </span><span class="string">" \t\n"</span><span class="keyword">;<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'10MB.txt'</span><span class="keyword">); </span><span class="comment">// 9.75410079956 MB<br />
</span><span class="default">tokenize</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">); </span><span class="comment">// 9.75426483154 MB<br />
</span><span class="keyword">unset(</span><span class="default">$str</span><span class="keyword">);<br />
</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">); </span><span class="comment">// 0.0543975830078 MB<br />
</span><span class="default">?&gt;<br />
</span>Case #3 result: memory is free<br />
<br />
So, better solution for tokenize function:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">tokenize</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">, </span><span class="default">$token_reset </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$token_symbols</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== </span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do something here...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$token_symbols</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$token_reset</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101015""></a>
  <div class="note">
   <strong class="user">fabiolimasouto at gmail dot com</strong>
   <a href="#101015" class="date">20-Nov-2010 05:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this example will hopefully help you understand how this function works:<br />
<br />
<span class="default">&lt;?php<br />
$selector </span><span class="keyword">= </span><span class="string">'div.class#id'</span><span class="keyword">;<br />
</span><span class="default">$tagname </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$selector</span><span class="keyword">,</span><span class="string">'.#'</span><span class="keyword">);<br />
echo </span><span class="default">$tagname</span><span class="keyword">.</span><span class="string">'&lt;br/&gt;'</span><span class="keyword">;<br />
<br />
while(</span><span class="default">$tok </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'.#'</span><span class="keyword">))<br />
{<br />
&nbsp;echo </span><span class="default">$tok</span><span class="keyword">.</span><span class="string">'&lt;br/&gt;'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs:<br />
div<br />
class<br />
id</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94463""></a>
  <div class="note">
   <strong class="user">benighted at gmail dot com</strong>
   <a href="#94463" class="date">06-Nov-2009 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple way to tokenize search parameters, including double or single quoted keys.&nbsp; If only one quote is found, the rest of the string is assumed to be part of that token.
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$keywords</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$token</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// find double quoted tokens
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$token</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}==</span><span class="string">'"'</span><span class="keyword">) { </span><span class="default">$token </span><span class="keyword">.= </span><span class="string">' '</span><span class="keyword">.</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'"'</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// find single quoted tokens
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$token</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}==</span><span class="string">"'"</span><span class="keyword">) { </span><span class="default">$token </span><span class="keyword">.= </span><span class="string">' '</span><span class="keyword">.</span><span class="default">strtok</span><span class="keyword">(</span><span class="string">"'"</span><span class="keyword">).</span><span class="string">"'"</span><span class="keyword">; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[] = </span><span class="default">$token</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Use substr(1,strlen($token)) and remove the part that adds the trailing quotes if you want your output without quotes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93315""></a>
  <div class="note">
   <strong class="user">azeem</strong>
   <a href="#93315" class="date">02-Sep-2009 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a java like StringTokenizer class using strtok function:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* The string tokenizer class allows an application to break a string into tokens.<br />
&nbsp;*<br />
&nbsp;* @example The following is one example of the use of the tokenizer. The code:<br />
&nbsp;* &lt;code&gt;<br />
&nbsp;* &lt;?php<br />
&nbsp;*&nbsp; &nbsp; $str = 'this is:@\t\n a test!';<br />
&nbsp;*&nbsp; &nbsp; $delim = ' !@:'\t\n; // remove these chars<br />
&nbsp;*&nbsp; &nbsp; $st = new StringTokenizer($str, $delim);<br />
&nbsp;*&nbsp; &nbsp; while ($st-&gt;hasMoreTokens()) {<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; echo $st-&gt;nextToken() . "\n";<br />
&nbsp;*&nbsp; &nbsp; }<br />
&nbsp;*&nbsp; &nbsp; prints the following output:<br />
&nbsp;*&nbsp; &nbsp; &nbsp; this<br />
&nbsp;*&nbsp; &nbsp; &nbsp; is<br />
&nbsp;*&nbsp; &nbsp; &nbsp; a<br />
&nbsp;*&nbsp; &nbsp; &nbsp; test<br />
&nbsp;* ?&gt;<br />
&nbsp;* &lt;/code&gt;<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">StringTokenizer </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @var string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$token</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @var string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$delim</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Constructs a string tokenizer for the specified string<br />
&nbsp;&nbsp; &nbsp; * @param string $str String to tokenize<br />
&nbsp;&nbsp; &nbsp; * @param string $delim The set of delimiters (the characters that separate tokens)<br />
&nbsp;&nbsp; &nbsp; * specified at creation time, default to ' '<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="comment">/*string*/ </span><span class="default">$str</span><span class="keyword">, </span><span class="comment">/*string*/ </span><span class="default">$delim </span><span class="keyword">= </span><span class="string">' '</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$delim</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">delim </span><span class="keyword">= </span><span class="default">$delim</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$this</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Tests if there are more tokens available from this tokenizer's string. It<br />
&nbsp;&nbsp; &nbsp; * does not move the internal pointer in any way. To move the internal pointer<br />
&nbsp;&nbsp; &nbsp; * to the next element call nextToken()<br />
&nbsp;&nbsp; &nbsp; * @return boolean - true if has more tokens, false otherwise<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">hasMoreTokens</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">token </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Returns the next token from this string tokenizer and advances the internal<br />
&nbsp;&nbsp; &nbsp; * pointer by one.<br />
&nbsp;&nbsp; &nbsp; * @return string - next element in the tokenized string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">nextToken</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$current </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">token</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">token </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">delim</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$current</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91532""></a>
  <div class="note">
   <strong class="user">yanick dot rochon at gmail dot com</strong>
   <a href="#91532" class="date">15-Jun-2009 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a small function I wrote as I needed to extract some named tokens from a string (a la Google). For example, I needed to format a string like "extension:gif size:64M animated:true author:'John Bash'" into<br />
<br />
array(<br />
&nbsp; 'extension' =&gt; 'gif',<br />
&nbsp; 'size' =&gt; '64M',<br />
&nbsp; 'animated' =&gt; true,<br />
&nbsp; 'author' =&gt; 'John Bash'<br />
)<br />
<br />
So, here's the code: <br />
<br />
<span class="default">&lt;?php<br />
<br />
header</span><span class="keyword">(</span><span class="string">'Content-type: text/plain; CHARSET=gb2312'</span><span class="keyword">);<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* NOTE : use mbstring.func_overload for multi-byte support with this function<br />
&nbsp;*<br />
&nbsp;* @param string $string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; the string to tokenize<br />
&nbsp;* @param int $offset&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the starting offset<br />
&nbsp;* @param string $defaultTokenName&nbsp;&nbsp; the default token name if none specified<br />
&nbsp;* @param string $groupDelimiters&nbsp; &nbsp; the characters to delimit token groups<br />
&nbsp;* @param string $groupNameDelimiter the character(s) to delimit token group names<br />
&nbsp;* @return array<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">getTokens</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$defaultTokenName </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$groupDelimiters </span><span class="keyword">= </span><span class="string">'\'"'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$groupNameDelimiter </span><span class="keyword">= </span><span class="string">':'</span><span class="keyword">) <br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$offset </span><span class="keyword">&gt;= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "offset out of range";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$spaces </span><span class="keyword">= </span><span class="string">" \t\n\r"</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// space characters<br />
<br />
&nbsp;&nbsp;&nbsp; // add group delimiters to spaces...<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$groupSpaces </span><span class="keyword">= </span><span class="default">$spaces </span><span class="keyword">. </span><span class="default">$groupNameDelimiter</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$delimiters </span><span class="keyword">= </span><span class="default">$groupSpaces </span><span class="keyword">. </span><span class="default">$groupDelimiters</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//var_dump($groupSpaces);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">ltrim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">), </span><span class="default">$groupSpaces</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$token_strings </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo "String is : " . $string . "\n";<br />
<br />
&nbsp;&nbsp;&nbsp; // 1. split all tokens...<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastOffset </span><span class="keyword">= </span><span class="default">$offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$escaped </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">false </span><span class="keyword">!== </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$groupDelimiters</span><span class="keyword">, </span><span class="default">$char </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">[</span><span class="default">$offset</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$groupChar </span><span class="keyword">= </span><span class="default">$char</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$groupChar </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">null </span><span class="keyword">!== </span><span class="default">$groupChar</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) &amp;&amp; ((</span><span class="default">$groupChar </span><span class="keyword">!== (</span><span class="default">$char </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">[++</span><span class="default">$offset</span><span class="keyword">])) || </span><span class="default">$escaped</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//$offset++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$escaped </span><span class="keyword">= (</span><span class="string">'\\' </span><span class="keyword">=== </span><span class="default">$char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "*** Grouped : " . substr($string, $lastOffset, $offset - $lastOffset) . "\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) &amp;&amp; ((</span><span class="default">false </span><span class="keyword">=== </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$delimiters</span><span class="keyword">, </span><span class="default">$char </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">[</span><span class="default">$offset</span><span class="keyword">])) || </span><span class="default">$escaped</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$escaped </span><span class="keyword">= (</span><span class="string">'\\' </span><span class="keyword">=== </span><span class="default">$char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "*** Non-group : " . substr($string, $lastOffset, $offset - $lastOffset) . "\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//skip spaces...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">while ((</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) &amp;&amp; ((</span><span class="default">false </span><span class="keyword">!== </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$groupSpaces</span><span class="keyword">, </span><span class="default">$char </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">[</span><span class="default">$offset</span><span class="keyword">])) || </span><span class="default">$escaped</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$escaped </span><span class="keyword">= (</span><span class="string">'\\' </span><span class="keyword">=== </span><span class="default">$char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$token_strings</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$lastOffset</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">- </span><span class="default">$lastOffset</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "Next token = '" . end($token_strings) . "'\n";<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tokens </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tokenName </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$token_strings </span><span class="keyword">as </span><span class="default">$token_str</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// clean $token_str<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$token_str </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$token_str</span><span class="keyword">), </span><span class="default">$spaces</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str_value </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$token_str</span><span class="keyword">, </span><span class="default">$delimiters</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$str_value</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'true'</span><span class="keyword">: </span><span class="default">$str_value </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'false'</span><span class="keyword">: </span><span class="default">$str_value </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default: break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// is it a token name?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="string">':' </span><span class="keyword">=== </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$token_str</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$tokenName</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$tokenName</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokenName </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$token_str</span><span class="keyword">, </span><span class="default">$delimiters</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$tokenName</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$tokenName</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$tokenName</span><span class="keyword">] = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$tokenName</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str_value<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$tokenName</span><span class="keyword">] = </span><span class="default">$str_value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokenName </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif (empty(</span><span class="default">$defaultTokenName</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$token_str</span><span class="keyword">, </span><span class="default">$delimiters</span><span class="keyword">);;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$defaultTokenName</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$defaultTokenName</span><span class="keyword">] = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$defaultTokenName</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str_value<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$defaultTokenName</span><span class="keyword">] = </span><span class="default">$str_value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!empty(</span><span class="default">$tokenName</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tokens</span><span class="keyword">[</span><span class="default">$tokenName</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$tokens</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="string">"check1: test "<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"check2:'hello world' "<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">'check3: "foo" '<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"check4: \\\"try this\\\""<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">'"buz" '<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">'check1:true'</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89421""></a>
  <div class="note">
   <strong class="user">KrazyBox</strong>
   <a href="#89421" class="date">06-Mar-2009 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of the change in strtok()'s handling of empty strings, it is now useless for scripts that rely on empty data to function.<br />
<br />
Take for instance, a standard header. (with UNIX newlines)<br />
<br />
http/1.0 200 OK\n<br />
Content-Type: text/html\n<br />
\n<br />
--HTML BODY HERE---<br />
<br />
When parsing this with strtok, one would wait until it found an empty string to signal the end of the header. However, because strtok now skips empty segments, it is impossible to know when the header has ended.<br />
This should not be called `correct' behavior, it certainly is not. It has rendered strtok incapable of (properly) processing a very simple standard.<br />
<br />
This new functionality, however, does not affect Windows style headers. You would search for a line that only contains "\r"<br />
This, however, is not a justification for the change.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87977""></a>
  <div class="note">
   <strong class="user">Logikos</strong>
   <a href="#87977" class="date">03-Jan-2009 10:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This looks very simple, but it took me a long time to figure out so I thought I'd share it incase someone else was wanting the same thing:<br />
<br />
this should work similar to substr() but with tokens instead!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/* subtok(string,chr,pos,len)<br />
&nbsp;*<br />
&nbsp;* chr = chr used to seperate tokens<br />
&nbsp;* pos = starting postion<br />
&nbsp;* len = length, if negative count back from right<br />
&nbsp;* <br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',0)&nbsp; &nbsp;&nbsp; = 'a.b.c.d.e'<br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',0,2)&nbsp;&nbsp; = 'a.b'<br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',2,1)&nbsp;&nbsp; = 'c'<br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',2,-1)&nbsp; = 'c.d'<br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',-4)&nbsp; &nbsp; = 'b.c.d.e'<br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',-4,2)&nbsp; = 'b.c'<br />
&nbsp;*&nbsp; subtok('a.b.c.d.e','.',-4,-1) = 'b.c.d'<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">subtok</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$chr</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">,</span><span class="default">$len </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">) {<br />
&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$chr</span><span class="keyword">,</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$chr</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">),</span><span class="default">$pos</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
explode breaks the tokens up into an array, array slice alows you to pick then tokens you want, and then implode converts it back to a string<br />
<br />
although its far from a clone, this was inspired by mIRC's gettok() function</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62073""></a>
  <div class="note">
   <strong class="user">mac.com@nemo</strong>
   <a href="#62073" class="date">18-Feb-2006 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function takes a string and returns an array with words (delimited by spaces), also taking into account quotes, doublequotes, backticks and backslashes (for escaping stuff).<br />
So<br />
<br />
$string = "cp&nbsp;&nbsp; 'my file' to `Judy's file`";<br />
var_dump(parse_cli($string));<br />
<br />
would yield:<br />
<br />
array(4) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; string(2) "cp"<br />
&nbsp; [1]=&gt;<br />
&nbsp; string(7) "my file"<br />
&nbsp; [2]=&gt;<br />
&nbsp; string(5) "to"<br />
&nbsp; [3]=&gt;<br />
&nbsp; string(11) "Judy's file"<br />
}<br />
<br />
Way it works, runs through the string character by character, for each character looking up the action to take, based on that character and its current $state.<br />
Actions can be (one or more of) adding the character/string to the current word, adding the word to the output array, and changing or (re)storing the state.<br />
For example a space will become part of the current 'word' (or 'token') if $state is 'doublequoted', but it will start a new token if $state was 'unquoted'.<br />
I was later told it's a "tokeniser using a finite state automaton". Who knew :-)<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">#_____________________<br />
# parse_cli($string) /<br />
</span><span class="keyword">function </span><span class="default">parse_cli</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'space'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$previous </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">// stores current state when encountering a backslash (which changes $state to 'escaped', but has to fall back into the previous $state afterwards)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">= array();&nbsp; &nbsp;&nbsp; </span><span class="comment">// the return value<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// type of character<br />
&nbsp;&nbsp;&nbsp; // array[states][chartypes] =&gt; actions<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chart </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'space'&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,&nbsp;&nbsp; </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'q'</span><span class="keyword">,&nbsp; </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'d'</span><span class="keyword">,&nbsp; </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'b'</span><span class="keyword">,&nbsp; </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'ue'</span><span class="keyword">, </span><span class="string">'other'</span><span class="keyword">=&gt;</span><span class="string">'ua'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'unquoted'&nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">'w '</span><span class="keyword">, </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'e'</span><span class="keyword">,&nbsp; </span><span class="string">'other'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'quoted'&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'w '</span><span class="keyword">, </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'e'</span><span class="keyword">,&nbsp; </span><span class="string">'other'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'doublequoted' </span><span class="keyword">=&gt; array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'w '</span><span class="keyword">, </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'e'</span><span class="keyword">,&nbsp; </span><span class="string">'other'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'backticked'&nbsp;&nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">,&nbsp; </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'w '</span><span class="keyword">, </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'e'</span><span class="keyword">,&nbsp; </span><span class="string">'other'</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'escaped'&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">'ap'</span><span class="keyword">, </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'ap'</span><span class="keyword">, </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'ap'</span><span class="keyword">, </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'ap'</span><span class="keyword">, </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'ap'</span><span class="keyword">, </span><span class="string">'other'</span><span class="keyword">=&gt;</span><span class="string">'ap'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">, array(</span><span class="string">'space'</span><span class="keyword">=&gt;</span><span class="string">' '</span><span class="keyword">, </span><span class="string">'quote'</span><span class="keyword">=&gt;</span><span class="string">'\''</span><span class="keyword">, </span><span class="string">'doublequote'</span><span class="keyword">=&gt;</span><span class="string">'"'</span><span class="keyword">, </span><span class="string">'backtick'</span><span class="keyword">=&gt;</span><span class="string">'`'</span><span class="keyword">, </span><span class="string">'backslash'</span><span class="keyword">=&gt;</span><span class="string">'\\'</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (! </span><span class="default">$type</span><span class="keyword">) </span><span class="default">$type </span><span class="keyword">= </span><span class="string">'other'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$type </span><span class="keyword">== </span><span class="string">'other'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// grabs all characters that are also 'other' following the current one in one go<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/[ \'\"\`\\\]/"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">, </span><span class="default">PREG_OFFSET_CAPTURE</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$matches</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$matches </span><span class="keyword">= </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$i</span><span class="keyword">); </span><span class="comment">// yep, $char length can be &gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] - </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// no more match on special characters, that must mean this is the last word!<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // the .= hereunder is because we *might* be in the middle of a word that just contained special chars<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break; </span><span class="comment">// jumps out of the for() loop<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$actions </span><span class="keyword">= </span><span class="default">$chart</span><span class="keyword">[</span><span class="default">$state</span><span class="keyword">][</span><span class="default">$type</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$actions</span><span class="keyword">); </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$act </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$actions</span><span class="keyword">, </span><span class="default">$j</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">' '</span><span class="keyword">) </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'space'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'u'</span><span class="keyword">) </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'unquoted'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'q'</span><span class="keyword">) </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'quoted'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'d'</span><span class="keyword">) </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'doublequoted'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'b'</span><span class="keyword">) </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'backticked'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'e'</span><span class="keyword">) { </span><span class="default">$previous </span><span class="keyword">= </span><span class="default">$state</span><span class="keyword">; </span><span class="default">$state </span><span class="keyword">= </span><span class="string">'escaped'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'a'</span><span class="keyword">) </span><span class="default">$word </span><span class="keyword">.= </span><span class="default">$char</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'w'</span><span class="keyword">) { </span><span class="default">$out</span><span class="keyword">[] = </span><span class="default">$word</span><span class="keyword">; </span><span class="default">$word </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$act </span><span class="keyword">== </span><span class="string">'p'</span><span class="keyword">) </span><span class="default">$state </span><span class="keyword">= </span><span class="default">$previous</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">)) </span><span class="default">$out</span><span class="keyword">[] = </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43381""></a>
  <div class="note">
   <strong class="user">manicdepressive at mindless dot com</strong>
   <a href="#43381" class="date">19-Jun-2004 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;pre&gt;<span class="default">&lt;?php<br />
</span><span class="comment">/** get leading, trailing, and embedded separator tokens that were 'skipped'<br />
if for some ungodly reason you are using php to implement a simple parser that <br />
needs to detect nested clauses as it builds a parse tree */<br />
<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="string">"(((alpha(beta))(gamma))"</span><span class="keyword">;<br />
<br />
</span><span class="default">$seps </span><span class="keyword">= </span><span class="string">'()'</span><span class="keyword">;<br />
</span><span class="default">$tok </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">,</span><span class="default">$seps </span><span class="keyword">); </span><span class="comment">// return false on empty string or null<br />
</span><span class="default">$cur </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;&nbsp; &nbsp; &nbsp; <br />
</span><span class="default">$dumbDone </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
</span><span class="default">$done </span><span class="keyword">= (</span><span class="default">FALSE</span><span class="keyword">===</span><span class="default">$tok</span><span class="keyword">);<br />
while (!</span><span class="default">$done</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="comment">// process skipped tokens (if any at first iteration) (special for last)<br />
&nbsp;&nbsp; </span><span class="default">$posTok </span><span class="keyword">= </span><span class="default">$dumbDone </span><span class="keyword">? </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) : </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$tok</span><span class="keyword">, </span><span class="default">$cur </span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$skippedMany </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$cur</span><span class="keyword">, </span><span class="default">$posTok</span><span class="keyword">-</span><span class="default">$cur </span><span class="keyword">); </span><span class="comment">// false when 0 width<br />
&nbsp;&nbsp; </span><span class="default">$lenSkipped </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$skippedMany</span><span class="keyword">); </span><span class="comment">// 0 when false<br />
&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">0</span><span class="keyword">!==</span><span class="default">$lenSkipped</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$skippedMany</span><span class="keyword">) -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">$last</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$skipped </span><span class="keyword">= </span><span class="default">$skippedMany</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$cur </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$skipped</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"skipped: </span><span class="default">$skipped</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; if (</span><span class="default">$dumbDone</span><span class="keyword">) break; </span><span class="comment">// this is the only place the loop is terminated<br />
<br />
&nbsp;&nbsp; // process current tok<br />
&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"curr tok: "</span><span class="keyword">.</span><span class="default">$tok</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// update cursor<br />
&nbsp;&nbsp; </span><span class="default">$cur </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$tok</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// get any next tok<br />
&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$dumbDone</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$tok </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$seps</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$dumbDone </span><span class="keyword">= (</span><span class="default">FALSE</span><span class="keyword">===</span><span class="default">$tok</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// you're not really done till you check for trailing skipped<br />
&nbsp;&nbsp; </span><span class="keyword">}<br />
};<br />
</span><span class="default">?&gt;</span>&lt;/pre&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
