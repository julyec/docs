<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Calculate the metaphone key of a string</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.md5.html">? md5</a></li>
      <li style="float: right;"><a href="function.money-format.html">money_format ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.strings.html">字符串 函数</a></li>
    <li>Calculate the metaphone key of a string</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.metaphone" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">metaphone</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">metaphone</span> &mdash; <span class="dc-title">Calculate the metaphone key of a string</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.metaphone-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>metaphone</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$max_phonemes</code><span class="initializer"> = 0</span></span>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   Calculates the metaphone key of <code class="parameter">string</code>.
  </p>
  <p class="para">
   Similar to <span class="function"><a href="function.soundex.html" class="function">soundex()</a></span> metaphone creates the same key for
   similar sounding words. It&#039;s more accurate than
   <span class="function"><a href="function.soundex.html" class="function">soundex()</a></span> as it knows the basic rules of English
   pronunciation.  The metaphone generated keys are of variable length.
  </p>
  <p class="para">
   Metaphone was developed by Lawrence Philips
   &lt;lphilips at verity dot com&gt;. It is described in [&quot;Practical
   Algorithms for Programmers&quot;, Binstock &amp; Rex, Addison Wesley,
   1995].
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.metaphone-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       The input string.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">max_phonemes</code></dt>

     <dd>

      <p class="para">
       This parameter restricts the returned metaphone key to 
       <code class="parameter">max_phonemes</code> <em class="emphasis">characters</em> in length.
       However, the resulting phonemes are always transcribed completely, so the
       resulting string length may be slightly longer than <code class="parameter">max_phonemes</code>.
       The default value of <code class="literal">0</code> means no restriction.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.metaphone-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns the metaphone key as a string.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.metaphone-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       The function returned <strong><code>false</code></strong> on failure.
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.metaphone-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>metaphone()</strong></span> basic example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programming'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programmer'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(7) &quot;PRKRMNK&quot;
string(6) &quot;PRKRMR&quot;
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #2 Using the <code class="parameter">max_phonemes</code> parameter</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programming'</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'programmer'</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(5) &quot;PRKRM&quot;
string(5) &quot;PRKRM&quot;
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #3 Using the <code class="parameter">max_phonemes</code> parameter</strong></p>
    <div class="example-contents"><p>
     In this example, <span class="function"><strong>metaphone()</strong></span> is advised to produce a string
     of five characters, but that would require to split the final phoneme
     (<code class="literal">&#039;x&#039;</code> is supposed to be transcribed to <code class="literal">&#039;KS&#039;</code>),
     so the function returns a string with six characters.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">metaphone</span><span style="color: #007700">(</span><span style="color: #DD0000">'Asterix'</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(6) &quot;ASTRKS&quot;
</pre></div>
    </div>
   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115812""></a>
  <div class="note">
   <strong class="user">isloera at usedformyjunk dot com</strong>
   <a href="#115812" class="date">27-Sep-2014 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I changed my domain so the code for spanish_methaphone&nbsp; is here<br />
<br />
<a href="http://www.ojocaliente.net/spanish_metaphone.php" rel="nofollow" target="_blank">http://www.ojocaliente.net/spanish_metaphone.php</a><br />
<br />
Please update the link ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115811""></a>
  <div class="note">
   <strong class="user">isloera at usedformyjunk dot com</strong>
   <a href="#115811" class="date">27-Sep-2014 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I changed my domain so the code for spanish_methaphone&nbsp; is here<br />
<br />
<a href="http://www.ojocaliente.net/spanish_metaphone.php" rel="nofollow" target="_blank">http://www.ojocaliente.net/spanish_metaphone.php</a><br />
<br />
Please update the link ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112417""></a>
  <div class="note">
   <strong class="user">Ray.Paseur often uses Gmail</strong>
   <a href="#112417" class="date">14-Jun-2013 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Metaphone() apparently ignores non-English characters.&nbsp; Comparing Pla?e TO Place yields "PL" and "PLS."&nbsp; A similar result comes from soundex().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83095""></a>
  <div class="note">
   <strong class="user">Vipindas K.S</strong>
   <a href="#83095" class="date">09-May-2008 09:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
metaphone<br />
=======================<br />
The metaphone() function can be used for spelling applications.This function returns the metaphone key of the string on success, or FALSE on failure.Its main use is when you are searching a genealogy database. check to see if a metaphone search is offered. It is also useful in making/searching family tree.<br />
Given below is a simple code that calculates and compares two strings to find whether its metaphone codes are equivalent.<br />
<br />
html code<br />
==========<br />
&lt;html&gt;<br />
&lt;body&gt;<br />
&lt;form action="test.php" name="test" method="get"&gt;<br />
Name1:&lt;input type="text" name="name1" /&gt;&lt;br /&gt;<br />
Name2:&lt;input type="text" name="name2" /&gt;&lt;br /&gt;<br />
&lt;input type="submit" name="submit" value="compare" /&gt;<br />
&lt;/form&gt;<br />
<br />
&lt;!--php code begins here --&gt;<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'submit'</span><span class="keyword">]))<br />
{<br />
</span><span class="default">$str1 </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'name1'</span><span class="keyword">];<br />
</span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'name2'</span><span class="keyword">];<br />
</span><span class="default">$meta_one</span><span class="keyword">=</span><span class="default">metaphone</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">);<br />
</span><span class="default">$meta_two</span><span class="keyword">=</span><span class="default">metaphone</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">);<br />
echo </span><span class="string">"metaphone code for "</span><span class="keyword">.</span><span class="default">$str1</span><span class="keyword">.</span><span class="string">" is "</span><span class="keyword">. </span><span class="default">$meta_one</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"metaphone code for "</span><span class="keyword">.</span><span class="default">$str2</span><span class="keyword">.</span><span class="string">" is "</span><span class="keyword">. </span><span class="default">$meta_two</span><span class="keyword">.</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
if(</span><span class="default">$meta_one</span><span class="keyword">==</span><span class="default">$meta_two</span><span class="keyword">)<br />
{<br />
echo </span><span class="string">"metaphone codes are matching"</span><span class="keyword">;<br />
}<br />
else<br />
{<br />
echo </span><span class="string">"metaphone codes are not matching"</span><span class="keyword">;<br />
}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;/body&gt;<br />
&lt;/html&gt;<br />
<br />
Metaphone&nbsp; algorithm was developed by Lawrence Philips.<br />
<br />
Lawrence Philips' RULES follow:<br />
<br />
&nbsp;The 16 consonant sounds:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |--- ZERO represents "th"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
&nbsp;&nbsp; &nbsp;&nbsp; B&nbsp; X&nbsp; S&nbsp; K&nbsp; J&nbsp; T&nbsp; F&nbsp; H&nbsp; L&nbsp; M&nbsp; N&nbsp; P&nbsp; R&nbsp; 0&nbsp; W&nbsp; Y<br />
<br />
&nbsp;Exceptions:<br />
<br />
&nbsp;&nbsp; Beginning of word: "ae-", "gn", "kn-", "pn-", "wr-"&nbsp; ----&gt; drop first letter<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "Aebersold", "Gnagy", "Knuth", "Pniewski", "Wright"<br />
<br />
&nbsp;&nbsp; Beginning of word: "x"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ----&gt; change to "s"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; as in "Deng Xiaopeng"<br />
<br />
&nbsp;&nbsp; Beginning of word: "wh-"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ----&gt; change to "w"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; as in "Whalen"<br />
<br />
&nbsp;Transformations:<br />
<br />
&nbsp;&nbsp; B ----&gt; B&nbsp; &nbsp; &nbsp; unless at the end of word after "m", as in "dumb", "McComb"<br />
<br />
&nbsp;&nbsp; C ----&gt; X&nbsp; &nbsp; &nbsp; (sh) if "-cia-" or "-ch-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S&nbsp; &nbsp; &nbsp; if "-ci-", "-ce-", or "-cy-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; SILENT if "-sci-", "-sce-", or "-scy-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; &nbsp; otherwise, including in "-sch-"<br />
<br />
&nbsp;&nbsp; D ----&gt; J&nbsp; &nbsp; &nbsp; if in "-dge-", "-dgy-", or "-dgi-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; F ----&gt; F<br />
<br />
&nbsp;&nbsp; G ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if in "-gh-" and not at end or before a vowel<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in "-gn" or "-gned"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in "-dge-" etc., as in above rule<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; J&nbsp; &nbsp; &nbsp; if before "i", or "e", or "y" if not double "gg"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; H ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if after vowel and no vowel follows<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or after "-ch-", "-sh-", "-ph-", "-th-", "-gh-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; H&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; J ----&gt; J<br />
<br />
&nbsp;&nbsp; K ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if after "c"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; K&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; L ----&gt; L<br />
<br />
&nbsp;&nbsp; M ----&gt; M<br />
<br />
&nbsp;&nbsp; N ----&gt; N<br />
<br />
&nbsp;&nbsp; P ----&gt; F&nbsp; &nbsp; &nbsp; if before "h"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; P&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; Q ----&gt; K<br />
<br />
&nbsp;&nbsp; R ----&gt; R<br />
<br />
&nbsp;&nbsp; S ----&gt; X&nbsp; &nbsp; &nbsp; (sh) if before "h" or in "-sio-" or "-sia-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; T ----&gt; X&nbsp; &nbsp; &nbsp; (sh) if "-tia-" or "-tio-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; (th) if before "h"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; silent if in "-tch-"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; T&nbsp; &nbsp; &nbsp; otherwise<br />
<br />
&nbsp;&nbsp; V ----&gt; F<br />
<br />
&nbsp;&nbsp; W ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if not followed by a vowel<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; W&nbsp; &nbsp; &nbsp; if followed by a vowel<br />
<br />
&nbsp;&nbsp; X ----&gt; KS<br />
<br />
&nbsp;&nbsp; Y ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; SILENT if not followed by a vowel<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Y&nbsp; &nbsp; &nbsp; if followed by a vowel<br />
<br />
&nbsp;&nbsp; Z ----&gt; S</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82103""></a>
  <div class="note">
   <strong class="user">php at casadebender dot com</strong>
   <a href="#82103" class="date">27-Mar-2008 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A double metaphone pecl module is available: <a href="http://pecl.php.net/package/doublemetaphone" rel="nofollow" target="_blank">http://pecl.php.net/package/doublemetaphone</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39076""></a>
  <div class="note">
   <strong class="user">mail at spam-off dot iaindooley dot com</strong>
   <a href="#39076" class="date">16-Jan-2004 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can use the metaphone function quite effectively with phrases by taking the levenshtein distances between two metaphone codes, and then taking this as a percentage of the length of the original metaphone code. thus you can define a percentage error, (say 20%) and accept only matches that are closer than that. i've found this works quite effectively in a function i am using on my website where an album name that the user entered is verified against existing album names that may be similar. this is also an excellent way of people being able to vaguely remember a phrase and get several suggestions out of the database. so you could type "i stiched nine times" with an error percentage of, say, 50 and still get 'a stitch in time saves nine' back as a match.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
