<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>设置 SNMP 对象的值</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.snmprealwalk.html">? snmprealwalk</a></li>
      <li style="float: right;"><a href="function.snmpwalk.html">snmpwalk ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.snmp.html">SNMP 函数</a></li>
    <li>设置 SNMP 对象的值</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.snmpset" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">snmpset</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">snmpset</span> &mdash; <span class="dc-title">设置 <abbr title="Simple Network Management Protocol">SNMP</abbr> 对象的值</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.snmpset-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>snmpset</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$hostname</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$community</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span></span> <code class="parameter">$object_id</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span></span> <code class="parameter">$type</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span></span> <code class="parameter">$value</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$timeout</code><span class="initializer"> = -1</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$retries</code><span class="initializer"> = -1</span></span><br>): <span class="type">bool</span></div>


  <p class="para rdfs-comment">
   <span class="function"><strong>snmpset()</strong></span> 用于通过 <code class="parameter">object_id</code> 设置 <abbr title="Simple Network Management Protocol">SNMP</abbr>
   对象的值。 
  </p>

 </div>


 <div class="refsect1 parameters" id="refsect1-function.snmpset-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">hostname</code></dt>

     <dd>

      <p class="para">
       <abbr title="Simple Network Management Protocol">SNMP</abbr> 代理（服务器）的主机名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">community</code></dt>

     <dd>

      <p class="para">
       The write community.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">object_id</code></dt>

     <dd>

      <p class="para">
       <abbr title="Simple Network Management Protocol">SNMP</abbr> 对象 ID。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">type</code></dt>

     <dd>

      <p class="para">
<abbr>MIB</abbr> 定义了各个对象 id 的类型。必须是下面列出的单个字符之一。
</p>
<table class="doctable table">
 <caption><strong>类型</strong></caption>
 
  <tbody class="tbody">
   <tr><td>=</td><td>MIB类型</td></tr>

   <tr><td>i</td><td>INTEGER</td> </tr>

   <tr><td>u</td><td>INTEGER</td></tr>

   <tr><td>s</td><td>STRING</td></tr>

   <tr><td>x</td><td>HEX STRING</td></tr>

   <tr><td>d</td><td>DECIMAL STRING</td></tr>

   <tr><td>n</td><td>NULLOBJ</td></tr>

   <tr><td>o</td><td>OBJID</td></tr>

   <tr><td>t</td><td>TIMETICKS</td></tr>

   <tr><td>a</td><td>IPADDRESS</td></tr>

   <tr><td>b</td><td>BITS</td></tr>

  </tbody>
 
</table>

<p class="para">
 如果在编译 <abbr title="Simple Network Management Protocol">SNMP</abbr> 库时定义了 <strong><code>OPAQUE_SPECIAL_TYPES</code></strong>，那么下列值是合法的：
</p>
<table class="doctable table">
 <caption><strong>types</strong></caption>
 
  <tbody class="tbody">
   <tr><td>U</td><td>unsigned int64</td></tr>

   <tr><td>I</td><td>signed int64</td></tr>

   <tr><td>F</td><td>float</td></tr>

   <tr><td>D</td><td>double</td></tr>

  </tbody>
 
</table>


      <p class="para">
这些值大都会使用与 ASN.1 相符的类型。&#039;s&#039;，&#039;x&#039;，&#039;d&#039;
以及 &#039;b&#039; 都是指定一个八字节字符串值的方式。并且 &#039;u&#039; 无符号类型也可用于处理 Gauge32 值。
</p>

      <p class="para">
如果 MIB 文件是用 &quot;snmp_read_mib&quot; 或者通过在 libsnmp config 中指定而加载入 MIB 树时，
&#039;=&#039; 可以被用作为所有对象的 <code class="parameter">type</code> 参数，因为 type 可以被自动从 MIB 中读取。
</p>

      <p class="para">
注意有两种方式可以设定 BITS 类型的变量，例如
&quot;SYNTAX    BITS {telnet(0), ftp(1), http(2), icmp(3), snmp(4), ssh(5), https(6)}&quot;:
</p>
<ul class="itemizedlist">
 <li class="listitem">
  <span class="simpara">
   使用 &quot;b&quot; 类型以及一个位数的列表。不推荐使用此方法，因为 GET 查询对同一个 OID 将会返回例如 0xF8。
  </span>
 </li>
 <li class="listitem">
  <span class="simpara">
   使用 &quot;x&quot; 类型以及一个十六进制数但是不需要通常的 &quot;0x&quot; 前缀。
  </span>
 </li>
</ul>
<p class="para">
 更多细节见示例部分。
</p>

     </dd>

    
    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       新值。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeout</code></dt>

     <dd>

      <p class="para">
       第一次超时前的微秒数。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">retries</code></dt>

     <dd>

      <p class="para">
       发生超时时重试的次数。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.snmpset-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>true</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
  <p class="para">
   如果 SNMP 主机拒绝该数据类型，则会出现一条 E_WARNING 消息，例如显示"Warning: Error in packet. Reason:(badValue)The value
   given has the wrong type or length."。如果指定了未知或无效的 OID，警告可能会显示为"Could not add variable"。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.snmpset-examples">
  <h3 class="title">示例</h3>
   <div class="example" id="">
    <p><strong>Example #1 使用 <span class="function"><strong>snmpset()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />  snmpset</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"public"</span><span style="color: #007700">, </span><span style="color: #DD0000">"IF-MIB::ifAlias.3"</span><span style="color: #007700">, </span><span style="color: #DD0000">"s"</span><span style="color: #007700">, </span><span style="color: #DD0000">"foo"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="">
    <p><strong>Example #2 使用 <span class="function"><strong>snmpset()</strong></span> 设置 BITS <abbr title="Simple Network Management Protocol">SNMP</abbr> 对象 ID</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />  snmpset</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"public"</span><span style="color: #007700">, </span><span style="color: #DD0000">'FOO-MIB::bar.42'</span><span style="color: #007700">, </span><span style="color: #DD0000">'b'</span><span style="color: #007700">, </span><span style="color: #DD0000">'0 1 2 3 4'</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// or<br />  </span><span style="color: #0000BB">snmpset</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"public"</span><span style="color: #007700">, </span><span style="color: #DD0000">'FOO-MIB::bar.42'</span><span style="color: #007700">, </span><span style="color: #DD0000">'x'</span><span style="color: #007700">, </span><span style="color: #DD0000">'F0'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.snmpset-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.snmpget.html" class="function" rel="rdfs-seeAlso">snmpget()</a> - 获取 SNMP 对象</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="95634""></a>
  <div class="note">
   <strong class="user">ch at lathspell dot de</strong>
   <a href="#95634" class="date">13-Jan-2010 06:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that there are two ways to set a variable of the type BITS like e.g.: <br />
&nbsp; SYNTAX&nbsp; &nbsp; &nbsp; &nbsp; BITS {telnet(0), ftp(1), http(2), icmp(3), snmp(4), ssh(5), https(6)}<br />
<br />
1. Using type "b" and a list of bit numbers like:<br />
&nbsp; snmpset('FOO-MIB::bar.42', 'b', '0 1 2 3 4');<br />
with the disadvantage that the success is not easily verifyable as an snmpget() for the same OID would return e.g. 0xF8.<br />
<br />
2. Using type "x" and a hex number but without(!) the usual "0x" prefix:<br />
&nbsp; snmpset('FOO-MIB::bar.42', 'x', 'F0');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74600""></a>
  <div class="note">
   <strong class="user">tridman</strong>
   <a href="#74600" class="date">19-Apr-2007 07:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have importet the MIB-Files into the MIB Tree with "snmp_read_mib" you may use '=' as the "type" parameter.<br />
In this case the type will also be taken from the loaded mib file. (Octest strings will be interpreted like strings though)<br />
Comes in handy for a more dynamic use of snmpset.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72000""></a>
  <div class="note">
   <strong class="user">deivis dot jakstas at gmail dot com</strong>
   <a href="#72000" class="date">28-Dec-2006 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you setting hex values correct format is:<br />
snmpset($source_ip,$community,"$oid","x","10 10 10 10");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="1192""></a>
  <div class="note">
   <strong class="user">slawrance at technologist dot com</strong>
   <a href="#1192" class="date">21-Jul-1999 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The "type" parameter must be one of the following, depending on the type of variable to set on the SNMP host:
<br />

<br />
i&nbsp; &nbsp; INTEGER
<br />
u&nbsp; &nbsp; unsigned INTEGER
<br />
t&nbsp; &nbsp; TIMETICKS
<br />
a&nbsp; &nbsp; IPADDRESS
<br />
o&nbsp; &nbsp; OBJID
<br />
s&nbsp; &nbsp; STRING
<br />
x&nbsp; &nbsp; HEX STRING
<br />
d&nbsp; &nbsp; DECIMAL STRING
<br />
n&nbsp; &nbsp; NULLOBJ
<br />
b&nbsp; &nbsp; BITS
<br />

<br />
If OPAQUE_SPECIAL_TYPES was defined while compiling the SNMP library, the
<br />
following are also valid:
<br />

<br />
U&nbsp; &nbsp; unsigned int64
<br />
I&nbsp; &nbsp; signed int64
<br />
F&nbsp; &nbsp; float
<br />
D&nbsp; &nbsp; double
<br />

<br />
As an example, using "i" would set an integer, and "s" would set a string.&nbsp; If the SNMP host rejects the data type, you might get the following message: "Warning: Error in packet. Reason: (badValue) The value given has the wrong type or length."
<br />

<br />
If you specify an unknown or invalid OID, you might get a "Could not add variable" message.&nbsp; When specifying an absolute OID (one that is already resolved) that is completely numeric, prepend it with a period.&nbsp; For example, an OID that could enable/disable Ethernet ports on an Asante hub might be "1.3.6.1.2.1.22.1.3.1.1.3.6.4.0", but you would need to use ".1.3.6.1.2.1.22.1.3.1.1.3.6.4.0" in the OID parameter so that the SNMP library won't try to resolve an already resolved OID.&nbsp; Friendly, unresolved OIDs do not need the period prepended, such as "system.SysContact.0"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
