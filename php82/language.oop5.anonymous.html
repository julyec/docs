<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>匿名类</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.oop5.traits.html">? Trait</a></li>
      <li style="float: right;"><a href="language.oop5.overloading.html">重载 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.oop5.html">类与对象</a></li>
    <li>匿名类</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.oop5.anonymous" class="sect1">
 <h2 class="title">匿名类</h2>

 <p class="para">
  匿名类很有用，可以创建一次性的简单对象。
 </p>

 <div class="informalexample">
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// 使用显性类<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">Logger<br /></span><span style="color: #007700">{<br />    public function </span><span style="color: #0000BB">log</span><span style="color: #007700">(</span><span style="color: #0000BB">$msg</span><span style="color: #007700">)<br />    {<br />        echo </span><span style="color: #0000BB">$msg</span><span style="color: #007700">;<br />    }<br />}<br /><br /></span><span style="color: #0000BB">$util</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLogger</span><span style="color: #007700">(new </span><span style="color: #0000BB">Logger</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">// 使用匿名类<br /></span><span style="color: #0000BB">$util</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setLogger</span><span style="color: #007700">(new class {<br />    public function </span><span style="color: #0000BB">log</span><span style="color: #007700">(</span><span style="color: #0000BB">$msg</span><span style="color: #007700">)<br />    {<br />        echo </span><span style="color: #0000BB">$msg</span><span style="color: #007700">;<br />    }<br />});</span>
</span>
</code></div>
  </div>

 </div>

 <p class="para">
  可以传递参数到匿名类的构造器，也可以扩展（extend）其他类、实现接口（implement interface），以及像其他普通的类一样使用 trait：
 </p>

 <div class="informalexample">
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class </span><span style="color: #0000BB">SomeClass </span><span style="color: #007700">{}<br />interface </span><span style="color: #0000BB">SomeInterface </span><span style="color: #007700">{}<br />trait </span><span style="color: #0000BB">SomeTrait </span><span style="color: #007700">{}<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(new class(</span><span style="color: #0000BB">10</span><span style="color: #007700">) extends </span><span style="color: #0000BB">SomeClass </span><span style="color: #007700">implements </span><span style="color: #0000BB">SomeInterface </span><span style="color: #007700">{<br />    private </span><span style="color: #0000BB">$num</span><span style="color: #007700">;<br /><br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$num</span><span style="color: #007700">)<br />    {<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num </span><span style="color: #007700">= </span><span style="color: #0000BB">$num</span><span style="color: #007700">;<br />    }<br /><br />    use </span><span style="color: #0000BB">SomeTrait</span><span style="color: #007700">;<br />});</span>
</span>
</code></div>
  </div>

  <p class="para">以上示例会输出：</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
object(class@anonymous)#1 (1) {
  [&quot;Command line code0x104c5b612&quot;:&quot;class@anonymous&quot;:private]=&gt;
  int(10)
}
</pre></div>
  </div>
 </div>

 <p class="para">
 匿名类被嵌套进普通 Class 后，不能访问这个外部类（Outer class）的 private（私有）、protected（受保护）方法或者属性。
  为了访问外部类（Outer class）protected 属性或方法，匿名类可以 extend（扩展）此外部类。
  为了使用外部类（Outer class）的 private 属性，必须通过构造器传进来：
 </p>

 <div class="informalexample">
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class </span><span style="color: #0000BB">Outer<br /></span><span style="color: #007700">{<br />    private </span><span style="color: #0000BB">$prop </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />    protected </span><span style="color: #0000BB">$prop2 </span><span style="color: #007700">= </span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /><br />    protected function </span><span style="color: #0000BB">func1</span><span style="color: #007700">()<br />    {<br />        return </span><span style="color: #0000BB">3</span><span style="color: #007700">;<br />    }<br /><br />    public function </span><span style="color: #0000BB">func2</span><span style="color: #007700">()<br />    {<br />        return new class(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prop</span><span style="color: #007700">) extends </span><span style="color: #0000BB">Outer </span><span style="color: #007700">{<br />            private </span><span style="color: #0000BB">$prop3</span><span style="color: #007700">;<br /><br />            public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$prop</span><span style="color: #007700">)<br />            {<br />                </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prop3 </span><span style="color: #007700">= </span><span style="color: #0000BB">$prop</span><span style="color: #007700">;<br />            }<br /><br />            public function </span><span style="color: #0000BB">func3</span><span style="color: #007700">()<br />            {<br />                return </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prop2 </span><span style="color: #007700">+ </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prop3 </span><span style="color: #007700">+ </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">func1</span><span style="color: #007700">();<br />            }<br />        };<br />    }<br />}<br /><br />echo (new </span><span style="color: #0000BB">Outer</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">func2</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">func3</span><span style="color: #007700">();</span>
</span>
</code></div>
  </div>

  <p class="para">以上示例会输出：</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
6
</pre></div>
  </div>
 </div>
 <p class="para">
  声明的同一个匿名类，所创建的对象都是这个类的实例。
 </p>

 <div class="informalexample">
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function </span><span style="color: #0000BB">anonymous_class</span><span style="color: #007700">()<br />{<br />    return new class {};<br />}<br /><br />if (</span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">anonymous_class</span><span style="color: #007700">()) === </span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">anonymous_class</span><span style="color: #007700">())) {<br />    echo </span><span style="color: #DD0000">'same class'</span><span style="color: #007700">;<br />} else {<br />    echo </span><span style="color: #DD0000">'different class'</span><span style="color: #007700">;<br />}</span>
</span>
</code></div>
 </div>

 <p class="para">以上示例会输出：</p>
 <div class="example-contents screen">
<div class="cdata"><pre>
same class
</pre></div>
  </div>
 </div>

 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   注意，匿名类的名称是通过引擎赋予的，如下例所示。
   由于实现的细节，不应该去依赖这个类名。
  </p>
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">get_class</span><span style="color: #007700">(new class {});</span>
</span>
</code></div>
  </div>

  <p class="para">以上示例的输出类似于：</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
class@anonymous/in/oNi1A0x7f8636ad2021
</pre></div>
   </div>
  </div>
 </p></blockquote>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="124809""></a>
  <div class="note">
   <strong class="user">razvan_bc at yahoo dot com</strong>
   <a href="#124809" class="date">09-Mar-2020 05:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can try these<br />
<br />
<span class="default">&lt;?php <br />
<br />
$oracle</span><span class="keyword">=&amp;</span><span class="default">$_</span><span class="keyword">[</span><span class="string">'nice_php'</span><span class="keyword">];<br />
</span><span class="default">$_</span><span class="keyword">[</span><span class="string">'nice_php'</span><span class="keyword">]=(function(){<br />
&nbsp;&nbsp;&nbsp; return new class{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">say</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$msg</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">sp</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">self</span><span class="keyword">::</span><span class="default">say</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; };<br />
});<br />
<br />
</span><span class="comment">/*<br />
$_['nice_php']()::say('Hello');<br />
$_['nice_php']()::sp();<br />
$_['nice_php']()::say('World');<br />
$_['nice_php']()::sp();<br />
$_['nice_php']()::say('!');<br />
//almost the same code bottom<br />
*/<br />
<br />
</span><span class="default">$oracle</span><span class="keyword">()::</span><span class="default">say</span><span class="keyword">(</span><span class="string">'Hello'</span><span class="keyword">);<br />
</span><span class="default">$oracle</span><span class="keyword">()::</span><span class="default">sp</span><span class="keyword">();<br />
</span><span class="default">$oracle</span><span class="keyword">()::</span><span class="default">say</span><span class="keyword">(</span><span class="string">'World'</span><span class="keyword">);<br />
</span><span class="default">$oracle</span><span class="keyword">()::</span><span class="default">sp</span><span class="keyword">();<br />
</span><span class="default">$oracle</span><span class="keyword">()::</span><span class="default">say</span><span class="keyword">(</span><span class="string">'!'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124026""></a>
  <div class="note">
   <strong class="user">joey</strong>
   <a href="#124026" class="date">09-Jul-2019 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The only way to type hint this would appear to be as object.<br />
<br />
If you need multiple instances of an anonymous class in a function you can use:<br />
<br />
$class = function(string $arg):object {<br />
&nbsp;&nbsp;&nbsp; return new class($arg) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function __construct(string $arg) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;ow = $arg;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; };<br />
};<br />
<br />
Though for the sake of structure it's ill advised to do something like this outside of a single scope or that's used across multiple files. If you class is only used in one scope however then it's probably not a code mess problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123605""></a>
  <div class="note">
   <strong class="user">sebastian.wasser at gmail</strong>
   <a href="#123605" class="date">12-Feb-2019 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wanted to share my findings on static properties of anonymous classes.<br />
<br />
So, given an anonymous class' object generating function like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">nc </span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return new class {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static </span><span class="default">$prop </span><span class="keyword">= [];<br />
&nbsp;&nbsp;&nbsp; };<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Getting a new object and changing the static property:<br />
<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">= </span><span class="default">nc</span><span class="keyword">();<br />
</span><span class="default">$a</span><span class="keyword">::</span><span class="default">$prop</span><span class="keyword">[] = </span><span class="string">'a'</span><span class="keyword">;<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">::</span><span class="default">$prop</span><span class="keyword">);<br />
</span><span class="comment">// array(1) {<br />
//&nbsp;&nbsp; [0] =&gt;<br />
//&nbsp;&nbsp; string(1) "a"<br />
// }<br />
</span><span class="default">?&gt;<br />
</span><br />
Now getting another object and changing the static property will change the original one, meaning that the static property is truly static:<br />
<br />
<span class="default">&lt;?php<br />
$b </span><span class="keyword">= </span><span class="default">nc</span><span class="keyword">();<br />
</span><span class="default">$b</span><span class="keyword">::</span><span class="default">$prop</span><span class="keyword">[] = </span><span class="string">'b'</span><span class="keyword">;<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">::</span><span class="default">$prop</span><span class="keyword">); </span><span class="comment">// Same as var_dump($a::$prop);<br />
// array(2) {<br />
//&nbsp;&nbsp; [0] =&gt;<br />
//&nbsp;&nbsp; string(1) "a"<br />
//&nbsp;&nbsp; [1] =&gt;<br />
//&nbsp;&nbsp; string(1) "b"<br />
// }<br />
<br />
</span><span class="default">assert</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">::</span><span class="default">$prop </span><span class="keyword">=== </span><span class="default">$b</span><span class="keyword">::</span><span class="default">$prop</span><span class="keyword">); </span><span class="comment">// true<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121839""></a>
  <div class="note">
   <strong class="user">solobot</strong>
   <a href="#121839" class="date">07-Nov-2017 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
eval() is workaround for generating multiple anonymous classes with static properties in loop<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">public function </span><span class="default">generateClassMap</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">classMap </span><span class="keyword">as </span><span class="default">$tableName </span><span class="keyword">=&gt; </span><span class="default">$class</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval(</span><span class="string">'$c = new class extends \common\MyStaticClass {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; public static $tableName;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; public static function tableName()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return static::$tableName;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">::</span><span class="default">$tableName </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">replicationPrefix</span><span class="keyword">.</span><span class="default">$tableName</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">classMap</span><span class="keyword">[</span><span class="default">$tableName</span><span class="keyword">] = </span><span class="default">$c</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>thus every class will have its own $tableName instead of common ancestor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121724""></a>
  <div class="note">
   <strong class="user">j.m \ jamesweb \ ca</strong>
   <a href="#121724" class="date">04-Oct-2017 12:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
/* I like the idea of OneShot classes.<br />
Thanks to that Anonymous bro\sist for precising&nbsp;&nbsp; <br />
new class( $a, $b )<br />
ˉˉˉˉˉˉˉˉˉ<br />
<br />
If you are looking for "Delayed OneShot Anonymous Classes" for any reason (like the reason: loading files in a readable manner while not using autoload), it would probably look something like this; */<br />
<br />
$u = function()use(&amp;$u){<br />
&nbsp;&nbsp;&nbsp; $u = new class{private $name = 'Utils';};<br />
};<br />
<br />
$w = function(&amp;$rewrite)use(&amp;$w){<br />
&nbsp;&nbsp;&nbsp; $w = null;<br />
&nbsp;&nbsp;&nbsp; $rewrite = new class{private $name = 'DataUtils';};<br />
};<br />
<br />
// Usage;<br />
var_dump(<br />
&nbsp;&nbsp;&nbsp; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'Delayed',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; '( Self Destructive )',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'Anonymous Class Creation',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'Before ( $u )' =&gt; $u,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'Running ( $u() )' =&gt; $u(),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'After ( $u )' =&gt; $u,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0,0,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0,0,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0,0,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'Delayed',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; '( Overwriting &amp;&amp; Self Destructive )',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'Anonymous Class Creation',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'Before ( $w )' =&gt; $w,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'Running ( $w($u) )' =&gt; $w($u),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'After ( $w )' =&gt; $w,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'After ( $u )' =&gt; $u<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; )<br />
);<br />
<br />
// btw : oh shoot I failed a spam challenge</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121055""></a>
  <div class="note">
   <strong class="user">ytubeshareit at gmail dot com</strong>
   <a href="#121055" class="date">06-May-2017 01:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Anonymous classes are syntax sugar that may appear deceiving to some.<br />
The 'anonymous' class is still parsed into the global scope, where it is auto assigned a name, and every time the class is needed, that global class definition is used.&nbsp; Example to illustrate....<br />
<br />
The anonymous class version...<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">return_anon</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return new class{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; public static </span><span class="default">$str</span><span class="keyword">=</span><span class="string">"foo"</span><span class="keyword">;&nbsp; <br />
&nbsp;&nbsp;&nbsp; };<br />
}<br />
</span><span class="default">$test</span><span class="keyword">=</span><span class="default">return_anon</span><span class="keyword">();<br />
echo </span><span class="default">$test</span><span class="keyword">::</span><span class="default">$str</span><span class="keyword">; </span><span class="comment">//ouputs foo<br />
<br />
//we can still access the 'anon' class directly in the global scope! <br />
</span><span class="default">$another</span><span class="keyword">=</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">); </span><span class="comment">//get the auto assigned name<br />
</span><span class="keyword">echo </span><span class="default">$another</span><span class="keyword">::</span><span class="default">$str</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">//outputs foo<br />
</span><span class="default">?&gt;<br />
</span><br />
The above is functionally the same as doing this....<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">I_named_this_one</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static </span><span class="default">$str</span><span class="keyword">=</span><span class="string">"foo"</span><span class="keyword">;<br />
}<br />
function </span><span class="default">return_not_anon</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">'I_named_this_one'</span><span class="keyword">;<br />
}<br />
</span><span class="default">$clzz</span><span class="keyword">=</span><span class="default">return_not_anon</span><span class="keyword">();</span><span class="comment">//get class name<br />
</span><span class="keyword">echo </span><span class="default">$clzz</span><span class="keyword">::</span><span class="default">$str</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121021""></a>
  <div class="note">
   <strong class="user">piotr at maslosoft dot com</strong>
   <a href="#121021" class="date">26-Apr-2017 05:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that class name returned by `get_class` might contain null bytes, as is the case in my version of PHP (7.1.4). <br />
<br />
Name will change when class starting line or it's body is changed.<br />
<br />
Yes, name is implementation detail that should not be relied upon, but in some rare use cases it is required (annotating anonymous class).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119953""></a>
  <div class="note">
   <strong class="user">primipilus13 at gmail dot com</strong>
   <a href="#119953" class="date">26-Sep-2016 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// using constructor and extends in anonymous class&nbsp; <br />
<br />
</span><span class="keyword">class </span><span class="default">A<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$name</span><span class="keyword">;&nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$b </span><span class="keyword">= new class(</span><span class="string">'anonymous'</span><span class="keyword">) extends </span><span class="default">A<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">getName</span><span class="keyword">() . </span><span class="string">' class'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
};<br />
<br />
echo </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(), </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="comment">// result: anonimous class</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119055""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#119055" class="date">25-Mar-2016 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Below three examples describe anonymous class with very simple and basic but quite understandable example<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// First way - anonymous class assigned directly to variable<br />
</span><span class="default">$ano_class_obj </span><span class="keyword">= new class{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$prop1 </span><span class="keyword">= </span><span class="string">'hello'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$prop2 </span><span class="keyword">= </span><span class="default">754</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">SETT </span><span class="keyword">= </span><span class="string">'some config'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getValue</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do some operation<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'some returned value'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getValueWithArgu</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do some operation<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'returned value is '</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
};<br />
<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$ano_class_obj</span><span class="keyword">);<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj</span><span class="keyword">-&gt;</span><span class="default">prop1</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj</span><span class="keyword">-&gt;</span><span class="default">prop2</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj</span><span class="keyword">::</span><span class="default">SETT</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj</span><span class="keyword">-&gt;</span><span class="default">getValue</span><span class="keyword">();<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj</span><span class="keyword">-&gt;</span><span class="default">getValueWithArgu</span><span class="keyword">(</span><span class="string">'OOP'</span><span class="keyword">);<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Second way - anonymous class assigned to variable via defined function<br />
</span><span class="default">$ano_class_obj_with_func </span><span class="keyword">= </span><span class="default">ano_func</span><span class="keyword">();<br />
<br />
function </span><span class="default">ano_func</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; return new class {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$prop1 </span><span class="keyword">= </span><span class="string">'hello'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$prop2 </span><span class="keyword">= </span><span class="default">754</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; const </span><span class="default">SETT </span><span class="keyword">= </span><span class="string">'some config'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">getValue</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do some operation<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'some returned value'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">getValueWithArgu</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do some operation<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'returned value is '</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; };<br />
}<br />
<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$ano_class_obj_with_func</span><span class="keyword">);<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_func</span><span class="keyword">-&gt;</span><span class="default">prop1</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_func</span><span class="keyword">-&gt;</span><span class="default">prop2</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_func</span><span class="keyword">::</span><span class="default">SETT</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_func</span><span class="keyword">-&gt;</span><span class="default">getValue</span><span class="keyword">();<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_func</span><span class="keyword">-&gt;</span><span class="default">getValueWithArgu</span><span class="keyword">(</span><span class="string">'OOP'</span><span class="keyword">);<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Third way - passing argument to anonymous class via constructors<br />
</span><span class="default">$arg </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="comment">// we got it by some operation<br />
</span><span class="default">$config </span><span class="keyword">= [</span><span class="default">2</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">]; </span><span class="comment">// we got it by some operation<br />
</span><span class="default">$ano_class_obj_with_arg </span><span class="keyword">= </span><span class="default">ano_func_with_arg</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">, </span><span class="default">$config</span><span class="keyword">);<br />
<br />
function </span><span class="default">ano_func_with_arg</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">, </span><span class="default">$config</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return new class(</span><span class="default">$arg</span><span class="keyword">, </span><span class="default">$config</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$prop1 </span><span class="keyword">= </span><span class="string">'hello'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$prop2 </span><span class="keyword">= </span><span class="default">754</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public </span><span class="default">$prop3</span><span class="keyword">, </span><span class="default">$config</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; const </span><span class="default">SETT </span><span class="keyword">= </span><span class="string">'some config'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">, </span><span class="default">$config</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">prop3 </span><span class="keyword">= </span><span class="default">$arg</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">config </span><span class="keyword">=</span><span class="default">$config</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">getValue</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do some operation<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'some returned value'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">getValueWithArgu</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do some operation<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'returned value is '</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; };<br />
}<br />
<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$ano_class_obj_with_arg</span><span class="keyword">);<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_arg</span><span class="keyword">-&gt;</span><span class="default">prop1</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_arg</span><span class="keyword">-&gt;</span><span class="default">prop2</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_arg</span><span class="keyword">::</span><span class="default">SETT</span><span class="keyword">;<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_arg</span><span class="keyword">-&gt;</span><span class="default">getValue</span><span class="keyword">();<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$ano_class_obj_with_arg</span><span class="keyword">-&gt;</span><span class="default">getValueWithArgu</span><span class="keyword">(</span><span class="string">'OOP'</span><span class="keyword">);<br />
echo </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"\n"</span><span class="keyword">;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
