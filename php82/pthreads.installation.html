<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>安装</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="pthreads.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="pthreads.configuration.html">运行时配置 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="pthreads.setup.html">安装/配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="pthreads.installation" class="section">
  <h2 class="title">安装</h2>
  <p class="para">
   pthreads 扩展由 PECL 主持，使用 <a href="https://github.com/krakjoe/pthreads" class="link external" title="Link : https://github.com/krakjoe/pthreads">&raquo;&nbsp;github</a> 管理源代码。
   使用标准的 PECL 包安装方式就可以完成安装：<a href="https://pecl.php.net/package/pthreads" class="link external" title="Link : https://pecl.php.net/package/pthreads">&raquo;&nbsp;https://pecl.php.net/package/pthreads</a>。
  </p>
  <p class="para">
   Windows 用户可以从 <a href="https://windows.php.net/downloads/pecl/releases/pthreads" class="link external" title="Link : https://windows.php.net/downloads/pecl/releases/pthreads">&raquo;&nbsp;PECL</a> 下载已经构建的二进制发行包。
  </p>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    Windows 用户需要将 pthreadVC2.dll （包含在 Windows 版二进制发行包中）所在路径加入到 <var class="envar">PATH</var> 环境变量中。
   </p>
  </div>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125359""></a>
  <div class="note">
   <strong class="user">bens at effortlessis dot com</strong>
   <a href="#125359" class="date">12-Sep-2020 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sadly, this extension seems to be in poor repair. After spending a few hours trying to get it to fly on Fedora 32 with PHP 7.4, I noticed that it's not really maintained since about 2016. <br />
<br />
Attempting to compile it with PHP 7.4 results in screens full of nasty compile errors.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123781""></a>
  <div class="note">
   <strong class="user">horica78 at yahoo dot com</strong>
   <a href="#123781" class="date">15-Apr-2019 08:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
They can still be used in web server if used with exec('php script.php') and php-cli.ini .</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123330""></a>
  <div class="note">
   <strong class="user">agnelvishal at gmail dot com</strong>
   <a href="#123330" class="date">11-Nov-2018 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To compile PHP 7.2 with pthreads on Ubuntu 16.04 or Ubuntu 18.04 or Debian 9 Stretch, use this bash file at https://gist.github.com/agnelvishal/24f42c65af2f6cace1e9387617a0182a</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120302""></a>
  <div class="note">
   <strong class="user">and dot webdev at gmail dot com</strong>
   <a href="#120302" class="date">08-Dec-2016 04:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Also, possible by phpbrew<br />
<br />
1. phpbrew install php-5.5.30 -- --enable-maintainer-zts<br />
2. phpbrew use php-5.5.30<br />
3. phpbrew ext install pthreads 2.0.10</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116368""></a>
  <div class="note">
   <strong class="user">Michel Phillipe Luca</strong>
   <a href="#116368" class="date">20-Dec-2014 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is how I got it working under Linux Ubuntu distro - WITHOUT USE PECL:<br />
<br />
We will download both, PHP and Pthread without PECL<br />
<br />
1 - Get PHP version<br />
For this example we will use version: 5.4.36<br />
<br />
# wget <a href="http://www.php.net/distributions/php-5.4.36.tar.gz" rel="nofollow" target="_blank">http://www.php.net/distributions/php-5.4.36.tar.gz</a><br />
<br />
2- Get Pthreads version:<br />
I'm using an old version but, you could take any one<br />
<br />
# wget <a href="http://pecl.php.net/get/pthreads-1.0.0.tgz" rel="nofollow" target="_blank">http://pecl.php.net/get/pthreads-1.0.0.tgz</a><br />
<br />
Extract both, php and pthreads versions<br />
<br />
#tar zxvf php-5.4.36.tar.gz<br />
#tar zxvf pthreads-1.0.0.tgz <br />
<br />
3- Move Pthreads to php/ext folder. Inside version of PHP downloaded at item 1.<br />
<br />
4- Reconfigure sources<br />
# ./buildconf --force<br />
# ./configure --help | grep pthreads<br />
<br />
You have to see --enable-pthreads listed. If do not, clear the buidls with this commands:<br />
<br />
# rm -rf aclocal.m4<br />
# rm -rf autom4te.cache/<br />
# ./buildconf --force<br />
<br />
5 - Inside php folder run configure command to set what we need:<br />
# ./configure --enable-debug --enable-maintainer-zts --enable-pthreads --prefix=/usr --with-config-file-path=/etc<br />
<br />
6 - Install PHP<br />
We will run make clear just to be sure that no other crashed build will mess our new one.<br />
<br />
# make clear <br />
# make<br />
# make install<br />
<br />
7 - Copy configuration file of PHP and add local lib to include path<br />
# cp php.ini-development /etc/php.ini<br />
<br />
Edit php.ini and set Include_path to be like this:<br />
<br />
Include_path = "/usr/local/lib/php"<br />
<br />
9 - Check Modules<br />
# php -m (check pthread loaded)<br />
<br />
You have to see pthreads listed<br />
<br />
10 - If pthread is not listed, update php.ini<br />
# echo "extension=pthreads.so" &gt;&gt; /etc/php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116341""></a>
  <div class="note">
   <strong class="user">sawyer dot lin at gmail dot com</strong>
   <a href="#116341" class="date">15-Dec-2014 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To execute pecl install pthreads<br />
The library autoconf shoud be installed at first<br />
<a href="http://stackoverflow.com/questions/9322742/php-autoconf-errors-on-mac-os-x-10-7-3-when-trying-to-install-pecl-extensions" rel="nofollow" target="_blank">http://stackoverflow.com/questions/9322742/php-autoconf-errors-on-mac-os-x-10-7-3-when-trying-to-install-pecl-extensions</a><br />
like <br />
apt-get install pthreads</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115004""></a>
  <div class="note">
   <strong class="user">zahid dot smz at gmail dot com</strong>
   <a href="#115004" class="date">11-May-2014 07:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Wampp (Windows)<br />
-----------------------------------------------------------------------------------<br />
1.&nbsp; Find out what is your 'PHP Extension Build' version by using phpinfo(). You can use this - <a href="http://localhost/?phpinfo=1" rel="nofollow" target="_blank">http://localhost/?phpinfo=1</a><br />
<br />
2.&nbsp; Download the pthreads that matches your php version (32 bit or 64 bit) and php extension build (currently used VC11). Use this link for download - <a href="http://windows.php.net/downloads/pecl/releases/pthreads/ " rel="nofollow" target="_blank">http://windows.php.net/downloads/pecl/releases/pthreads/ </a><br />
<br />
3.&nbsp; Extract the zip -<br />
&nbsp;&nbsp; &nbsp;&nbsp; Move php_pthreads.dll to the 'bin\php\ext\' directory.<br />
&nbsp;&nbsp; &nbsp;&nbsp; Move pthreadVC2.dll to the 'bin\php\' directory.<br />
&nbsp;&nbsp; &nbsp;&nbsp; Move pthreadVC2.dll to the 'bin\apache\bin' directory.<br />
&nbsp;&nbsp; &nbsp;&nbsp; Move pthreadVC2.dll to the 'C:\windows\system32' directory.<br />
<br />
4.&nbsp; Open php\php.ini and add<br />
&nbsp;&nbsp; &nbsp;&nbsp; extension=php_pthreads.dll<br />
<br />
Now restart server and you are done. Thanks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114837""></a>
  <div class="note">
   <strong class="user">Pedro Proenca</strong>
   <a href="#114837" class="date">12-Apr-2014 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I haven't found any proper instructions on how to install pthreads in linux, so I'll leave the steps I followed:<br />
<br />
# Required libraries<br />
sudo apt-get install gcc make libzzip-dev libreadline-dev libxml2-dev \<br />
libssl-dev libmcrypt-dev libcurl4-openssl-dev lib32bz2-dev <br />
<br />
# Download PHP<br />
cd /usr/local/src<br />
<br />
wget <a href="http://www.php.net/distributions/php-&lt;version&gt;.tar.gz" rel="nofollow" target="_blank">http://www.php.net/distributions/php-&lt;version&gt;.tar.gz</a><br />
( e.g. wget <a href="http://www.php.net/distributions/php-5.5.8.tar.gz " rel="nofollow" target="_blank">http://www.php.net/distributions/php-5.5.8.tar.gz </a>)<br />
<br />
# Extract<br />
tar zxvf php-&lt;version&gt;.tar.gz<br />
(e.g. tar zxvf php-5.5.8.tar.gz )<br />
<br />
# Configure<br />
cd /usr/local/src/php-&lt;version&gt;<br />
( e.g. cd /usr/local/src/php-5.5.8 )<br />
<br />
./configure --prefix=/usr --with-config-file-path=/etc --enable-maintainer-zts<br />
<br />
# Compile<br />
make &amp;&amp; make install<br />
( make -j3 &amp;&amp; make -j3 install) -&gt; Faster building<br />
<br />
# Copy configuration<br />
cp php.ini-development /etc/php.ini<br />
<br />
# Install pthreads<br />
pecl install pthreads<br />
echo "extension=pthreads.so" &gt;&gt; /etc/php.ini<br />
<br />
# Check installation<br />
php -m | grep pthreads</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114836""></a>
  <div class="note">
   <strong class="user">pedro dot proenca at shapedfor dot me</strong>
   <a href="#114836" class="date">12-Apr-2014 11:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I haven't found any proper instructions on how to install pthreads in linux, so I'll leave the steps I followed:<br />
<br />
# Required libraries<br />
sudo apt-get install gcc make libzzip-dev libreadline-dev libxml2-dev \<br />
libssl-dev libmcrypt-dev libcurl4-openssl-dev lib32bz2-dev <br />
<br />
# Download PHP<br />
cd /usr/local/src<br />
<br />
wget <a href="http://www.php.net/distributions/php-&lt;version&gt;.tar.gz" rel="nofollow" target="_blank">http://www.php.net/distributions/php-&lt;version&gt;.tar.gz</a><br />
( e.g. wget <a href="http://www.php.net/distributions/php-5.5.8.tar.gz " rel="nofollow" target="_blank">http://www.php.net/distributions/php-5.5.8.tar.gz </a>)<br />
<br />
# Extract<br />
tar zxvf php-&lt;version&gt;.tar.gz<br />
(e.g. tar zxvf php-5.5.8.tar.gz )<br />
<br />
# Configure<br />
cd /usr/local/src/php-&lt;version&gt;<br />
( e.g. cd /usr/local/src/php-5.5.8 )<br />
<br />
./configure --prefix=/usr --with-config-file-path=/etc --enable-maintainer-zts<br />
<br />
# Compile<br />
make &amp;&amp; make install<br />
( make -j3 &amp;&amp; make -j3 install) -&gt; Faster building<br />
<br />
# Copy configuration<br />
cp php.ini-development /etc/php.ini<br />
<br />
# Install pthreads<br />
pecl install pthreads<br />
echo "extension=pthreads.so" &gt;&gt; /etc/php.ini<br />
<br />
# Check installation<br />
php -m | grep pthreads</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113019""></a>
  <div class="note">
   <strong class="user">rbfowler9lfc at hotmail dot com</strong>
   <a href="#113019" class="date">19-Aug-2013 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those using XAMPP or other apache-php bundles, it's necessary to add LoadFile "C:/xampp/php/pthreadVC2.dll" to httpd-xampp.conf if you want to utilize pthreads in a browser window.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112868""></a>
  <div class="note">
   <strong class="user">matias dot zumbo at gmail dot com</strong>
   <a href="#112868" class="date">30-Jul-2013 11:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
HOW TO INSTALL IN LINUX SYSTEM'S:<br />
------------------------------------<br />
<br />
1) Download PHP sources and Unpack PHP<br />
<br />
2) Download PEAR<br />
&nbsp;&nbsp; &nbsp; wget <a href="http://pear.php.net/go-pear.phar" rel="nofollow" target="_blank">http://pear.php.net/go-pear.phar</a><br />
&nbsp;&nbsp; &nbsp; php go-pear.phar<br />
<br />
3) Download pthreads<br />
Get PECL extension (PECL is a repository for PHP Extensions)<br />
<br />
# pecl install pthread-0.4.4<br />
<br />
4) Unpack pthreads<br />
copy pthread-0.4.4&nbsp; to&nbsp; php/ext<br />
(for ./configure allow&nbsp; add option --enable-pthreads)<br />
<br />
# mv build/php-src-master/ext/pthreads-master&nbsp; &nbsp; build/php-src-master/ext/pthreads<br />
<br />
5)&nbsp; Reconfigure sources<br />
# ./buildconf --force<br />
# ./configure --help | grep pthreads<br />
<br />
You should see the appropriate --enable-pthreads option listed as a result, if you do not, then<br />
<br />
# rm -rf aclocal.m4<br />
# rm -rf autom4te.cache/<br />
# ./buildconf --force<br />
<br />
6) Build PHP<br />
Compile PHP source code<br />
Add:<br />
# ./configure --enable-debug --enable-maintainer-zts --enable-pthreads<br />
<br />
7) Installing PHP<br />
# make<br />
# sudo make install<br />
<br />
8) Update php.ini<br />
Add in php.ini<br />
extension=pthreads.so<br />
Include_path = "/usr/local/lib/php"<br />
<br />
9) Check Modules<br />
php -m (check pthread loaded)<br />
<br />
10) Test Thread Class<br />
# php SimpleTest.php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112545""></a>
  <div class="note">
   <strong class="user">jason at jason-rush dot com</strong>
   <a href="#112545" class="date">27-Jun-2013 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The files are in the format:<br />
php_pthreads-X.XX-Y.Y-ts-vcZZ-x86.zip<br />
<br />
where<br />
X.XX is the version of the phpthreads-win32<br />
Y.Y is the base version of PHP that you are running<br />
ZZ is ?? (version of compiler?)<br />
<br />
Currently, 0.44 is the latest release of phpthreads-win32, so X.XX = 0.44<br />
If you are running PHP 5.3.13, then Y.Y = 5.3<br />
If you are running PHP 5.5.0, then Y.Y=5.5<br />
etc<br />
<br />
php_pthreads-0.44-5.3-ts-vc9-x86.zip<br />
php_pthreads-0.44-5.4-ts-vc9-x86.zip<br />
php_pthreads-0.44-5.5-ts-vc11-x64.zip<br />
php_pthreads-0.44-5.5-ts-vc11-x86.zip</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112197""></a>
  <div class="note">
   <strong class="user">Jimmy Christensen</strong>
   <a href="#112197" class="date">16-May-2013 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Windows the installation is as follows:<br />
<br />
Download the pthreads that matches your php version.<br />
I found mine at: <a href="http://windows.php.net/downloads/pecl/releases/pthreads/" rel="nofollow" target="_blank">http://windows.php.net/downloads/pecl/releases/pthreads/</a><br />
(I used version 0.44 wich is the newest at the time of writing this, and then downloaded the one for php 5.3 which is the version I am using).<br />
<br />
Extract the zip.<br />
Move php_pthreads.dll to the php\ext\ directory.<br />
Move pthreadVC2.dll to the php\ directory.<br />
<br />
Open php\php.ini and add<br />
extension=php_pthreads.dll<br />
<br />
You are done.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
