<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>文件系统函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="filesystem.constants.html">? 预定义常量</a></li>
      <li style="float: right;"><a href="function.basename.html">basename ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.filesystem.html">文件系统</a></li>
    <li>文件系统函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.filesystem" class="reference">
 <h1 class="title">文件系统函数</h1>

 <div class="partintro">
  <h1 class="title">参见</h1>
  <p class="simpara">
   相关函数参见<a href="ref.dir.html" class="link">目录</a>和<a href="ref.exec.html" class="link">程序执行</a>章节。
  </p>
  <p class="simpara">
   远程文件能使用的 URL 包装器（ wrapper）列表和详细解释，可参见 <a href="wrappers.html" class="xref">支持的协议和封装协议</a>。
  </p>
 </div>

















































































































































































































































































































































































































































































































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.basename.html">basename</a> &mdash; 返回路径中的文件名部分</li><li><a href="function.chgrp.html">chgrp</a> &mdash; 改变文件所属的组</li><li><a href="function.chmod.html">chmod</a> &mdash; 改变文件模式</li><li><a href="function.chown.html">chown</a> &mdash; 改变文件的所有者</li><li><a href="function.clearstatcache.html">clearstatcache</a> &mdash; 清除文件状态缓存</li><li><a href="function.copy.html">copy</a> &mdash; 拷贝文件</li><li><a href="function.delete.html">delete</a> &mdash; 参见 unlink 或 unset</li><li><a href="function.dirname.html">dirname</a> &mdash; 返回路径中的目录部分</li><li><a href="function.disk-free-space.html">disk_free_space</a> &mdash; 返回目录中的可用空间</li><li><a href="function.disk-total-space.html">disk_total_space</a> &mdash; 返回一个目录的磁盘总大小</li><li><a href="function.diskfreespace.html">diskfreespace</a> &mdash; disk_free_space 的别名</li><li><a href="function.fclose.html">fclose</a> &mdash; 关闭一个已打开的文件指针</li><li><a href="function.fdatasync.html">fdatasync</a> &mdash; 同步文件数据（不包含元数据）</li><li><a href="function.feof.html">feof</a> &mdash; 测试文件指针是否到了文件结束的位置</li><li><a href="function.fflush.html">fflush</a> &mdash; 将缓冲内容输出到文件</li><li><a href="function.fgetc.html">fgetc</a> &mdash; 从文件指针中读取字符</li><li><a href="function.fgetcsv.html">fgetcsv</a> &mdash; 从文件指针中读入一行并解析 CSV 字段</li><li><a href="function.fgets.html">fgets</a> &mdash; 从文件指针中读取一行</li><li><a href="function.fgetss.html">fgetss</a> &mdash; 从文件指针中读取一行并过滤掉 HTML 标记</li><li><a href="function.file-exists.html">file_exists</a> &mdash; 检查文件或目录是否存在</li><li><a href="function.file-get-contents.html">file_get_contents</a> &mdash; 将整个文件读入一个字符串</li><li><a href="function.file-put-contents.html">file_put_contents</a> &mdash; 将数据写入文件</li><li><a href="function.file.html">file</a> &mdash; 把整个文件读入一个数组中</li><li><a href="function.fileatime.html">fileatime</a> &mdash; 取得文件的上次访问时间</li><li><a href="function.filectime.html">filectime</a> &mdash; 取得文件的 inode 修改时间</li><li><a href="function.filegroup.html">filegroup</a> &mdash; 取得文件的组</li><li><a href="function.fileinode.html">fileinode</a> &mdash; 取得文件的 inode</li><li><a href="function.filemtime.html">filemtime</a> &mdash; 取得文件修改时间</li><li><a href="function.fileowner.html">fileowner</a> &mdash; 取得文件的所有者</li><li><a href="function.fileperms.html">fileperms</a> &mdash; 获取文件权限</li><li><a href="function.filesize.html">filesize</a> &mdash; 取得文件大小</li><li><a href="function.filetype.html">filetype</a> &mdash; 取得文件类型</li><li><a href="function.flock.html">flock</a> &mdash; 可移植的协同文件锁定</li><li><a href="function.fnmatch.html">fnmatch</a> &mdash; 用模式匹配文件名</li><li><a href="function.fopen.html">fopen</a> &mdash; 打开文件或者 URL</li><li><a href="function.fpassthru.html">fpassthru</a> &mdash; 输出文件指针处的所有剩余数据</li><li><a href="function.fputcsv.html">fputcsv</a> &mdash; 将行格式化为 CSV 并写入文件指针</li><li><a href="function.fputs.html">fputs</a> &mdash; fwrite 的别名</li><li><a href="function.fread.html">fread</a> &mdash; 读取文件（可安全用于二进制文件）</li><li><a href="function.fscanf.html">fscanf</a> &mdash; 从文件中格式化输入</li><li><a href="function.fseek.html">fseek</a> &mdash; 在文件指针中定位</li><li><a href="function.fstat.html">fstat</a> &mdash; 通过已打开的文件指针取得文件信息</li><li><a href="function.fsync.html">fsync</a> &mdash; 同步文件变更（包括元数据）</li><li><a href="function.ftell.html">ftell</a> &mdash; 返回文件指针读/写的位置</li><li><a href="function.ftruncate.html">ftruncate</a> &mdash; 将文件截断到指定的长度</li><li><a href="function.fwrite.html">fwrite</a> &mdash; 写入文件（可安全用于二进制文件）</li><li><a href="function.glob.html">glob</a> &mdash; 寻找与模式匹配的文件路径</li><li><a href="function.is-dir.html">is_dir</a> &mdash; 判断给定文件名是否是一个目录</li><li><a href="function.is-executable.html">is_executable</a> &mdash; 判断给定文件名是否可执行</li><li><a href="function.is-file.html">is_file</a> &mdash; 判断给定文件名是否为一个正常的文件</li><li><a href="function.is-link.html">is_link</a> &mdash; 判断给定文件名是否为一个符号连接</li><li><a href="function.is-readable.html">is_readable</a> &mdash; 判断给定文件名是否可读</li><li><a href="function.is-uploaded-file.html">is_uploaded_file</a> &mdash; 判断文件是否是通过 HTTP POST 上传的</li><li><a href="function.is-writable.html">is_writable</a> &mdash; 判断给定的文件名是否可写</li><li><a href="function.is-writeable.html">is_writeable</a> &mdash; is_writable 的别名</li><li><a href="function.lchgrp.html">lchgrp</a> &mdash; 修改符号链接的所有组</li><li><a href="function.lchown.html">lchown</a> &mdash; 修改符号链接的所有者</li><li><a href="function.link.html">link</a> &mdash; 建立一个硬连接</li><li><a href="function.linkinfo.html">linkinfo</a> &mdash; 获取一个连接的信息</li><li><a href="function.lstat.html">lstat</a> &mdash; 给出一个文件或符号连接的信息</li><li><a href="function.mkdir.html">mkdir</a> &mdash; 新建目录</li><li><a href="function.move-uploaded-file.html">move_uploaded_file</a> &mdash; 将上传的文件移动到新位置</li><li><a href="function.parse-ini-file.html">parse_ini_file</a> &mdash; 解析一个配置文件</li><li><a href="function.parse-ini-string.html">parse_ini_string</a> &mdash; 解析配置字符串</li><li><a href="function.pathinfo.html">pathinfo</a> &mdash; 返回文件路径的信息</li><li><a href="function.pclose.html">pclose</a> &mdash; 关闭进程文件指针</li><li><a href="function.popen.html">popen</a> &mdash; 打开进程文件指针</li><li><a href="function.readfile.html">readfile</a> &mdash; 输出文件</li><li><a href="function.readlink.html">readlink</a> &mdash; 返回符号连接指向的目标</li><li><a href="function.realpath-cache-get.html">realpath_cache_get</a> &mdash; 获取真实目录缓存的详情</li><li><a href="function.realpath-cache-size.html">realpath_cache_size</a> &mdash; 获取真实路径缓冲区的大小</li><li><a href="function.realpath.html">realpath</a> &mdash; 返回规范化的绝对路径名</li><li><a href="function.rename.html">rename</a> &mdash; 重命名一个文件或目录</li><li><a href="function.rewind.html">rewind</a> &mdash; 倒回文件指针的位置</li><li><a href="function.rmdir.html">rmdir</a> &mdash; 删除目录</li><li><a href="function.set-file-buffer.html">set_file_buffer</a> &mdash; stream_set_write_buffer 的别名</li><li><a href="function.stat.html">stat</a> &mdash; 给出文件的信息</li><li><a href="function.symlink.html">symlink</a> &mdash; 建立符号连接</li><li><a href="function.tempnam.html">tempnam</a> &mdash; 建立一个具有唯一文件名的文件</li><li><a href="function.tmpfile.html">tmpfile</a> &mdash; 建立一个临时文件</li><li><a href="function.touch.html">touch</a> &mdash; 设定文件的访问和修改时间</li><li><a href="function.umask.html">umask</a> &mdash; 改变当前的 umask</li><li><a href="function.unlink.html">unlink</a> &mdash; 删除文件</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111670""></a>
  <div class="note">
   <strong class="user">ob at babcom dot biz</strong>
   <a href="#111670" class="date">14-Mar-2013 03:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a function based on "tunnelareaten at gmail dot com"s idea to search for files in a given directory by a searchstring or by fileextension.<br />
<br />
I added support to search recursively through all sub-directories an to determine weather the filepath should be returned or not.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// recursive function to get contents of given folder by searchterm or fileextension<br />
// (does not show folders)<br />
// standards: Foldername:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Searchterm:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Searchtype:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ext/search (file-extension or searchterm within filename)<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SaveCompletePath:&nbsp; &nbsp; &nbsp; &nbsp; true/1<br />
// usage:&nbsp; &nbsp;&nbsp; array FileSearch_r($Folder,$Search[,$SearchType,$SavePath])<br />
<br />
</span><span class="keyword">function </span><span class="default">FileSearch_r</span><span class="keyword">(</span><span class="default">$Dir</span><span class="keyword">,</span><span class="default">$Search</span><span class="keyword">,</span><span class="default">$SearchType</span><span class="keyword">=</span><span class="string">"search"</span><span class="keyword">,</span><span class="default">$SavePath</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$Array</span><span class="keyword">=array();<br />
&nbsp; </span><span class="default">$D</span><span class="keyword">=</span><span class="default">dir</span><span class="keyword">(</span><span class="default">$Dir</span><span class="keyword">);<br />
&nbsp; while (</span><span class="default">false</span><span class="keyword">!==(</span><span class="default">$Entry</span><span class="keyword">=</span><span class="default">$D</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">()))<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$Entry</span><span class="keyword">!=</span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$Entry</span><span class="keyword">!=</span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Entry</span><span class="keyword">=</span><span class="default">$Dir</span><span class="keyword">.</span><span class="default">$Entry</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">)) </span><span class="default">$Array</span><span class="keyword">=</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$Array</span><span class="keyword">,</span><span class="default">FileSearch_r</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$Search</span><span class="keyword">,</span><span class="default">$SearchType</span><span class="keyword">,</span><span class="default">$SavePath</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$SearchType</span><span class="keyword">==</span><span class="string">"search"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">?</span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">,</span><span class="default">$Search</span><span class="keyword">)&gt;</span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">:(</span><span class="default">$SearchType</span><span class="keyword">==</span><span class="string">"ext"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">?</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">,-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$Search</span><span class="keyword">))===</span><span class="default">$Search<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">:</span><span class="default">true</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Array</span><span class="keyword">[]=</span><span class="default">$Entry</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; </span><span class="default">$D</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$Array</span><span class="keyword">,</span><span class="default">SORT_STRING</span><span class="keyword">);<br />
&nbsp; if(!(bool)</span><span class="default">$SavePath</span><span class="keyword">) </span><span class="default">$Array</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$Dir</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$Array</span><span class="keyword">));<br />
&nbsp; return </span><span class="default">$Array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91075""></a>
  <div class="note">
   <strong class="user">drapeko.com</strong>
   <a href="#91075" class="date">23-May-2009 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You have an array of directories (straightforward list of directories):
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp; $array </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko/var'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko/var/y'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/var/libexec'
<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; );
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
And you would like to transform this array to hierarchy of directories:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;$array </span><span class="keyword">= array (
<br />
&nbsp;&nbsp; &nbsp; </span><span class="string">'home' </span><span class="keyword">=&gt; array (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'drapeko' </span><span class="keyword">=&gt; array (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'var' </span><span class="keyword">=&gt; array (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'y' </span><span class="keyword">=&gt; array()
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; )
<br />
&nbsp;&nbsp; &nbsp; ),
<br />
&nbsp;&nbsp; &nbsp; </span><span class="string">'var' </span><span class="keyword">=&gt; array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'libexec' </span><span class="keyword">=&gt; array()
<br />
&nbsp;&nbsp; &nbsp; )
<br />
&nbsp;);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
How can you do it?
<br />

<br />
First of all the below function will help us.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* This function converts real filesystem path to the string array representation.
<br />
&nbsp;*
<br />
&nbsp;* for example,
<br />
&nbsp;* '/home/drapeko/var/y&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; will be converted to&nbsp; &nbsp; $result_array['home']['drapeko']['var']['y']
<br />
&nbsp;* '/home/drapeko/var/y/file.txt&nbsp;&nbsp; will be converted to&nbsp; &nbsp; &nbsp;&nbsp; $result_array['home']['drapeko']['var']['y']
<br />
&nbsp;*
<br />
&nbsp;* @param $path&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; realpath of the directory
<br />
&nbsp;* @return string&nbsp; &nbsp; &nbsp; &nbsp; string array representation of the path
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">pathToArrayStr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// TODO constants/configs?
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">':/'</span><span class="keyword">, </span><span class="string">':\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">), </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// if the first or last symbol is '/' delete it (e.g. for linux)
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">"/^\//"</span><span class="keyword">, </span><span class="string">"/\/$/"</span><span class="keyword">), </span><span class="string">''</span><span class="keyword">, </span><span class="default">$res_path</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// create string
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="string">'[\''</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\'][\''</span><span class="keyword">, </span><span class="default">$res_path</span><span class="keyword">).</span><span class="string">'\']'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">$res_path</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
It simply converts the real path of the file to array string representation.
<br />

<br />
How can you use this function? I know it looks like a little confusing. But it's quite simple. Consider the example below:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;$result </span><span class="keyword">= array();
<br />
&nbsp;</span><span class="default">$check </span><span class="keyword">= array();
<br />
&nbsp;foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">pathToArrayStr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="string">'result'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; foreach(</span><span class="default">$check </span><span class="keyword">as </span><span class="default">$ck</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$ck</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue </span><span class="default">2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$check</span><span class="keyword">[] = </span><span class="default">$str</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; eval(</span><span class="string">'$result'</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">' = array();'</span><span class="keyword">);
<br />
&nbsp;}
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Heh, how do you find it? This approach has helped me very much. I hope you will find it useful. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73954""></a>
  <div class="note">
   <strong class="user">Christian</strong>
   <a href="#73954" class="date">17-Mar-2007 09:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just learned that, to specify file names in a portable manner, you DON'T need 'DIRECTORY_SEPARATOR' - just use '/'. This really surprised and shocked me, as until now I typed about a zillion times 'DIRECTORY_SEPARATOR' to stay platform independent - unnecessary. Don't make the same mistake.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50360""></a>
  <div class="note">
   <strong class="user">tunnelareaten at gmail dot com</strong>
   <a href="#50360" class="date">25-Feb-2005 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made this function to search and/or display files by extension or for a string occurance in the filename. Any comments or enhancements are welcome offcourse. I'll update this function soon.<br />
<br />
usage: list_files([string], [string], [int 1 | 0], [int 1 | 0]);<br />
<br />
search for extension: list_files([string], [string], [0], [int 1 | 0]);<br />
returns array: $myArray = list_files([string], [string], [0], [0]);<br />
echo result: list_files([string], [string], [0], [1]);<br />
<br />
search for string occurance: list_files([string], [string], [1], [int 1 | 0]);<br />
returns array: $myArray = list_files([string], [string], [1], [0]);<br />
echo result: list_files([string], [string], [1], [1]);<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">list_files</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">$stringSearch</span><span class="keyword">, </span><span class="default">$searchHandler</span><span class="keyword">, </span><span class="default">$outputHandler</span><span class="keyword">) {<br />
&nbsp;</span><span class="default">$errorHandler </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;</span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;if (! </span><span class="default">$directoryHandler </span><span class="keyword">= @</span><span class="default">opendir </span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">)) {<br />
&nbsp; echo (</span><span class="string">"&lt;pre&gt;\nerror: directory \"</span><span class="default">$directory</span><span class="string">\" doesn't exist!\n&lt;/pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;return </span><span class="default">$errorHandler </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;}<br />
&nbsp;if (</span><span class="default">$searchHandler </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fileName </span><span class="keyword">= @</span><span class="default">readdir </span><span class="keyword">(</span><span class="default">$directoryHandler</span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(@</span><span class="default">substr </span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, - @</span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$stringSearch</span><span class="keyword">)) === </span><span class="default">$stringSearch</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;if (</span><span class="default">$searchHandler </span><span class="keyword">=== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; while(</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fileName </span><span class="keyword">= @</span><span class="default">readdir </span><span class="keyword">(</span><span class="default">$directoryHandler</span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(@</span><span class="default">substr_count </span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">$stringSearch</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;if ((</span><span class="default">$errorHandler </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) &amp;&amp;&nbsp; (@</span><span class="default">count </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">)) {<br />
&nbsp; echo (</span><span class="string">"&lt;pre&gt;\nerror: no filetype \"</span><span class="default">$fileExtension</span><span class="string">\" found!\n&lt;/pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;}<br />
&nbsp;else {<br />
&nbsp; </span><span class="default">sort </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">$outputHandler </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; if (</span><span class="default">$outputHandler </span><span class="keyword">=== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo (</span><span class="string">"&lt;pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; echo (</span><span class="string">"&lt;/pre&gt;\n"</span><span class="keyword">); <br />
&nbsp; }<br />
&nbsp;}<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35196""></a>
  <div class="note">
   <strong class="user">Gregor Mosheh</strong>
   <a href="#35196" class="date">22-Aug-2003 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function searches a directory and returns an array of all files whose filename matches the specified regular expression. It's similar in concept to the Unix find program.<br />
<br />
&nbsp;function findfile($location='',$fileregex='') {<br />
&nbsp;&nbsp;&nbsp; if (!$location or !is_dir($location) or !$fileregex) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; $matchedfiles = array();<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; $all = opendir($location);<br />
&nbsp;&nbsp;&nbsp; while ($file = readdir($all)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (is_dir($location.'/'.$file) and $file &lt;&gt; ".." and $file &lt;&gt; ".") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $subdir_matches = findfile($location.'/'.$file,$fileregex);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $matchedfiles = array_merge($matchedfiles,$subdir_matches);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; elseif (!is_dir($location.'/'.$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (preg_match($fileregex,$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array_push($matchedfiles,$location.'/'.$file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; closedir($all);<br />
&nbsp;&nbsp;&nbsp; unset($all);<br />
&nbsp;&nbsp;&nbsp; return $matchedfiles;<br />
&nbsp;}<br />
<br />
$htmlfiles = findfile('/some/dir','/\.(htm|html)$/');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32089""></a>
  <div class="note">
   <strong class="user">mitra at mitra dot biz</strong>
   <a href="#32089" class="date">15-May-2003 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Pollard@php.net contributed this in response to a question on setting these variables ...<br />
This option *IS* settable within your PHP scripts.<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; ini_set</span><span class="keyword">(</span><span class="string">'auto_detect_line_endings'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">'unknowntype.txt'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'auto_detect_line_endings'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$content2 </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">'unixfile.txt'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Note, with PHP 4.3 anytime Mac files are read using fgets or file you'll need to auto_detect_line_endings since \n is otherwise assumed.&nbsp; However, with PHP 5.0, stream_get_line() will allow you to specify what line ending character to read up to.<br />
<br />
\\ Read a line from a MAC file<br />
stream_get_line($fp, 4096, "\r"); <br />
<br />
\\ Read a line from a UNIX file<br />
stream_get_line($fp, 4096, "\n"); <br />
<br />
\\ Read a line from a DOS file<br />
stream_get_line($fp, 4096, "\r\n"); <br />
<br />
\\ Read a line up to any filesystem line ending<br />
ini_set('auto_detect_line_endings', true); fgets($fp); <br />
<br />
\\ You can also make up your own line ending characters:<br />
\\ Read up to the first instance of ":"<br />
stream_get_line($fp, 4096, ":");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30924""></a>
  <div class="note">
   <strong class="user">regis at webstuff dot com dot br</strong>
   <a href="#30924" class="date">03-Apr-2003 07:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a useful function if you're having trouble writing raw bytes into a file. <br />
<br />
It receives an integer and returns an array containing the ASCII values of the bytes on each index of the array.<br />
<br />
function int2bytes($number){<br />
&nbsp; $byte = $number;<br />
&nbsp; $i=0;<br />
&nbsp; do{<br />
&nbsp;&nbsp;&nbsp; $dec_tmp = $byte;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $byte = bcdiv($byte,256,0);<br />
&nbsp;&nbsp;&nbsp; $resto = $dec_tmp - (256 * $byte);<br />
&nbsp;&nbsp;&nbsp; $return[] = $resto;<br />
&nbsp; } while($byte &gt;= 256);<br />
&nbsp; if($byte) $return[] = $byte;<br />
&nbsp; return array_reverse($return);<br />
}<br />
<br />
Example:<br />
<br />
$arr = int2bytes(75832);<br />
<br />
$arr will contain the following values:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; 40<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; 56<br />
)<br />
<br />
Now, to write this data to the file, just use a fputs() with chr(), just like this:<br />
<br />
fputs($fp,chr($arr[0]).chr($arr[1]).chr($arr[2]))<br />
<br />
-- Regis</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30152""></a>
  <div class="note">
   <strong class="user">jdhurn at uberidx dot com</strong>
   <a href="#30152" class="date">08-Mar-2003 07:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a function I use to determine if a file contains Binary information. I use this for my search engine so that it doesn't try to index files like .zip or .mp3 or any other file that doesn't contain readable information. It makes use of the Character Type Extension if it's loaded, if it's not then it uses Regular Expressions.<br />
<br />
function is_binary($link)<br />
{<br />
&nbsp;&nbsp; &nbsp; $tmpStr&nbsp; = '';<br />
&nbsp;&nbsp; &nbsp; @$fp&nbsp; &nbsp;&nbsp; = fopen($link, 'rb');<br />
&nbsp;&nbsp; &nbsp; @$tmpStr = fread($fp, 256);<br />
&nbsp;&nbsp; &nbsp; @fclose($fp);<br />
<br />
&nbsp;&nbsp; &nbsp; if($tmpStr != '')<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpStr = str_replace(chr(10), '', $tmpStr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpStr = str_replace(chr(13), '', $tmpStr);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpInt = 0;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for($i =0; $i &lt; strlen($tmpStr); $i++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( extension_loaded('ctype') )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !ctype_print($tmpStr[$i]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpInt++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( !eregi("[[:print:]]+", $tmpStr[$i]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpInt++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($tmpInt &gt; 5)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(0);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(1);<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(0);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
