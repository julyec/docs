<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Get the list of table names stored in a specific data source</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.odbc-tableprivileges.html">? odbc_tableprivileges</a></li>
      <li style="float: right;"><a href="book.pdo.html">PDO ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.uodbc.html">ODBC 函数</a></li>
    <li>Get the list of table names stored in a specific data source</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.odbc-tables" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_tables</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">odbc_tables</span> &mdash; <span class="dc-title">Get the list of table names stored in a specific data source</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.odbc-tables-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>odbc_tables</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">resource</span> <code class="parameter">$odbc</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$catalog</code><span class="initializer"> = <strong><code>null</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$schema</code><span class="initializer"> = <strong><code>null</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$table</code><span class="initializer"> = <strong><code>null</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$types</code><span class="initializer"> = <strong><code>null</code></strong></span></span><br>): <span class="type"><span class="type">resource</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Lists all tables in the requested range.
  </p>
  <p class="para">
   To support enumeration of qualifiers, owners, and table types,
   the following special semantics for the
   <code class="parameter">catalog</code>, <code class="parameter">schema</code>,
   <code class="parameter">table</code>, and
   <code class="parameter">table_type</code> are available:
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      If <code class="parameter">catalog</code> is a single percent
      character (%) and <code class="parameter">schema</code> and
      <code class="parameter">table</code> are empty strings, then the result
      set contains a list of valid qualifiers for the data
      source. (All columns except the TABLE_QUALIFIER column contain
      NULLs.)
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      If <code class="parameter">schema</code> is a single percent character
      (%) and <code class="parameter">catalog</code> and
      <code class="parameter">table</code> are empty strings, then the result
      set contains a list of valid owners for the data source. (All
      columns except the TABLE_OWNER column contain
      NULLs.)
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      If <code class="parameter">table_type</code> is a single percent
      character (%) and <code class="parameter">catalog</code>,
      <code class="parameter">schema</code> and <code class="parameter">table</code>
      are empty strings, then the result set contains a list of
      valid table types for the data source. (All columns except the
      TABLE_TYPE column contain NULLs.)
     </span>
    </li>
   </ul>
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.odbc-tables-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">odbc</code></dt>

     <dd>

      <p class="para">ODBC 连接标识符，详见
<span class="function"><a href="function.odbc-connect.html" class="function">odbc_connect()</a></span>。</p>
     </dd>

    
    
     <dt>
<code class="parameter">catalog</code></dt>

     <dd>

      <p class="para">
       The catalog (&#039;qualifier&#039; in ODBC 2 parlance).
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">schema</code></dt>

     <dd>

      <p class="para">
       The schema (&#039;owner&#039; in ODBC 2 parlance).
       此参数接受下列查询模式：
<code class="literal">%</code> 来匹配零到多个字符，
<code class="literal">_</code> 来匹配单个字符。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">table</code></dt>

     <dd>

      <p class="para">
       The name.
       此参数接受下列查询模式：
<code class="literal">%</code> 来匹配零到多个字符，
<code class="literal">_</code> 来匹配单个字符。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">types</code></dt>

     <dd>

      <p class="para">
       If <code class="parameter">table_type</code> is not an empty string, it
       must contain a list of comma-separated values for the types of
       interest; each value may be enclosed in single quotes (<code class="literal">&#039;</code>) or
       unquoted. For example, <code class="literal">&#039;TABLE&#039;,&#039;VIEW&#039;</code> or <code class="literal">TABLE, VIEW</code>.  If the
       data source does not support a specified table type,
       <span class="function"><strong>odbc_tables()</strong></span> does not return any results for
       that type.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-tables-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an ODBC result identifier containing the information 
    或者在失败时返回 <strong><code>false</code></strong>.
  </p>
  <p class="para">
   The result set has the following columns:
   <ul class="itemizedlist">
    <li class="listitem"><span class="simpara"><code class="literal">TABLE_CAT</code></span></li>
    <li class="listitem"><span class="simpara"><code class="literal">TABLE_SCHEM</code></span></li>
    <li class="listitem"><span class="simpara"><code class="literal">TABLE_NAME</code></span></li>
    <li class="listitem"><span class="simpara"><code class="literal">TABLE_TYPE</code></span></li>
    <li class="listitem"><span class="simpara"><code class="literal">REMARKS</code></span></li>
   </ul>
   Drivers can report additional columns.
  </p>
  <p class="simpara">
   The result set is ordered by <code class="literal">TABLE_TYPE</code>, <code class="literal">TABLE_CAT</code>,
   <code class="literal">TABLE_SCHEM</code> and <code class="literal">TABLE_NAME</code>.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.odbc-tables-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">schema</code>, <code class="parameter">table</code> and <code class="parameter">types</code>
       are now nullable.
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.odbc-tables-examples">
  <h3 class="title">示例</h3>
  <div class="example" id="example-2044">
   <p><strong>Example #1 List Tables in a Catalog</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">odbc_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">, </span><span style="color: #0000BB">$user</span><span style="color: #007700">, </span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$tables </span><span style="color: #007700">= </span><span style="color: #0000BB">odbc_tables</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'SalesOrders'</span><span style="color: #007700">, </span><span style="color: #DD0000">'dbo'</span><span style="color: #007700">, </span><span style="color: #DD0000">'%'</span><span style="color: #007700">, </span><span style="color: #DD0000">'TABLE'</span><span style="color: #007700">);<br />while ((</span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">odbc_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$tables</span><span style="color: #007700">))) {<br />    </span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br />    break; </span><span style="color: #FF8000">// further rows omitted for brevity<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>以上示例的输出类似于：</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [TABLE_CAT] =&gt; SalesOrders
    [TABLE_SCHEM] =&gt; dbo
    [TABLE_NAME] =&gt; Orders
    [TABLE_TYPE] =&gt; TABLE
    [REMARKS] =&gt;
)
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-tables-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-tableprivileges.html" class="function" rel="rdfs-seeAlso">odbc_tableprivileges()</a> - Lists tables and the privileges associated with each table</span></li>
    <li class="member"><span class="function"><a href="function.odbc-columns.html" class="function" rel="rdfs-seeAlso">odbc_columns()</a> - Lists the column names in specified tables</span></li>
    <li class="member"><span class="function"><a href="function.odbc-specialcolumns.html" class="function" rel="rdfs-seeAlso">odbc_specialcolumns()</a> - Retrieves special columns</span></li>
    <li class="member"><span class="function"><a href="function.odbc-statistics.html" class="function" rel="rdfs-seeAlso">odbc_statistics()</a> - Retrieve statistics about a table</span></li>
    <li class="member"><span class="function"><a href="function.odbc-procedures.html" class="function" rel="rdfs-seeAlso">odbc_procedures()</a> - Get the list of procedures stored in a specific data source</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="58482""></a>
  <div class="note">
   <strong class="user">narcomweb at wanadoo dot fr</strong>
   <a href="#58482" class="date">05-Nov-2005 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here a Code for listing Table names<br />
<span class="default">&lt;?php<br />
$dbh </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$dbh</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; </span><span class="default">$tables </span><span class="keyword">= array();<br />
&nbsp;&nbsp; while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; if(</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="string">"TABLE_TYPE"</span><span class="keyword">)==</span><span class="string">"TABLE"</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo</span><span class="string">"&lt;br&gt;"</span><span class="keyword">.</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="string">"TABLE_NAME"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>You don't have views or System tables with.<br />
Only simple tables in your database.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55018""></a>
  <div class="note">
   <strong class="user">pmains at ux dot com</strong>
   <a href="#55018" class="date">22-Jul-2005 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This probably works for a variety of formats, but if you want a list of *just* the table names from an SQL dsn source (I'm using MSSQL), here's the code.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment"># ... assign $dsn, $uid, &amp; $pwd ...<br />
<br />
</span><span class="default">$dbh </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$dbh</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tables </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$tables</span><span class="keyword">, </span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="string">"TABLE_NAME"</span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$tables </span><span class="keyword">as </span><span class="default">$t </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$t</span><span class="string">\n"</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40362""></a>
  <div class="note">
   <strong class="user">iggvopvantoodlwin</strong>
   <a href="#40362" class="date">01-Mar-2004 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With regard to the note made on results not working.<br />
Test the database with the easy:<br />
<br />
odbc_result_all(odbc_tables($db));<br />
<br />
$db is obviously a connected batadase. Then start to experiment:<br />
<br />
if(!$odbcr=odbc_tables($db,"udb","", "%", "'TABLE'"))<br />
<br />
"udb" is the DNS - aka 'name of my ODBC database in the Windows ODBC thingamy'. In result_all the full path was shown but I just used the name I assigned; either should work.<br />
<br />
The second parameter "" is listed by result_all as "TABLE_SCHEM" and all items were "NULL", so I have put "".<br />
<br />
The third parameter is "%". According to result_all this col is "TABLE_NAME", so I could have put the name of one of my tables, i.e. "Address".<br />
<br />
In my case I have an Access database setup with several tables. In ODBC I have created a link. Running the all on everything result above shows a set of system tables which I do not need to know about at this point so I look at the result and then build my new table check using the "TABLE" string as the tables I am interested in are listed as "TABLE" under their "TABLE_TYPE" column.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="11870""></a>
  <div class="note">
   <strong class="user">liquidicee at hotmail dot com</strong>
   <a href="#11870" class="date">10-Mar-2001 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's how to get a list of all the tables in your database.. with an actual example of how its done and how to get the results.. and you don't need to put in schema and all that other crap
<br />

<br />
<span class="default">&lt;?php
<br />
$conn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"</span><span class="default">$database</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$username</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$password</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">$tablelist </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);
<br />
while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">)) {
<br />
if (</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">) == </span><span class="string">"TABLE"</span><span class="keyword">)
<br />
echo </span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">) .</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
to understand what the above is doing,
<br />
use odbc_result_all($tablelist); this will show you EVERYTHING returned by odbc_tables() then you can look through it and see better how odbc_tables() works and what exactly it returns in the string to get a better idea on how to deal with it.
<br />
it would have saved me alot of time if i would have just taken a look at the full string returned by odbc_tables(), so i suggest you take the minute or two and look... here is an example of how to do it..which would have been helpful for me ;x.
<br />

<br />
<span class="default">&lt;?php
<br />
$conn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"</span><span class="default">$database</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$username</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$password</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">$tablelist </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);
<br />
while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">)) {
<br />
echo </span><span class="default">odbc_result_all</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
hopefully this will help some people.. i have alot more to add about this but no time :(
<br />
so again hope this helps.
<br />
Liquidice</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
