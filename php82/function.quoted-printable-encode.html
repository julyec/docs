<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>将 8-bit 字符串转换成 quoted-printable 字符串</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.quoted-printable-decode.html">? quoted_printable_decode</a></li>
      <li style="float: right;"><a href="function.quotemeta.html">quotemeta ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.strings.html">字符串 函数</a></li>
    <li>将 8-bit 字符串转换成 quoted-printable 字符串</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.quoted-printable-encode" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">quoted_printable_encode</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">quoted_printable_encode</span> &mdash; <span class="dc-title">将 8-bit 字符串转换成 quoted-printable 字符串</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.quoted-printable-encode-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>quoted_printable_encode</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   返回 quoted-printable 格式的字符，该格式由 <a href="http://www.faqs.org/rfcs/rfc2045" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2045">&raquo;&nbsp;RFC2045</a> 6.7.章节里制定。
  </p>
  <p class="para">
   该函数与 <span class="function"><a href="function.imap-8bit.html" class="function">imap_8bit()</a></span> 函数十分相似，不同的是该函数不需要 IMAP 模块就能运行。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.quoted-printable-encode-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       输入的字符串。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.quoted-printable-encode-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回编码之后的字符串。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.quoted-printable-encode-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>quoted_printable_encode()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$encoded </span><span style="color: #007700">= </span><span style="color: #0000BB">quoted_printable_encode</span><span style="color: #007700">(</span><span style="color: #DD0000">'M?chten Sie ein paar ?pfel?'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$encoded</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">quoted_printable_decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$encoded</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(37) &quot;M=C3=B6chten Sie ein paar =C3=84pfel?&quot;
string(29) &quot;M?chten Sie ein paar ?pfel?&quot;
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.quoted-printable-encode-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.quoted-printable-decode.html" class="function" rel="rdfs-seeAlso">quoted_printable_decode()</a> - 将 quoted-printable 字符串转换为 8-bit 字符串</span></li>
    <li class="member"><span class="function"><a href="function.iconv-mime-encode.html" class="function" rel="rdfs-seeAlso">iconv_mime_encode()</a> - Composes a MIME header field</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120637""></a>
  <div class="note">
   <strong class="user">marcus at synchromedia dot co dot uk</strong>
   <a href="#120637" class="date">13-Feb-2017 07:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function returns the quoted-printable string with Windows / RFC822 CRLF line breaks. If you're passing the output of this function into mail(), you may need to convert its line breaks to Unix LF style first.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115840""></a>
  <div class="note">
   <strong class="user">jurgen at edesign dot nl</strong>
   <a href="#115840" class="date">02-Oct-2014 09:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Both PHP's native implementation and the function of ericth at NOSPAM dot pennyworth dot com (below) contain an feature/error (usage for SMTP mismatch) which has been solved in my adjustment below.<br />
<br />
The error causes a text containing period character(s), when passed through these functions, end up with encoded lines starting with a period character, the first period character on that line will be discarded when it is transported over SMTP.<br />
<br />
Solution: add (another) leading '.' to period characters which would end up as first character on a line when encoded.<br />
<br />
See <a href="http://stackoverflow.com/a/13949483: " rel="nofollow" target="_blank">http://stackoverflow.com/a/13949483: </a>"This is a dirty artifact of your transport layer... SMTP is the most probable culprit (see the call for caution in the mail function documentation) but there may be other low level mecanisms that behave similarly. For example if you tweaked the sendmail_path setting or use a buggy sendmail program you may experience similar woes."<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'PHP_QPRINT_MAXL'</span><span class="keyword">, </span><span class="default">75</span><span class="keyword">);<br />
<br />
function </span><span class="default">leading_dot_fixed_php_quot_print_encode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hex </span><span class="keyword">= </span><span class="string">"0123456789ABCDEF"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str_index </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$length</span><span class="keyword">--) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (((</span><span class="default">$c </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">++]) == </span><span class="string">"\015"</span><span class="keyword">) &amp;&amp; (</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">] == </span><span class="string">"\012"</span><span class="keyword">) &amp;&amp; </span><span class="default">$length </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\015"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">++];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">ctype_cntrl</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) == </span><span class="default">0x7f</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) &amp; </span><span class="default">0x80</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">'='</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || ((</span><span class="default">$c </span><span class="keyword">== </span><span class="string">' '</span><span class="keyword">) &amp;&amp; (</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">] == </span><span class="string">"\015"</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$lp </span><span class="keyword">+= </span><span class="default">3</span><span class="keyword">) &gt; </span><span class="default">PHP_QPRINT_MAXL</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\015"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\012"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$hex</span><span class="keyword">[</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) &gt;&gt; </span><span class="default">4</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$hex</span><span class="keyword">[</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) &amp; </span><span class="default">0xf</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((++</span><span class="default">$lp</span><span class="keyword">) &gt; </span><span class="default">PHP_QPRINT_MAXL</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\015"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\012"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$c</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$lp </span><span class="keyword">== </span><span class="default">1 </span><span class="keyword">&amp;&amp; </span><span class="default">$c </span><span class="keyword">== </span><span class="string">'.'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106078""></a>
  <div class="note">
   <strong class="user">ericth at NOSPAM dot pennyworth dot com</strong>
   <a href="#106078" class="date">07-Oct-2011 01:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have re-written the PHP 5.3.8 function for quoted_printable_encode into PHP for use with PHP &lt; 5.3.&nbsp; Tested with PHP 5.2.11.<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'PHP_QPRINT_MAXL'</span><span class="keyword">, </span><span class="default">75</span><span class="keyword">);<br />
<br />
function </span><span class="default">php_quot_print_encode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hex </span><span class="keyword">= </span><span class="string">"0123456789ABCDEF"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str_index </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$length</span><span class="keyword">--) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (((</span><span class="default">$c </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">++]) == </span><span class="string">"\015"</span><span class="keyword">) &amp;&amp; (</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">] == </span><span class="string">"\012"</span><span class="keyword">) &amp;&amp; </span><span class="default">$length </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\015"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">++];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">ctype_cntrl</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) == </span><span class="default">0x7f</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) &amp; </span><span class="default">0x80</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">'='</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; || ((</span><span class="default">$c </span><span class="keyword">== </span><span class="string">' '</span><span class="keyword">) &amp;&amp; (</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$str_index</span><span class="keyword">] == </span><span class="string">"\015"</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$lp </span><span class="keyword">+= </span><span class="default">3</span><span class="keyword">) &gt; </span><span class="default">PHP_QPRINT_MAXL</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\015"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\012"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$hex</span><span class="keyword">[</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) &gt;&gt; </span><span class="default">4</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$hex</span><span class="keyword">[</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) &amp; </span><span class="default">0xf</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((++</span><span class="default">$lp</span><span class="keyword">) &gt; </span><span class="default">PHP_QPRINT_MAXL</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\015"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">"\012"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lp </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$c</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105402""></a>
  <div class="note">
   <strong class="user">arnaudv6</strong>
   <a href="#105402" class="date">15-Aug-2011 08:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One will like to know and clearly read that RFC2045 specifies a line shall not exceed 75 characters.<br />
Accordingly, quoted_printable_encode() splits line at this limit.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100091""></a>
  <div class="note">
   <strong class="user">Thorsten Glaser</strong>
   <a href="#100091" class="date">24-Sep-2010 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Two bugs:<br />
<br />
1) your linebreak is wrong<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $linebreak = "\r\n";<br />
<br />
2) continuation of lines with no whitespace is broken<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; /*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * the text after the whitespace will have to <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * be read again ( + any additional characters<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * that came into existence as a result of the<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * encoding process after the whitespace)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * Also, do not start at 0, if there was *no*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * whitespace in the whole line<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (($i + $addtl_chars) &gt; $whitesp_diff) {&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $output .= substr($cur_conv_line, 0,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (strlen($cur_conv_line) - $whitesp_diff)) .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $linebreak;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i = $i - $whitesp_diff + $addtl_chars;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; /* emit continuation --mirabilos */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $output .= $cur_conv_line .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; '=' . $linebreak;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97230""></a>
  <div class="note">
   <strong class="user">tzangerl [dot] pdc {dot} kth dot se</strong>
   <a href="#97230" class="date">09-Apr-2010 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function that QP-encodes an input string (written for PHP &lt; 5.3) and
<br />
wordwraps it at the same time, in order to avoid classification according to the MIME QP LONG LINE rule of SpamAssassin.&nbsp; Thanks for Matt Jeffers to point out errors in the below quoted_printable script!
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">quoted_printable_encode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$line_max </span><span class="keyword">= </span><span class="default">75</span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">$hex </span><span class="keyword">= array(</span><span class="string">'0'</span><span class="keyword">,</span><span class="string">'1'</span><span class="keyword">,</span><span class="string">'2'</span><span class="keyword">,</span><span class="string">'3'</span><span class="keyword">,</span><span class="string">'4'</span><span class="keyword">,</span><span class="string">'5'</span><span class="keyword">,</span><span class="string">'6'</span><span class="keyword">,</span><span class="string">'7'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'8'</span><span class="keyword">,</span><span class="string">'9'</span><span class="keyword">,</span><span class="string">'A'</span><span class="keyword">,</span><span class="string">'B'</span><span class="keyword">,</span><span class="string">'C'</span><span class="keyword">,</span><span class="string">'D'</span><span class="keyword">,</span><span class="string">'E'</span><span class="keyword">,</span><span class="string">'F'</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/(?:\r\n|\r|\n)/"</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">$linebreak </span><span class="keyword">= </span><span class="string">"=0D=0A=\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="comment">/* the linebreak also counts as characters in the mime_qp_long_line
<br />
&nbsp;&nbsp;&nbsp; * rule of spam-assassin */
<br />
&nbsp;&nbsp; </span><span class="default">$line_max </span><span class="keyword">= </span><span class="default">$line_max </span><span class="keyword">- </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$linebreak</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">$escape </span><span class="keyword">= </span><span class="string">"="</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$cur_conv_line </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$whitespace_pos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$addtl_chars </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// iterate lines
<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">); </span><span class="default">$j</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">$lines</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$linlen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// iterate chars
<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$linlen</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dec </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$length</span><span class="keyword">++;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (</span><span class="default">$dec </span><span class="keyword">== </span><span class="default">32</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// space occurring at end of line, need to encode
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ((</span><span class="default">$i </span><span class="keyword">== (</span><span class="default">$linlen </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">))) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="string">"=20"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$length </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$addtl_chars </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$whitespace_pos </span><span class="keyword">= </span><span class="default">$i</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; } elseif ( (</span><span class="default">$dec </span><span class="keyword">== </span><span class="default">61</span><span class="keyword">) || (</span><span class="default">$dec </span><span class="keyword">&lt; </span><span class="default">32 </span><span class="keyword">) || (</span><span class="default">$dec </span><span class="keyword">&gt; </span><span class="default">126</span><span class="keyword">) ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$h2 </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">/</span><span class="default">16</span><span class="keyword">); </span><span class="default">$h1 </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">$escape </span><span class="keyword">. </span><span class="default">$hex</span><span class="keyword">[</span><span class="string">"</span><span class="default">$h2</span><span class="string">"</span><span class="keyword">] . </span><span class="default">$hex</span><span class="keyword">[</span><span class="string">"</span><span class="default">$h1</span><span class="string">"</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$addtl_chars </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// length for wordwrap exceeded, get a newline into the text
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$length </span><span class="keyword">&gt;= </span><span class="default">$line_max</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$cur_conv_line </span><span class="keyword">.= </span><span class="default">$c</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// read only up to the whitespace for the current line
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$whitesp_diff </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">- </span><span class="default">$whitespace_pos </span><span class="keyword">+ </span><span class="default">$addtl_chars</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/* the text after the whitespace will have to be read
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * again ( + any additional characters that came into
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * existence as a result of the encoding process after the whitespace)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; *
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Also, do not start at 0, if there was *no* whitespace in
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * the whole line */
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if ((</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">$addtl_chars</span><span class="keyword">) &gt; </span><span class="default">$whitesp_diff</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$cur_conv_line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$cur_conv_line</span><span class="keyword">) - 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$whitesp_diff</span><span class="keyword">)) . </span><span class="default">$linebreak</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">=&nbsp; </span><span class="default">$i </span><span class="keyword">- </span><span class="default">$whitesp_diff </span><span class="keyword">+ </span><span class="default">$addtl_chars</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$cur_conv_line </span><span class="keyword">. </span><span class="default">$linebreak</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cur_conv_line </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$whitespace_pos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// length for wordwrap not reached, continue reading
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cur_conv_line </span><span class="keyword">.= </span><span class="default">$c</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; } </span><span class="comment">// end of for
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$whitespace_pos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$cur_conv_line</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cur_conv_line </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$j</span><span class="keyword">&lt;=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$linebreak</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp; } </span><span class="comment">// end for
<br />

<br />
&nbsp; </span><span class="keyword">return </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">);
<br />
} </span><span class="comment">// end quoted_printable_encode
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
