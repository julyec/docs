<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>执行外部程序并且显示原始输出</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.exec.html">? exec</a></li>
      <li style="float: right;"><a href="function.proc-close.html">proc_close ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.exec.html">程序执行函数</a></li>
    <li>执行外部程序并且显示原始输出</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.passthru" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">passthru</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">passthru</span> &mdash; <span class="dc-title">执行外部程序并且显示原始输出</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.passthru-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>passthru</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$command</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter reference">&$result_code</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type">?</span><span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
    同 <span class="function"><a href="function.exec.html" class="function">exec()</a></span> 函数类似，
    <span class="function"><strong>passthru()</strong></span> 函数
    也是用来执行外部命令（<code class="parameter">command</code>）的。
    当所执行的 Unix 命令输出二进制数据，
    并且需要直接传送到浏览器的时候，
    需要用此函数来替代 <span class="function"><a href="function.exec.html" class="function">exec()</a></span> 
    或 <span class="function"><a href="function.system.html" class="function">system()</a></span> 函数。
    常用来执行诸如 pbmplus 之类的可以直接输出图像流的命令。
    通过设置 Content-type 为 <code class="literal">image/gif</code>，
    然后调用 pbmplus 程序输出 gif 文件，
    就可以从 PHP 脚本中直接输出图像到浏览器。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.passthru-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">command</code></dt>

     <dd>

      <p class="para">
       要执行的命令。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">result_code</code></dt>

     <dd>

      <p class="para">
        如果提供  <code class="parameter">result_code</code> 参数，
        Unix 命令的返回状态会被记录到此参数。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.passthru-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>null</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.passthru-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   如果 <span class="function"><strong>passthru()</strong></span> 无法执行 <code class="parameter">command</code>，会发出 <strong><code>E_WARNING</code></strong>。
  </p>
  <p class="para">
   如果 <code class="parameter">command</code> 为空或者包含 null 字节，则抛出 <span class="classname"><a href="class.valueerror.html" class="classname">ValueError</a></span>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.passthru-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       如果 <code class="parameter">command</code> 为空或者包含 null 字节，<span class="function"><strong>passthru()</strong></span> 现在将抛出
       <span class="classname"><a href="class.valueerror.html" class="classname">ValueError</a></span>。之前会发出 <strong><code>E_WARNING</code></strong> 并返回 <strong><code>false</code></strong>。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 notes" id="refsect1-function.passthru-notes">
  <h3 class="title">注释</h3>
  <div class="warning"><strong class="warning">Warning</strong><p class="para">当传入用户提供的数据到本函数时，应使用
<span class="function"><a href="function.escapeshellarg.html" class="function">escapeshellarg()</a></span> 或 <span class="function"><a href="function.escapeshellcmd.html" class="function">escapeshellcmd()</a></span>
来防止用户欺骗系统执行任意命令。</p></div>
  <blockquote class="note"><p><strong class="note">Note</strong>: <p class="para">如何程序使用此函数启动，为了能保持在后台运行，此程序必须将输出重定向到文件或其它输出流。否则会导致
PHP 挂起，直至程序执行结束。</p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.passthru-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.exec.html" class="function" rel="rdfs-seeAlso">exec()</a> - 执行一个外部程序</span></li>
    <li class="member"><span class="function"><a href="function.system.html" class="function" rel="rdfs-seeAlso">system()</a> - 执行外部程序，并且显示输出</span></li>
    <li class="member"><span class="function"><a href="function.popen.html" class="function" rel="rdfs-seeAlso">popen()</a> - 打开进程文件指针</span></li>
    <li class="member"><span class="function"><a href="function.escapeshellcmd.html" class="function" rel="rdfs-seeAlso">escapeshellcmd()</a> - shell 元字符转义</span></li>
    <li class="member"><a href="language.operators.execution.html" class="link">执行运算符</a></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="127699""></a>
  <div class="note">
   <strong class="user">divinity76+spam at gmail dot com</strong>
   <a href="#127699" class="date">06-Oct-2022 04:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you have problems with passthru("docker-compose ...bash") losing interactive shell size information, try using proc_open instead, for some reason docker-compose bash knows the size of the outer terminal when i use use proc_open, but loses that information when i use passthru,<br />
<br />
eg i replaced<br />
<span class="default">&lt;?php<br />
passthru</span><span class="keyword">(</span><span class="string">"docker-compose -f docker-compose.yml bash"</span><span class="keyword">,</span><span class="default">$ret</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>with<br />
<span class="default">&lt;?php<br />
$empty1</span><span class="keyword">=array();<br />
</span><span class="default">$empty2</span><span class="keyword">=array();<br />
</span><span class="default">$proc</span><span class="keyword">=</span><span class="default">proc_open</span><span class="keyword">(</span><span class="string">"docker-compose -f docker-compose.yml bash"</span><span class="keyword">,</span><span class="default">$empty1</span><span class="keyword">,</span><span class="default">$empty2 </span><span class="keyword">);<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">proc_close</span><span class="keyword">(</span><span class="default">$proc</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
and suddenly docker-compose bash knew my terminal size :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="127611""></a>
  <div class="note">
   <strong class="user">mail at dtrasbo dot dk</strong>
   <a href="#127611" class="date">12-Sep-2022 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To capture the output of a command in a string without using output buffer functions, use shell_exec()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124165""></a>
  <div class="note">
   <strong class="user">tox at novasonica dot com</strong>
   <a href="#124165" class="date">03-Sep-2019 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying to implement a system that allows running arbitrary CLI commands with parameters, but I kept running into the issues with user prompts from the command as they would let execution hang. The solution is simple: just use passthru() as it outputs everything and correctly handles user prompts out of the box.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120208""></a>
  <div class="note">
   <strong class="user">me at yourMomsPussy dot cum</strong>
   <a href="#120208" class="date">22-Nov-2016 03:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
`command` // back ticks drop you out of PHP mode into shell<br />
exec('command', $output); // exec will allow you to capture the return of a command as reference<br />
shell_exec('command'); // will return the output to a variable<br />
system(); //as seen above.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101148""></a>
  <div class="note">
   <strong class="user">myselfasunder at gmail dot com dot dfvuks</strong>
   <a href="#101148" class="date">29-Nov-2010 01:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP's program-execution commands fail miserably when it comes to STDERR, and the proc_open() command doesn't work all that consistently in non-blocking mode under Windows.<br />
<br />
This command, although useful, is no different. To form a mechanism that will see/capture both STDOUT and STDERR output, pipe the command to the 'tee' command (which can be found for Windows), and wrap the whole thing in output buffering.<br />
<br />
Dustin Oprea</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84773""></a>
  <div class="note">
   <strong class="user">Chroot</strong>
   <a href="#84773" class="date">29-Jul-2008 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have chrooted apache and php, you will also want to put /bin/sh into the chrooted environment. Otherwise, the exec() or passthru() will not function properly, and will produce error code 127, file not found.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79361""></a>
  <div class="note">
   <strong class="user">jo at durchholz dot org</strong>
   <a href="#79361" class="date">22-Nov-2007 12:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note to Paul Giblock: the command *is* run through the shell.<br />
You can verify this on any Linux system with<br />
<br />
<span class="default">&lt;?php<br />
passthru </span><span class="keyword">(</span><span class="string">'echo $PATH'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You'll get the content of the PATH environment variable, not the string $PATH.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75229""></a>
  <div class="note">
   <strong class="user">Paul Giblock</strong>
   <a href="#75229" class="date">18-May-2007 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Stuart:<br />
<br />
The pasthru function does not execute the program through the shell.&nbsp; What this mean, among other things, is that your PATH variable is never set.&nbsp; Therefore, you have to use full paths on everything.<br />
<br />
I believe system() will run your program underneith a shell.&nbsp; This allow the program to run in a 'normal' environment.<br />
<br />
-Paul</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60314""></a>
  <div class="note">
   <strong class="user">nuker at list dot ru</strong>
   <a href="#60314" class="date">03-Jan-2006 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote function, that gets proxy server value from the Internet Explorer (from<br />
registry). It was tested in Windows XP Pro<br />
<br />
(Sorry for my English)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getProxyFromIE</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">(</span><span class="string">"reg query \"HKEY_CURRENT_USER\Software\Microsoft"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"\Windows\CurrentVersion\Internet Settings\" /v ProxyEnable"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$proxyenable</span><span class="keyword">,</span><span class="default">$proxyenable_status</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">(</span><span class="string">"reg query \"HKEY_CURRENT_USER\Software\Microsoft"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"\Windows\CurrentVersion\Internet Settings\" /v ProxyServer"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$proxyserver</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$proxyenable_status</span><span class="keyword">!=</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; </span><span class="comment">#Can't access the registry! Very very bad...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$enabled</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$proxyenable</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">],-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$enabled</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$proxy</span><span class="keyword">=</span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"^[ \t]{1,10}ProxyServer\tREG_SZ[ \t]{1,20}"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$proxyserver</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">"[\=\;]"</span><span class="keyword">,</span><span class="default">$proxy</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$proxy</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">";"</span><span class="keyword">,</span><span class="default">$proxy</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$proxy </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">"http"</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$proxy</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"http="</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(@!</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">"^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\:"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"[0-9]{1,5}$"</span><span class="keyword">,</span><span class="default">$proxy</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$proxy</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$proxy</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Note, that this function returns FALSE if proxy is disabled in Internet<br />
Explorer. This function returns ONLY HTTP proxy server.<br />
<br />
Usage:<br />
<span class="default">&lt;?php<br />
$proxy</span><span class="keyword">=</span><span class="default">getProxyFromIE</span><span class="keyword">();<br />
if(!</span><span class="default">$proxy</span><span class="keyword">)<br />
echo </span><span class="string">"Can't get proxy!"</span><span class="keyword">;<br />
else<br />
echo </span><span class="default">$proxy</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59507""></a>
  <div class="note">
   <strong class="user">Stuart Eve</strong>
   <a href="#59507" class="date">08-Dec-2005 11:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I dunno if anyone else might find this useful, but when I was trying to use the passthru() command on Suse9.3 I was having no success with the command:<br />
<br />
$command = 'gdal_translate blahahahaha';<br />
<br />
passthru($command);<br />
<br />
It only worked once I put:<br />
<br />
$command = '/usr/bin/local/gdal_translate blalalala';<br />
<br />
passthru($command);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57754""></a>
  <div class="note">
   <strong class="user">vijayramanan at rediffmail dot com</strong>
   <a href="#57754" class="date">13-Oct-2005 03:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had an issue when i used exec<br />
<br />
I think we were echoing information on the test.php script.<br />
for eg: when we tried <br />
<br />
exec(php test.php,$array,$error);<br />
<br />
the return was 127 and the code was failing.<br />
<br />
checking the note on this page gave us a hint to use passthru instead.<br />
The only thing to note is that you need to provide the fuull path.<br />
<br />
now our command became<br />
<br />
passthru(/bin/php /pathtotest/test.php,$array,$error);<br />
<br />
this works.<br />
<br />
yipeee!!!!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55643""></a>
  <div class="note">
   <strong class="user">stuartc1 at NOSPAM dot hotmail dot com</strong>
   <a href="#55643" class="date">09-Aug-2005 07:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thought it might beuseful to note the passthru seems to supress error messages whilst being run in Dos on Windows (test on NT).<br />
<br />
To show FULL raw output including errors, use system().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54108""></a>
  <div class="note">
   <strong class="user">igor at bboy dot ru</strong>
   <a href="#54108" class="date">23-Jun-2005 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using passthru() to download files (for dynamically generated content or something outside webserver root) using similar code:<br />
<br />
header("Content-Type: application/octet-stream");<br />
header("Content-Disposition: attachment; filename=\"myfile.zip\"");<br />
header("Content-Length: 11111");<br />
passthru("cat myfile.zip",$err);<br />
<br />
and your download goes fine, but subsequent downloads / link clicks are screwed up, with headers and binary data being all over the website, try putting<br />
<br />
exit();<br />
<br />
after the passthrough. This will exit the script after the download is done and will not interfere with any future actions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50759""></a>
  <div class="note">
   <strong class="user">sarel dot w at envent dot co dot za</strong>
   <a href="#50759" class="date">08-Mar-2005 11:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Zak Estrada<br />
14-Dec-2004 11:21 <br />
Remember to use the full path (IE '/usr/local/bin/foo' instead of 'foo') when using passthru, otherwise you'll get an exit code of 127 (command not found).<br />
<br />
Remember, you'll also get this error if your file does not have executable permission.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50540""></a>
  <div class="note">
   <strong class="user">puppy at cyberpuppy dot org</strong>
   <a href="#50540" class="date">02-Mar-2005 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding swbrown's comment...you need to use an output buffer if you don't want the data displayed.<br />
<br />
For example:<br />
ob_start();<br />
passthru("&lt;i&gt;command&lt;/i&gt;");<br />
$var = ob_get_contents();<br />
ob_end_clean(); //Use this instead of ob_flush()<br />
<br />
This gets all the output from the command, and exits without sending any data to stdout.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48174""></a>
  <div class="note">
   <strong class="user">Zak Estrada</strong>
   <a href="#48174" class="date">14-Dec-2004 08:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember to use the full path (IE '/usr/local/bin/foo' instead of 'foo') when using passthru, otherwise you'll get an exit code of 127 (command not found).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42732""></a>
  <div class="note">
   <strong class="user">php @ richud dot com</strong>
   <a href="#42732" class="date">27-May-2004 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding kpierre's post, be mindful that if you shell script errors, you will find the error output from it in the base error_log file (not virtualhost error_log) in apache.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35540""></a>
  <div class="note">
   <strong class="user">jcr at marvel-databadge dot com</strong>
   <a href="#35540" class="date">04-Sep-2003 11:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With apache 2.x on RH9 passthru() writes 1 byte at a time. Apache 2.x buffers and chunk encodes the output for you - but the chunked encoding devides the output in chunks of 1 byte each...thus several bytes of overhead per byte. I guess that buffering behaviour is by design - but caused problems for me with IE adobe acrobot 5 plugin. The plugin doesn't like like it if you send it a stream of 1 byte chunks - it tells you your file is not a pdf or gives a blank screen. Using output buffering (ob_start / ob_endflush) gives reasonable size chunks and the plugin works OK.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32662""></a>
  <div class="note">
   <strong class="user">swbrown at ucsd dot edu</strong>
   <a href="#32662" class="date">03-Jun-2003 08:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
passthru() seems absolutely determined to buffer output no matter what you do, even with ob_implicit_flush().&nbsp; The solution seems to be to use popen() instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="18647""></a>
  <div class="note">
   <strong class="user">kpierre at fit dot edu</strong>
   <a href="#18647" class="date">30-Jan-2002 07:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documention does not mention that passthru() will only display standard output and not standard error.<br />
<br />
If you are running a script you can pipe the STDERR to STDOUT by doing <br />
<br />
exec 2&gt;&amp;1<br />
<br />
Eg. the script below will actually print something with the passthru() function...<br />
<br />
#!/bin/sh<br />
exec 2&gt;&amp;1<br />
ulimit -t 60<br />
cat nosuchfile.txt</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15799""></a>
  <div class="note">
   <strong class="user">andreas dot hochsteger at oeamtc dot at</strong>
   <a href="#15799" class="date">03-Oct-2001 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you sometimes get no output from passthru() use system() instead. This solved this problem for me (php 4.0.5 on Tru64 Unix compiled with gcc).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13535""></a>
  <div class="note">
   <strong class="user">sidney at jigsaw dot nl</strong>
   <a href="#13535" class="date">20-Jun-2001 05:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PJ's ulimit example is nice; however, if you include multiple commands in the script after the ulimit command, each gets its own, seperate 60 second time slot!&lt;br&gt;
<br />

<br />
Furthermore, these sixty seconds are *CPU* time. Most programs hang for other reasons than CPU hogging (for example, waiting for a database connection) so for most purposes the number 60 is rather too high.&lt;br&gt;
<br />

<br />
Try "ulimit -t 1" first, which will give you about 10^9 cycles on modern hardware -- quite enough to get a lot of work done!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="11298""></a>
  <div class="note">
   <strong class="user">PJ at piggei dot com</strong>
   <a href="#11298" class="date">14-Feb-2001 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About the problem of zombies, you may call a bash script like this:
<br />

<br />
--------------------------
<br />
#! /bin/bash
<br />
ulimit -t 60
<br />

<br />
&lt;your command here&gt;
<br />
--------------------------</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
