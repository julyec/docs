<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>引用是什么</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.references.html">? 引用的解释</a></li>
      <li style="float: right;"><a href="language.references.whatdo.html">引用做什么 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.references.html">引用的解释</a></li>
    <li>引用是什么</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.references.whatare" class="sect1">
  <h2 class="title">引用是什么</h2>
  <p class="simpara">
   在 PHP 中引用意味着用不同的名字访问同一个变量内容。这并不像 C
   的指针：例如你不能对他们做指针运算，他们并不是实际的内存地址......
   查看<a href="language.references.arent.html" class="xref">引用不是什么</a>了解更多信息。
   替代的是，引用是符号表别名。注意在PHP 中，变量名和变量内容是不一样的，
   因此同样的内容可以有不同的名字。最接近的比喻是
   Unix 的文件名和文件本身&mdash;&mdash;变量名是目录条目，而变量内容则是文件本身。引用可以被看作是
   Unix 文件系统中的硬链接。
  </p>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123692""></a>
  <div class="note">
   <strong class="user">aldo dot caruso at argencasas dot com</strong>
   <a href="#123692" class="date">13-Mar-2019 04:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following three code snippets show the effect of using references in scalar variables, arrays and objects under different circumstances.<br />
<br />
In any case the result is the expected one if you stick to the concept that a reference is an alias to a variable. After assigning by reference ( no matter if $a =&amp; $b or $b =&amp; $a ) both variable names refer to the same variable.<br />
<br />
References with scalars<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
References are aliases for the same variable<br />
*/<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">=&amp; </span><span class="default">$a</span><span class="keyword">;<br />
<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
echo </span><span class="string">"</span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 2,2<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
echo </span><span class="string">"</span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3,3<br />
<br />
// Variables can be bound before being assigned<br />
</span><span class="default">$c </span><span class="keyword">=&amp; </span><span class="default">$d</span><span class="keyword">;<br />
</span><span class="default">$c </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
echo </span><span class="string">"</span><span class="default">$c</span><span class="string">,</span><span class="default">$d</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 4,4<br />
</span><span class="default">?&gt;<br />
</span><br />
References with arrays<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
Array elements referencing scalar variables<br />
*/<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
</span><span class="default">$c </span><span class="keyword">= array(&amp;</span><span class="default">$a</span><span class="keyword">, &amp;</span><span class="default">$b</span><span class="keyword">);<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
echo </span><span class="string">"c: </span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]</span><span class="string">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3,4<br />
<br />
</span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">5</span><span class="keyword">;<br />
</span><span class="default">$c</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">6</span><span class="keyword">;<br />
echo </span><span class="string">"a,b: </span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 5,6<br />
<br />
/*<br />
Reference between arrays<br />
*/<br />
<br />
</span><span class="default">$d </span><span class="keyword">= array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">$e </span><span class="keyword">=&amp; </span><span class="default">$d</span><span class="keyword">;<br />
<br />
</span><span class="default">$d</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">3</span><span class="keyword">;<br />
</span><span class="default">$d</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">4</span><span class="keyword">;<br />
echo </span><span class="string">"e: </span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]</span><span class="string">,</span><span class="default">$e</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3,4<br />
<br />
</span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">5</span><span class="keyword">;<br />
</span><span class="default">$e</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">6</span><span class="keyword">;<br />
echo </span><span class="string">"d: </span><span class="default">$d</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]</span><span class="string">,</span><span class="default">$d</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 5,6<br />
<br />
</span><span class="default">$e </span><span class="keyword">= </span><span class="default">7</span><span class="keyword">;<br />
echo </span><span class="string">"d: </span><span class="default">$d</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 7 ( $d is no more an array, but an integer )<br />
<br />
/*<br />
Iterating an array of references using foreach construct<br />
*/<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
</span><span class="default">$f </span><span class="keyword">= array(&amp;</span><span class="default">$a</span><span class="keyword">,&amp;</span><span class="default">$b</span><span class="keyword">);<br />
<br />
foreach(</span><span class="default">$f </span><span class="keyword">as </span><span class="default">$x</span><span class="keyword">) </span><span class="comment">// If $x is assigned by value it doesn't change referred variables.<br />
&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
echo </span><span class="string">"a,b: </span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 1,2<br />
<br />
</span><span class="keyword">foreach(</span><span class="default">$f </span><span class="keyword">as &amp;</span><span class="default">$x</span><span class="keyword">) </span><span class="comment">// If $x is assigned by reference it changes referred variables.<br />
&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
echo </span><span class="string">"a,b: </span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3,3<br />
<br />
// Be aware that, after the loop, $x still references $f[1] and so $b<br />
</span><span class="default">$x </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
echo </span><span class="string">"a,b: </span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3,4 ( $b affected )<br />
<br />
// To avoid previous side effects it is advisable to unset x, unlinking it from $f[1] and $b<br />
</span><span class="keyword">unset(</span><span class="default">$x</span><span class="keyword">);<br />
</span><span class="default">$x </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">;<br />
echo </span><span class="string">"a,b: </span><span class="default">$a</span><span class="string">,</span><span class="default">$b</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3,4 ( $b not affected )<br />
</span><span class="default">?&gt;<br />
</span><br />
References with objects<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
Object property referencing a scalar variable<br />
*/<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$b </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br />
</span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">=&amp; </span><span class="default">$a</span><span class="keyword">;<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
echo </span><span class="string">"b-&gt;x: </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">x</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 2<br />
<br />
</span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
echo </span><span class="string">"a: </span><span class="default">$a</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3<br />
<br />
/* Reference between objects */<br />
</span><span class="default">$c </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br />
</span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$d </span><span class="keyword">=&amp; </span><span class="default">$c</span><span class="keyword">;<br />
<br />
</span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
echo </span><span class="string">"c-&gt;x: </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">x</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 2<br />
<br />
</span><span class="default">$d </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br />
</span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">y </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
echo </span><span class="string">"c-&gt;y: </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">y</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// 3<br />
</span><span class="keyword">echo </span><span class="string">"c-&gt;x: </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">x</span><span class="string">\n"</span><span class="keyword">; </span><span class="comment">// Undefined property: stdClass::$x<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122978""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#122978" class="date">26-Jul-2018 03:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Unlike in C, PHP references are not treated as pre-dereferenced pointers, but as complete aliases.<br />
<br />
The data that they are aliasing ("referencing") will not become available for garbage collection until all references to it have been removed. <br />
<br />
"Regular" variables are themselves considered references, and are not treated differently from variables assigned using =&amp; for the purposes of garbage collection.<br />
<br />
The following examples are provided for clarification.<br />
<br />
1) When treated as a variable containing a value, references behave as expected. However, they are in fact objects that *reference* the original data.<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">var = </span><span class="string">"foo"</span><span class="keyword">;<br />
</span><span class="default">$ref1 </span><span class="keyword">=&amp; </span><span class="default">$var</span><span class="keyword">; </span><span class="comment">// new object that references $var<br />
</span><span class="default">$ref2 </span><span class="keyword">=&amp; </span><span class="default">$ref1</span><span class="keyword">; </span><span class="comment">// references $var directly, not $ref1!!!!!<br />
<br />
</span><span class="keyword">echo </span><span class="default">$ref</span><span class="keyword">; </span><span class="comment">// &gt;foo<br />
<br />
</span><span class="keyword">unset(</span><span class="default">$ref</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$ref1</span><span class="keyword">; </span><span class="comment">// &gt;Notice:&nbsp; Undefined variable: ref1<br />
</span><span class="keyword">echo </span><span class="default">$ref2</span><span class="keyword">; </span><span class="comment">// &gt;foo<br />
</span><span class="keyword">echo </span><span class="default">$var</span><span class="keyword">; </span><span class="comment">// &gt;foo<br />
</span><span class="default">?&gt;<br />
</span><br />
2) When accessed via reference, the original data will not be removed until *all* references to it have been removed. This includes both references and "regular" variables assigned without the &amp; operator, and there are no distinctions made between the two for the purpose of garbage collection.<br />
<br />
<span class="default">&lt;?php <br />
$var </span><span class="keyword">= </span><span class="string">"foo"</span><span class="keyword">;<br />
</span><span class="default">$ref </span><span class="keyword">=&amp; </span><span class="default">$var</span><span class="keyword">;<br />
<br />
unset(</span><span class="default">$var</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$var</span><span class="keyword">; </span><span class="comment">// &gt;Notice:&nbsp; Undefined variable: var<br />
</span><span class="keyword">echo </span><span class="default">$ref</span><span class="keyword">; </span><span class="comment">// &gt;foo<br />
</span><span class="default">?&gt;<br />
</span><br />
3) To remove the original data without removing all references to it, simply set it to null.<br />
<br />
<span class="default">&lt;?php <br />
$var </span><span class="keyword">= </span><span class="string">"foo"</span><span class="keyword">;<br />
</span><span class="default">$ref </span><span class="keyword">=&amp; </span><span class="default">$var</span><span class="keyword">;<br />
<br />
</span><span class="default">$ref </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$var</span><span class="keyword">; </span><span class="comment">// Value is NULL, so nothing prints<br />
</span><span class="keyword">echo </span><span class="default">$ref</span><span class="keyword">; </span><span class="comment">// Value is NULL, so nothing prints<br />
</span><span class="default">?&gt;<br />
</span><br />
4) Placing data in an array also counts as adding one more reference to it, for the purposes of garbage collection.<br />
<br />
For more info, see <a href="http://php.net/manual/en/features.gc.refcounting-basics.php" rel="nofollow" target="_blank">http://php.net/manual/en/features.gc.refcounting-basics.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121734""></a>
  <div class="note">
   <strong class="user">273118949 at qq dot com</strong>
   <a href="#121734" class="date">07-Oct-2017 04:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
it just likes a person who has two different names.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120403""></a>
  <div class="note">
   <strong class="user">anon</strong>
   <a href="#120403" class="date">02-Jan-2017 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In summary, "&amp;$reference" means "do-not-copy-on-write the value here, in perpetuity". Assigning by reference is not assignment, it's "make &amp;$variable a reference and its value do-not-copy-on-write, in perpetuity, and make the variable I'm assigning to use that do-not-copy-on-write value as well".<br />
<br />
To "unreference/unalias" you have to either unset or make an explicit copy into a new variable.<br />
<br />
Object properties that are references will survive cloning and remain references. Generally the same is true with references in arrays and PHP's array functions (combine, intersect, call_user_func, func_get_args, etc).<br />
<br />
Calling a function that uses a reference parameter will *make* the supplied variable a reference. This is also true when using variadic array expansion for arguments; the supplier's array element will become a reference.<br />
<br />
Generally, don't use them unless you're dealing with low-level calls, or need an accumulator, etc. For poorly designed functions that use them, give them a copy to mangle.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
