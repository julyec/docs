<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>返回经过仿射变换后的图像，剪切区域可选</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.image2wbmp.html">? image2wbmp</a></li>
      <li style="float: right;"><a href="function.imageaffinematrixconcat.html">imageaffinematrixconcat ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD 和图像处理 函数</a></li>
    <li>返回经过仿射变换后的图像，剪切区域可选</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imageaffine" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imageaffine</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imageaffine</span> &mdash; <span class="dc-title">返回经过仿射变换后的图像，剪切区域可选</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.imageaffine-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imageaffine</strong></span>(<span class="methodparam"><span class="type"><a href="class.gdimage.html" class="type GdImage">GdImage</a></span> <code class="parameter">$image</code></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">$affine</code></span>, <span class="methodparam"><span class="type">?</span><span class="type"><span class="type">array</span><span class="type"></span></span> <code class="parameter">$clip</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type"><a href="class.gdimage.html" class="type GdImage">GdImage</a></span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">

  </p>

  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">本函数还未编写文档，仅有参数列表。</p></div>

 </div>


 <div class="refsect1 parameters" id="refsect1-function.imageaffine-parameters">
  <h3 class="title">参数</h3>
  <dl>
   <dt>

<code class="parameter">image</code></dt>
<dd>
<p class="para">由图象创建函数(例如<span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>)返回的 
<span class="classname"><a href="class.gdimage.html" class="classname">GdImage</a></span> 对象。</p></dd>

   
    <dt>
<code class="parameter">affine</code></dt>

    <dd>

     <p class="para">
      数组，其中键为 0 至 5 的数字。
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">clip</code></dt>

    <dd>

     <p class="para">
      数组，其中键为 &quot;x&quot;，&quot;y&quot;，&quot;width&quot; 和 &quot;height&quot;；或者 <strong><code>null</code></strong>。
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.imageaffine-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
    成功则返回仿射变换后的图像对象， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.imageaffine-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">clip</code> 现在允许为 null。
      </td>
     </tr>

     <tr>
      <td>8.0.0</td>
      <td>
       成功时此函数现在返回 <span class="classname"><a href="class.gdimage.html" class="classname">GDImage</a></span> 实例；之前返回 <span class="type">resource</span>。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125882""></a>
  <div class="note">
   <strong class="user">der at herrstrietzel dot de</strong>
   <a href="#125882" class="date">06-Mar-2021 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Might be an alternative or workaround for imagecopyresampled as imageaffine supports more sophisticated interpolation such as IMG_MITCHELL.<br />
<br />
// create image resource<br />
$img_path = 'test.jpg';<br />
$img = imagecreatefromstring(file_get_contents($img_path));<br />
// scale image to 50% with Mitchell interpolation <br />
$scale = 0.5;<br />
imagesetinterpolation($img, IMG_MITCHELL);<br />
$img_scaled = imageaffine($img, [0.5, 0, 0, 0.5, 0, 0]);<br />
// save image<br />
$output = 'test_scaledAffine.png';<br />
imagepng($img_scaled, $output, 9);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
echo '&lt;img src="'.$output.'" width="300"&gt;';<br />
<br />
Helper function example:<br />
<br />
function scaleImgAffine($img, $newWidth, $resized_file='', $interpolation=IMG_MITCHELL)<br />
{<br />
&nbsp;&nbsp;&nbsp; // create img resource if $img is file path <br />
&nbsp;&nbsp;&nbsp; if(!is_resource($img)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $img = imagecreatefromstring(file_get_contents($img));&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; // get original img dimensions<br />
&nbsp;&nbsp;&nbsp; $w = imagesx($img);<br />
&nbsp;&nbsp;&nbsp; $h = imagesy($img);<br />
<br />
&nbsp;&nbsp;&nbsp; /** <br />
&nbsp;&nbsp;&nbsp; * recommended interpolation method is 'IMG_MITCHELL' <br />
&nbsp;&nbsp;&nbsp; * providing the overall best precision and <br />
&nbsp;&nbsp;&nbsp; * compression for most image types <br />
&nbsp;&nbsp;&nbsp; * in particular for pngs with transparency suffering <br />
&nbsp;&nbsp;&nbsp; * from artifacted downsampling result <br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp;&nbsp; imagesetinterpolation($img, $interpolation);<br />
&nbsp;&nbsp;&nbsp; /*<br />
&nbsp;&nbsp;&nbsp; * imageaffine will scale dimensions in an anamorphic way - <br />
&nbsp;&nbsp;&nbsp; * even with square based images: <br />
&nbsp;&nbsp;&nbsp; * 1200x1200 will get something like 1199x1200<br />
&nbsp;&nbsp;&nbsp; * - improvements are very welcome<br />
&nbsp;&nbsp;&nbsp; * Workaround: Adjusting both the original width and the clip parameter <br />
&nbsp;&nbsp;&nbsp; * by adding 1px solved the issue for me<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp;&nbsp; $scale = ($newWidth+1) / $w;<br />
&nbsp;&nbsp;&nbsp; $newHeight = floor($h*$scale);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // scale by affine matrix<br />
&nbsp;&nbsp;&nbsp; $resized_affine = <br />
&nbsp;&nbsp;&nbsp; imageaffine(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $img, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; [$scale, 0, 0, $scale, 0, 0],<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ['x' =&gt; 0, 'y' =&gt; 0, 'width' =&gt; $w, 'height' =&gt; $h-1] <br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; /*<br />
&nbsp;&nbsp;&nbsp; * 'clip' parameter might be misleading as it expects <br />
&nbsp;&nbsp;&nbsp; * the original and not the final/transformed width<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // save to file or return resource<br />
&nbsp;&nbsp;&nbsp; if($resized_file){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $file_type = pathinfo($resized_file, PATHINFO_EXTENSION );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch($file_type){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case 'jpg':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case 'jpeg':&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // flatten transparency for jpgs<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmp_img = imagecreatetruecolor($newWidth, $newHeight );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $bg = imagecolorallocate($tmp_img, 255,255,255);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imagefill($tmp_img, 0, 0, $bg);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imagesavealpha($tmp_img, false);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imagealphablending($tmp_img, true);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imagecopy($tmp_img, $resized_affine, 0, 0, 0, 0, $newWidth, $newHeight );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imagejpeg($tmp_img, $resized_file, 85);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case 'png':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imagepng($resized_affine, $resized_file, 9);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $resized_affine;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
$img_scaled_affine = scaleImgAffine($img_path, 400, 'test_scaledAffine.jpg', true);<br />
<br />
IMG_MITCHELL is in particular advanced when it comes to scaling png24 with transparency in GDlib environments (... actually png31 due to gds alpha 7bit channel?). Most commonly you'll experience bad compression using png due to imperceptible artifacts after resizing.<br />
<br />
Hopefully we'll see an implementation of more advanced interpolation methods in basic GD resizing functions like imagecopyresized or imagescale.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122400""></a>
  <div class="note">
   <strong class="user">adri at sternschanze dot net</strong>
   <a href="#122400" class="date">17-Feb-2018 01:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
CORRECTION:<br />
<br />
The AFFINE ARRAY, is defined like,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ a0, b0, a1, b1, a2, b2 ];</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113960""></a>
  <div class="note">
   <strong class="user">abc at ed48 dot com</strong>
   <a href="#113960" class="date">22-Dec-2013 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example, which performs a specific processing, every time it is executed:<br />
<br />
<span class="default">&lt;?php <br />
<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'imageaffine'</span><span class="keyword">)) <br />
{ <br />
echo </span><span class="string">'FUNCTION NOT DEFINED IN THIS VERSION OF PHP'</span><span class="keyword">; <br />
exit; <br />
} <br />
<br />
</span><span class="default">$base_img </span><span class="keyword">= </span><span class="string">'affine.png'</span><span class="keyword">; <br />
<br />
</span><span class="default">$tgt_img1 </span><span class="keyword">= </span><span class="string">'triangle1.png'</span><span class="keyword">; <br />
<br />
</span><span class="default">$tgt_img2 </span><span class="keyword">= </span><span class="string">'triangle2.png'</span><span class="keyword">; <br />
<br />
</span><span class="default">$arr_affine </span><span class="keyword">= [ <br />
[ </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ </span><span class="default">1.2</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0.6</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ -</span><span class="default">1.2</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">0.6</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ </span><span class="default">1</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ </span><span class="default">2</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ </span><span class="default">cos</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), </span><span class="default">sin</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), -</span><span class="default">sin</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), </span><span class="default">cos</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">], <br />
[ </span><span class="default">cos</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), -</span><span class="default">sin</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), </span><span class="default">sin</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), </span><span class="default">cos</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">] <br />
];<br />
<br />
</span><span class="default">$RSR_base </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">400</span><span class="keyword">, </span><span class="default">300</span><span class="keyword">); <br />
</span><span class="default">$w </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">); <br />
</span><span class="default">$h </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">); <br />
<br />
</span><span class="default">$arr_clip </span><span class="keyword">= [ </span><span class="string">'x' </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">, </span><span class="string">'y' </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">, </span><span class="string">'width' </span><span class="keyword">=&gt; </span><span class="default">$w</span><span class="keyword">, </span><span class="string">'height' </span><span class="keyword">=&gt; </span><span class="default">$h </span><span class="keyword">]; <br />
<br />
</span><span class="default">$fillcolor </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">); <br />
<br />
</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">, </span><span class="default">$fillcolor</span><span class="keyword">); <br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">$base_img</span><span class="keyword">); <br />
<br />
</span><span class="default">$drawcolor </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);&nbsp; <br />
<br />
</span><span class="default">$triangle </span><span class="keyword">= [ </span><span class="default">50</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">150 </span><span class="keyword">]; <br />
</span><span class="default">$points </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">; <br />
<br />
</span><span class="default">imageantialias</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); <br />
<br />
</span><span class="default">$drawtriangle </span><span class="keyword">= </span><span class="default">imagefilledpolygon</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">$triangle</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">$drawcolor</span><span class="keyword">);<br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">$tgt_img1</span><span class="keyword">);<br />
<br />
</span><span class="default">$select </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">); <br />
<br />
</span><span class="default">$RSRaff2 </span><span class="keyword">= </span><span class="default">imageaffine</span><span class="keyword">(</span><span class="default">$RSR_base</span><span class="keyword">, </span><span class="default">$arr_affine</span><span class="keyword">[</span><span class="default">$select</span><span class="keyword">], </span><span class="default">$arr_clip</span><span class="keyword">); <br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$RSRaff2</span><span class="keyword">, </span><span class="default">$tgt_img2</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">); <br />
<br />
</span><span class="default">?&gt;</span> <br />
<br />
SUPPORT IMAGE&lt;br&gt;&lt;br&gt; <br />
&lt;img src="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$base_img</span><span class="keyword">; </span><span class="default">?&gt;</span>" alt="*" /&gt;&lt;br&gt;&lt;br&gt; <br />
<br />
BASE IMAGE&lt;br&gt;&lt;br&gt; <br />
&lt;img src="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$tgt_img1</span><span class="keyword">; </span><span class="default">?&gt;</span>" alt="*" /&gt;&lt;br&gt;&lt;br&gt; <br />
<br />
RESULT IMAGE&lt;br&gt;&lt;br&gt; <br />
&lt;img src="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$tgt_img2</span><span class="keyword">; </span><span class="default">?&gt;</span>" alt="*" /&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113959""></a>
  <div class="note">
   <strong class="user">abc at ed48 dot com</strong>
   <a href="#113959" class="date">22-Dec-2013 05:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
correcting:<br />
<br />
c ) SCALE,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ M, 0, N, 1, 0, 0 ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = Mx + 0y + 0 = Mx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = 0x + Ny = 0 = Ny<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Each point will stretch or compress its path, horizontally or vertically, according M and N; negative or positive values.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113958""></a>
  <div class="note">
   <strong class="user">abc at  ed48 dot com</strong>
   <a href="#113958" class="date">22-Dec-2013 04:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
AFFINE is a geometric transformation operation involving MATRICES, covering both, 2D and 3D environment.<br />
Transformations are often used in linear algebra and computer graphics.<br />
<br />
In geometric transformations of images, the pixel coordinate is mapped.<br />
<br />
This means that, each pixel is localized by two coordinates, in the rectangular domain of the image.<br />
Without going into more details about pixel mapping, let's get to what really matters: the AFFINE transformations.<br />
There are several classes of pixel mapping, one is called "affine".<br />
Affine transformations include: scaling, rotation, shearing and translation.<br />
<br />
PHP 5.5.0+, like "libart", uses ARRAYS of six floating-point elements to do the job.<br />
<br />
The AFFINE ARRAY, is defined like, <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ a0, a1, b0, b1, a2, b2 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; where, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; a0, a1, b0, b1, a2, b2 are floating-point values.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; represented by equations,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = a0x + a1y + a2<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = b0x + b1y + b2<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
a ) IDENTITY, no change made in the path of points,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ 1, 0, 0, 1, 0, 0 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = 1x + 0y + 0 = x<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = 0x + 1y = 0 = y<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
b ) TRANSLATION,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ 1, 0, 0, 1, H, V ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = 1x + 0y + H = x + H<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = 0x + 1y = V = y + V<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Each point is moved H units horizontaly and V units verticaly.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
c ) SCALE,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ i, 0, j, 1, 0, 0 ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = Mx + 0y + 0 = Mx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = 0x + Ny = 0 = Ny<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Each point will stretch or compress its path, horizontally or vertically, according M and N; negative or positive values.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
d ) SHEARING, parallel to x axis,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ 1, K, 0, 1, 0, 0 ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = 1x + Ky + 0 = x + Ky<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = 0x + 1y = 0 = y<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; SHEARING, parallel to y axis,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ K, 0, 0, 1, 0, 0 ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' = 1x + 0y + 0 = x<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = Kx + 1y = 0 = y + Kx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
e ) ROTATION, clockwise,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ cos ?, sin ?, -sin ?, cos ?, 0, 0 ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' =&nbsp; x cos ? + y sin ? + 0 = x cos ? + y sin ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = -x sin ? + y cos ? = 0 = y cos ? - x sin ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; ROTATION, conterclockwise,<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $affine = [ cos ?, -sin ?, sin ?, cos ?, 0, 0 ];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; equations remapping,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; x' =&nbsp; x cos ? - y sin ? + 0 = x cos ? - y sin ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; y' = x sin ? + y cos ? = 0 = y sin ? - x cos ?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
