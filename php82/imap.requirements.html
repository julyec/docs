<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>需求</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imap.setup.html">? 安装/配置</a></li>
      <li style="float: right;"><a href="imap.installation.html">安装 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="imap.setup.html">安装/配置</a></li>
    <li>需求</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imap.requirements" class="section">
  <h2 class="title">需求</h2>
  <p class="para">
   This extension requires the c-client library to be installed.
   Grab the latest version from <a href="https://github.com/uw-imap/imap" class="link external" title="Link : https://github.com/uw-imap/imap">&raquo;&nbsp;https://github.com/uw-imap/imap</a>
   and compile it.
  </p>
  <p class="para">
   It&#039;s important that you do not copy the IMAP source files directly into
   the system include directory as there may be conflicts.  Instead, create
   a new directory inside the system include directory, such as 
   <var class="filename">/usr/local/imap-2000b/</var> (location and name
   depend on your setup and IMAP version), and inside this new 
   directory create additional directories named <var class="filename">lib/</var> 
   and <var class="filename">include/</var>.  From the <var class="filename">c-client</var> 
   directory from your IMAP source tree, copy all the <var class="filename">*.h</var> 
   files into <var class="filename">include/</var> and all the 
   <var class="filename">*.c</var> files into <var class="filename">lib/</var>.  
   Additionally when you compiled IMAP, a file named
   <var class="filename">c-client.a</var> was created.  Also put this in the 
   <var class="filename">lib/</var> directory but rename it as
   <var class="filename">libc-client.a</var>.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    To build the c-client library with SSL or/and Kerberos support read
    the docs supplied with the package.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    In Mandrake Linux, the IMAP library (<var class="filename">libc-client.a</var>)
    is compiled without Kerberos support. A separate version with SSL
    (<var class="filename">client-PHP4.a</var>) is installed. The library must
    be recompiled in order to add Kerberos support.
   </span>
  </p></blockquote>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="127695""></a>
  <div class="note">
   <strong class="user">obeco</strong>
   <a href="#127695" class="date">06-Oct-2022 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
php-imap package is not available neither in Red Hat Enterprise Linux 7 nor 8.<br />
<br />
To compile the extension yourself:<br />
<br />
Prerequisites<br />
# yum install pam-devel openssl-devel<br />
<br />
Follow steps 2 and 3 from the previous post of "ldi at email dot cz"<br />
<br />
Download the c-client library from github, you can see the link at the top of the page and compile with:<br />
# make lr5 SSLINCLUDE=/usr/include/openssl/ EXTRACFLAGS=-fPIC<br />
(if you are using another distro, instead of lr5 you will type something else, you can view the Makefile for other unix flavors)<br />
<br />
Follow step 5 from the previous post of "ldi at email dot cz" which is what the second paragraph at the top of the page explains.<br />
<br />
Download the PHP source code of the version installed in your system and go to the php/ext/imap folder.<br />
<br />
# phpize<br />
(If you installed the PHP packages from the Red Hat Software Collections you must run the following command before to set the enviroment eg: scl enable rh-php73 bash)<br />
<br />
# ./configure --with-imap=&lt;&lt;path_to_where_you_unpacked_the_c-client_library_and_compiled_it&gt;&gt; --with-imap-ssl<br />
<br />
# make<br />
<br />
This creates the file php/ext/imap/modules/imap.so :)<br />
Copy it to your extension_dir (you can find it in the phpinfo() page).<br />
Create an .ini file in the php.d folder with the text: extension=imap.so<br />
<br />
Restart apache and be happy.<br />
<br />
P.S. You could probably find the extension compiled out there but who knows the trustiness of the source so better to get the official unaltered sources.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123714""></a>
  <div class="note">
   <strong class="user">allan at umich dot edu</strong>
   <a href="#123714" class="date">21-Mar-2019 07:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that the source code archives at the University of Washington, and the mirrors, have been dead for some time.<br />
<br />
There is a github repository located here: https://github.com/uw-imap/imap</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116601""></a>
  <div class="note">
   <strong class="user">jameslandrok at gmail dot com</strong>
   <a href="#116601" class="date">27-Jan-2015 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A more secure &amp; easy way to do this on Debian 7.7, php 5.4:<br />
<br />
apt-get install php5-imap<br />
<br />
Packages installed<br />
&nbsp; libc-client2007e mlock php5-imap</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113177""></a>
  <div class="note">
   <strong class="user">crabb1d at gmail dot com</strong>
   <a href="#113177" class="date">09-Sep-2013 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those using Ubuntu and who are completely daunted by compiling this, it's easy under Ubuntu:<br />
<br />
Install libc-client-dev<br />
# sudo apt-get install libc-client-dev<br />
<br />
Install PHP5 imap:<br />
# sudo apt-get install php5-imap<br />
<br />
Restart Apache<br />
# sudo service apache2 reload<br />
<br />
Should work for most people.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112758""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#112758" class="date">19-Jul-2013 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When compiling IMAP 2007f with php 5.3.27 on a 64 bit OL5.7 machine, add in the Makefile: EXTRACFLAGS=-fPIC and EXTRAAUTHENTICATORS=gss</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106032""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#106032" class="date">04-Oct-2011 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When compiling IMAP on a 64 bit machine, use: make EXTRACFLAGS=-fPIC.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99221""></a>
  <div class="note">
   <strong class="user">ldi at email dot cz</strong>
   <a href="#99221" class="date">04-Aug-2010 10:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After few hours of testing it on CentOS 5 64 bit I'd like to share the steps required to compile imap with php:<br />
<br />
1. Install openssl:<br />
<br />
&nbsp;&nbsp; yum install openssl openssl-devel<br />
<br />
2. If you don't have openssl compiled and installed in /usr/local/ssl create symlink:<br />
<br />
&nbsp;&nbsp; ln -s /usr/lib64/openssl/engines/ /usr/local/ssl<br />
<br />
3. Add the libraries:<br />
<br />
&nbsp;&nbsp; ln -s /usr/include/ /usr/local/ssl/include<br />
<br />
4. Compile IMAP<br />
<br />
&nbsp; cd /path/to/imap_src<br />
&nbsp; make lnp SSLTYPE=unix<br />
<br />
5. Copy files as described above<br />
&nbsp;mkdir lib<br />
&nbsp;mkdir include<br />
&nbsp;cp c-client/*.c lib/<br />
&nbsp;cp c-client/*.h include/<br />
&nbsp;cp c-client/c-client.a lib/libc-client.a<br />
&nbsp;<br />
6. Compile PHP<br />
&nbsp; cd /path/to/php/src<br />
&nbsp; ./configure --with-imap=/path/to/imap_src --with-libdir=lib64</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98727""></a>
  <div class="note">
   <strong class="user">Nick</strong>
   <a href="#98727" class="date">02-Jul-2010 10:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you run into an error similar to the following when compiling / making PHP:<br />
<br />
errno 0x21c /usr/local/imap-2007e/lib/libc-client.a(netmsg.o)<br />
ld: fatal: relocations remain against allocatable but non-writable sections<br />
make: Fatal error: Command failed for target `libphp5.la'<br />
<br />
You need to recompile the IMAP library and add -fpic or -fPIC to your CFLAGS.<br />
<br />
See:<br />
<a href="http://bugs.php.net/bug.php?id=35465" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=35465</a><br />
<br />
Also, if you compiled OpenSSL from source, you'll need to do the same, as you'll get error messages for libc-client.a</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96810""></a>
  <div class="note">
   <strong class="user">eelco at care dot nl</strong>
   <a href="#96810" class="date">17-Mar-2010 02:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Spent hours and hours on compiling PHP with IMAP support on CentOS 64-bit but after many trial and error sessions I got if fixed.<br />
<br />
If you have set the '--with-libdir=lib64' flag and you encounter the the 'cannot find the c-client library' error while compiling, try to create a symlink 'lib64' to 'lib' in your imap installation dir.<br />
<br />
Apparantly, PHP will search only in lib64 directories if the flag is set. This also applies on the IMAP library but documentation lacks on this point.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
