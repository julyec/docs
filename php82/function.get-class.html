<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>返回对象的类名</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.get-class-vars.html">? get_class_vars</a></li>
      <li style="float: right;"><a href="function.get-declared-classes.html">get_declared_classes ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.classobj.html">类/对象 函数</a></li>
    <li>返回对象的类名</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.get-class" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">get_class</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">get_class</span> &mdash; <span class="dc-title">返回对象的类名</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.get-class-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>get_class</strong></span>(<span class="methodparam"><span class="type">object</span> <code class="parameter">$object</code><span class="initializer"> = ?</span></span>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   返回指定 <code class="parameter">object</code> 的类名。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.get-class-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">object</code></dt>

     <dd>

      <p class="para">
       要测试的对象。如果在类里，此参数可以省略。
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       <span class="simpara">
        自 PHP 7.2.0 起，<code class="parameter">object</code> 不再允许显式传递 <strong><code>null</code></strong>
        并抛出 <strong><code>E_WARNING</code></strong>。自 PHP 8.0.0 起，传递 <strong><code>null</code></strong>
        会抛出 <span class="classname"><a href="class.typeerror.html" class="classname">TypeError</a></span>。
       </span>
      </p></blockquote>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.get-class-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回 <code class="parameter">object</code>
   实例的类名。
  </p>
  <p class="para">
   如果在类中省略 <code class="parameter">object</code>，
   则返回当前所在类的名称。
  </p>
  <p class="para">
    如果 <code class="parameter">object</code> 是命名空间中某个类的实例，则会返回带上命名空间的类名。
  </p>
 </div>

 <div class="refsect1 errors" id="refsect1-function.get-class-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   如果用除对象外的其它类型调用 <span class="function"><strong>get_class()</strong></span>，则会抛出
   <span class="classname"><a href="class.typeerror.html" class="classname">TypeError</a></span>。在 PHP 8.0.0 之前，会引发
   <strong><code>E_WARNING</code></strong> 级别的错误。
  </p>
  <p class="para">
   如果在类外不带任何参数调用 <span class="function"><strong>get_class()</strong></span>，会抛出
   <span class="classname"><a href="class.error.html" class="classname">Error</a></span>。在 PHP 8.0.0 之前，会引发
   <strong><code>E_WARNING</code></strong> 级别的错误。
  </p>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.get-class-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>8.0.0</td>
       <td>
        在类外不带任何参数调用此函数将会抛出 <span class="classname"><a href="class.error.html" class="classname">Error</a></span>。之前会引发
        <strong><code>E_WARNING</code></strong> 并且函数会返回 <strong><code>false</code></strong>。
       </td>
      </tr>

      <tr>
       <td>7.2.0</td>
       <td>
        在此版本之前，<code class="parameter">object</code> 的默认值是 
        <strong><code>null</code></strong>，它与不传递任何值有相同的效果。<code class="parameter">object</code>
        已经移除了默认值 <strong><code>null</code></strong> 且不再是有效的输入。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.get-class-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 使用 <span class="function"><strong>get_class()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class </span><span style="color: #0000BB">foo </span><span style="color: #007700">{<br />    function </span><span style="color: #0000BB">name</span><span style="color: #007700">()<br />    {<br />        echo </span><span style="color: #DD0000">"My name is " </span><span style="color: #007700">, </span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">) , </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />    }<br />}<br /><br /></span><span style="color: #FF8000">// 创建对象<br /></span><span style="color: #0000BB">$bar </span><span style="color: #007700">= new </span><span style="color: #0000BB">foo</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// 类外调用<br /></span><span style="color: #007700">echo </span><span style="color: #DD0000">"Its name is " </span><span style="color: #007700">, </span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">$bar</span><span style="color: #007700">) , </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// 类内调用<br /></span><span style="color: #0000BB">$bar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Its name is foo
My name is foo
</pre></div>
    </div>
   </div>
   <div class="example" id="">
    <p><strong>Example #2 父类中使用 <span class="function"><strong>get_class()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">abstract class </span><span style="color: #0000BB">bar </span><span style="color: #007700">{<br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">()<br />    {<br />        </span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">));<br />        </span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">get_class</span><span style="color: #007700">());<br />    }<br />}<br /><br />class </span><span style="color: #0000BB">foo </span><span style="color: #007700">extends </span><span style="color: #0000BB">bar </span><span style="color: #007700">{<br />}<br /><br />new </span><span style="color: #0000BB">foo</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(3) &quot;foo&quot;
string(3) &quot;bar&quot;
</pre></div>
    </div>
   </div>
   <div class="example" id="">
    <p><strong>Example #3 命名空间中的类中使用 <span class="function"><strong>get_class()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">namespace </span><span style="color: #0000BB">Foo\Bar</span><span style="color: #007700">;<br /><br />class </span><span style="color: #0000BB">Baz </span><span style="color: #007700">{<br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">()<br />    {<br /><br />    }<br />}<br /><br /></span><span style="color: #0000BB">$baz </span><span style="color: #007700">= new </span><span style="color: #0000BB">\Foo\Bar\Baz</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">get_class</span><span style="color: #007700">(</span><span style="color: #0000BB">$baz</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(11) &quot;Foo\Bar\Baz&quot;
</pre></div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.get-class-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.get-called-class.html" class="function" rel="rdfs-seeAlso">get_called_class()</a> - 后期静态绑定（&quot;Late Static Binding&quot;）类的名称</span></li>
    <li class="member"><span class="function"><a href="function.get-parent-class.html" class="function" rel="rdfs-seeAlso">get_parent_class()</a> - 检索对象或者类的父级类名</span></li>
    <li class="member"><span class="function"><a href="function.gettype.html" class="function" rel="rdfs-seeAlso">gettype()</a> - 获取变量的类型</span></li>
    <li class="member"><span class="function"><a href="function.get-debug-type.html" class="function" rel="rdfs-seeAlso">get_debug_type()</a> - Gets the type name of a variable in a way that is suitable for debugging</span></li>
    <li class="member"><span class="function"><a href="function.is-subclass-of.html" class="function" rel="rdfs-seeAlso">is_subclass_of()</a> - 检查对象是否继承或者实现（implement）此类</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="126144""></a>
  <div class="note">
   <strong class="user">davidsch</strong>
   <a href="#126144" class="date">07-Jun-2021 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There are discussions below regarding how to create a singleton that allows subclassing. It seems with get_called_class&nbsp; there is now a cleaner solution than what is discussed below, that does not require overriding a method per subclass.<br />
<br />
e.g.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">MySuperclass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; static private </span><span class="default">$instances </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; static public function </span><span class="default">getInstance</span><span class="keyword">(): </span><span class="default">ACFBlock </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$className </span><span class="keyword">= </span><span class="default">get_called_class</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$className</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$className</span><span class="keyword">] = new static();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$className</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Singleton<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">}<br />
}<br />
<br />
class </span><span class="default">MySubclass </span><span class="keyword">extends </span><span class="default">MySuperclass </span><span class="keyword">{<br />
}<br />
<br />
</span><span class="default">MySubclass</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121744""></a>
  <div class="note">
   <strong class="user">kiril (AT) aternus networks</strong>
   <a href="#121744" class="date">10-Oct-2017 09:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want the Class Name without the Namespace or if you've got here because basename() returns a dot (.) for the FQCN (Fully Qualified Class Name), here is the solution:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// FQCN: App\Http\Controllers\CustomerReportController<br />
<br />
</span><span class="default">substr</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::class, (int)</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::class, </span><span class="string">'\\'</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">)<br />
<br />
</span><span class="comment">// returns: CustomerReportController<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121681""></a>
  <div class="note">
   <strong class="user">Hayley Watson</strong>
   <a href="#121681" class="date">24-Sep-2017 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Although you can call a class's static methods from an instance of the class as though they were object instance methods, it's nice to know that, since classes are represented in PHP code by their names as strings, the same thing goes for the return value of get_class():<br />
<br />
<span class="default">&lt;?php<br />
$t</span><span class="keyword">-&gt;</span><span class="default">Faculty</span><span class="keyword">();<br />
</span><span class="default">SomeClass</span><span class="keyword">::</span><span class="default">Faculty</span><span class="keyword">(); </span><span class="comment">// $t instanceof SomeClass<br />
</span><span class="string">"SomeClass"</span><span class="keyword">::</span><span class="default">Faculty</span><span class="keyword">();<br />
</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">)::</span><span class="default">Faculty</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
The first is legitimate, but the last makes it clear to someone reading it that Faculty() is a static method (because the name of the method certainly doesn't).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120347""></a>
  <div class="note">
   <strong class="user">dense</strong>
   <a href="#120347" class="date">17-Dec-2016 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
well, if you call&nbsp; get_class() on an aliased class, you will get the original class name<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Person </span><span class="keyword">{}<br />
<br />
</span><span class="default">class_alias</span><span class="keyword">(</span><span class="string">'Person'</span><span class="keyword">, </span><span class="string">'User'</span><span class="keyword">);<br />
<br />
</span><span class="default">$me </span><span class="keyword">= new </span><span class="default">User</span><span class="keyword">;<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$me</span><span class="keyword">) ); </span><span class="comment">// 'Person'<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120233""></a>
  <div class="note">
   <strong class="user">XyQrTw</strong>
   <a href="#120233" class="date">28-Nov-2016 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get class name without the Namespace you can use easily this trick :<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace </span><span class="default">My\Long\Namespace</span><span class="keyword">;<br />
<br />
class </span><span class="default">MyClass </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; static function </span><span class="default">getClassName</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">basename</span><span class="keyword">(</span><span class="default">__CLASS__</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// or with get_class();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">basename</span><span class="keyword">(</span><span class="default">get_class</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
echo </span><span class="default">\My\Long\Namespace\MyClass</span><span class="keyword">::</span><span class="default">getClassName</span><span class="keyword">(); </span><span class="comment">// Display : MyClass<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116364""></a>
  <div class="note">
   <strong class="user">RQuadling at GMail dot com</strong>
   <a href="#116364" class="date">19-Dec-2014 03:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With regard to getting the class name from a namespaced class name, then using basename() seems to do the trick quite nicely.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace </span><span class="default">Foo\Bar</span><span class="keyword">;<br />
<br />
abstract class </span><span class="default">Baz<br />
</span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">report</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'__CLASS__&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="keyword">, </span><span class="default">__CLASS__</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="default">basename</span><span class="keyword">(</span><span class="default">__CLASS__</span><span class="keyword">), </span><span class="default">PHP_EOL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'get_called_class '</span><span class="keyword">, </span><span class="default">get_called_class</span><span class="keyword">(), </span><span class="string">' '</span><span class="keyword">, </span><span class="default">basename</span><span class="keyword">(</span><span class="default">get_called_class</span><span class="keyword">()), </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Snafu </span><span class="keyword">extends </span><span class="default">Baz<br />
</span><span class="keyword">{<br />
}<br />
<br />
(new </span><span class="default">Snafu</span><span class="keyword">)-&gt;</span><span class="default">report</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
produces output of ...<br />
<br />
__CLASS__&nbsp; &nbsp; &nbsp; &nbsp; Foo\Bar\Baz&nbsp;&nbsp; Baz<br />
get_called_class Foo\Bar\Snafu Snafu</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115849""></a>
  <div class="note">
   <strong class="user">jjanak at webperfection dot net</strong>
   <a href="#115849" class="date">03-Oct-2014 11:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&gt;= 5.5<br />
<br />
::class<br />
fully qualified class name, instead of get_class<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace </span><span class="default">my\library\mvc</span><span class="keyword">;<br />
<br />
class </span><span class="default">Dispatcher </span><span class="keyword">{}<br />
<br />
print </span><span class="default">Dispatcher</span><span class="keyword">::class; </span><span class="comment">// FQN == my\library\mvc\Dispatcher<br />
<br />
</span><span class="default">$disp </span><span class="keyword">= new </span><span class="default">Dispatcher</span><span class="keyword">;<br />
<br />
print </span><span class="default">$disp</span><span class="keyword">::class; </span><span class="comment">// parse error</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115763""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#115763" class="date">18-Sep-2014 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want the path to an file if you have i file structure like this<br />
<br />
project -&gt; system -&gt; libs -&gt; controller.php<br />
project -&gt; system -&gt; modules -&gt; foo -&gt; foo.php<br />
<br />
and foo() in foo.php extends controller() in controller.php like this<br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="keyword">namespace </span><span class="default">system\modules\foo</span><span class="keyword">;<br />
<br />
class </span><span class="default">foo </span><span class="keyword">extends </span><span class="default">\system\libs\controller </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
and you want to know the path to foo.php in controller() this may help you<br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="keyword">namespace </span><span class="default">system\libs</span><span class="keyword">;<br />
<br />
class </span><span class="default">controller </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getChildPath</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">getChildPath</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?PHP<br />
$f </span><span class="keyword">= new </span><span class="default">foo</span><span class="keyword">();&nbsp; </span><span class="comment">// system\modules\foo<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115623""></a>
  <div class="note">
   <strong class="user">var23rav at gmail dot com</strong>
   <a href="#115623" class="date">27-Aug-2014 01:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
class A<br />
{<br />
function __construct(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //parent::__construct();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor A: '.get_class();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor A:- argument = $this: '.get_class($this);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor A-parent: '.get_parent_class();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor A-parent:- argument =&nbsp; $this: '.get_parent_class($this);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class B extends A<br />
{<br />
function __construct(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; parent::__construct();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor B: '.get_class();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor B:- argument =&nbsp; $this: '.get_class($this);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor B-parent: '.get_parent_class();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $this-&gt;m =&nbsp; 'From constructor B-parent:- argument =&nbsp; $this: '.get_parent_class($this);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
$b = new B();<br />
//----------------output--------------------<br />
<br />
From constructor A: A<br />
From constructor A:- argument = $this: B<br />
From constructor A-parent: <br />
From constructor A-parent:- argument = $this: A<br />
From constructor B: B<br />
From constructor B:- argument = $this: B<br />
From constructor B-parent: A<br />
From constructor B-parent:- argument = $this: A<br />
<br />
Use get_class() to get the name of class&nbsp; ,it will help you get the class name, in case you extend that class with another class and want to get the name of the class to which object is instance of user get_class($object)<br />
<br />
when you create an object of class{$b object of B} which has a super class{Class A}. <br />
uses these code IN Super Class {A} <br />
--------------------------------------------<br />
to get class name B{object instance} :&nbsp; get_class($this)&nbsp; <br />
to get class name A{super class}&nbsp; : get_class() or get_parent_class($this)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114568""></a>
  <div class="note">
   <strong class="user">dave at shax dot com</strong>
   <a href="#114568" class="date">06-Mar-2014 04:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A lot of people in other comments wanting to get the classname without the namespace. Some weird suggestions of code to do that - not what I would've written! So wanted to add my own way.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">get_class_name</span><span class="keyword">(</span><span class="default">$classname</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$classname</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">)) return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$classname</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$pos</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Also did some quick benchmarking, and strrpos() was the fastest too. Micro-optimisations = macro optimisations!<br />
<br />
39.0954 ms - preg_match()<br />
28.6305 ms - explode() + end()<br />
20.3314 ms - strrpos()<br />
<br />
(For reference, here's the debug code used. c() is a benchmarking function that runs each closure run 10,000 times.)<br />
<br />
<span class="default">&lt;?php<br />
c</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; function(</span><span class="default">$class </span><span class="keyword">= </span><span class="string">'a\b\C'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\\\\([\w]+)$/'</span><span class="keyword">, </span><span class="default">$class</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) return </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$class</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; },<br />
&nbsp;&nbsp;&nbsp; function(</span><span class="default">$class </span><span class="keyword">= </span><span class="string">'a\b\C'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bits </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">$class</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">end</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; },<br />
&nbsp;&nbsp;&nbsp; function(</span><span class="default">$class </span><span class="keyword">= </span><span class="string">'a\b\C'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">)) return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$pos</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113947""></a>
  <div class="note">
   <strong class="user">Nanhe Kumar</strong>
   <a href="#113947" class="date">20-Dec-2013 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Parent</span><span class="keyword">{<br />
}<br />
class </span><span class="default">Child </span><span class="keyword">extends </span><span class="default">Parent</span><span class="keyword">{&nbsp; &nbsp; <br />
}<br />
</span><span class="default">$c </span><span class="keyword">= new </span><span class="default">Child</span><span class="keyword">();<br />
echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) </span><span class="comment">//Child<br />
</span><span class="default">?&gt;<br />
&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Parent</span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">getClass</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; echo </span><span class="default">get_class</span><span class="keyword">(); <br />
&nbsp; }<br />
}<br />
class </span><span class="default">Child </span><span class="keyword">extends </span><span class="default">Parent</span><span class="keyword">{<br />
}<br />
</span><span class="default">$obj </span><span class="keyword">= new </span><span class="default">Child</span><span class="keyword">();<br />
</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">getClass</span><span class="keyword">(); </span><span class="comment">//outputs Parent<br />
</span><span class="default">?&gt;<br />
&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Parent</span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">getClass</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">); <br />
&nbsp; }<br />
}<br />
class </span><span class="default">Child </span><span class="keyword">extends </span><span class="default">Parent</span><span class="keyword">{<br />
}<br />
</span><span class="default">$obj </span><span class="keyword">= new </span><span class="default">Child</span><span class="keyword">();<br />
</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">getClass</span><span class="keyword">(); </span><span class="comment">// Parent<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112159""></a>
  <div class="note">
   <strong class="user">emmanuel dot antico at gmail dot com</strong>
   <a href="#112159" class="date">10-May-2013 07:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
/**<br />
&nbsp;* Obtains an object class name without namespaces<br />
&nbsp;*/<br />
function get_real_class($obj) {<br />
&nbsp;&nbsp;&nbsp; $classname = get_class($obj);<br />
<br />
&nbsp;&nbsp;&nbsp; if (preg_match('@\\\\([\w]+)$@', $classname, $matches)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $classname = $matches[1];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $classname;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107964""></a>
  <div class="note">
   <strong class="user">macnimble at gmail dot com</strong>
   <a href="#107964" class="date">17-Mar-2012 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Need a quick way to parse the name of a class when it's namespaced? Try this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace </span><span class="default">Engine</span><span class="keyword">;<br />
function </span><span class="default">parse_classname </span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">)<br />
{<br />
&nbsp; return array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'namespace' </span><span class="keyword">=&gt; </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">),<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'classname' </span><span class="keyword">=&gt; </span><span class="default">join</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">), -</span><span class="default">1</span><span class="keyword">)),<br />
&nbsp; );<br />
}<br />
final class </span><span class="default">Kernel<br />
</span><span class="keyword">{<br />
&nbsp; final public function </span><span class="default">__construct </span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">, </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parse_classname</span><span class="keyword">(</span><span class="default">__CLASS__</span><span class="keyword">),</span><span class="default">1</span><span class="keyword">), </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Or this for a one-line method to get just the classname:<br />
&nbsp;&nbsp;&nbsp; // echo join('', array_slice(explode('\\', __CLASS__), -1));<br />
&nbsp; </span><span class="keyword">}<br />
}<br />
new </span><span class="default">Kernel</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [namespace] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; Engine<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [classname] =&gt; Kernel<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106794""></a>
  <div class="note">
   <strong class="user">mail dot temc at gmail dot com</strong>
   <a href="#106794" class="date">06-Dec-2011 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
People seem to mix up what __METHOD__, get_class($obj) and get_class() do, related to class inheritance.
<br />

<br />
Here's a good example that should fix that for ever:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{
<br />
&nbsp;function </span><span class="default">doMethod</span><span class="keyword">(){
<br />
&nbsp; echo </span><span class="default">__METHOD__ </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;}
<br />
&nbsp;function </span><span class="default">doGetClassThis</span><span class="keyword">(){
<br />
&nbsp; echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">).</span><span class="string">'::doThat' </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;}
<br />
&nbsp;function </span><span class="default">doGetClass</span><span class="keyword">(){
<br />
&nbsp; echo </span><span class="default">get_class</span><span class="keyword">().</span><span class="string">'::doThat' </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;}
<br />
}
<br />

<br />
class </span><span class="default">Bar </span><span class="keyword">extends </span><span class="default">Foo </span><span class="keyword">{
<br />

<br />
}
<br />

<br />
class </span><span class="default">Quux </span><span class="keyword">extends </span><span class="default">Bar </span><span class="keyword">{
<br />
&nbsp;function </span><span class="default">doMethod</span><span class="keyword">(){
<br />
&nbsp; echo </span><span class="default">__METHOD__ </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;}
<br />
&nbsp;function </span><span class="default">doGetClassThis</span><span class="keyword">(){
<br />
&nbsp; echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">).</span><span class="string">'::doThat' </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;}
<br />
&nbsp;function </span><span class="default">doGetClass</span><span class="keyword">(){
<br />
&nbsp; echo </span><span class="default">get_class</span><span class="keyword">().</span><span class="string">'::doThat' </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;}
<br />
}
<br />

<br />
</span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();
<br />
</span><span class="default">$bar </span><span class="keyword">= new </span><span class="default">Bar</span><span class="keyword">();
<br />
</span><span class="default">$quux </span><span class="keyword">= new </span><span class="default">Quux</span><span class="keyword">();
<br />

<br />
echo </span><span class="string">"\n--doMethod--\n"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">doMethod</span><span class="keyword">();
<br />
</span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">doMethod</span><span class="keyword">();
<br />
</span><span class="default">$quux</span><span class="keyword">-&gt;</span><span class="default">doMethod</span><span class="keyword">();
<br />

<br />
echo </span><span class="string">"\n--doGetClassThis--\n"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">doGetClassThis</span><span class="keyword">();
<br />
</span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">doGetClassThis</span><span class="keyword">();
<br />
</span><span class="default">$quux</span><span class="keyword">-&gt;</span><span class="default">doGetClassThis</span><span class="keyword">();
<br />

<br />
echo </span><span class="string">"\n--doGetClass--\n"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">doGetClass</span><span class="keyword">();
<br />
</span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">doGetClass</span><span class="keyword">();
<br />
</span><span class="default">$quux</span><span class="keyword">-&gt;</span><span class="default">doGetClass</span><span class="keyword">();
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
OUTPUT:
<br />

<br />
--doMethod--
<br />
Foo::doMethod
<br />
Foo::doMethod
<br />
Quux::doMethod
<br />

<br />
--doGetClassThis--
<br />
Foo::doThat
<br />
Bar::doThat
<br />
Quux::doThat
<br />

<br />
--doGetClass--
<br />
Foo::doThat
<br />
Foo::doThat
<br />
Quux::doThat</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106686""></a>
  <div class="note">
   <strong class="user">ozana at omdesign dot cz</strong>
   <a href="#106686" class="date">28-Nov-2011 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simplest way how to gets Class without namespace
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">namespace </span><span class="default">a\b\c\d\e\f</span><span class="keyword">;
<br />

<br />
class </span><span class="default">Foo </span><span class="keyword">{
<br />

<br />
&nbsp; public function </span><span class="default">__toString</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">__CLASS__</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">end</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">);
<br />
&nbsp; }
<br />
}
<br />

<br />
echo new </span><span class="default">Foo</span><span class="keyword">(); </span><span class="comment">// prints Foo
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106368""></a>
  <div class="note">
   <strong class="user">Michael Richey</strong>
   <a href="#106368" class="date">31-Oct-2011 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Attempting various singleton base class methods described on this page, I have created a base class and bridge function that allows it to work without get_called_class() if it's not available.&nbsp; Unlike other methods listed here, I chose not to prevent use of __construct() or __clone().
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton </span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$m_pInstance</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; final public static function </span><span class="default">getInstance</span><span class="keyword">(){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= static::</span><span class="default">getClass</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!isset(static::</span><span class="default">$m_pInstance</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$m_pInstance</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">] = new </span><span class="default">$class</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::</span><span class="default">$m_pInstance</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; final public static function </span><span class="default">getClass</span><span class="keyword">(){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">get_called_class</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
</span><span class="comment">// I don't remember where I found this, but this is to allow php &lt; 5.3 to use this method.
<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_called_class'</span><span class="keyword">)) {
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">get_called_class</span><span class="keyword">(</span><span class="default">$bt </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$l </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$bt</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">]))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Cannot find called class -&gt; stack level too deep."</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'type'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'type not set'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'type'</span><span class="keyword">]) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'::'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$callerLine </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; do {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$callerLine </span><span class="keyword">= </span><span class="default">$lines</span><span class="keyword">[</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">] - </span><span class="default">$i</span><span class="keyword">] . </span><span class="default">$callerLine</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } while (</span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$callerLine</span><span class="keyword">, </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">]) === </span><span class="default">false</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/([a-zA-Z0-9\_]+)::' </span><span class="keyword">. </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">] . </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$callerLine</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// must be an edge case.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Could not find caller class: originating method call is obscured."</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'self'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'parent'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">get_called_class</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">, </span><span class="default">$l </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// won't get here.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">'-&gt;'</span><span class="keyword">: switch (</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">]) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'__get'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// edge case -&gt; get class of calling object
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'object'</span><span class="keyword">]))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Edge case fail. __get called on non object."</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'object'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default: return </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$l</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default: throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Unknown backtrace method type"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{
<br />
}
<br />

<br />
class </span><span class="default">C </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{
<br />
}
<br />

<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">B</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();
<br />
echo </span><span class="string">'class: '</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);
<br />

<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;
<br />

<br />
</span><span class="default">$c </span><span class="keyword">= </span><span class="default">C</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();
<br />
echo echo </span><span class="string">'class: '</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>This returns:
<br />
class: b
<br />
class: c</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101272""></a>
  <div class="note">
   <strong class="user">me at nwhiting dot com</strong>
   <a href="#101272" class="date">06-Dec-2010 08:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Method for pulling the name of a class with namespaces pre-stripped.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Returns the name of a class using get_class with the namespaces stripped.<br />
&nbsp;* This will not work inside a class scope as get_class() a workaround for<br />
&nbsp;* that is using get_class_name(get_class());<br />
&nbsp;*<br />
&nbsp;* @param&nbsp; object|string&nbsp; $object&nbsp; Object or Class Name to retrieve name<br />
<br />
&nbsp;* @return&nbsp; string&nbsp; Name of class with namespaces stripped<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">get_class_name</span><span class="keyword">(</span><span class="default">$object </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">) &amp;&amp; !</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">) ? </span><span class="default">$object </span><span class="keyword">: </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$class</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">];<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
And for everyone for Unit Test goodiness!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">namespace </span><span class="default">testme\here</span><span class="keyword">;<br />
<br />
class </span><span class="default">TestClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">test</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">get_class_name</span><span class="keyword">(</span><span class="default">get_class</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">GetClassNameTest </span><span class="keyword">extends </span><span class="default">\PHPUnit_Framework_TestCase<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">testGetClassName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class&nbsp; </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$std&nbsp; </span><span class="keyword">= new </span><span class="default">\stdClass</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'TestClass'</span><span class="keyword">, </span><span class="default">get_class_name</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'stdClass'</span><span class="keyword">, </span><span class="default">get_class_name</span><span class="keyword">(</span><span class="default">$std</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'Test'</span><span class="keyword">, </span><span class="default">get_class_name</span><span class="keyword">(</span><span class="string">'Test'</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="default">get_class_name</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="default">get_class_name</span><span class="keyword">(array()));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'TestClass'</span><span class="keyword">, </span><span class="default">$class</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98496""></a>
  <div class="note">
   <strong class="user">Aaron</strong>
   <a href="#98496" class="date">18-Jun-2010 11:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This can sometimes be used in place of get_called_class(). I used this function in a parent class to get the name of the class that extends it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97164""></a>
  <div class="note">
   <strong class="user">ovidiu.bute [at] gmail.com</strong>
   <a href="#97164" class="date">05-Apr-2010 10:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using namespaces this function will return the name of the class including the namespace, so watch out if your code does any checks for this. Ex:
<br />

<br />
namespace Shop;
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">Foo
<br />
</span><span class="keyword">{
<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()
<br />
&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; echo </span><span class="string">"Foo"</span><span class="keyword">;
<br />
&nbsp; }
<br />
}
<br />

<br />
</span><span class="comment">//Different file
<br />

<br />
</span><span class="keyword">include(</span><span class="string">'inc/Shop.class.php'</span><span class="keyword">); 
<br />

<br />
</span><span class="default">$test </span><span class="keyword">= new </span><span class="default">Shop\Foo</span><span class="keyword">();
<br />
echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);</span><span class="comment">//returns Shop\Foo
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88856""></a>
  <div class="note">
   <strong class="user">Lanselot</strong>
   <a href="#88856" class="date">11-Feb-2009 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware if you're omitting the parameter on inherited classes.<br />
It'll return the class name of the method where it's called.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">foo</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">get_class</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp; function </span><span class="default">bar</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">get_class</span><span class="keyword">();<br />
&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">$instance </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">();<br />
echo </span><span class="default">$instance</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">(); </span><span class="comment">//Prints 'B';<br />
</span><span class="keyword">echo </span><span class="default">$instance</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">(); </span><span class="comment">//Prints 'A';<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86230""></a>
  <div class="note">
   <strong class="user">danbettles at yahoo dot co dot uk</strong>
   <a href="#86230" class="date">08-Oct-2008 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is possible to write a completely self-contained Singleton base class in PHP 5.3 using the new get_called_class function.&nbsp; When called in a static method, this function returns the name of the class the call was made against.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; final public static function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static </span><span class="default">$aoInstance </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$calledClassName </span><span class="keyword">= </span><span class="default">get_called_class</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (! isset (</span><span class="default">$aoInstance</span><span class="keyword">[</span><span class="default">$calledClassName</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aoInstance</span><span class="keyword">[</span><span class="default">$calledClassName</span><span class="keyword">] = new </span><span class="default">$calledClassName</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$aoInstance</span><span class="keyword">[</span><span class="default">$calledClassName</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; final private function </span><span class="default">__clone</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">DatabaseConnection </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$connection</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// @todo Connect to the database<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// @todo Drop the connection to the database<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
</span><span class="default">$oDbConn </span><span class="keyword">= new </span><span class="default">DatabaseConnection</span><span class="keyword">();&nbsp; </span><span class="comment">// Fatal error<br />
<br />
</span><span class="default">$oDbConn </span><span class="keyword">= </span><span class="default">DatabaseConnection</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();&nbsp; </span><span class="comment">// Returns single instance<br />
</span><span class="default">?&gt;<br />
</span><br />
Full write-up in Oct 2008: <a href="http://danbettles.blogspot.com" rel="nofollow" target="_blank">http://danbettles.blogspot.com</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85228""></a>
  <div class="note">
   <strong class="user">Edward</strong>
   <a href="#85228" class="date">21-Aug-2008 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The code in my previous comment was not completely correct. I think this one is. <br />
<br />
&lt;?<br />
abstract class Singleton {<br />
&nbsp;&nbsp;&nbsp; protected static $__CLASS__ = __CLASS__;<br />
<br />
&nbsp;&nbsp;&nbsp; protected function __construct() {<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; abstract protected function init();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Gets an instance of this singleton. If no instance exists, a new instance is created and returned.<br />
&nbsp;&nbsp; &nbsp; * If one does exist, then the existing instance is returned.<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; public static function getInstance() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static $instance;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $class = self::getClass();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($instance === null) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $instance = new $class();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $instance-&gt;init();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $instance;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Returns the classname of the child class extending this class<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @return string The class name<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; private static function getClass() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $implementing_class = static::$__CLASS__;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $original_class = __CLASS__;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($implementing_class === $original_class) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; die("You MUST provide a &lt;code&gt;protected static \$__CLASS__ = __CLASS__;&lt;/code&gt; statement in your Singleton-class!");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $implementing_class;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85209""></a>
  <div class="note">
   <strong class="user">Edward</strong>
   <a href="#85209" class="date">20-Aug-2008 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With Late Static Bindings, available as of PHP 5.3.0, it is now possible to implement an abstract Singleton class with minimal overhead in the child classes. Late static bindings are explained here: <a href="http://nl2.php.net/manual/en/language.oop5.late-static-bindings.php" rel="nofollow" target="_blank">http://nl2.php.net/manual/en/language.oop5.late-static-bindings.php</a><br />
<br />
In short, it introduces a new 'static::' keyword, that is evaluated at runtime. In the following code I use it to determine the classname of the child Singleton class.<br />
<br />
&lt;?<br />
abstract class Singleton {<br />
&nbsp;&nbsp;&nbsp; protected static $__CLASS__ = __CLASS__;<br />
&nbsp;&nbsp;&nbsp; protected static $instance;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected function __construct() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::$instance = $this;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;init();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; abstract protected function init();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected function getInstance() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $class = static::getClass();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (static::$instance===null) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; static::$instance = new $class;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::$instance;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private static function getClass() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (static::$__CLASS__ == __CLASS__) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; die("You MUST provide a &lt;code&gt;protected static \$__CLASS__ = __CLASS__;&lt;/code&gt; statement in your Singleton-class!");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::$__CLASS__;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
?&gt;<br />
<br />
An example Singleton class can then be implemented as follows:<br />
<br />
&lt;?<br />
class A extends Singleton {<br />
&nbsp;&nbsp;&nbsp; protected static $__CLASS__ = __CLASS__; // Provide this in each singleton class.<br />
<br />
&nbsp;&nbsp;&nbsp; protected function someFunction() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $instance = static::getInstance();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ...<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
?&gt;<br />
<br />
Hope this helps you save some time :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82873""></a>
  <div class="note">
   <strong class="user">dave dot zap at gmail dot com</strong>
   <a href="#82873" class="date">29-Apr-2008 09:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Take care using the backtrace method to find the calling class of a static method, you should step backward through the array and find a match for your getInstance() function. In backtrace the class name you want is not always the last item in the array.<br />
<br />
I will not post the whole singleton class here, but have made the following modification to Frederik Krautwald's method (found below)<br />
<br />
<span class="default">&lt;?php <br />
$bt </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
</span><span class="comment">// this method is count($bt)-1) by Frederik will fall over when calling getInstance from within an include file.<br />
//$class = $bt[count($bt) - 1]['class'];<br />
<br />
</span><span class="keyword">for( </span><span class="default">$i</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">)-</span><span class="default">1 </span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">--)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">] == </span><span class="string">'getInstance'</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82479""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#82479" class="date">12-Apr-2008 02:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Perl (and some other languages) you can call some methods in both object and class (aka static) context. I made such a method for one of my classes in PHP5, but found out that static methods in PHP5 do not 'know' the name of the calling subclass', so I use a backtrace to determine it. I don't like hacks like this, but as long as PHP doesn't have an alternative, this is what has to be done:<br />
<br />
public function table_name() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = null;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset($this)) { // object context<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = get_class($this);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else { // class context<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = get_class();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $trace = debug_backtrace();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach ($trace as &amp;$frame) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset($frame['class'])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($frame['class'] != $result) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!is_subclass_of($frame['class'], $result)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = $frame['class'];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $result;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81304""></a>
  <div class="note">
   <strong class="user">andregs at NOSPAM dot gmail dot NOSPAM dot com</strong>
   <a href="#81304" class="date">21-Feb-2008 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After reading the previous comments, this is the best I've done to get the final class name of a subclass:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Singleton<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp; private static </span><span class="default">$_instances </span><span class="keyword">= array();<br />
&nbsp;&nbsp; protected final function </span><span class="default">__construct</span><span class="keyword">(){}<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; * @param string $classname<br />
&nbsp;&nbsp;&nbsp; * @return Singleton<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp; </span><span class="keyword">protected static function </span><span class="default">getInstance</span><span class="keyword">()<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$classname </span><span class="keyword">= </span><span class="default">func_get_arg</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (! isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$_instances</span><span class="keyword">[</span><span class="default">$classname</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_instances</span><span class="keyword">[</span><span class="default">$classname</span><span class="keyword">] = new </span><span class="default">$classname</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_instances</span><span class="keyword">[</span><span class="default">$classname</span><span class="keyword">];<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
}<br />
<br />
class </span><span class="default">Child </span><span class="keyword">extends </span><span class="default">Singleton<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; * @return Child<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">getInstance</span><span class="keyword">()<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">get_class</span><span class="keyword">());<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Subclasses must override "getInstance" and cannot override "__construct".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77698""></a>
  <div class="note">
   <strong class="user">dodgie74 at NOSPAM dot yahoo dot NOSPAM dot co dot uk</strong>
   <a href="#77698" class="date">09-Sep-2007 05:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted in bug #30934 (which is not actually a bug but a consequence of a design decision), the "self" keyword is bound at compile time. Amongst other things, this means that in base class methods, any use of the "self" keyword will refer to that base class regardless of the actual (derived) class on which the method was invoked. This becomes problematic when attempting to call an overridden static method from within an inherited method in a derived class. For example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Base<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$m_instanceName </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">classDisplayName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'Base Class'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">instanceDisplayName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//here, we want "self" to refer to the actual class, which might be a derived class that inherits this method, not necessarily this base class<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">m_instanceName </span><span class="keyword">. </span><span class="string">' - ' </span><span class="keyword">. </span><span class="default">self</span><span class="keyword">::</span><span class="default">classDisplayName</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Derived </span><span class="keyword">extends </span><span class="default">Base<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">Derived</span><span class="keyword">( </span><span class="default">$name </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">m_instanceName </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">classDisplayName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'Derived Class'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$o </span><span class="keyword">= new </span><span class="default">Derived</span><span class="keyword">(</span><span class="string">'My Instance'</span><span class="keyword">);<br />
echo </span><span class="default">$o</span><span class="keyword">-&gt;</span><span class="default">instanceDisplayName</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
In the above example, assuming runtime binding (where the keyword "self" refers to the actual class on which the method was invoked rather than the class in which the method is defined) would produce the output:<br />
<br />
My Instance - Derived Class<br />
<br />
However, assuming compile-time binding (where the keyword "self" refers to the class in which the method is defined), which is how php works, the output would be:<br />
<br />
My Instance - Base Class<br />
<br />
The oddity here is that "$this" is bound at runtime to the actual class of the object (obviously) but "self" is bound at compile-time, which seems counter-intuitive to me. "self" is ALWAYS a synonym for the name of the class in which it is written, which the programmer knows so s/he can just use the class name; what the programmer cannot know is the name of the actual class on which the method was invoked (because the method could be invoked on a derived class), which it seems to me is something for which "self" ought to be useful.<br />
<br />
However, questions about design decisions aside, the problem still exists of how to achieve behaviour similar to "self" being bound at runtime, so that both static and non-static methods invoked on or from within a derived class act on that derived class. The get_class() function can be used to emulate the functionality of runtime binding for the "self" keyword for static methods:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Base<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$m_instanceName </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">classDisplayName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'Base Class'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">instanceDisplayName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$realClass </span><span class="keyword">= </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">m_instanceName </span><span class="keyword">. </span><span class="string">' - ' </span><span class="keyword">. </span><span class="default">call_user_func</span><span class="keyword">(array(</span><span class="default">$realClass</span><span class="keyword">, </span><span class="string">'classDisplayName'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Derived </span><span class="keyword">extends </span><span class="default">Base<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">Derived</span><span class="keyword">( </span><span class="default">$name </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">m_instanceName </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">classDisplayName</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'Derived Class'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$o </span><span class="keyword">= new </span><span class="default">Derived</span><span class="keyword">(</span><span class="string">'My Instance'</span><span class="keyword">);<br />
echo </span><span class="default">$o</span><span class="keyword">-&gt;</span><span class="default">instanceDisplayName</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Output:<br />
My Instance - Derived Class<br />
<br />
I realise that some people might respond "why don't use just just the class name with ' Class' appended instead of the classDisplayName() method", which is to miss the point. The point is not the actual strings returned but the concept of wanting to use the real class for an overridden static method from within an inherited non-static method. The above is just a simplified version of a real-world problem that was too complex to use as an example.<br />
<br />
Apologies if this has been mentioned before.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77214""></a>
  <div class="note">
   <strong class="user">bramus at bram dot us</strong>
   <a href="#77214" class="date">20-Aug-2007 08:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@ Frederik : <br />
<br />
&lt;?<br />
$class = $bt[count($bt) - 1]['class']; <br />
?&gt;<br />
<br />
should be<br />
<br />
&lt;?<br />
$class = $bt[count($bt) - 2]['class'];<br />
?&gt;<br />
<br />
;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75979""></a>
  <div class="note">
   <strong class="user">Frederik Krautwald</strong>
   <a href="#75979" class="date">25-Jun-2007 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Due to PHP 5 engine that permits to get final class in a static called function, and this is a modified version of examples published below.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$_instances </span><span class="keyword">= array();<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">__construct</span><span class="keyword">() {}<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected static function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$_instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">] = new </span><span class="default">$class</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">A </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">C </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">A</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">B</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
</span><span class="default">$c </span><span class="keyword">= </span><span class="default">C</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"\$a is a " </span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) . </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"\$b is a " </span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">) . </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"\$c is a " </span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) . </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
I don't know about if performance would increase if debug_backtrace() is skipped and instead have getInstance() to accept a passed class retrieved by get_class() method as parameter as described in a post below.<br />
<br />
By having set getInstance() to protected in the Singleton class, the function is required to be overridden (good OOP practice).<br />
<br />
One thing to mention is, that there is no error checking in case $class is null or undefined, which would result in a fatal error. At the moment, though, I can't see how it could happen when the getInstance() is protected, i.e. has to be overridden in a subclass -- but with good coding practice you should always error check.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75949""></a>
  <div class="note">
   <strong class="user">mightye at gmail dot com</strong>
   <a href="#75949" class="date">23-Jun-2007 06:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To: Bryan<br />
<br />
In this model it is still workable if your singleton variable is actually an array.&nbsp; Consider:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected final static </span><span class="default">$instances </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">__construct</span><span class="keyword">(){}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">get_real_class</span><span class="keyword">(); </span><span class="comment">// imaginary function returning the final class name, not the class the code executes from<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">] = new </span><span class="default">$class</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">A </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{<br />
}<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{<br />
}<br />
<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">A</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">B</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"\$a is a " </span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) . </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"\$b is a " </span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">) . </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span>This would output:<br />
$a is a A<br />
$b is a B<br />
<br />
The only alternative as described elsewhere is to make getInstance() protected abstract, accept the class name as an argument, and extend this call with a public final method for every sub-class which uses get_class() in its local object scope and passes it to the superclass.<br />
<br />
Or else create a singleton factory like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">final class </span><span class="default">SingletonFactory </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$instances </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">] = new </span><span class="default">$class</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instances</span><span class="keyword">[</span><span class="default">$class</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>The downside to this of course to this latter model is that the class itself doesn't get to decide if it is a singleton, the calling code gets to decide this instead, and a class that really wants or *needs* to be a singleton has no way to enforce this, not even by making its constructor protected.<br />
<br />
Basically these design patterns, and various other meta manipulations (things which operate on the nature of the object, not on the data the object holds) could benefit greatly from knowing exactly what the final type of this object is, and not having native access to this information obligates work-arounds.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74846""></a>
  <div class="note">
   <strong class="user">janci</strong>
   <a href="#74846" class="date">30-Apr-2007 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To yicheng zero-four at gmail dot com: Another, maybe better example where finding out the real class (not the class we are in) in static method should be quite usefull is the Singleton pattern. <br />
<br />
There is currently no way how to create an abstract Singleton class that could be used just by extending it without the need to change the extended class. Consider this example:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$__instance </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">getInstance</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">self</span><span class="keyword">::</span><span class="default">$__instance </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// This acctually is not what we want, $class will always be 'Singleton' :(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">get_class</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$__instance </span><span class="keyword">= new </span><span class="default">$class</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$__instance</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Foo </span><span class="keyword">extends </span><span class="default">Singleton<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// ...<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">$single_foo </span><span class="keyword">= </span><span class="default">Foo</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span>This piece of code will result in a fatal error saying: Cannot instantiate abstract class Singleton in ... on line 11<br />
<br />
The best way I figured out how to avoid this requires simple but still a change of the extended (Foo) class:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$__instance </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; protected static function </span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">self</span><span class="keyword">::</span><span class="default">$__instance </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">class_exists</span><span class="keyword">(</span><span class="default">$class</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$__instance </span><span class="keyword">= new </span><span class="default">$class</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Cannot instantiate undefined class [' </span><span class="keyword">. </span><span class="default">$class </span><span class="keyword">. </span><span class="string">']'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$__instance</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Foo </span><span class="keyword">extends </span><span class="default">Singleton<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// You have to overload the getInstance method in each extended class:<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">getInstance</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">(</span><span class="default">get_class</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$single_foo </span><span class="keyword">= </span><span class="default">Foo</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
This is of course nothing horrible, you will propably need to change something in the extended class anyway (at least the constructor access), but still... it is just not as nice as it possibly could be ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72440""></a>
  <div class="note">
   <strong class="user">yicheng zero-four at gmail dot com</strong>
   <a href="#72440" class="date">18-Jan-2007 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This a response to luke at liveoakinteractive dot com and davidc at php dot net.&nbsp; Static methods and variables, by definition, are bound to class types not object instances.&nbsp; You should not need to dynamically find out what class a static method belongs to, since the context of your code should make it quite obvious.&nbsp; Your questions reveals that you probably don't quite understand OOP quite yet (it took me a while as well).<br />
<br />
Luke, the observed behavior from your particular code snippet makes perfect sense when you think about it.&nbsp; The method getclass() is defined in BooBoof, so the __CLASS__ macro would be bound to BooBoof and defined in relation to the BooBoof class.&nbsp; The fact that CooCoof is a subclass of BooBoof just means that it gains a shortcut to BooBoof::getclass().&nbsp; So, in effect, you are really asking (in a convoluted way): "What is the class to which belongs the method call BooBoof::getclass()?"&nbsp; The correct solution (if you actually want/need to do this) is to simply implement CooCoof::getclass() { return __CLASS__; } inside of the CooCoof definition, and any childclasses that you want to mimic this behavior.&nbsp; CooCoof::getclass() will have the expected behavior.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71574""></a>
  <div class="note">
   <strong class="user">luke at liveoakinteractive dot com</strong>
   <a href="#71574" class="date">06-Dec-2006 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This note is a response to the earlier post by davidc at php dot net. Unfortunately, the solution posted for getting the class name from a static method does not work with inherited classes.<br />
<br />
Observe the following:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">BooBoof </span><span class="keyword">{<br />
&nbsp; public static function </span><span class="default">getclass</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">__CLASS__</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">retrieve_class</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">CooCoof </span><span class="keyword">extends </span><span class="default">BooBoof </span><span class="keyword">{<br />
}<br />
<br />
echo </span><span class="default">CooCoof</span><span class="keyword">::</span><span class="default">getclass</span><span class="keyword">();<br />
</span><span class="comment">// outputs BooBoof<br />
<br />
</span><span class="default">$coocoof </span><span class="keyword">= new </span><span class="default">CooCoof</span><span class="keyword">;<br />
echo </span><span class="default">$coocoof</span><span class="keyword">-&gt;</span><span class="default">retrieve_class</span><span class="keyword">();<br />
</span><span class="comment">// outputs CooCoof<br />
</span><span class="default">?&gt;<br />
</span><br />
__CLASS__ and get_class($this) do not work the same way with inherited classes. I have been thus far unable to determine a reliable way to get the actual class from a static method.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65249""></a>
  <div class="note">
   <strong class="user">benjaminhill at gmail dot com</strong>
   <a href="#65249" class="date">27-Apr-2006 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
More funkyness:<br />
<br />
class Parent {<br />
&nbsp;&nbsp; function displayTableName() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo get_class($this);<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo get_class();<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
class Child {<br />
&nbsp;&nbsp; function __construct() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;displayTableName();<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
Will return <br />
- Child<br />
- Parent<br />
<br />
So when they say "the object isn't required in PHP5" - they don't really mean it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54480""></a>
  <div class="note">
   <strong class="user">refrozen dot com</strong>
   <a href="#54480" class="date">05-Jul-2005 03:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
philip at cornado dot com, it returns the value of the class from which it was called, rather than the instance's name... causing inheritance to result in unexpected returns</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39558""></a>
  <div class="note">
   <strong class="user">MagicalTux at FF.ST</strong>
   <a href="#39558" class="date">02-Feb-2004 04:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the constant __CLASS__ is different from get_class($this) :<br />
&lt;?<br />
&nbsp; class test {<br />
&nbsp;&nbsp;&nbsp; function whoami() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "Hello, I'm whoami 1 !\r\n";<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "Value of __CLASS__ : ".__CLASS__."\r\n";<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "Value of get_class() : ".get_class($this)."\r\n\r\n";<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; class test2 extends test {<br />
&nbsp;&nbsp;&nbsp; function whoami2() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "Hello, I'm whoami 2 !\r\n";<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "Value of __CLASS__ : ".__CLASS__."\r\n";<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "Value of get_class() : ".get_class($this)."\r\n\r\n";<br />
&nbsp;&nbsp; &nbsp;&nbsp; parent::whoami(); // call parent whoami() function<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; $test=new test;<br />
&nbsp; $test-&gt;whoami();<br />
&nbsp; $test2=new test2;<br />
&nbsp; $test2-&gt;whoami();<br />
&nbsp; $test2-&gt;whoami2();<br />
?&gt;<br />
<br />
The output is :<br />
Hello, I'm whoami 1 !<br />
Value of __CLASS__ : test<br />
Value of get_class() : test<br />
<br />
Hello, I'm whoami 1 !<br />
Value of __CLASS__ : test<br />
Value of get_class() : test2<br />
<br />
Hello, I'm whoami 2 !<br />
Value of __CLASS__ : test2<br />
Value of get_class() : test2<br />
<br />
Hello, I'm whoami 1 !<br />
Value of __CLASS__ : test<br />
Value of get_class() : test2<br />
<br />
In fact, __CLASS__ returns the name of the class the function is in and get_class($this) returns the name of the class which was created.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
