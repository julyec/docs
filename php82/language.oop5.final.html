<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Final 关键字</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.oop5.magic.html">? 魔术方法</a></li>
      <li style="float: right;"><a href="language.oop5.cloning.html">对象复制 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.oop5.html">类与对象</a></li>
    <li>Final 关键字</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.oop5.final" class="sect1">
  <h2 class="title">Final 关键字</h2>
  <p class="para">
   final 关键字通过在定义方法和常量之前加上 <code class="literal">final</code> 来防止被子类覆盖。
   如果一个类被声明为 final，则不能被继承。
  </p>
  
  <p class="para">
   <div class="example" id="example-562">
    <p><strong>Example #1 Final 方法示例</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />   public function </span><span style="color: #0000BB">test</span><span style="color: #007700">() {<br />       echo </span><span style="color: #DD0000">"BaseClass::test() called\n"</span><span style="color: #007700">;<br />   }<br />   <br />   final public function </span><span style="color: #0000BB">moreTesting</span><span style="color: #007700">() {<br />       echo </span><span style="color: #DD0000">"BaseClass::moreTesting() called\n"</span><span style="color: #007700">;<br />   }<br />}<br /><br />class </span><span style="color: #0000BB">ChildClass </span><span style="color: #007700">extends </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />   public function </span><span style="color: #0000BB">moreTesting</span><span style="color: #007700">() {<br />       echo </span><span style="color: #DD0000">"ChildClass::moreTesting() called\n"</span><span style="color: #007700">;<br />   }<br />}<br /></span><span style="color: #FF8000">// 产生 Fatal error: Cannot override final method BaseClass::moreTesting()<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-564">
    <p><strong>Example #2 Final 类示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">final class </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />   public function </span><span style="color: #0000BB">test</span><span style="color: #007700">() {<br />       echo </span><span style="color: #DD0000">"BaseClass::test() called\n"</span><span style="color: #007700">;<br />   }<br />   <br />   </span><span style="color: #FF8000">// 由于类已经是 final，所以 final 关键字是多余的<br />   </span><span style="color: #007700">final public function </span><span style="color: #0000BB">moreTesting</span><span style="color: #007700">() {<br />       echo </span><span style="color: #DD0000">"BaseClass::moreTesting() called\n"</span><span style="color: #007700">;<br />   }<br />}<br /><br />class </span><span style="color: #0000BB">ChildClass </span><span style="color: #007700">extends </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />}<br /></span><span style="color: #FF8000">// 产生 Fatal error: Class ChildClass may not inherit from final class (BaseClass)<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

 <p class="para">
  <div class="example" id="example-566">
   <p><strong>Example #3 PHP 8.1.0 起可用的 final 常量示例</strong></p>
   <div class="example-contents">
    <div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">Foo<br /></span><span style="color: #007700">{<br />    final public const </span><span style="color: #0000BB">X </span><span style="color: #007700">= </span><span style="color: #DD0000">"foo"</span><span style="color: #007700">;<br />}<br /><br />class </span><span style="color: #0000BB">Bar </span><span style="color: #007700">extends </span><span style="color: #0000BB">Foo<br /></span><span style="color: #007700">{<br />    public const </span><span style="color: #0000BB">X </span><span style="color: #007700">= </span><span style="color: #DD0000">"bar"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">// Fatal error: Bar::X cannot override final constant Foo::X<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    属性和常量不能被定义为 final，只有类、方法、常量（PHP 8.1.0 起）才能被定义为 final。
   </span>
   <span class="simpara">
    从 PHP 8.0.0 起，除了构造函数之外，私有方法也不能声明为 final 。
   </span>
  </p></blockquote>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="128448""></a>
  <div class="note">
   <strong class="user">Rumour</strong>
   <a href="#128448" class="date">03-May-2023 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Class constants CAN be "finalised" since PHP8.1. To partly contradict to the most popular user contribution, that was written a long time ago, they were still absolutely right.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121514""></a>
  <div class="note">
   <strong class="user">John smith</strong>
   <a href="#121514" class="date">11-Aug-2017 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Right way:<br />
&nbsp;final protected function example() {<br />
}<br />
<br />
Wrong way:<br />
<br />
protected final function example() {<br />
}<br />
<br />
Source: Practices</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119439""></a>
  <div class="note">
   <strong class="user">suisuiruyi at gmail dot com</strong>
   <a href="#119439" class="date">06-Jun-2016 09:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: Properties cannot be declared final, only classes and methods may be declared as final.<br />
you can use trait:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">trait </span><span class="default">PropertiesTrait </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$same </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$different </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
}<br />
<br />
class </span><span class="default">PropertiesExample </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; use </span><span class="default">PropertiesTrait</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$same </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; </span><span class="comment">// Strict Standards<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$different </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; </span><span class="comment">// 致命错误<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116993""></a>
  <div class="note">
   <strong class="user">xavier dot inghels at gmail dot com</strong>
   <a href="#116993" class="date">31-Mar-2015 09:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Final is not really about overriding or overloading a method.<br />
PHP doesn't support (yet ?) method ovverriding.<br />
<br />
The final keyword however prevent you to redefine a method already previously declared.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115148""></a>
  <div class="note">
   <strong class="user">mattsch at gmail dot com</strong>
   <a href="#115148" class="date">03-Jun-2014 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use final methods to replace class constants.&nbsp; The reason for this is you cannot unit test a class constant used in another class in isolation because you cannot mock a constant.&nbsp;&nbsp; Final methods allow you to have the same functionality as a constant while keeping your code loosely coupled.<br />
<br />
Tight coupling example (bad to use constants):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">interface </span><span class="default">FooInterface<br />
</span><span class="keyword">{<br />
}<br />
<br />
class </span><span class="default">Foo </span><span class="keyword">implements </span><span class="default">FooInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">BAR </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
interface </span><span class="default">BazInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getFooBar</span><span class="keyword">();<br />
}<br />
<br />
</span><span class="comment">// This class cannot be unit tested in isolation because the actual class Foo must also be loaded to get the value of Foo::BAR<br />
</span><span class="keyword">class </span><span class="default">Baz </span><span class="keyword">implements </span><span class="default">BazInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$foo</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">FooInterface $foo</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">= </span><span class="default">$foo</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getFooBar</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">Foo</span><span class="keyword">::</span><span class="default">BAR</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();<br />
</span><span class="default">$baz </span><span class="keyword">= new </span><span class="default">Baz</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br />
</span><span class="default">$bar </span><span class="keyword">= </span><span class="default">$baz</span><span class="keyword">-&gt;</span><span class="default">getFooBar</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Loose coupling example (eliminated constant usage):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">interface </span><span class="default">FooInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">bar</span><span class="keyword">();<br />
}<br />
<br />
class </span><span class="default">Foo </span><span class="keyword">implements </span><span class="default">FooInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; final public function </span><span class="default">bar</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
interface </span><span class="default">BazInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getFooBar</span><span class="keyword">();<br />
}<br />
<br />
</span><span class="comment">// This class can be unit tested in isolation because class Foo does not need to be loaded by mocking FooInterface and calling the final bar method.<br />
</span><span class="keyword">class </span><span class="default">Baz </span><span class="keyword">implements </span><span class="default">BazInterface<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$foo</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">FooInterface $foo</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">= </span><span class="default">$foo</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getFooBar</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();<br />
</span><span class="default">$baz </span><span class="keyword">= new </span><span class="default">Baz</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br />
</span><span class="default">$bar </span><span class="keyword">= </span><span class="default">$baz</span><span class="keyword">-&gt;</span><span class="default">getFooBar</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115012""></a>
  <div class="note">
   <strong class="user">cottton at i-stats dot net</strong>
   <a href="#115012" class="date">12-May-2014 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
imo good to know:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">BaseClass<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$var </span><span class="keyword">= </span><span class="string">'i belong to BaseClass'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">test</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'i am `'</span><span class="keyword">.</span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'()` and this is my var: `'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">changeVar</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$var </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'i am `'</span><span class="keyword">.</span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'()` and i just changed my $var to: `'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; final public static function </span><span class="default">dontCopyMe</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$var </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'i am `'</span><span class="keyword">.</span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'()` and i just changed my $var to: `'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">ChildClass </span><span class="keyword">extends </span><span class="default">BaseClass<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected static </span><span class="default">$var </span><span class="keyword">= </span><span class="string">'i belong to ChildClass'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">test</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'i am `'</span><span class="keyword">.</span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'()` and this is my var: `'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`&lt;br&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'and this is my parent var: `'</span><span class="keyword">.</span><span class="default">parent</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">changeVar</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$var </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'i am `'</span><span class="keyword">.</span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'()` and i just changed my $var to: `'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`&lt;br&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'but the parent $var is still: `'</span><span class="keyword">.</span><span class="default">parent</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">dontCopyMe</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) </span><span class="comment">// Fatal error: Cannot override final method BaseClass::dontCopyMe() in ...<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$var </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'i am `'</span><span class="keyword">.</span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'()` and i just changed my $var to: `'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">$var</span><span class="keyword">.</span><span class="string">'`&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">BaseClass</span><span class="keyword">::</span><span class="default">test</span><span class="keyword">();&nbsp; </span><span class="comment">// i am `BaseClass::test()` and this is my var: `i belong to BaseClass`<br />
</span><span class="default">ChildClass</span><span class="keyword">::</span><span class="default">test</span><span class="keyword">(); </span><span class="comment">// i am `ChildClass::test()` and this is my var: `i belong to ChildClass`<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // and this is my parent var: `i belong to BaseClass`<br />
</span><span class="default">ChildClass</span><span class="keyword">::</span><span class="default">changeVar</span><span class="keyword">(</span><span class="string">'something new'</span><span class="keyword">); </span><span class="comment">// i am `ChildClass::changeVar()` and i just changed my $var to: `something new`<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // but the parent $var is still: `i belong to BaseClass`<br />
</span><span class="default">BaseClass</span><span class="keyword">::</span><span class="default">changeVar</span><span class="keyword">(</span><span class="string">'something different'</span><span class="keyword">); </span><span class="comment">// i am `BaseClass::changeVar()` and i just changed my $var to: `something different`<br />
</span><span class="default">BaseClass</span><span class="keyword">::</span><span class="default">dontCopyMe</span><span class="keyword">(</span><span class="string">'a text'</span><span class="keyword">); </span><span class="comment">// i am `BaseClass::dontCopyMe()` and i just changed my $var to: `a text`<br />
</span><span class="default">ChildClass</span><span class="keyword">::</span><span class="default">dontCopyMe</span><span class="keyword">(</span><span class="string">'a text'</span><span class="keyword">); </span><span class="comment">// Fatal error: Cannot override final method BaseClass::dontCopyMe() in ...<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114455""></a>
  <div class="note">
   <strong class="user">t at bestcodepractise dot com</strong>
   <a href="#114455" class="date">22-Feb-2014 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@someone<br />
@thomas<br />
Decorating a finalized class is not possible. The decorator that's mentioned is incomplete. There's a fundamental flaw in it. Look:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//copy'n'paste your FooBar, Foo definition<br />
<br />
</span><span class="default">$f </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">;<br />
</span><span class="default">$fd </span><span class="keyword">= new </span><span class="default">FooDecorator</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$fd </span><span class="keyword">instanceof </span><span class="default">$f</span><span class="keyword">);&nbsp; </span><span class="comment">//FALSE<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">is_a</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">, </span><span class="string">'Foo'</span><span class="keyword">)); </span><span class="comment">//FALSE<br />
</span><span class="default">fooFoo</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">);&nbsp; </span><span class="comment">//E_RECOVERABLE_ERROR here !!!;<br />
<br />
</span><span class="default">?&gt;<br />
</span>What you've created is just an object that happens to have the same methods(a duck type). But if in the client code someone makes decision based on the type of your passed decorator they'll make incorrect decision - or to be more precise not the one that you, the author of the 'decorator' wants them to make. <br />
FYI that's the correct implementation based on GoF:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Foo<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">method doFoo</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do something useful and return a result<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
</span><span class="comment">//decorator must inherit the interface(the methods, type info etc.) //of the decorated class by *extending* it.<br />
</span><span class="keyword">class </span><span class="default">FooDecorator </span><span class="keyword">extends </span><span class="default">Foo <br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$foo</span><span class="keyword">;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">Foo $foo</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">= </span><span class="default">$foo</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">doFoo</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">-&gt;</span><span class="default">doFoo</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... customize result ...<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function </span><span class="default">fooFoo</span><span class="keyword">(</span><span class="default">Foo $f</span><span class="keyword">) {}<br />
</span><span class="default">$f </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">;<br />
</span><span class="default">$fd </span><span class="keyword">= new </span><span class="default">FooDecorator</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$fd </span><span class="keyword">instanceof </span><span class="default">$f</span><span class="keyword">); </span><span class="comment">//true<br />
</span><span class="default">fooFoo</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">); </span><span class="comment">//no E_RECOVERABLE_ERROR here;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I haven't come across any legitimate use of a finalizing class/method and I personally think that 'final' is has no much use and is just a copy'n'pasted from Java into PHP. The keyword makes code difficult to test. If you have to create a test double from a finalized class because you'll need create a derived type to shadow the methods you don't care about. If one of them is finalized you've already lost.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114038""></a>
  <div class="note">
   <strong class="user">someone dot else at elsewhere dot net</strong>
   <a href="#114038" class="date">04-Jan-2014 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@thomas at somewhere dot com<br />
<br />
The 'final' keyword is extremely useful.&nbsp; Inheritance is also useful, but can be abused and becomes problematic in large applications.&nbsp; If you ever come across a finalized class or method that you wish to extend, write a decorator instead.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">final class </span><span class="default">Foo<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">method doFoo</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do something useful and return a result<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
final class </span><span class="default">FooDecorator<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$foo</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">Foo $foo</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">= </span><span class="default">$foo</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">doFoo</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">-&gt;</span><span class="default">doFoo</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ... customize result ...<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100149""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#100149" class="date">28-Sep-2010 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The behaviour of FINAL is not as serious as you may think. A little explample:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; final private function </span><span class="default">method</span><span class="keyword">(){}&nbsp; &nbsp;&nbsp; <br />
}<br />
<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">method</span><span class="keyword">(){}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Normally you would expect some of the following will happen:<br />
- An error that final and private keyword cannot be used together<br />
- No error as the private visibility says, that a method/var/etc. is only visible within the same class<br />
<br />
But what happens is PHP is a little curios: "Cannot override final method A::method()"<br />
<br />
So its possible to deny method names in subclasses! Don't know if this is&nbsp; a good behavior, but maybe its useful for your purpose.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99705""></a>
  <div class="note">
   <strong class="user">Baldurien</strong>
   <a href="#99705" class="date">31-Aug-2010 01:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Note for Java developers: the 'final' keyword is not used for class constants in PHP. We use the keyword 'const'."<br />
<br />
<a href="http://php.net/manual/en/language.oop5.constants.php" rel="nofollow" target="_blank">http://php.net/manual/en/language.oop5.constants.php</a><br />
<br />
This is more or less true, regardless of the fact that constant (being defined at class level or not) in PHP are only scalar (int, string, etc) while in Java they may be pure object (ex: java.awat.Color.BLACK). The only possible solution of having such kind of constant is :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Bar </span><span class="keyword">{...}<br />
class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp; public static </span><span class="default">$FOOBAR</span><span class="keyword">;<br />
<br />
&nbsp; static function </span><span class="default">__init</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$init </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$init</span><span class="keyword">) throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Constants were already initialized'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$FOOBAR </span><span class="keyword">= new </span><span class="default">Bar</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$init </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">Foo</span><span class="keyword">::</span><span class="default">__init</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span>That said, perhaps it is useless unless PHP automatically calls the __init() method.<br />
<br />
However, one alternative that could be done in certain case is this : <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">__autoload</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">) { <br />
&nbsp; ... require </span><span class="default">the file where the </span><span class="keyword">class </span><span class="default">is </span><span class="keyword">...<br />
&nbsp; if (</span><span class="default">interface_exists</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">)) return;<br />
&nbsp; if (</span><span class="default">class_exists</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rc </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$rc</span><span class="keyword">-&gt;</span><span class="default">hasMethod</span><span class="keyword">(</span><span class="string">'__init'</span><span class="keyword">)) return;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">= </span><span class="default">$rc</span><span class="keyword">-&gt;</span><span class="default">getMethod</span><span class="keyword">(</span><span class="string">'__init'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!(</span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">isStatic</span><span class="keyword">() &amp;&amp; </span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">isPrivate</span><span class="keyword">())) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="default">$className </span><span class="keyword">. </span><span class="string">' __init() method must be private and static !'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">invoke</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return;<br />
&nbsp; }<br />
&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Class or interface not found ' </span><span class="keyword">. </span><span class="default">$className</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This can only work when one class is defined per file, since we are assured that __autoload() will be called to load the file containing the class.<br />
<br />
eg: <br />
<br />
test2.php:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">B </span><span class="keyword">{<br />
&nbsp;public static </span><span class="default">$X</span><span class="keyword">;<br />
&nbsp;private static function </span><span class="default">__init</span><span class="keyword">() {<br />
&nbsp;&nbsp; echo </span><span class="string">'B'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">; <br />
&nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$X </span><span class="keyword">= array(</span><span class="default">1</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;}<br />
}<br />
class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp; public static </span><span class="default">$Y</span><span class="keyword">;<br />
&nbsp; private static function </span><span class="default">__init</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$Y </span><span class="keyword">= array(</span><span class="default">3</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>test.php:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">__autoload</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">) {<br />
&nbsp; if (</span><span class="default">$n </span><span class="keyword">== </span><span class="string">'A' </span><span class="keyword">|| </span><span class="default">$n </span><span class="keyword">== </span><span class="string">'B'</span><span class="keyword">) require </span><span class="string">'test2.php'</span><span class="keyword">;<br />
&nbsp; ... do </span><span class="default">our __init</span><span class="keyword">() </span><span class="default">trick </span><span class="keyword">...<br />
}<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">B</span><span class="keyword">::</span><span class="default">$X</span><span class="keyword">); </span><span class="comment">// shows B, then array(2) (1, 2)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">A</span><span class="keyword">::</span><span class="default">$Y</span><span class="keyword">); </span><span class="comment">// shows NULL.<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92295""></a>
  <div class="note">
   <strong class="user">jriddy at gmail dot com</strong>
   <a href="#92295" class="date">17-Jul-2009 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note for Java developers: the 'final' keyword is not used for class constants in PHP. We use the keyword 'const'.<br />
<br />
<a href="http://php.net/manual/en/language.oop5.constants.php" rel="nofollow" target="_blank">http://php.net/manual/en/language.oop5.constants.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87444""></a>
  <div class="note">
   <strong class="user">santoshjoshi2003 at yahoo dot co dot in</strong>
   <a href="#87444" class="date">05-Dec-2008 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The use of final keyword is just like that occurs in Java<br />
In java final has three uses<br />
&nbsp;&nbsp;&nbsp; 1) prevent class Inheritance<br />
&nbsp;&nbsp;&nbsp; 2) prevent method overriding or redifination of <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; method in subclass <br />
&nbsp;&nbsp;&nbsp; 3) and to declare constants <br />
&nbsp;But the third point seems to be missing from the PHP<br />
&nbsp;I guess, as i am a java developer Currently gaining competence in PHP</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78862""></a>
  <div class="note">
   <strong class="user">slorenzo at clug dot org dot ve</strong>
   <a href="#78862" class="date">30-Oct-2007 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">parentClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">someMethod</span><span class="keyword">() { }<br />
}<br />
class </span><span class="default">childClass </span><span class="keyword">extends </span><span class="default">parentClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public final function </span><span class="default">someMethod</span><span class="keyword">() { } </span><span class="comment">//override parent function<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">$class </span><span class="keyword">= new </span><span class="default">childClass</span><span class="keyword">;<br />
</span><span class="default">$class</span><span class="keyword">-&gt;</span><span class="default">someMethod</span><span class="keyword">(); </span><span class="comment">//call the override function in chield class<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74058""></a>
  <div class="note">
   <strong class="user">penartur at yandex dot ru</strong>
   <a href="#74058" class="date">22-Mar-2007 01:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that you cannot ovverride final methods even if they are defined as private in parent class.
<br />
Thus, the following example:
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">parentClass </span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; final private function </span><span class="default">someMethod</span><span class="keyword">() { }
<br />
}
<br />
class </span><span class="default">childClass </span><span class="keyword">extends </span><span class="default">parentClass </span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">someMethod</span><span class="keyword">() { }
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>dies with error "Fatal error: Cannot override final method parentClass::someMethod() in ***.php on line 7"
<br />

<br />
Such behaviour looks slight unexpected because in child class we cannot know, which private methods exists in a parent class and vice versa.
<br />

<br />
So, remember that if you defined a private final method, you cannot place method with the same name in child class.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
