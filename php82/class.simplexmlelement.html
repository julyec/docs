<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>The SimpleXMLElement class</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="simplexml.examples-errors.html">? Dealing with XML errors</a></li>
      <li style="float: right;"><a href="simplexmlelement.addattribute.html">SimpleXMLElement::addAttribute ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.simplexml.html">SimpleXML</a></li>
    <li>The SimpleXMLElement class</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.simplexmlelement" class="reference">
 <h1 class="title">The SimpleXMLElement class</h1>
 
 
 <div class="partintro"><p class="verinfo">(PHP 5, PHP 7, PHP 8)</p>
 

  <div class="section" id="simplexmlelement.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    Represents an element in an XML document.
   </p>
  </div>

 
  <div class="section" id="simplexmlelement.synopsis">
   <h2 class="title">类摘要</h2>
 

   <div class="classsynopsis">
    <span class="ooclass">
     <strong class="classname"></strong>
    </span>

    <div class="classsynopsisinfo">
     <span class="ooclass">
      <span class="modifier">class</span> <strong class="classname">SimpleXMLElement</strong>
     </span>

     <span class="oointerface"><span class="modifier">implements</span> 
       <a href="class.stringable.html" class="interfacename">Stringable</a></span><span class="oointerface">,  <a href="class.countable.html" class="interfacename">Countable</a></span><span class="oointerface">,  <a href="class.recursiveiterator.html" class="interfacename">RecursiveIterator</a></span> {</div>

    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 方法 */</div>
    <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.construct.html" class="methodname">__construct</a></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$dataIsURL</code><span class="initializer"> = <strong><code>false</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$namespaceOrPrefix</code><span class="initializer"> = &quot;&quot;</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$isPrefix</code><span class="initializer"> = <strong><code>false</code></strong></span></span><br>)</div>

    <div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.addattribute.html" class="methodname">addAttribute</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$qualifiedName</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$value</code></span>, <span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$namespace</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type void">void</span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.addchild.html" class="methodname">addChild</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$qualifiedName</code></span>, <span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$value</code><span class="initializer"> = <strong><code>null</code></strong></span></span>, <span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$namespace</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type">?</span><span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.asxml.html" class="methodname">asXML</a></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$filename</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type">string</span>|<span class="type">bool</span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.attributes.html" class="methodname">attributes</a></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$namespaceOrPrefix</code><span class="initializer"> = <strong><code>null</code></strong></span></span>, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$isPrefix</code><span class="initializer"> = <strong><code>false</code></strong></span></span>): <span class="type"><span class="type">?</span><span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.children.html" class="methodname">children</a></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$namespaceOrPrefix</code><span class="initializer"> = <strong><code>null</code></strong></span></span>, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$isPrefix</code><span class="initializer"> = <strong><code>false</code></strong></span></span>): <span class="type"><span class="type">?</span><span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.count.html" class="methodname">count</a></span>(): <span class="type">int</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.current.html" class="methodname">current</a></span>(): <span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.getdocnamespaces.html" class="methodname">getDocNamespaces</a></span>(<span class="methodparam"><span class="type">bool</span> <code class="parameter">$recursive</code><span class="initializer"> = <strong><code>false</code></strong></span></span>, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$fromRoot</code><span class="initializer"> = <strong><code>true</code></strong></span></span>): <span class="type"><span class="type">array</span>|<span class="type"><span class="type false">false</span></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.getname.html" class="methodname">getName</a></span>(): <span class="type">string</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.getnamespaces.html" class="methodname">getNamespaces</a></span>(<span class="methodparam"><span class="type">bool</span> <code class="parameter">$recursive</code><span class="initializer"> = <strong><code>false</code></strong></span></span>): <span class="type">array</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.getchildren.html" class="methodname">getChildren</a></span>(): <span class="type"><span class="type">?</span><span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.haschildren.html" class="methodname">hasChildren</a></span>(): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.key.html" class="methodname">key</a></span>(): <span class="type">string</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.next.html" class="methodname">next</a></span>(): <span class="type"><span class="type void">void</span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.registerxpathnamespace.html" class="methodname">registerXPathNamespace</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$prefix</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$namespace</code></span>): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.rewind.html" class="methodname">rewind</a></span>(): <span class="type"><span class="type void">void</span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.tostring.html" class="methodname">__toString</a></span>(): <span class="type">string</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.valid.html" class="methodname">valid</a></span>(): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="simplexmlelement.xpath.html" class="methodname">xpath</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$expression</code></span>): <span class="type"><span class="type">array</span>|<span class="type">null</span>|<span class="type"><span class="type false">false</span></span></span></div>

   }</div>

 
  </div>

  <div class="section">
   <h2 class="title">更新日志</h2>
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>8.0.0</td>
       <td>
        <span class="classname"><strong class="classname">SimpleXMLElement</strong></span> implements
        <span class="interfacename"><a href="class.stringable.html" class="interfacename">Stringable</a></span>,
        <span class="interfacename"><a href="class.countable.html" class="interfacename">Countable</a></span>,
        and <span class="interfacename"><a href="class.recursiveiterator.html" class="interfacename">RecursiveIterator</a></span> now.
       </td>
      </tr>

     </tbody>
    
   </table>

  </div>
 
 </div>
 
 












































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="simplexmlelement.addattribute.html">SimpleXMLElement::addAttribute</a> &mdash; Adds an attribute to the SimpleXML element</li><li><a href="simplexmlelement.addchild.html">SimpleXMLElement::addChild</a> &mdash; Adds a child element to the XML node</li><li><a href="simplexmlelement.asxml.html">SimpleXMLElement::asXML</a> &mdash; Return a well-formed XML string based on SimpleXML element</li><li><a href="simplexmlelement.attributes.html">SimpleXMLElement::attributes</a> &mdash; Identifies an element's attributes</li><li><a href="simplexmlelement.children.html">SimpleXMLElement::children</a> &mdash; Finds children of given node</li><li><a href="simplexmlelement.construct.html">SimpleXMLElement::__construct</a> &mdash; Creates a new SimpleXMLElement object</li><li><a href="simplexmlelement.count.html">SimpleXMLElement::count</a> &mdash; Counts the children of an element</li><li><a href="simplexmlelement.current.html">SimpleXMLElement::current</a> &mdash; Returns the current element</li><li><a href="simplexmlelement.getdocnamespaces.html">SimpleXMLElement::getDocNamespaces</a> &mdash; Returns namespaces declared in document</li><li><a href="simplexmlelement.getname.html">SimpleXMLElement::getName</a> &mdash; Gets the name of the XML element</li><li><a href="simplexmlelement.getnamespaces.html">SimpleXMLElement::getNamespaces</a> &mdash; Returns namespaces used in document</li><li><a href="simplexmlelement.getchildren.html">SimpleXMLElement::getChildren</a> &mdash; Returns the sub-elements of the current element</li><li><a href="simplexmlelement.haschildren.html">SimpleXMLElement::hasChildren</a> &mdash; Checks whether the current element has sub elements</li><li><a href="simplexmlelement.key.html">SimpleXMLElement::key</a> &mdash; Return current key</li><li><a href="simplexmlelement.next.html">SimpleXMLElement::next</a> &mdash; Move to next element</li><li><a href="simplexmlelement.registerxpathnamespace.html">SimpleXMLElement::registerXPathNamespace</a> &mdash; Creates a prefix/ns context for the next XPath query</li><li><a href="simplexmlelement.rewind.html">SimpleXMLElement::rewind</a> &mdash; Rewind to the first element</li><li><a href="simplexmlelement.savexml.html">SimpleXMLElement::saveXML</a> &mdash; 别名 SimpleXMLElement::asXML</li><li><a href="simplexmlelement.tostring.html">SimpleXMLElement::__toString</a> &mdash; Returns the string content</li><li><a href="simplexmlelement.valid.html">SimpleXMLElement::valid</a> &mdash; Check whether the current element is valid</li><li><a href="simplexmlelement.xpath.html">SimpleXMLElement::xpath</a> &mdash; Runs XPath query on XML data</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="128605""></a>
  <div class="note">
   <strong class="user">ohcc at 163 dot com</strong>
   <a href="#128605" class="date">12-Jun-2023 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can remove SimpleXMLElement nodes using php's unset() language construct.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $xml </span><span class="keyword">= &lt;&lt;&lt;'EOT'<br />
</span><span class="string">&lt;users&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;user&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;name&gt;orange&lt;/name&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;sex&gt;male&lt;/sex&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;homepage&gt;wuxiancheng.cn&lt;/homepage&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/user&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;user&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;name&gt;tangerine&lt;/name&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;sex&gt;male&lt;/sex&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;homepage&gt;51-n.com&lt;/homepage&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/user&gt;<br />
&lt;/users&gt;<br />
</span><span class="keyword">EOT;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sxe </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// This will remove the first user node<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$sxe</span><span class="keyword">-&gt;</span><span class="default">user</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// This will remove all user nodes<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$sxe</span><span class="keyword">-&gt;</span><span class="default">user</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$sxe</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="125438""></a>
  <div class="note">
   <strong class="user">Patanjali</strong>
   <a href="#125438" class="date">15-Oct-2020 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further to rmirabelle's comment, to compare two SimpleXML elements, do the comparison between the objects returned by the dom_import_simplexml function, as per:<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">if(</span><span class="default">dom_import_simplexml</span><span class="keyword">(</span><span class="default">$simplexml_element_1</span><span class="keyword">)===</span><span class="default">dom_import_simplexml</span><span class="keyword">(</span><span class="default">$simplexml_element_2</span><span class="keyword">)){<br />
&nbsp; ...<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span><br />
You must ensure that both are SimpleXML elements before conversion to DOM objects.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124615""></a>
  <div class="note">
   <strong class="user">guilhermeasn at yahoo dot com dot br</strong>
   <a href="#124615" class="date">15-Jan-2020 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Class with a method to transform array or object to XML:<br />
<br />
class MakeXML {<br />
<br />
&nbsp;&nbsp;&nbsp; public static function array_obj_to_xml($data, \SimpleXMLElement &amp;$xmlObj) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach((array) $data as $key =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(is_numeric($key)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $key = "n" . $key;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(is_array($value) or is_object($value)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $subnode = $xmlObj-&gt;addChild($key);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; self::array_obj_to_xml($value, $subnode);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xmlObj-&gt;addChild($key, htmlspecialchars($value));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
Example:<br />
<br />
$object = new \stdClass();<br />
$object-&gt;example = "Try this class";<br />
<br />
$objxml = new \SimpleXMLElement('&lt;API/&gt;');<br />
MakeXML::array_obj_to_xml($objxml, $objxml);<br />
echo $objxml-&gt;asXML();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122728""></a>
  <div class="note">
   <strong class="user">Budu</strong>
   <a href="#122728" class="date">13-May-2018 07:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
public function crearXml(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $pruebaXml = &lt;&lt;&lt;XML<br />
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;<br />
&lt;Root&gt;&lt;/Root&gt;<br />
XML;<br />
$example = new SimpleXMLElement($pruebaXml); //Crea un nuevo objeto SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $example-&gt;addAttribute('id', '1');//A?ade un elemento hijo al nodo XML<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while( $nodo = $this-&gt;iteraciones-&gt;iterate()){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $nodos = $example-&gt;addChild('Nodo');<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $nodos-&gt;addAttribute('id',$nodo-&gt;getId());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $acierto = $nodos-&gt;addChild('nuevoHijo', $nodo-&gt;getX());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $miFichero = $example-&gt;asXML();//Retorna un string XML correcto basado en un elemento SimpleXML<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $miArchivo = fopen("xml/example.xml", "w+");//Abre un fichero o un URL<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; fwrite($miArchivo, $miFichero);//Escritura archivo<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122006""></a>
  <div class="note">
   <strong class="user">CameronXie</strong>
   <a href="#122006" class="date">11-Dec-2017 10:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Map xml to array (with attributes)<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">declare(</span><span class="default">strict_types</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* @param SimpleXMLElement $xml<br />
&nbsp;* @return array<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">xmlToArray</span><span class="keyword">(</span><span class="default">SimpleXMLElement $xml</span><span class="keyword">): array<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$parser </span><span class="keyword">= function (</span><span class="default">SimpleXMLElement $xml</span><span class="keyword">, array </span><span class="default">$collection </span><span class="keyword">= []) use (&amp;</span><span class="default">$parser</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nodes </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attributes </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">0 </span><span class="keyword">!== </span><span class="default">count</span><span class="keyword">(</span><span class="default">$attributes</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$attributes </span><span class="keyword">as </span><span class="default">$attrName </span><span class="keyword">=&gt; </span><span class="default">$attrValue</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$collection</span><span class="keyword">[</span><span class="string">'attributes'</span><span class="keyword">][</span><span class="default">$attrName</span><span class="keyword">] = </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$attrValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">0 </span><span class="keyword">=== </span><span class="default">$nodes</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$collection</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">] = </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$collection</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$nodes </span><span class="keyword">as </span><span class="default">$nodeName </span><span class="keyword">=&gt; </span><span class="default">$nodeValue</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$nodeValue</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="string">'../' </span><span class="keyword">. </span><span class="default">$nodeName</span><span class="keyword">)) &lt; </span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$collection</span><span class="keyword">[</span><span class="default">$nodeName</span><span class="keyword">] = </span><span class="default">$parser</span><span class="keyword">(</span><span class="default">$nodeValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$collection</span><span class="keyword">[</span><span class="default">$nodeName</span><span class="keyword">][] = </span><span class="default">$parser</span><span class="keyword">(</span><span class="default">$nodeValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$collection</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; };<br />
<br />
&nbsp;&nbsp;&nbsp; return [<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">() =&gt; </span><span class="default">$parser</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; ];<br />
}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121166""></a>
  <div class="note">
   <strong class="user">kurtbr at gmail dot com</strong>
   <a href="#121166" class="date">31-May-2017 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a helper class to convert a PHP array to XML<br />
You would call it doing the following:<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= new </span><span class="default">Xml</span><span class="keyword">();<br />
</span><span class="default">$xml</span><span class="keyword">-&gt; </span><span class="default">generateXmlFromArray</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="string">'entities'</span><span class="keyword">, </span><span class="string">'entity'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Xml<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getXmlFromArray</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">\SimpleXMLElement </span><span class="keyword">&amp;</span><span class="default">$xmlElement</span><span class="keyword">, </span><span class="default">$entity</span><span class="keyword">, </span><span class="default">$starting </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handleValue </span><span class="keyword">= function(</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$addChild </span><span class="keyword">= function(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, &amp;</span><span class="default">$subNode </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)use(&amp;</span><span class="default">$xmlElement</span><span class="keyword">, </span><span class="default">$handleValue</span><span class="keyword">, </span><span class="default">$entity</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$subNode </span><span class="keyword">instanceof </span><span class="default">\SimpleXMLElement</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currentKey </span><span class="keyword">= </span><span class="default">key</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$initialValue </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$currentKey</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$initialValue </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$value</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subNode </span><span class="keyword">= </span><span class="default">$xmlElement</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$initialValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getXmlFromArray</span><span class="keyword">(</span><span class="default">$handleValue</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">), </span><span class="default">$subNode</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xmlElement</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$handleValue</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">key</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$setSubNodePrimitiveValue </span><span class="keyword">= function(</span><span class="default">$value</span><span class="keyword">)use(&amp;</span><span class="default">$xmlElement</span><span class="keyword">, </span><span class="default">$entity</span><span class="keyword">, </span><span class="default">$handleValue</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">$handleValue</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= </span><span class="default">$xmlElement</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$value </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$setSubNodePrimitiveValue</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$starting </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$addChild</span><span class="keyword">(</span><span class="default">$entity</span><span class="keyword">, </span><span class="default">$item</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$addChild</span><span class="keyword">(</span><span class="default">$entity</span><span class="keyword">, </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$xmlElement</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$value </span><span class="keyword">as </span><span class="default">$subEntity </span><span class="keyword">=&gt; </span><span class="default">$subEntityItem</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$addChild</span><span class="keyword">(</span><span class="default">$subEntity</span><span class="keyword">, </span><span class="default">$subEntityItem</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xmlElement</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$entity</span><span class="keyword">, </span><span class="default">$handleValue</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @param array $array<br />
&nbsp;&nbsp; &nbsp; * @param string $openingTag<br />
&nbsp;&nbsp; &nbsp; * @param string $entity<br />
&nbsp;&nbsp; &nbsp; * @param string $nameSpace<br />
&nbsp;&nbsp; &nbsp; * @param bool $isPrefixed<br />
&nbsp;&nbsp; &nbsp; * @return \SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">generateXmlFromArray</span><span class="keyword">(array </span><span class="default">$array</span><span class="keyword">, </span><span class="default">string $openingTag</span><span class="keyword">, </span><span class="default">string $entity</span><span class="keyword">, </span><span class="default">$nameSpace </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$isPrefixed </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xmlString </span><span class="keyword">= </span><span class="string">'&lt;'</span><span class="keyword">.</span><span class="default">$openingTag</span><span class="keyword">.</span><span class="string">'&gt;&lt;/'</span><span class="keyword">.</span><span class="default">$openingTag</span><span class="keyword">.</span><span class="string">'&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">\SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlString</span><span class="keyword">, </span><span class="default">LIBXML_NOERROR</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$nameSpace</span><span class="keyword">, </span><span class="default">$isPrefixed</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getXmlFromArray</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$entity</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$xml</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @param string $xml<br />
&nbsp;&nbsp; &nbsp; * @return bool<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">validateXml</span><span class="keyword">(</span><span class="default">string $xml</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom </span><span class="keyword">= new </span><span class="default">\DOMDocument</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">validate</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">loadXmlPathAsArray</span><span class="keyword">(</span><span class="default">string $xmlPath</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$xmlPath</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">), </span><span class="default">TRUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (array)</span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @param string $xmlString<br />
&nbsp;&nbsp; &nbsp; * @return array<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">loadXmlStringAsArray</span><span class="keyword">(</span><span class="default">string $xmlString</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= (array) @</span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlString</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$array</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= (array) @</span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$xmlString</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= (array)@</span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">), </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @param string $xmlString<br />
&nbsp;&nbsp; &nbsp; * @return \SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">loadXmlString</span><span class="keyword">(</span><span class="default">string $xmlString</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return @</span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlString</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120462""></a>
  <div class="note">
   <strong class="user">xxxargonxxx at gmail dot com</strong>
   <a href="#120462" class="date">12-Jan-2017 06:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
See previous two parts to get better understanding of how these tricks works. Example shown here refers to part two. (Sorry, length limitation)<br />
<br />
3. Tricks<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// The real profit is in combination of property and array accesses and unset($someNode-&gt;{0}) trick -<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // it allows you to remove whatever node you want:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'div'</span><span class="keyword">}[</span><span class="default">2</span><span class="keyword">]);&nbsp;&nbsp; </span><span class="comment">// remove node with * mark (text*)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Another trick is removing child node using child node object<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newChildNode </span><span class="keyword">= </span><span class="default">$rootNode</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'div'</span><span class="keyword">,</span><span class="string">'text**'</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// Create<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$newChildNode</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">});&nbsp; &nbsp; &nbsp; </span><span class="comment">// Remove, node removed from parent object too!<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"--2--\n"</span><span class="keyword">.</span><span class="default">$rootNode</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;xml_root&gt;complex node<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;type_one&gt;renewed node 1&lt;/type_one&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;type_two&gt;node 3&lt;/type_two&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;type_one&gt;node 2&lt;/type_one&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;div&gt;text&lt;/div&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;div&gt;text&lt;/div&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;div&gt;text&lt;/div&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/xml_root&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; */ <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120461""></a>
  <div class="note">
   <strong class="user">xxxargonxxx at gmail dot com</strong>
   <a href="#120461" class="date">12-Jan-2017 06:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to view, edit and remove elements.<br />
Speaking in terms of CRUD style, there is no methods to read, edit and remove nodes. But it is possible.<br />
<br />
2. How child nodes works (understanding)<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"Exercise 2 \n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rootNode </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;xml_root&gt;complex node&lt;/xml_root&gt;'</span><span class="keyword">);&nbsp; </span><span class="comment">// Create root node<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNode1 </span><span class="keyword">= </span><span class="default">$rootNode</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'type_one'</span><span class="keyword">,</span><span class="string">'node 1'</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create child node 1 with name 'type_one'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNode2 </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;type_one&gt;node 2&lt;/type_one&gt;'</span><span class="keyword">);&nbsp; &nbsp; &nbsp; </span><span class="comment">// Create child node 2 with name 'type_one'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNode3 </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;type_two&gt;node 3&lt;/type_two&gt;'</span><span class="keyword">);&nbsp; &nbsp; &nbsp; </span><span class="comment">// Create child node 3 with name 'type_two' (different!)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Now $rootNode has only one children because other child nodes was created separately<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Lets paste child node to root node<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$childNode1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'type_one'</span><span class="keyword">} = </span><span class="default">$childNode2</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Note that the property name is 'type_one'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'type_two'</span><span class="keyword">} = </span><span class="default">$childNode3</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Note that the property name is 'type_two'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$rootNode</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; object(SimpleXMLElement)#68 (2) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ["type_one"]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 2"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ["type_two"]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 3"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // We see that "node 1" disappeared, that's because assigning one node to some property of another in not a magic.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // To be clear, the real calls looks like:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'type_one'</span><span class="keyword">}[</span><span class="default">0</span><span class="keyword">] = (string) </span><span class="default">$childNode2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'type_two'</span><span class="keyword">}[</span><span class="default">0</span><span class="keyword">] = (string) </span><span class="default">$childNode3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Explanation:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // A: (string)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // It means that you can't assign node itself, only its string representation because assigned node will be casted to string anyway.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // It also means that tag name of assigned node doesn't matter - its name will be whatever name you specified in {} braces.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // B: [0]<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // The array access operator ([0]) means that each tag name (type_one and type_two) has its own collection with integer indexes.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // If you want to add another tag with same name, you should increment index:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'type_one'</span><span class="keyword">}[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">$childNode2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$rootNode</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; object(SimpleXMLElement)#68 (2) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ["type_one"]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array(2) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 2"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 2"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ["type_two"]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 3"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Note 1. The value of $childNode1 has been changed to "node 1" - that's because the child node, returned from addChild() method<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // is referenced with parent node. If you change its content in one side - it changes in other side too:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNode1</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} = </span><span class="string">'renewed node 1'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// But it won't happen with $childNode2 - it is single and has no reference with parent node:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNode2</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} = </span><span class="string">'renewed node 2'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$rootNode</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; object(SimpleXMLElement)#68 (2) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ["type_one"]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array(2) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(14) "renewed node 1"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 2"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ["type_two"]=&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; string(6) "node 3"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Note 2. When you added child nodes, the parent node's string content is still alive, var_dump doesn't show it,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // but you can see through echoing XML:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"--1--\n"</span><span class="keyword">.</span><span class="default">$rootNode</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;xml_root&gt;complex node &lt;--------- here!<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;type_one&gt;renewed node 1&lt;/type_one&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;type_two&gt;node 3&lt;/type_two&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;type_one&gt;node 2&lt;/type_one&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/xml_root&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // See 'complex node'? Bad news that you can't change string content anymore, if we try to call `$rootNode-&gt;{0} = 'something'` -<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // it overrides all content - both string and child nodes! I don't know how to write to string content only in that case.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // But still you can read string content and remove entire node as described above.<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // So the following statements gives same result, except $result variable value:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$someNode </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;div&gt;text&lt;/div&gt;'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$rootNode</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'div'</span><span class="keyword">,</span><span class="string">'text'</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// $result is SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$rootNode</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$someNode</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(),</span><span class="default">$someNode</span><span class="keyword">);&nbsp; </span><span class="comment">// $result is SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="string">'div'</span><span class="keyword">}[] = </span><span class="string">'text*'</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// $result is string 'text*'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$rootNode</span><span class="keyword">-&gt;{</span><span class="default">$someNode</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">()}[] = </span><span class="default">$someNode</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// $result is string 'text'<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120460""></a>
  <div class="note">
   <strong class="user">xxxargonxxx at gmail dot com</strong>
   <a href="#120460" class="date">12-Jan-2017 06:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to view, edit and remove elements.<br />
Speaking in terms of CRUD style, there is no methods to read, edit and remove nodes. But it is possible.<br />
<br />
1. How to work with single node and its value (basics)<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"Exercise 1 \n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$someNode </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;xml_root&gt;simple node&lt;/xml_root&gt;'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Read<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$someNode</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} .</span><span class="string">"\n"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Echoes "simple node"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$someNode </span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Echoes "simple node", might be used for read case too<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Edit<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$someNode</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} = </span><span class="string">'new value'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$someNode</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} .</span><span class="string">"\n"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Echoes "new value", value is changed!<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Remove<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$someNode</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">});<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Don't touch this node anymore otherwise it will throw a warning:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // "Warning:&nbsp; SimpleXMLElement::asXML(): Node no longer exists in &lt;...&gt; on line &lt;...&gt;"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // echo $someNode ."\n";&nbsp; &nbsp; &nbsp; // Throws the warning<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Recap: property access to zero property ($someNode-&gt;{0}) is the way to read and edit string content of the node AND<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // to remove the node itself<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112420""></a>
  <div class="note">
   <strong class="user">frame at dynamiccreated dot de</strong>
   <a href="#112420" class="date">14-Jun-2013 01:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Important note I miss here in the documentation:<br />
<br />
SimpleXML supports Array/Iteration-Methods. Therefore it is possible to <br />
<br />
add attributes<br />
edit attributes<br />
remove attributes<br />
<br />
add nodes<br />
edit nodes<br />
remove nodes<br />
<br />
This is the reason why SimpleXML provides only add-methods not deleting- or editing-methods. We also need this methods because SimpleXML acts as a normal class and<br />
new member will not converted to a new node.<br />
<br />
Deleting a node seems not to be possible within a foreach-loop. The reason is simple. To do that we need a valid key, but the Iterator only gives us a "understandable feedback" on which node we are working on: the tag name.<br />
<br />
So this will not work:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach(</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">seg </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$seg</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if((string)</span><span class="default">$seg</span><span class="keyword">[</span><span class="string">'id'</span><span class="keyword">] === </span><span class="string">'whatever'</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$seg</span><span class="keyword">); </span><span class="comment">// only clears local copy<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$seg</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]); </span><span class="comment">// wrong index "seg"<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
But this, eg. will work:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">unset(</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">seg</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
</span><span class="default">?&gt;<br />
</span><br />
In case of doubt always do a print_r/var_dump(). It nicely shows the real linked indexes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111394""></a>
  <div class="note">
   <strong class="user">Yukull</strong>
   <a href="#111394" class="date">15-Feb-2013 01:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
xml to object conversion function :<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; @param:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xml: SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $force: set to true to always create 'text', 'attribute', and 'children' even if empty<br />
&nbsp;&nbsp;&nbsp; @return<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; object with attributs:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (string) name: XML tag name<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (string) text: text content of the attribut name<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (array) attributes: array witch keys are attribute key and values are attribute value<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (array) children: array of objects made with xml2obj() on each child<br />
**/<br />
</span><span class="keyword">function </span><span class="default">xml2obj</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">,</span><span class="default">$force </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">){<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$obj </span><span class="keyword">= new </span><span class="default">StdClass</span><span class="keyword">();&nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">((string)</span><span class="default">$xml</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$attributes </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]&nbsp; = (string)</span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[] = </span><span class="default">xml2obj</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">$force</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$force </span><span class="keyword">or </span><span class="default">$text </span><span class="keyword">!== </span><span class="string">''</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">text </span><span class="keyword">= </span><span class="default">$text</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$force </span><span class="keyword">or </span><span class="default">count</span><span class="keyword">(</span><span class="default">$attributes</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">attributes </span><span class="keyword">= </span><span class="default">$attributes</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$force </span><span class="keyword">or </span><span class="default">count</span><span class="keyword">(</span><span class="default">$children</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">children </span><span class="keyword">= </span><span class="default">$children</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$obj</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108867""></a>
  <div class="note">
   <strong class="user">heaver</strong>
   <a href="#108867" class="date">31-May-2012 07:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
XML to JSON conversion without '@attributes'<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">XML2JSON</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">normalizeSimpleXML</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">, &amp;</span><span class="default">$result</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$obj</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">normalizeSimpleXML</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$key </span><span class="keyword">== </span><span class="string">'@attributes'</span><span class="keyword">) &amp;&amp; (</span><span class="default">$key</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$res</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$res</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">normalizeSimpleXML</span><span class="keyword">(</span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">), </span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108112""></a>
  <div class="note">
   <strong class="user">demian dot katz at villanova dot edu</strong>
   <a href="#108112" class="date">29-Mar-2012 05:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a more namespace-aware version of the earlier function for attaching one SimpleXMLElement to another.&nbsp; I'm sure it could still be further improved (right now it generates some redundant xmlns definitions), but it seems to be working well enough for my purposes so far.<br />
<br />
function SimpleXMLElement_append($parent, $child)<br />
{<br />
&nbsp;&nbsp;&nbsp; // get all namespaces for document<br />
&nbsp;&nbsp;&nbsp; $namespaces = $child-&gt;getNamespaces(true);<br />
<br />
&nbsp;&nbsp;&nbsp; // check if there is a default namespace for the current node<br />
&nbsp;&nbsp;&nbsp; $currentNs = $child-&gt;getNamespaces();<br />
&nbsp;&nbsp;&nbsp; $defaultNs = count($currentNs) &gt; 0 ? current($currentNs) : null;<br />
&nbsp;&nbsp;&nbsp; $prefix = (count($currentNs) &gt; 0) ? current(array_keys($currentNs)) : '';<br />
&nbsp;&nbsp;&nbsp; $childName = strlen($prefix) &gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ? $prefix . ':' . $child-&gt;getName() : $child-&gt;getName();<br />
<br />
&nbsp;&nbsp;&nbsp; // check if the value is string value / data<br />
&nbsp;&nbsp;&nbsp; if (trim((string) $child) == '') {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $element = $parent-&gt;addChild($childName, null, $defaultNs);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $element = $parent-&gt;addChild(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $childName, htmlspecialchars((string)$child), $defaultNs<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; foreach ($child-&gt;attributes() as $attKey =&gt; $attValue) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $element-&gt;addAttribute($attKey, $attValue);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach ($namespaces as $nskey =&gt; $nsurl) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($child-&gt;attributes($nsurl) as $attKey =&gt; $attValue) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $element-&gt;addAttribute($nskey . ':' . $attKey, $attValue, $nsurl);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; // add children -- try with namespaces first, but default to all children<br />
&nbsp;&nbsp;&nbsp; // if no namespaced children are found.<br />
&nbsp;&nbsp;&nbsp; $children = 0;<br />
&nbsp;&nbsp;&nbsp; foreach ($namespaces as $nskey =&gt; $nsurl) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($child-&gt;children($nsurl) as $currChild) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; SimpleXMLElement_append($element, $currChild);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $children++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ($children == 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($child-&gt;children() as $currChild) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; SimpleXMLElement_append($element, $currChild);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107869""></a>
  <div class="note">
   <strong class="user">saganmarketing.com</strong>
   <a href="#107869" class="date">12-Mar-2012 12:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Parsing an invalid XML string through SimpleXML causes the script to crash completely (usually) therefore it is best to make sure the XML is valid before parsing with something like this:<br />
<br />
// Must be tested with ===, as in if(isXML($xml) === true){}<br />
// Returns the error message on improper XML<br />
function isXML($xml){<br />
&nbsp;&nbsp;&nbsp; libxml_use_internal_errors(true);<br />
<br />
&nbsp;&nbsp;&nbsp; $doc = new DOMDocument('1.0', 'utf-8');<br />
&nbsp;&nbsp;&nbsp; $doc-&gt;loadXML($xml);<br />
<br />
&nbsp;&nbsp;&nbsp; $errors = libxml_get_errors();<br />
<br />
&nbsp;&nbsp;&nbsp; if(empty($errors)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return true;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $error = $errors[0];<br />
&nbsp;&nbsp;&nbsp; if($error-&gt;level &lt; 3){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return true;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $explodedxml = explode("r", $xml);<br />
&nbsp;&nbsp;&nbsp; $badxml = $explodedxml[($error-&gt;line)-1];<br />
<br />
&nbsp;&nbsp;&nbsp; $message = $error-&gt;message . ' at line ' . $error-&gt;line . '. Bad XML: ' . htmlentities($badxml);<br />
&nbsp;&nbsp;&nbsp; return $message;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106500""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#106500" class="date">14-Nov-2011 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning to anyone trying to parse XML with a key name that includes a hyphen ie.)<br />
&lt;subscribe&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;callback-url&gt;example url&lt;/callback-url&gt;<br />
&lt;/subscribe&gt;<br />
<br />
In order to access the callback-url you will need to do something like the following:<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
</span><span class="default">$callback </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;{</span><span class="string">"callback-url"</span><span class="keyword">};<br />
</span><span class="default">?&gt;<br />
</span>If you attempt to do it without the curly braces and quotes you will find out that you are returned a 0 instead of what you want.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105390""></a>
  <div class="note">
   <strong class="user">juanfhj at gmail dot spam dot me dot not dot com</strong>
   <a href="#105390" class="date">13-Aug-2011 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To access the underlying element as a string, it's necessary to make the cast $x = (string)$my_xml_element.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103614""></a>
  <div class="note">
   <strong class="user">dans at dansheps dot com</strong>
   <a href="#103614" class="date">22-Apr-2011 12:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I created a little function to parse the simple XML into a structure which is easier to iterate(I believe anyways) than the simpleXML node structure.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parseSimpleXML</span><span class="keyword">(</span><span class="default">$xmldata</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNames </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$xmldata</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">() !== </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$xmldata</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() AS </span><span class="default">$child </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !isset(</span><span class="default">$childNames</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNames</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childNames</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parseSimpleXML</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata </span><span class="keyword">= new </span><span class="default">XMLNode</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$xmldata</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">()-&gt;</span><span class="default">count</span><span class="keyword">() &gt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata</span><span class="keyword">-&gt;{</span><span class="string">'@attributes'</span><span class="keyword">} = new </span><span class="default">XMLAttribute</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$xmldata</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() AS </span><span class="default">$name </span><span class="keyword">=&gt; </span><span class="default">$attrib </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata</span><span class="keyword">-&gt;{</span><span class="string">'@attributes'</span><span class="keyword">}-&gt;{</span><span class="default">$name</span><span class="keyword">} = (string)</span><span class="default">$attrib</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">count</span><span class="keyword">(</span><span class="default">$childNames</span><span class="keyword">) &gt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$childNames </span><span class="keyword">AS </span><span class="default">$name </span><span class="keyword">=&gt; </span><span class="default">$count </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$count </span><span class="keyword">=== </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata</span><span class="keyword">-&gt;{</span><span class="default">$name</span><span class="keyword">} = </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata</span><span class="keyword">-&gt;{</span><span class="default">$name</span><span class="keyword">} = new </span><span class="default">XMLMultiNode</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$counter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] AS </span><span class="default">$data </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata</span><span class="keyword">-&gt;{</span><span class="default">$name</span><span class="keyword">}-&gt;{</span><span class="default">$counter</span><span class="keyword">} = </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$counter</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( (string)</span><span class="default">$xmldata </span><span class="keyword">!== </span><span class="string">'' </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returndata</span><span class="keyword">-&gt;{</span><span class="string">'@innerXML'</span><span class="keyword">} = (string)</span><span class="default">$xmldata</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$returndata</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102405""></a>
  <div class="note">
   <strong class="user">ms dot n at 163 dot com</strong>
   <a href="#102405" class="date">11-Feb-2011 10:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Adds a new function for SimpleXMLElement class, in order to output HTML code.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">CeiXML </span><span class="keyword">extends </span><span class="default">SimpleXMLElement</span><span class="keyword">{
<br />
public function </span><span class="default">asHTML</span><span class="keyword">(){
<br />
</span><span class="default">$ele</span><span class="keyword">=</span><span class="default">dom_import_simplexml</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);
<br />
</span><span class="default">$dom </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">(</span><span class="string">'1.0'</span><span class="keyword">, </span><span class="string">'utf-8'</span><span class="keyword">);
<br />
</span><span class="default">$element</span><span class="keyword">=</span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">importNode</span><span class="keyword">(</span><span class="default">$ele</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);
<br />
</span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">appendChild</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">);
<br />
return </span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">saveHTML</span><span class="keyword">();
<br />
}
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102361""></a>
  <div class="note">
   <strong class="user">Pavel Musil pavel dot musil at gmail dot com</strong>
   <a href="#102361" class="date">10-Feb-2011 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple recursive function to append XML object into SimpleXMLElement node:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// root: parent element - SimpleXMLElement instance<br />
// append: XML object from simplexml_load_string<br />
<br />
</span><span class="keyword">function </span><span class="default">xml_join</span><span class="keyword">(</span><span class="default">$root</span><span class="keyword">, </span><span class="default">$append</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$append</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">((string) </span><span class="default">$append</span><span class="keyword">))==</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= </span><span class="default">$root</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$append</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$append</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$child</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">xml_join</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= </span><span class="default">$root</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$append</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(), (string) </span><span class="default">$append</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$append</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$n </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$xml_append </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;data&gt;&lt;items&gt;&lt;item id="1"&gt;value&lt;/item&gt;&lt;/items&gt;&lt;/data&gt;'</span><span class="keyword">);<br />
</span><span class="default">$xml_root </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;result&gt;&lt;/result&gt;'</span><span class="keyword">);<br />
<br />
</span><span class="default">$cxml </span><span class="keyword">= </span><span class="default">$xml_root</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'clone'</span><span class="keyword">);<br />
</span><span class="default">xml_join</span><span class="keyword">(</span><span class="default">$cxml</span><span class="keyword">, </span><span class="default">$xml_append</span><span class="keyword">-&gt;</span><span class="default">items</span><span class="keyword">-&gt;</span><span class="default">item</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
<br />
print </span><span class="default">$xml_root</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Result:<br />
&lt;?xml version="1.0"?&gt;<br />
&lt;result&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;clone&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;item id="1"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; value<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/item&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/clone&gt;<br />
&lt;/result&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100811""></a>
  <div class="note">
   <strong class="user">rmirabelle</strong>
   <a href="#100811" class="date">08-Nov-2010 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To further previous comments and drive the point home:<br />
<br />
What makes SimpleXMLElement tricky to work with is that it feels and behaves like an object, but is actually a system RESOURCE,&nbsp; (specifically a libxml resource).&nbsp; <br />
<br />
That's why you can't store a SimpleXMLElement to $_SESSION or perform straight comparison operations on node values without first casting them to some type of object.&nbsp; $_SESSION expects to store 'an object' and comparison operators expect to compare 2 'objects' and SimpleXMLElements are not objects.&nbsp; <br />
<br />
When you echo or print a node's value, PHP converts the value (a resource) into a string object for you.&nbsp; It's a time saver for sure, but can fool you into thinking that your SimpleXMLElement is an object.&nbsp; <br />
<br />
Hope this helps clarify</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100162""></a>
  <div class="note">
   <strong class="user">joshduck at gmail dot com</strong>
   <a href="#100162" class="date">28-Sep-2010 05:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You should cast elements to a float (or even string) if you plan on using them in addition, multiplication, etc. If you don't then PHP will incorrectly treat the node values as an integer.<br />
<br />
<span class="default">&lt;?php<br />
$obj </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;root&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;a&gt;1.9&lt;/a&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;b&gt;1.9&lt;/b&gt;<br />
&lt;/root&gt;'</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">a </span><span class="keyword">+ </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">b</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">((float)</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">a </span><span class="keyword">+ (float)</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">b</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">((string)</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">a </span><span class="keyword">+ (string)</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">b</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The first line gives: int(2)<br />
The second and third give the expected result: float(3.8)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100071""></a>
  <div class="note">
   <strong class="user">francs at seznam dot cz</strong>
   <a href="#100071" class="date">23-Sep-2010 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware when you trying to cast some attribute to boolean.<br />
<br />
(boolean)$xml-&gt;attributes()-&gt;someAtt;<br />
<br />
returns TRUE if attribute is array([0] =&gt; 0);<br />
<br />
use (boolean)(int) instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99071""></a>
  <div class="note">
   <strong class="user">kweij at lsg dot nl</strong>
   <a href="#99071" class="date">26-Jul-2010 04:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm using SimpleXML for, ofcourse, it's simplicity, however I did wanted to manipulate the xml and combining one SimpleXMLElement with any other, so I wrote this function to add a SimpleXMLElement-child.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">SimpleXMLElement_append</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// check class<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ((</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) == </span><span class="string">'SimpleXMLElement'</span><span class="keyword">) &amp;&amp; (</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) == </span><span class="string">'SimpleXMLElement'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// check if the value is string value / data<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">trim</span><span class="keyword">((string) </span><span class="default">$value</span><span class="keyword">) == </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// add element and attributes<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element </span><span class="keyword">= </span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$attKey </span><span class="keyword">=&gt; </span><span class="default">$attValue</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$attKey</span><span class="keyword">, </span><span class="default">$attValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// add children<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$child</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">SimpleXMLElement_append</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">, </span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// set the value of this item<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element </span><span class="keyword">= </span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(), </span><span class="default">trim</span><span class="keyword">((string) </span><span class="default">$value</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// throw an error<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Wrong type of input parameters, expected SimpleXMLElement'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I'd recommend SimpleXMLElement to extend it's addChild() function with the functionalitity above.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98717""></a>
  <div class="note">
   <strong class="user">cherubangel at gmail dot com</strong>
   <a href="#98717" class="date">02-Jul-2010 04:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that changing attributes from within a foreach loop, especially namespaced attributes, can be very tricky.<br />
<br />
For example, when trying to change the value of an existing xlink:href attribute:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach(</span><span class="default">$xmlelement </span><span class="keyword">-&gt; </span><span class="default">attributes</span><span class="keyword">(</span><span class="string">'xlink'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) as </span><span class="default">$attribute </span><span class="keyword">=&gt; </span><span class="default">$attribvalue</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$attribvalue</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'value'</span><span class="keyword">; </span><span class="comment">// Throws an error<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$attribvalue </span><span class="keyword">= </span><span class="string">'value'</span><span class="keyword">; </span><span class="comment">// Does not change your XML<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xmlelement </span><span class="keyword">-&gt; </span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$attribute</span><span class="keyword">, </span><span class="string">'value'</span><span class="keyword">, </span><span class="string">'<a href="http://www.w3.org/1999/xlink" rel="nofollow" target="_blank">http://www.w3.org/1999/xlink</a>'</span><span class="keyword">); </span><span class="comment">// Adds an attribute, does not change existing one.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xmlelement</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">] = </span><span class="string">'value'</span><span class="keyword">; </span><span class="comment">// Adds an attribute, does not change existing one.<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
Instead, you should access the array returned by the attributes() function directly, like this:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $xmlelement </span><span class="keyword">-&gt; </span><span class="default">attributes</span><span class="keyword">(</span><span class="string">'xlink'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) -&gt; </span><span class="default">href </span><span class="keyword">= </span><span class="string">'value'</span><span class="keyword">; </span><span class="comment">// Works!<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96317""></a>
  <div class="note">
   <strong class="user">php at keith tyler dot com</strong>
   <a href="#96317" class="date">19-Feb-2010 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The root node element of your input XML string is not retrievable as a property.<br />
<br />
<span class="default">&lt;?php<br />
$xml</span><span class="keyword">=</span><span class="string">"&lt;foo&gt;bar&lt;/foo&gt;"</span><span class="keyword">;<br />
</span><span class="default">$sxe</span><span class="keyword">=new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
print </span><span class="default">$sxe</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
prints nothing. You can only get to the root element via the array index method ($sxe[0]).<br />
<br />
Also, you may not have two (or more) root elements -- that is apparently not well-formed XML.<br />
<br />
<span class="default">&lt;?php<br />
$xml</span><span class="keyword">=</span><span class="string">"&lt;foo/&gt;&lt;bar/&gt;"</span><span class="keyword">;<br />
</span><span class="default">$sxe</span><span class="keyword">=new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
throws an exception. A Q&amp;D is to append an arbitraty root node structure to both ends of the input:<br />
<br />
<span class="default">&lt;?php<br />
$xml</span><span class="keyword">=</span><span class="string">"&lt;foo/&gt;&lt;bar/&gt;"</span><span class="keyword">;<br />
</span><span class="default">$sxe</span><span class="keyword">=new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">"&lt;z&gt;"</span><span class="keyword">.</span><span class="default">$xml</span><span class="keyword">.</span><span class="string">"&lt;/z&gt;"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Doing this also solves the above problem of root node property accessibility. (It may not work if your XML string includes a declaration.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95229""></a>
  <div class="note">
   <strong class="user">triplepoint at gmail dot com</strong>
   <a href="#95229" class="date">19-Dec-2009 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's occasionally useful to add an XML processing instruction to a SimpleXMLElement (treating it as if it were a full document).
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">SimpleXMLElement_Plus </span><span class="keyword">extends </span><span class="default">SimpleXMLElement </span><span class="keyword">{
<br />

<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">addProcessingInstruction</span><span class="keyword">( </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create a DomElement from this simpleXML object
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom_sxe </span><span class="keyword">= </span><span class="default">dom_import_simplexml</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create a handle to the owner doc of this xml
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom_parent </span><span class="keyword">= </span><span class="default">$dom_sxe</span><span class="keyword">-&gt;</span><span class="default">ownerDocument</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Find the topmost element of the domDocument
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xpath </span><span class="keyword">= new </span><span class="default">DOMXPath</span><span class="keyword">(</span><span class="default">$dom_parent</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first_element </span><span class="keyword">= </span><span class="default">$xpath</span><span class="keyword">-&gt;</span><span class="default">evaluate</span><span class="keyword">(</span><span class="string">'/*[1]'</span><span class="keyword">)-&gt;</span><span class="default">item</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add the processing instruction before the topmost element&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pi </span><span class="keyword">= </span><span class="default">$dom_parent</span><span class="keyword">-&gt;</span><span class="default">createProcessingInstruction</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom_parent</span><span class="keyword">-&gt;</span><span class="default">insertBefore</span><span class="keyword">(</span><span class="default">$pi</span><span class="keyword">, </span><span class="default">$first_element</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
For example, if you had a simpleXMLElement_Plus object made out of the xml fragment:
<br />
&lt;xml&gt;&lt;content /&gt;&lt;/xml&gt;
<br />

<br />
And you needed the output to be:
<br />
&lt;?xml version="1.0"?&gt;
<br />
&lt;?xml-stylesheet type="text/xsl" href="xsl/xsl.xsl"?&gt;
<br />
&lt;xml&gt;&lt;content/&gt;&lt;/xml&gt;
<br />

<br />
you could do (using the class above):
<br />
<span class="default">&lt;?php
<br />
$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement_Plus</span><span class="keyword">(</span><span class="string">'&lt;xml&gt;&lt;content /&gt;&lt;/xml&gt;'</span><span class="keyword">);
<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addProcessingInstruction</span><span class="keyword">(</span><span class="string">'xml-stylesheet'</span><span class="keyword">, </span><span class="string">'type="text/xsl" href="xsl/xsl.xsl"'</span><span class="keyword">);
<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94718""></a>
  <div class="note">
   <strong class="user">ivandosreisandrade at gmail dot com</strong>
   <a href="#94718" class="date">19-Nov-2009 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
here goes my contribution for those whom are struggling to understand how SimpleXMLElement works.<br />
<br />
After some time trying to figure out how this works, I've came up to this small example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $xmlstr </span><span class="keyword">= </span><span class="string">"&lt;?xml version='1.0' ?&gt;\n"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// optionally you can specify a xml-stylesheet for presenting the results. just uncoment the following line and change the stylesheet name.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; /* "&lt;?xml-stylesheet type='text/xsl' href='xml_style.xsl' ?&gt;\n". */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;book&gt;&lt;/book&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// create the SimpleXMLElement object with an empty &lt;book&gt; element<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// add some child nodes<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">"title"</span><span class="keyword">, </span><span class="string">"Title of my book"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">"abstract"</span><span class="keyword">, </span><span class="string">"My book is about learning to work with SimpleXMLElement"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// add some more child nodes<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chapter1 </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">"chapter_1"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// add an attribute to child chapter_1<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chapter1</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="string">"chapter_title"</span><span class="keyword">, </span><span class="string">"Introduction to my book"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chapter2 </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">"chapter_2"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chapter2</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="string">"chapter_title"</span><span class="keyword">, </span><span class="string">"Development of my book"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chapter3 </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">"chapter_3"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chapter3</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="string">"chapter_title"</span><span class="keyword">, </span><span class="string">"Another chapter of my book"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$conclusion </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">"conclusion"</span><span class="keyword">, </span><span class="string">"The ending of my book"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// insert the header to tell the browser how to read the document<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: text/xml"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print the SimpleXMLElement as a XML well-formed string<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
With this script you can just copy-paste and try to understand how it works.<br />
I hope it can help somebody :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94296""></a>
  <div class="note">
   <strong class="user">brett at brettbrewer dot com</strong>
   <a href="#94296" class="date">27-Oct-2009 04:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Figuring out how to access the properties of a SimpleXmlElement object was a little tricky for me. In particular, it took a while to discover that I needed to cast my SimpleXmlElement properties to be of type "string" to print them or do comparisons on them. For instance, assuming you already have a string of xml in $xmlstr...<br />
<br />
<span class="default">&lt;?php<br />
$sxml</span><span class="keyword">= new </span><span class="default">SimpleXmlElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
<br />
if ((string) </span><span class="default">$sxml</span><span class="keyword">-&gt;</span><span class="default">property</span><span class="keyword">== </span><span class="string">"somevalue"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo (string) </span><span class="default">$sxml</span><span class="keyword">-&gt;</span><span class="default">property</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>The properties of a SimpleXmlElement object are objects themselves, so you need to put "(string)" before them, which casts their values to a string instead of an object. I assume if you were doing a numeric comparison you'd want to cast to an (int) or something numeric instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
