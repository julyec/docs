<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>读取/设置当前会话的保存路径</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.session-reset.html">? session_reset</a></li>
      <li style="float: right;"><a href="function.session-set-cookie-params.html">session_set_cookie_params ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.session.html">Session 函数</a></li>
    <li>读取/设置当前会话的保存路径</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.session-save-path" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_save_path</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">session_save_path</span> &mdash; <span class="dc-title">读取/设置当前会话的保存路径</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.session-save-path-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>session_save_path</strong></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$path</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_save_path()</strong></span> 
   返回当前会话的保存路径。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.session-save-path-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">path</code></dt>

     <dd>

      <p class="para">
       指定会话数据保存的路径。如果已经指定且不为 <strong><code>null</code></strong>，保存数据的路径将会改变。
       必须在调用 <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span> 函数之前调用
       <span class="function"><strong>session_save_path()</strong></span> 函数。
      </p>
      <p class="para">
       <blockquote class="note"><p><strong class="note">Note</strong>: 
        <p class="para">
         在某些操作系统上，建议使用可以高效处理
         大量小尺寸文件的文件系统上的路径来保存会话数据。
         例如，在 Linux 平台上，对于会话数据保存的工作而言，reiserfs 文件系统会比 ext2fs 文件系统能够提供更好的性能。
        </p>
       </p></blockquote>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-save-path-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回保存会话数据的路径， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.session-save-path-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">path</code> 现在可为 null。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-save-path-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member">
     <a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a>
     配置指令。
    </li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123596""></a>
  <div class="note">
   <strong class="user">hrushiemail at gmail dot com</strong>
   <a href="#123596" class="date">09-Feb-2019 03:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">'session.save_path'</span><span class="keyword">,</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">]) . </span><span class="string">'/tmp'</span><span class="keyword">));<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'session.gc_probability'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
(for using above code create a tmp folder/directory in your directory)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122023""></a>
  <div class="note">
   <strong class="user">ohcc at 163 dot com</strong>
   <a href="#122023" class="date">15-Dec-2017 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If session.save_handler is set to files, on systems that have maximum path length limitations, when the session data file's path is too long, php may get you an error like "No such file or directory" and fails to start session, although the session-saving folder really exists on the disk.<br />
<br />
You should:<br />
<br />
1. Keep the session-saving folder's absolute path not too long<br />
2. If you're with PHP 7.1+, don't set session.sid_length to a number too great, such as 255<br />
<br />
I once got stuck with this problem on Windows and wasted hours to solve it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113372""></a>
  <div class="note">
   <strong class="user">mdibbets at outlook dot nospam</strong>
   <a href="#113372" class="date">03-Oct-2013 07:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made a folder next to the public html folder and placed these lines at the very first point in index.php<br />
<br />
Location of session folder:<br />
<br />
/domains/account/session<br />
<br />
location of index.php<br />
<br />
/domains/account/public_html/index.php<br />
<br />
What I placed in index.php at line 0:<br />
<br />
<span class="default">&lt;?php <br />
ini_set</span><span class="keyword">(</span><span class="string">'session.save_path'</span><span class="keyword">,</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">]) . </span><span class="string">'/../session'</span><span class="keyword">));<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">This is the only solution that worked </span><span class="keyword">for </span><span class="default">me</span><span class="keyword">. </span><span class="default">Hope this helps someone</span><span class="keyword">.</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98106""></a>
  <div class="note">
   <strong class="user">alvaro at demogracia dot com</strong>
   <a href="#98106" class="date">26-May-2010 03:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Debian does not use the default garbage collector for sessions. Instead, it sets session.gc_probability to zero and it runs a cron job to clean up old session data in the default directory.<br />
<br />
As a result, if your site sets a custom location with session_save_path() you also need to set a value for session.gc_probability, e.g.:<br />
<br />
<span class="default">&lt;?php<br />
session_save_path</span><span class="keyword">(</span><span class="string">'/home/example.com/sessions'</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'session.gc_probability'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Otherwise, old files in '/home/example.com/sessions' will never get removed!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80901""></a>
  <div class="note">
   <strong class="user">sampathperera at hotmail dot com - Sri Lanka</strong>
   <a href="#80901" class="date">05-Feb-2008 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Session on clustered web servers !<br />
<br />
We had problem in PHP session handling with 2 web server cluster. Problem was one servers session data was not available in other server.<br />
<br />
So I made a simple configuration in both server php.ini file. Changed session.save_path default value to shared folder on both servers (/mnt/session/).<br />
<br />
It works for me. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
