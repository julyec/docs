<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>返回指定目录下文件的详细列表</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.ftp-raw.html">? ftp_raw</a></li>
      <li style="float: right;"><a href="function.ftp-rename.html">ftp_rename ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.ftp.html">FTP 函数</a></li>
    <li>返回指定目录下文件的详细列表</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.ftp-rawlist" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ftp_rawlist</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">ftp_rawlist</span> &mdash; <span class="dc-title">返回指定目录下文件的详细列表</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.ftp-rawlist-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>ftp_rawlist</strong></span>(<span class="methodparam"><span class="type"><a href="class.ftp-connection.html" class="type FTP\Connection">FTP\Connection</a></span> <code class="parameter">$ftp</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$directory</code></span>, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$recursive</code><span class="initializer"> = <strong><code>false</code></strong></span></span>): <span class="type"><span class="type">array</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>ftp_rawlist()</strong></span> 函数将执行 FTP
   <strong class="command">LIST</strong> 命令，并把结果做为一个数组返回。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.ftp-rawlist-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">ftp</code></dt>

     <dd>

       <p class="para"><span class="classname"><a href="class.ftp-connection.html" class="classname">FTP\Connection</a></span> 实例。</p>
     </dd>

    
    
     <dt>
<code class="parameter">directory</code></dt>

     <dd>

      <p class="para">
       要操作的目录路径，可以包括 <strong class="command">LIST</strong> 参数。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">recursive</code></dt>

     <dd>

      <p class="para">
       如果此参数为 <strong><code>true</code></strong>，实际执行的命令将会为 <strong class="command">LIST -R</strong>。
     </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.ftp-rawlist-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回一个数组，数组的每个元素为返回文本的每一行，输出结构不会被解析。使用函数
   <span class="function"><a href="function.ftp-systype.html" class="function">ftp_systype()</a></span> 可以用来判断 FTP 服务器的类型，从而可以用来判断返回列表的类型。
  </p>
  <p class="para">
   不以任何方式解析输出。<span class="function"><a href="function.ftp-systype.html" class="function">ftp_systype()</a></span> 返回的系统类型标识符可用于确定应如何解释结果。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.ftp-rawlist-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
 <td>8.1.0</td>
 <td>
  现在 <code class="parameter">ftp</code> 参数接受 <span class="classname"><a href="class.ftp-connection.html" class="classname">FTP\Connection</a></span>
  实例，之前接受 <a href="language.types.resource.html" class="link">资源(resource)</a>。
 </td>
</tr>

    </tbody>
   
  </table>

 </div>

 
 <div class="refsect1 examples" id="refsect1-function.ftp-rawlist-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>ftp_rawlist()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">// 初始化连接<br /></span><span style="color: #0000BB">$ftp </span><span style="color: #007700">= </span><span style="color: #0000BB">ftp_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$ftp_server</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 使用用户名和密码登录<br /></span><span style="color: #0000BB">$login_result </span><span style="color: #007700">= </span><span style="color: #0000BB">ftp_login</span><span style="color: #007700">(</span><span style="color: #0000BB">$ftp</span><span style="color: #007700">, </span><span style="color: #0000BB">$ftp_user_name</span><span style="color: #007700">, </span><span style="color: #0000BB">$ftp_user_pass</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 获取 / 路径下的文件列表<br /></span><span style="color: #0000BB">$buff </span><span style="color: #007700">= </span><span style="color: #0000BB">ftp_rawlist</span><span style="color: #007700">(</span><span style="color: #0000BB">$ftp</span><span style="color: #007700">, </span><span style="color: #DD0000">'/'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 关闭连接<br /></span><span style="color: #0000BB">ftp_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ftp</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// 输出<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$buff</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [0]=&gt;
  string(65) &quot;drwxr-x---   3 vincent  vincent      4096 Jul 12 12:16 public_ftp&quot;
  [1]=&gt;
  string(66) &quot;drwxr-x---  15 vincent  vincent      4096 Nov  3 21:31 public_html&quot;
  [2]=&gt;
  string(73) &quot;lrwxrwxrwx   1 vincent  vincent        11 Jul 12 12:16 www -&gt; public_html&quot;
}
</pre></div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.ftp-rawlist-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.ftp-nlist.html" class="function" rel="rdfs-seeAlso">ftp_nlist()</a> - 返回给定目录的文件列表</span></li>
    <li class="member"><span class="function"><a href="function.ftp-mlsd.html" class="function" rel="rdfs-seeAlso">ftp_mlsd()</a> - 返回指定目录中的文件列表</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="122642""></a>
  <div class="note">
   <strong class="user">Roline88 at hotmail dot com</strong>
   <a href="#122642" class="date">19-Apr-2018 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function also will return false if the content of the provided directory is empty.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114910""></a>
  <div class="note">
   <strong class="user">nickman at freemail dot hu</strong>
   <a href="#114910" class="date">24-Apr-2014 07:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The solution of fredvanetten at tinqle dot com is nice but needs further evaluation as because of the preg_split and static listing of the variables will produce different values: comparing a file of today or an older, from a previous year:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [time] =&gt; 2012<br />
&nbsp;&nbsp;&nbsp; [day] =&gt; 11<br />
&nbsp;&nbsp;&nbsp; [month] =&gt; Sep<br />
&nbsp;&nbsp;&nbsp; [size] =&gt; 37262<br />
&nbsp;&nbsp;&nbsp; [group] =&gt; group<br />
&nbsp;&nbsp;&nbsp; [user] =&gt; owner<br />
&nbsp;&nbsp;&nbsp; [number] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [rights] =&gt; -rw-rw-rw-<br />
)<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [time] =&gt; 14:01<br />
&nbsp;&nbsp;&nbsp; [day] =&gt; 23<br />
&nbsp;&nbsp;&nbsp; [month] =&gt; Apr<br />
&nbsp;&nbsp;&nbsp; [size] =&gt; 37262<br />
&nbsp;&nbsp;&nbsp; [group] =&gt; group<br />
&nbsp;&nbsp;&nbsp; [user] =&gt; owner<br />
&nbsp;&nbsp;&nbsp; [number] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [rights] =&gt; -rw-rw-rw-<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114633""></a>
  <div class="note">
   <strong class="user">mediaboat at gmail dot com</strong>
   <a href="#114633" class="date">14-Mar-2014 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
All&nbsp; parse_rawlist Functions here have one Problem.<br />
<br />
when a file starts with a space character like " robots.txt ", it will be ignored.<br />
<br />
Rename, delete will fail...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110803""></a>
  <div class="note">
   <strong class="user">fredvanetten at tinqle dot com</strong>
   <a href="#110803" class="date">10-Dec-2012 07:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple function that'll parse the data returned by ftp_rawlist() into an associative array. I wrote it because some of the functions listed below are way to long, complex or won't work with file names that contain spaces.
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">listDetailed</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="default">$directory </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$children </span><span class="keyword">= @</span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="default">$directory</span><span class="keyword">))) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items </span><span class="keyword">= array();
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$children </span><span class="keyword">as </span><span class="default">$child</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chunks </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/\s+/"</span><span class="keyword">, </span><span class="default">$child</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$item</span><span class="keyword">[</span><span class="string">'rights'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'number'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'group'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'day'</span><span class="keyword">], </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">]) = </span><span class="default">$chunks</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">] = </span><span class="default">$chunks</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]{</span><span class="default">0</span><span class="keyword">} === </span><span class="string">'d' </span><span class="keyword">? </span><span class="string">'directory' </span><span class="keyword">: </span><span class="string">'file'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_splice</span><span class="keyword">(</span><span class="default">$chunks</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">implode</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">, </span><span class="default">$chunks</span><span class="keyword">)] = </span><span class="default">$item</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$items</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Throw exception or return false &lt; up to you
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101071""></a>
  <div class="note">
   <strong class="user">Johnny Doe</strong>
   <a href="#101071" class="date">24-Nov-2010 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In case anybody wants to get a detailed listing using the MLSD command over a passive connection, the following function might be helpful as a starting point for your own implementation:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">ftp_mlsd</span><span class="keyword">(</span><span class="default">$ftp</span><span class="keyword">, </span><span class="default">$directory</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ok </span><span class="keyword">= @</span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$ftp</span><span class="keyword">, </span><span class="default">$directory</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$ok</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">ftp_raw</span><span class="keyword">(</span><span class="default">$ftp</span><span class="keyword">, </span><span class="string">'PASV'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/^227.*\(([0-9]+,[0-9]+,[0-9]+,[0-9]+),([0-9]+),([0-9]+)\)$/'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$matches</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$controlIP </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$controlPort </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])*</span><span class="default">256</span><span class="keyword">+</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$socket </span><span class="keyword">= </span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$controlIP</span><span class="keyword">, </span><span class="default">$controlPort</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ftp_raw</span><span class="keyword">(</span><span class="default">$ftp</span><span class="keyword">, </span><span class="string">'MLSD'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$socket</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$socket</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$socket</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= array();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">) as </span><span class="default">$line</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$line</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= array();
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">explode</span><span class="keyword">(</span><span class="string">';'</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">) as </span><span class="default">$property</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$property</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$value</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[</span><span class="default">$filename</span><span class="keyword">] = </span><span class="default">$file</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Please note that this function ignores the setting of ftp_pasv(). Making the function to work universally for both active and passive connections is left as an exercise to the reader ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97876""></a>
  <div class="note">
   <strong class="user">shaun at shaunfreeman dot co dot uk</strong>
   <a href="#97876" class="date">13-May-2010 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Get a listing of all files including hidden files except '.' or '..' use:
<br />

<br />
<span class="default">&lt;?php
<br />
ftp_chdir</span><span class="keyword">(</span><span class="default">$connid</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">);
<br />
</span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$connid</span><span class="keyword">, </span><span class="string">"-A"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
This had me dancing in circles for some time!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97683""></a>
  <div class="note">
   <strong class="user">John</strong>
   <a href="#97683" class="date">02-May-2010 04:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There are a couple of php-related reasons given here for ftp_rawlist returning an empty result. However be aware that ZoneAlarm (and possibly other) firewalls can block responses without giving any visible clue so be sure to check that first.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94412""></a>
  <div class="note">
   <strong class="user">nospam at advancedonsite dot com</strong>
   <a href="#94412" class="date">03-Nov-2009 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ftp_rawlist kept returning empty file listing, it would work on some machines but not others, it turned out to be ftp_pasv command was needed.<br />
Very frustrating</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91722""></a>
  <div class="note">
   <strong class="user">ahmadmarafa at gmail dot com</strong>
   <a href="#91722" class="date">23-Jun-2009 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this is function to check for dirs 
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">ftp_isdir</span><span class="keyword">(</span><span class="default">$connect_id</span><span class="keyword">,</span><span class="default">$dir</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$connect_id</span><span class="keyword">,</span><span class="default">$dir</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ftp_cdup</span><span class="keyword">(</span><span class="default">$connect_id</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91120""></a>
  <div class="note">
   <strong class="user">tmp at gmx dot de</strong>
   <a href="#91120" class="date">26-May-2009 04:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To format the _recrusive_ result of this function I use this:<br />
<br />
<span class="default">&lt;?php<br />
$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">FTP_SERVER</span><span class="keyword">);<br />
<br />
</span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">FTP_USR</span><span class="keyword">, </span><span class="default">FTP_PASS</span><span class="keyword">);<br />
<br />
</span><span class="default">$rawfiles </span><span class="keyword">= </span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);<br />
<br />
</span><span class="comment">// here the magic begins!<br />
</span><span class="default">$structure </span><span class="keyword">= array();<br />
</span><span class="default">$arraypointer </span><span class="keyword">= &amp;</span><span class="default">$structure</span><span class="keyword">;<br />
foreach (</span><span class="default">$rawfiles </span><span class="keyword">as </span><span class="default">$rawfile</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$rawfile</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] == </span><span class="string">'/'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$paths </span><span class="keyword">= </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$rawfile</span><span class="keyword">)), </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arraypointer </span><span class="keyword">= &amp;</span><span class="default">$structure</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$paths </span><span class="keyword">as </span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$arraypointer </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'text'</span><span class="keyword">] == </span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arraypointer </span><span class="keyword">= &amp;</span><span class="default">$arraypointer</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">][</span><span class="string">'children'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } elseif(!empty(</span><span class="default">$rawfile</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/[\s]+/"</span><span class="keyword">, </span><span class="default">$rawfile</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arraypointer</span><span class="keyword">[] = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'text'&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="default">$info</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'isDir'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">$info</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">'d'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'size'&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="default">byteconvert</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">]),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'chmod'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">chmodnum</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'date'&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] . </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$info</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] . </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$info</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">]),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'raw'&nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">$info<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// the 'children' attribut is automatically added if the folder contains at least one file<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// in $structure is all the data<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$structure</span><span class="keyword">);<br />
<br />
</span><span class="comment">// little helper functions<br />
</span><span class="keyword">function </span><span class="default">byteconvert</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$symbol </span><span class="keyword">= array(</span><span class="string">'B'</span><span class="keyword">, </span><span class="string">'KB'</span><span class="keyword">, </span><span class="string">'MB'</span><span class="keyword">, </span><span class="string">'GB'</span><span class="keyword">, </span><span class="string">'TB'</span><span class="keyword">, </span><span class="string">'PB'</span><span class="keyword">, </span><span class="string">'EB'</span><span class="keyword">, </span><span class="string">'ZB'</span><span class="keyword">, </span><span class="string">'YB'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">( </span><span class="default">log</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">) / </span><span class="default">log</span><span class="keyword">(</span><span class="default">1024</span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">sprintf</span><span class="keyword">( </span><span class="string">'%.2f ' </span><span class="keyword">. </span><span class="default">$symbol</span><span class="keyword">[ </span><span class="default">$exp </span><span class="keyword">], (</span><span class="default">$bytes </span><span class="keyword">/ </span><span class="default">pow</span><span class="keyword">(</span><span class="default">1024</span><span class="keyword">, </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$exp</span><span class="keyword">))) );<br />
}<br />
<br />
function </span><span class="default">chmodnum</span><span class="keyword">(</span><span class="default">$chmod</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trans </span><span class="keyword">= array(</span><span class="string">'-' </span><span class="keyword">=&gt; </span><span class="string">'0'</span><span class="keyword">, </span><span class="string">'r' </span><span class="keyword">=&gt; </span><span class="string">'4'</span><span class="keyword">, </span><span class="string">'w' </span><span class="keyword">=&gt; </span><span class="string">'2'</span><span class="keyword">, </span><span class="string">'x' </span><span class="keyword">=&gt; </span><span class="string">'1'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chmod </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$chmod</span><span class="keyword">, </span><span class="default">$trans</span><span class="keyword">), </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$chmod</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])) . </span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) . </span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]));<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89540""></a>
  <div class="note">
   <strong class="user">francois frao_o</strong>
   <a href="#89540" class="date">12-Mar-2009 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Why not using POSIX regex to do the job here ? A preg_replace returns the information in an associative array with the following keys:<br />
<br />
&lt;rights&gt;<br />
&lt;number&gt;<br />
&lt;owner&gt;<br />
&lt;group&gt;<br />
&lt;file_size&gt;<br />
&lt;mod_time&gt;<br />
&lt;file&gt;<br />
&lt;type&gt; * that's a bonus: it will tell you if the item is either a file or a directory<br />
<br />
Code is shown below:<br />
<br />
$list=@ftp_rawlist($con,$directory) ;<br />
<br />
$items=array() ;<br />
<br />
foreach($list as $_)<br />
preg_replace(<br />
<br />
'`^(.{10}+)(\s*)(\d{1})(\s*)(\d*|\w*)'.<br />
'(\s*)(\d*|\w*)(\s*)(\d*)\s'.<br />
'([a-zA-Z]{3}+)(\s*)([0-9]{1,2}+)'.<br />
'(\s*)([0-9]{2}+):([0-9]{2}+)(\s*)(.*)$`Ue',<br />
<br />
'$items[]=array(<br />
"rights"=&gt;"$1", <br />
"number"=&gt;"$3", <br />
"owner"=&gt;"$5", "group"=&gt;"$7",<br />
"file_size"=&gt;"$9",<br />
"mod_time"=&gt;"$10 $12 $14:$15",<br />
"file"=&gt;"$17",<br />
"type"=&gt;print_r((preg_match("/^d/","$1"))?"dir":"file",1));',<br />
<br />
$_) ; # :p</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86869""></a>
  <div class="note">
   <strong class="user">www.bosssftp.com</strong>
   <a href="#86869" class="date">07-Nov-2008 02:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some FTP servers only allow you to get list of files under current working directory. So if you always get result as empty array (array(0){ }), try changing the cwd befor get the list:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">ftprawlist</span><span class="keyword">(</span><span class="default">$connid</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">) {
<br />
&nbsp; </span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$connid</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">);
<br />
&nbsp; return </span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$connid</span><span class="keyword">, </span><span class="string">"-a"</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82752""></a>
  <div class="note">
   <strong class="user">paul maybe at squirrel mail org</strong>
   <a href="#82752" class="date">24-Apr-2008 05:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding converting permissions from symbolic notation to octal, note that Hazem dot Khaled at gmail dot com's chmodnum function produces INCORRECT results.&nbsp; The resutls are base-10 numbers that only LOOK like they are octal numbers.&nbsp; The function also ignores setuid, setgid and sticky bits, and will produce incorrect numbers if such a file is encountered.&nbsp; Instead, this brute-force code works.&nbsp; Maybe there is something more slick, but this isn't too CPU-intensive (note that it assumes you've error-checked that you indeed have a 10-character string!):<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $permissions = 'drwxr-xr-x';&nbsp; // or whatever<br />
&nbsp;&nbsp; &nbsp;&nbsp; $mode = 0;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[1] == 'r') $mode += 0400;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[2] == 'w') $mode += 0200;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[3] == 'x') $mode += 0100;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if ($permissions[3] == 's') $mode += 04100;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if ($permissions[3] == 'S') $mode += 04000;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[4] == 'r') $mode += 040;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[5] == 'w') $mode += 020;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[6] == 'x') $mode += 010;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if ($permissions[6] == 's') $mode += 02010;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if ($permissions[6] == 'S') $mode += 02000;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[7] == 'r') $mode += 04;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[8] == 'w') $mode += 02;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ($permissions[9] == 'x') $mode += 01;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if ($permissions[9] == 't') $mode += 01001;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if ($permissions[9] == 'T') $mode += 01000;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; printf('Mode is %d decimal and %o octal', $mode, $mode);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80218""></a>
  <div class="note">
   <strong class="user">weltvolk</strong>
   <a href="#80218" class="date">04-Jan-2008 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With this handy function based on functions presented here you get the file list in alphabetical order with all directories on top:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">rawlist_dump</span><span class="keyword">() {<br />
&nbsp; global </span><span class="default">$ftp_connect</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$ftp_rawlist </span><span class="keyword">= </span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$ftp_connect</span><span class="keyword">, </span><span class="string">"."</span><span class="keyword">);<br />
&nbsp; foreach (</span><span class="default">$ftp_rawlist </span><span class="keyword">as </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$vinfo </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">"/[\s]+/"</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] !== </span><span class="string">"total"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'chmod'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'num'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'owner'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'group'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'day'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] = </span><span class="default">$vinfo</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rawlist</span><span class="keyword">[</span><span class="default">$info</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]] = </span><span class="default">$info</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$dir </span><span class="keyword">= array();<br />
&nbsp; </span><span class="default">$file </span><span class="keyword">= array();<br />
&nbsp; foreach (</span><span class="default">$rawlist </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$v</span><span class="keyword">[</span><span class="string">'chmod'</span><span class="keyword">]{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"d"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } elseif (</span><span class="default">$v</span><span class="keyword">[</span><span class="string">'chmod'</span><span class="keyword">]{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"-"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; foreach (</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$dirname </span><span class="keyword">=&gt; </span><span class="default">$dirinfo</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"[ </span><span class="default">$dirname</span><span class="string"> ] " </span><span class="keyword">. </span><span class="default">$dirinfo</span><span class="keyword">[</span><span class="string">'chmod'</span><span class="keyword">] . </span><span class="string">" | " </span><span class="keyword">. </span><span class="default">$dirinfo</span><span class="keyword">[</span><span class="string">'owner'</span><span class="keyword">] . </span><span class="string">" | " </span><span class="keyword">. </span><span class="default">$dirinfo</span><span class="keyword">[</span><span class="string">'group'</span><span class="keyword">] . </span><span class="string">" | " </span><span class="keyword">. </span><span class="default">$dirinfo</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">] . </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$dirinfo</span><span class="keyword">[</span><span class="string">'day'</span><span class="keyword">] . </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$dirinfo</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">] . </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; foreach (</span><span class="default">$file </span><span class="keyword">as </span><span class="default">$filename </span><span class="keyword">=&gt; </span><span class="default">$fileinfo</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$filename</span><span class="string"> " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'chmod'</span><span class="keyword">] . </span><span class="string">" | " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'owner'</span><span class="keyword">] . </span><span class="string">" | " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'group'</span><span class="keyword">] . </span><span class="string">" | " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">] . </span><span class="string">" Byte | " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">] . </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'day'</span><span class="keyword">] . </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">] . </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">rawlist_dump</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70447""></a>
  <div class="note">
   <strong class="user">ari at bs-inc dot com</strong>
   <a href="#70447" class="date">17-Oct-2006 01:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a little cleaner:<br />
<br />
function parse_rawlist( $array )<br />
{<br />
&nbsp;&nbsp;&nbsp; foreach($array as $curraw)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $current = preg_split("/[\s]+/",$curraw,9);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['perms']&nbsp; = $current[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['number'] = $current[1];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['owner']&nbsp; = $current[2];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['group']&nbsp; = $current[3];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['size']&nbsp; = $current[4];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['month']&nbsp; = $current[5];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['day']&nbsp; &nbsp; = $current[6];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['time']&nbsp; = $current[7];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['year']&nbsp; = $current[8];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $struc['raw']&nbsp; = $curraw;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $structure[$struc['name']] = $struc;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return $structure;<br />
<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59346""></a>
  <div class="note">
   <strong class="user">admin at mikeholloway dot co dot uk</strong>
   <a href="#59346" class="date">03-Dec-2005 02:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problems picking up the directories on a mac using cjacobsen at pge dot cl's (11-Jan-05) solution. Slight ammendment to the regexp works for me:<br />
<br />
ereg("([-dl][rwxstST-]+).* ?([0-9 ]* )?([a-zA-Z0-9]+).* ([a-zA-Z0-9]+).* ([0-9]*) ([a-zA-Z]+[0-9: ]*[0-9])[ ]+(([0-9]{2}:[0-9]{2})|[0-9]{4}) (.+)", $file, $regs)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52635""></a>
  <div class="note">
   <strong class="user">nate at 8networks dot com</strong>
   <a href="#52635" class="date">07-May-2005 12:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this snip fixes the date problem with the listing and sorts out the variables:<br />
<br />
$filedata['access_permissions']<br />
$filedata['link_count']<br />
$filedata['uid']<br />
$filedata['gid']<br />
$filedata['size']<br />
$filedata['mod_date_month']<br />
$filedata['mod_date_day']<br />
$filedata['mod_time']<br />
$filedata['name']<br />
<br />
list($filedata['access_permissions'], $filedata['link_count'], $filedata['uid'], $filedata['gid'], $filedata['size'], $filedata['mod_date_month'], $filedata['mod_date_day'], $filedata['mod_time'], $filedata['name']) = preg_split("/[\s,]+/", $value);<br />
<br />
$filedata['type'] = $filedata['access_permissions']{0};<br />
<br />
$filedata['access_permissions'] = substr($filedata['access_permissions'],1);<br />
<br />
// now check the date to see if the last modifcation was this year or last.<br />
<br />
if ( strrpos($filedata['mod_time'], ':') != 2 ) { $filedata['mod_date'] = $filedata['mod_date_month'] ." " . $filedata['mod_date_day'] . " " . $filedata['mod_time']; $filedata['mod_time'] = "00:00"; } else { $filedata['mod_date'] = $filedata['mod_date_month'] ." " . $filedata['mod_date_day'] . " " . date("Y"); }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49628""></a>
  <div class="note">
   <strong class="user">marc dot peterlongo at francetelecom dot com</strong>
   <a href="#49628" class="date">03-Feb-2005 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you try:<br />
<br />
$path = "directory pathname with spaces";<br />
$list = ftp_rawlist($conn_id,$path);<br />
<br />
It doesn't work<br />
<br />
but when you try:<br />
<br />
$path = "directory pathname with spaces";<br />
ftp_chdir($conn_id,$path);<br />
$list = ftp_rawlist($conn_id,".");<br />
<br />
It works</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48899""></a>
  <div class="note">
   <strong class="user">cjacobsen at pge dot cl</strong>
   <a href="#48899" class="date">11-Jan-2005 05:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Excelent expresion, but don't match SUID, SGUI and Sticky flags when 'x' is disabled. Fix it with [rwxstST-].<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">itemize_dir</span><span class="keyword">(</span><span class="default">$contents</span><span class="keyword">) {<br />
&nbsp;&nbsp; foreach (</span><span class="default">$contents </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">"([-dl][rwxstST-]+).* ([0-9]*) ([a-zA-Z0-9]+).* ([a-zA-Z0-9]+).* ([0-9]*) ([a-zA-Z]+[0-9: ]*[0-9])[ ]+(([0-9]{2}:[0-9]{2})|[0-9]{4}) (.+)"</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$regs</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$type </span><span class="keyword">= (int) </span><span class="default">strpos</span><span class="keyword">(</span><span class="string">"-dl"</span><span class="keyword">, </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]{</span><span class="default">0</span><span class="keyword">});<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">] = </span><span class="default">$type</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'rights'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'number'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'group'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'date'</span><span class="keyword">] = </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m-d"</span><span class="keyword">,</span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$regs</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">]));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dir_list</span><span class="keyword">[] = </span><span class="default">$tmp_array</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return </span><span class="default">$dir_list</span><span class="keyword">;<br />
}<br />
</span><span class="default">$buff </span><span class="keyword">= </span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$cid</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);<br />
</span><span class="default">$items </span><span class="keyword">= </span><span class="default">itemize_dir</span><span class="keyword">(</span><span class="default">$buff</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48339""></a>
  <div class="note">
   <strong class="user">greg at upsdn dot net</strong>
   <a href="#48339" class="date">19-Dec-2004 11:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
list all (including hidden files and dirs):<br />
<span class="default">&lt;?php<br />
&nbsp; $contents </span><span class="keyword">= </span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="string">"-al "</span><span class="keyword">.</span><span class="default">$dir_name</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
just as ftp command:<br />
LIST al <br />
<br />
"-aF " is equal to '-al', please refer to "ls --help"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47713""></a>
  <div class="note">
   <strong class="user">greg at upsdn dot net</strong>
   <a href="#47713" class="date">25-Nov-2004 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The previous regular expression(by Jonathan Almarez,ergye at yahoo dot com and guru at virusas dot lt) is very good.But i found it does not&nbsp; take into account for directories(number&gt;9)<br />
<br />
Change [0-9] to [0-9]*<br />
<br />
The code below not only parses:<br />
drwxrwxr-x&nbsp; &nbsp;&nbsp; 9 msik&nbsp; &nbsp;&nbsp; ia&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 4096 Nov&nbsp; 5 14:19 Group3<br />
<br />
It also parses:<br />
drwxrwxr-x&nbsp;&nbsp; 19 msik&nbsp; &nbsp;&nbsp; ia&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 4096 Nov&nbsp; 5 14:19 Group3<br />
3 <br />
drwxrwxr-x&nbsp;&nbsp; 119 msik&nbsp; &nbsp;&nbsp; ia&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 4096 Nov&nbsp; 5 14:19 Group3<br />
3 <br />
<br />
0 = file<br />
1 = directory<br />
2 = simlink<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">itemize_dir</span><span class="keyword">(</span><span class="default">$contents</span><span class="keyword">) {<br />
&nbsp;&nbsp; foreach (</span><span class="default">$contents </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">"([-dl][rwxst-]+).* ([0-9]*) ([a-zA-Z0-9]+).* ([a-zA-Z0-9]+).* ([0-9]*) ([a-zA-Z]+[0-9: ]*[0-9])[ ]+(([0-9]{2}:[0-9]{2})|[0-9]{4}) (.+)"</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$regs</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$type </span><span class="keyword">= (int) </span><span class="default">strpos</span><span class="keyword">(</span><span class="string">"-dl"</span><span class="keyword">, </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]{</span><span class="default">0</span><span class="keyword">});<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">] = </span><span class="default">$type</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'rights'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'number'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'group'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'date'</span><span class="keyword">] = </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m-d"</span><span class="keyword">,</span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$regs</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">]));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp_array</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] = </span><span class="default">$regs</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dir_list</span><span class="keyword">[] = </span><span class="default">$tmp_array</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return </span><span class="default">$dir_list</span><span class="keyword">;<br />
}<br />
</span><span class="default">$buff </span><span class="keyword">= </span><span class="default">ftp_rawlist</span><span class="keyword">(</span><span class="default">$cid</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);<br />
</span><span class="default">$items </span><span class="keyword">= </span><span class="default">itemize_dir</span><span class="keyword">(</span><span class="default">$buff</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46784""></a>
  <div class="note">
   
   <a href="#46784" class="date">22-Oct-2004 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that there is no standard for the format, therefore don't be suprised when parsing routines for this work perfectly on some servers, and fail horribly on some.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45309""></a>
  <div class="note">
   <strong class="user">eros at speedy dot com dot ar</strong>
   <a href="#45309" class="date">01-Sep-2004 02:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
NO, NO, NO.<br />
<br />
The above examples are all wrong, the spaces given in array are not there "just because", its just a tabbed structure. In php we don't have structures like in c/cpp, but the following function will do the job.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">parse_rawlist</span><span class="keyword">( </span><span class="default">$array </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; for ( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++ ) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$current </span><span class="keyword">= </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'perms'</span><span class="keyword">]&nbsp; = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'number'</span><span class="keyword">] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">11</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'owner'</span><span class="keyword">]&nbsp; = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'group'</span><span class="keyword">]&nbsp; = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">24</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'size'</span><span class="keyword">]&nbsp;&nbsp; = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">33</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'month'</span><span class="keyword">]&nbsp; = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">42</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'day'</span><span class="keyword">]&nbsp; &nbsp; = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">46</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'time'</span><span class="keyword">]&nbsp;&nbsp; = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">49</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$structure</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'name'</span><span class="keyword">]&nbsp;&nbsp; = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">, </span><span class="default">55</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">) - </span><span class="default">55</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$structure</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38759""></a>
  <div class="note">
   
   <a href="#38759" class="date">06-Jan-2004 03:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you write<br />
<span class="default">&lt;?php<br />
rawlist </span><span class="keyword">(</span><span class="default">$ftp</span><span class="keyword">, </span><span class="string">"-a"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>The command will be "LIST -a", so the retuned list will also contain hidden files like ".htaccess".<br />
<br />
In this case all files and folders of the current directory are contained.<br />
To list another folder, you must change to it with "ftp_chdir".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
