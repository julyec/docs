<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>给指定文件的内容生成散列值</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.hash-equals.html">? hash_equals</a></li>
      <li style="float: right;"><a href="function.hash-final.html">hash_final ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.hash.html">Hash 函数</a></li>
    <li>给指定文件的内容生成散列值</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.hash-file" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">hash_file</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.1.2, PHP 7, PHP 8, PECL hash &gt;= 1.1)</p><p class="refpurpose"><span class="refname">hash_file</span> &mdash; <span class="dc-title">给指定文件的内容生成散列值</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.hash-file-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>hash_file</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$algo</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$binary</code><span class="initializer"> = <strong><code>false</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = []</span></span><br>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>


 </div>

 <div class="refsect1 parameters" id="refsect1-function.hash-file-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">algo</code></dt>

     <dd>

      <p class="para">
       要使用的散列算法的名称（例如：&quot;md5&quot;，&quot;sha256&quot;，&quot;haval160,4&quot; 等）。
       可以在 <span class="function"><a href="function.hash-algos.html" class="function">hash_algos()</a></span> 中查看当前支持的算法。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       要进行散列运算的文件位置的 URL ；支持 fopen 封装协议。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">binary</code></dt>

     <dd>

      <p class="para">
       设置为 <strong><code>true</code></strong> 时，输出原始二进制数据。
       设置为 <strong><code>false</code></strong> 时，输出小写的十六进制字符串。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       各种散列算法的一系列选项数组。目前 MurmurHash 算法仅支持 "seed" 参数。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.hash-file-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   如果 <code class="parameter">binary</code> 设置为 true， 则返回原始二进制数据表示的信息摘要，
   否则返回十六进制小写字符串格式表示的信息摘要。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.hash-file-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>8.1.0</td>
       <td>新增 <code class="parameter">options</code> 参数。</td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.hash-file-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="example-1796">
    <p><strong>Example #1 <span class="function"><a href="function.hash.html" class="function">hash()</a></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'ripemd160'</span><span style="color: #007700">, </span><span style="color: #DD0000">'The quick brown fox jumped over the lazy dog.'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
ec457d0a974c48d5685a7efa03d137dc8bbde7e3
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.hash-file-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.hash.html" class="function" rel="rdfs-seeAlso">hash()</a> - 生成散列值（消息摘要）</span></li>
    <li class="member"><span class="function"><a href="function.hash-hmac-file.html" class="function" rel="rdfs-seeAlso">hash_hmac_file()</a> - 使用 HMAC 方法和给定文件的内容生成带密钥的散列值</span></li>
    <li class="member"><span class="function"><a href="function.hash-update-file.html" class="function" rel="rdfs-seeAlso">hash_update_file()</a> - 从文件向活跃的散列运算上下文中填充数据</span></li>
    <li class="member"><span class="function"><a href="function.md5-file.html" class="function" rel="rdfs-seeAlso">md5_file()</a> - 计算指定文件的 MD5 散列值</span></li>
    <li class="member"><span class="function"><a href="function.sha1-file.html" class="function" rel="rdfs-seeAlso">sha1_file()</a> - 计算文件的 sha1 散列值</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="122549""></a>
  <div class="note">
   <strong class="user">Lawrence Cherone</strong>
   <a href="#122549" class="date">26-Mar-2018 12:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's sometimes necessary to hash the same file with different algos, <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">hash_file_multi</span><span class="keyword">(</span><span class="default">$algos </span><span class="keyword">= [], </span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$algos</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">\InvalidArgumentException</span><span class="keyword">(</span><span class="string">'First argument must be an array'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">\InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Second argument must be a string'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">\InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Second argument, file not found'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= [];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ini hash contexts<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$algos </span><span class="keyword">as </span><span class="default">$algo</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ctx</span><span class="keyword">[</span><span class="default">$algo</span><span class="keyword">] = </span><span class="default">hash_init</span><span class="keyword">(</span><span class="default">$algo</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// calculate hash<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$buffer </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">65536</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$ctx </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$context</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">hash_update</span><span class="keyword">(</span><span class="default">$ctx</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$buffer</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// finalise hash and store in return<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$algos </span><span class="keyword">as </span><span class="default">$algo</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$algo</span><span class="keyword">] = </span><span class="default">hash_final</span><span class="keyword">(</span><span class="default">$ctx</span><span class="keyword">[</span><span class="default">$algo</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">\InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Could not open file for reading'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Which would be used like:<br />
<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">hash_file_multi</span><span class="keyword">([</span><span class="string">'md5'</span><span class="keyword">, </span><span class="string">'sha1'</span><span class="keyword">, </span><span class="string">'sha256'</span><span class="keyword">], </span><span class="string">'path/to/file.ext'</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'md5'</span><span class="keyword">] === </span><span class="default">hash_file</span><span class="keyword">(</span><span class="string">'md5'</span><span class="keyword">, </span><span class="string">'path/to/file.ext'</span><span class="keyword">)); </span><span class="comment">//true<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'sha1'</span><span class="keyword">] === </span><span class="default">hash_file</span><span class="keyword">(</span><span class="string">'sha1'</span><span class="keyword">, </span><span class="string">'path/to/file.ext'</span><span class="keyword">)); </span><span class="comment">//true<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'sha256'</span><span class="keyword">] === </span><span class="default">hash_file</span><span class="keyword">(</span><span class="string">'sha256'</span><span class="keyword">, </span><span class="string">'path/to/file.ext'</span><span class="keyword">)); </span><span class="comment">//true</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121609""></a>
  <div class="note">
   <strong class="user">lnker dot ua at gmail dot com</strong>
   <a href="#121609" class="date">05-Sep-2017 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Link id : 6r1j-d2gs<br />
Code description : hash_file() performance check; Table head columns are sortable by clicking;<br />
<br />
Open the code with PhpFiddle - <a href="http://phpfiddle.org/main/code/6r1j-d2gs" rel="nofollow" target="_blank">http://phpfiddle.org/main/code/6r1j-d2gs</a><br />
Open the code with PhpFiddle Lite - <a href="http://phpfiddle.org/lite/code/6r1j-d2gs" rel="nofollow" target="_blank">http://phpfiddle.org/lite/code/6r1j-d2gs</a><br />
<br />
So do not care a lot about performance! Just use what you need!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117484""></a>
  <div class="note">
   <strong class="user">synnus at gmail dot com</strong>
   <a href="#117484" class="date">17-Jun-2015 11:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
bench 476&nbsp;Mo, win is 'haval160,4' : 0.037002<br />
<br />
ALGO: md2, time: 74.702272891998<br />
ALGO: md4, time: 9.2155270576477<br />
ALGO: md5, time: 9.0815191268921<br />
ALGO: sha1, time: 9.0945210456848<br />
ALGO: sha224, time: 9.1465229988098<br />
ALGO: sha256, time: 9.143522977829<br />
ALGO: sha384, time: 14.065804004669<br />
ALGO: sha512, time: 13.990800857544<br />
ALGO: ripemd128, time: 9.3185329437256<br />
ALGO: ripemd160, time: 9.3165328502655<br />
ALGO: ripemd256, time: 9.2495288848877<br />
ALGO: ripemd320, time: 9.2395279407501<br />
ALGO: whirlpool, time: 27.779588937759<br />
ALGO: tiger128,3, time: 9.3075330257416<br />
ALGO: tiger160,3, time: 9.1875250339508<br />
ALGO: tiger192,3, time: 9.3875370025635<br />
ALGO: tiger128,4, time: 9.1755249500275<br />
ALGO: tiger160,4, time: 9.355535030365<br />
ALGO: tiger192,4, time: 9.2025260925293<br />
ALGO: snefru, time: 42.781446218491<br />
ALGO: snefru256, time: 42.613437175751<br />
ALGO: gost, time: 18.606064081192<br />
ALGO: gost-crypto, time: 18.664067983627<br />
ALGO: adler32, time: 9.1535229682922<br />
ALGO: crc32, time: 10.126579999924<br />
ALGO: crc32b, time: 10.01757311821<br />
ALGO: fnv132, time: 9.7505569458008<br />
ALGO: fnv1a32, time: 9.7935597896576<br />
ALGO: fnv164, time: 9.8945660591125<br />
ALGO: fnv1a64, time: 9.3025319576263<br />
ALGO: joaat, time: 9.7175559997559<br />
ALGO: haval128,3, time: 9.6855540275574<br />
ALGO: haval160,3, time: 10.10857796669<br />
ALGO: haval192,3, time: 9.6765530109406<br />
ALGO: haval224,3, time: 20.636180877686<br />
ALGO: haval256,3, time: 10.641607999802<br />
ALGO: haval128,4, time: 7.5594329833984<br />
ALGO: haval160,4, time: 7.2884171009064<br />
ALGO: haval192,4, time: 7.2934169769287<br />
ALGO: haval224,4, time: 7.2964169979095<br />
ALGO: haval256,4, time: 7.3034179210663<br />
ALGO: haval128,5, time: 8.3244760036469<br />
ALGO: haval160,5, time: 8.3174757957458<br />
ALGO: haval192,5, time: 8.3204758167267<br />
ALGO: haval224,5, time: 8.3234758377075<br />
ALGO: haval256,5, time: 8.3254759311676<br />
<br />
bench 13,0&nbsp;Mo, win is 'adler32'&nbsp; : 0.037002<br />
<br />
ALGO: md2, time: 2.0341160297394<br />
ALGO: md4, time: 0.062004089355469<br />
ALGO: md5, time: 0.071003913879395<br />
ALGO: sha1, time: 0.086004972457886<br />
ALGO: sha224, time: 0.18301010131836<br />
ALGO: sha256, time: 0.18301105499268<br />
ALGO: sha384, time: 0.36102104187012<br />
ALGO: sha512, time: 0.3610200881958<br />
ALGO: ripemd128, time: 0.15900897979736<br />
ALGO: ripemd160, time: 0.20701193809509<br />
ALGO: ripemd256, time: 0.16500997543335<br />
ALGO: ripemd320, time: 0.22501301765442<br />
ALGO: whirlpool, time: 0.74204206466675<br />
ALGO: tiger128,3, time: 0.12200689315796<br />
ALGO: tiger160,3, time: 0.12100696563721<br />
ALGO: tiger192,3, time: 0.12200713157654<br />
ALGO: tiger128,4, time: 0.15700888633728<br />
ALGO: tiger160,4, time: 0.15700888633728<br />
ALGO: tiger192,4, time: 0.15600895881653<br />
ALGO: snefru, time: 1.1520659923553<br />
ALGO: snefru256, time: 1.151065826416<br />
ALGO: gost, time: 0.48902797698975<br />
ALGO: gost-crypto, time: 0.49202799797058<br />
ALGO: adler32, time: 0.037002086639404<br />
ALGO: crc32, time: 0.10300588607788<br />
ALGO: crc32b, time: 0.093006134033203<br />
ALGO: fnv132, time: 0.043002128601074<br />
ALGO: fnv1a32, time: 0.045002937316895<br />
ALGO: fnv164, time: 0.12800693511963<br />
ALGO: fnv1a64, time: 0.12800693511963<br />
ALGO: joaat, time: 0.070003986358643<br />
ALGO: haval128,3, time: 0.12900686264038<br />
ALGO: haval160,3, time: 0.12800693511963<br />
ALGO: haval192,3, time: 0.12900805473328<br />
ALGO: haval224,3, time: 0.12800693511963<br />
ALGO: haval256,3, time: 0.12800693511963<br />
ALGO: haval128,4, time: 0.19901204109192<br />
ALGO: haval160,4, time: 0.1990110874176<br />
ALGO: haval192,4, time: 0.20001196861267<br />
ALGO: haval224,4, time: 0.20001101493835<br />
ALGO: haval256,4, time: 0.20001220703125<br />
ALGO: haval128,5, time: 0.22601294517517<br />
ALGO: haval160,5, time: 0.2270131111145<br />
ALGO: haval192,5, time: 0.2270131111145<br />
ALGO: haval224,5, time: 0.2270131111145<br />
ALGO: haval256,5, time: 0.22701287269592</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109259""></a>
  <div class="note">
   <strong class="user">holdoffhunger at gmail dot com</strong>
   <a href="#109259" class="date">30-Jun-2012 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The Hash_File() function returns the same value as if the function Hash() had been performed on the same exact piece of data.&nbsp; At first, I was uncertain if Hash_File() used the filename, or even the permission settings, when defining the data to be hashed for the given algorithm.&nbsp; If it did work that way, then that means the same exact files would have different HASH values when you moved or renamed them on your system.&nbsp; Anyway, fortunately, it does not work that way.&nbsp; Hash() and Hash_File() produce identical results for the same pieces of data.&nbsp; This is also true for the relationship between the Hash_HMAC() and Hash_HMAC_File() functions: the same pieces of data, the same keys, produce identical results.&nbsp; It was a wise, design principle.<br />
<br />
Some sample code to demonstrate this principle :<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Author: holdoffhunger@gmail.com<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Preset Data<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test_data </span><span class="keyword">= </span><span class="string">"php-hashing"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test_file </span><span class="keyword">= </span><span class="string">"test.txt"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test_file_read </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$test_file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Hash Data<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test_data_hash </span><span class="keyword">= </span><span class="default">hash</span><span class="keyword">(</span><span class="string">"md2"</span><span class="keyword">, </span><span class="default">$test_data</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test_file_hash </span><span class="keyword">= </span><span class="default">hash_file</span><span class="keyword">(</span><span class="string">"md2"</span><span class="keyword">, </span><span class="default">$test_file</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Print Hash Results<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">print(</span><span class="string">"Data Hash (</span><span class="default">$test_data</span><span class="string">): </span><span class="default">$test_data_hash</span><span class="string">&lt;br&gt;&lt;br&gt;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print(</span><span class="string">"File Hash (</span><span class="default">$test_file_read</span><span class="string">): </span><span class="default">$test_file_hash</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
&nbsp;&nbsp;&nbsp; Expected Results<br />
&nbsp;&nbsp;&nbsp; ..................................<br />
&nbsp;&nbsp;&nbsp; <br />
Data Hash (php-hashing): 457d84e1d69e519a7b73348db21477d3<br />
<br />
File Hash (php-hashing): 457d84e1d69e519a7b73348db21477d3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104836""></a>
  <div class="note">
   <strong class="user">apm at domain itsmee.co.uk</strong>
   <a href="#104836" class="date">10-Jul-2011 04:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have verified that the output of the "crc32" is the ITU I.363.5 algorithm (a.k.a. AAL5 CRC - popularised by BZIP2 but also used in ATM transmissions - the algorithm is the same as that in POSIX 1003.2-1992 in Cksum but that stuffs the size into the CRC at the end for extra measure).&nbsp; However, the output is expressed in reverse order to many CRC programs.&nbsp; Using the "standard" crctest.txt (numbers 1 to 9 in sequence - google it, it's not hard to find), php will output 181989fc - many other (Intel little endian) programs would output this as fc891918, hence the confusion (that I have had, at least).<br />
<br />
The crc32b is the 32-bit Frame Check Sequence of ITU V.42 (used in Ethernet and popularised by PKZip).&nbsp; The output from this CRC is popularised in Intel little endian format and would produce cbf43926 on the same file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103656""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#103656" class="date">26-Apr-2011 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please take note that hash-file will throw error on files &gt;=2GB.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100061""></a>
  <div class="note">
   <strong class="user">chernyshevsky at hotmail dot com</strong>
   <a href="#100061" class="date">22-Sep-2010 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use hash_file() to get the CRC32 value of a file, use the following to unpack the hex string returned by the function to an integer (similar to crc32()):<br />
<br />
$hash = hash_file('crc32b', $filepath);<br />
$array = unpack('N', pack('H*', $hash));<br />
$crc32 = $array[1];</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85672""></a>
  <div class="note">
   <strong class="user">Keisial at gmail dot com</strong>
   <a href="#85672" class="date">11-Sep-2008 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The 'octets reversed' you are seeing is the bug 45028 which has been fixed. <a href="http://bugs.php.net/bug.php?id=45028" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=45028</a><br />
<br />
The difference between crc32 and crc32b is explained on mhash man page. crc32 is the one used on ethernet, while crc32b is the one used on zip, png... They differ on the table used.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84653""></a>
  <div class="note">
   <strong class="user">allaryin at gmail dot com</strong>
   <a href="#84653" class="date">23-Jul-2008 03:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who are wondering, there appears to be no fundamental difference between hash_file('md5')/hash_file('sha1') and md5_file()/sha1_file(). They produce identical output and have comparable performance.<br />
<br />
There is, however, a difference between hash_file('crc32') and something silly like crc32(file_get_contents()).<br />
<br />
crc32(file_get_contents())'s results are most similar to those of hash_file('crc32b'), just with the octets reversed:<br />
<br />
<span class="default">&lt;?php<br />
$fname </span><span class="keyword">= </span><span class="string">"something.png"</span><span class="keyword">;<br />
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="default">hash_file</span><span class="keyword">( </span><span class="string">'crc32'</span><span class="keyword">, </span><span class="default">$fname </span><span class="keyword">);<br />
echo </span><span class="string">"crc32&nbsp; = </span><span class="default">$hash</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="default">hash_file</span><span class="keyword">( </span><span class="string">'crc32b'</span><span class="keyword">, </span><span class="default">$fname </span><span class="keyword">);<br />
echo </span><span class="string">"crc32b = </span><span class="default">$hash</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%x"</span><span class="keyword">,</span><span class="default">crc32</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fname</span><span class="keyword">)));<br />
echo </span><span class="string">"manual = </span><span class="default">$hash</span><span class="string">\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
crc32&nbsp; = f41d7f4e<br />
crc32b = 7dafbba4<br />
manual = a4bbaf7d</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
