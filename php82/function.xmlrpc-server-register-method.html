<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>注册 PHP 函数搭到资源用于匹配 method_name</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.xmlrpc-server-register-introspection-callback.html">? xmlrpc_server_register_introspection_callback</a></li>
      <li style="float: right;"><a href="function.xmlrpc-set-type.html">xmlrpc_set_type ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.xmlrpc.html">XML-RPC 函数</a></li>
    <li>注册 PHP 函数搭到资源用于匹配 method_name</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.xmlrpc-server-register-method" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">xmlrpc_server_register_method</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">xmlrpc_server_register_method</span> &mdash; <span class="dc-title">注册 PHP 函数搭到资源用于匹配 method_name</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.xmlrpc-server-register-method-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>xmlrpc_server_register_method</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$server</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$method_name</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$function</code></span>): <span class="type">bool</span></div>

  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">此函数是<em class="emphasis">实验性</em>的。此函数的表象，包括名称及其相关文档都可能在未来的
PHP 发布版本中未通知就被修改。使用本函数风险自担。</p></div>
  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">本函数还未编写文档，仅有参数列表。</p></div>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125645""></a>
  <div class="note">
   <strong class="user">giunta dot gaetano at gmail dot com</strong>
   <a href="#125645" class="date">30-Dec-2020 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note 1: even if you add introspection data via calls to `xmlrpc_server_register_introspection_callback` or `xmlrpc_server_add_introspection_data`, the server will not validate for you the number or type of received parameters.<br />
This means that you have to implement all required validation of the received parameters in your php function.<br />
<br />
Note 2: take care about dealing with base64 and datetime values in the received parameters: those are not automatically transformed into php scalar values, but into stdClass objects with members `xmlrpc_type` and `scalar`</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68808""></a>
  <div class="note">
   <strong class="user">giunta dot gaetano at sea-aeroportimilano dot it</strong>
   <a href="#68808" class="date">11-Aug-2006 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To have an xmlrpc fault response programatically generated by the server, the php function registered as method handler must return an array containing a FaultCode and a FaultString members.<br />
<br />
function $myfunc($methodname, $vals, $extra_data)<br />
{<br />
...<br />
return array('faultCode' =&gt; 666, 'faultString' =&gt; 'DOH!');<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59137""></a>
  <div class="note">
   <strong class="user">nyvsld at gmail dot com</strong>
   <a href="#59137" class="date">27-Nov-2005 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
prototype of registered function:<br />
<br />
function method_impl(string $method_name, array $params, array $user_data);<br />
<br />
$method_name<br />
&nbsp;&nbsp;&nbsp; the public method name, known by calling client<br />
$params<br />
&nbsp;&nbsp;&nbsp; parameters specified by calling client<br />
$user_data<br />
&nbsp;&nbsp;&nbsp; any local data, passed by `xmlrpc_server_call_method'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55729""></a>
  <div class="note">
   <strong class="user">dante at lorenso dot com</strong>
   <a href="#55729" class="date">11-Aug-2005 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To register a callback to a 'static' function within the same class, consider a syntax like the following:<br />
&lt;code&gt;<br />
$callback = array (__CLASS__, "my_function_name");<br />
xmlrpc_server_register_method($xmlrpc_server, "my_function", $callback);<br />
&lt;/code&gt;<br />
Doing it this way makes it easier to rename your class later.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51340""></a>
  <div class="note">
   <strong class="user">eiriks at hollowmatrix dot com</strong>
   <a href="#51340" class="date">28-Mar-2005 03:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember that you can't do like Chrigu and Nate said if you want to add methods from a static class (Hence you can't create any instances of it).<br />
A workaround is to create lambda functions calling the<br />
methods:<br />
<br />
// Our static handler class<br />
static class MyHandler<br />
{<br />
&nbsp;&nbsp;&nbsp; public function getPrice($item)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $prices = array("apple" =&gt; 4, "orange" =&gt; 5);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $prices[$item];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function buy($item, $number)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $price = self::getPrice($item) * $number;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do_thing_to_sell_the_item();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $price;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
// Use reflection to get method names and parameters<br />
$mirror = new ReflectionClass("MyHandler");<br />
foreach ($mirror-&gt;getMethods() as $method)<br />
{<br />
&nbsp;&nbsp;&nbsp; // Create new "lambda" function for each method<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // Generate argument list<br />
&nbsp;&nbsp;&nbsp; $args = array();<br />
&nbsp;&nbsp;&nbsp; foreach ($method-&gt;getParameters() as $param)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $args[] = '$'.$param-&gt;getName();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $args = implode(',', $args);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // Generate code<br />
&nbsp;&nbsp;&nbsp; $methodname = $method-&gt;getName();<br />
&nbsp;&nbsp;&nbsp; $code = "return {$real_class}::{$methodname}({$args});";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // Create function, retrieve function name<br />
&nbsp;&nbsp;&nbsp; $function_name = create_function($args, $code);<br />
<br />
&nbsp;&nbsp;&nbsp; // Register the function<br />
&nbsp;&nbsp;&nbsp; xmlrpc_server_register_method($myserver, $methodname, $function_name);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31665""></a>
  <div class="note">
   <strong class="user">Nate Parsons</strong>
   <a href="#31665" class="date">29-Apr-2003 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In case its not completely obvious what Chrigu meant,<br />
<br />
You can register a method inside your class by doing the following:<br />
<br />
xml_rpc_server_register_methode($xmlrpc_server, "myClientCall", array(&amp;$this, "handleClientCallFunc"));<br />
<br />
where $this == the magic class $this. =)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26942""></a>
  <div class="note">
   
   <a href="#26942" class="date">18-Nov-2002 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example how to register a class methode:<br />
<br />
xml_rpc_server_register_methode($xmlrpc_server, "foo", array(&amp;$bar, "foo_func"));<br />
<br />
where $bar is the instance of your class and foo_func a methode of this class. Don't forget the '&amp;'!<br />
<br />
hope this may be useful...<br />
<br />
Chrigu</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
