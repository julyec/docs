<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Stream 函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="streamwrapper.url-stat.html">? streamWrapper::url_stat</a></li>
      <li style="float: right;"><a href="function.stream-bucket-append.html">stream_bucket_append ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.stream.html">Stream</a></li>
    <li>Stream 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.stream" class="reference">
 <h1 class="title">Stream 函数</h1>

 




































































































































































 



























 






















































































  


















<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.stream-bucket-append.html">stream_bucket_append</a> &mdash; Append bucket to brigade</li><li><a href="function.stream-bucket-make-writeable.html">stream_bucket_make_writeable</a> &mdash; Returns a bucket object from the brigade to operate on</li><li><a href="function.stream-bucket-new.html">stream_bucket_new</a> &mdash; Create a new bucket for use on the current stream</li><li><a href="function.stream-bucket-prepend.html">stream_bucket_prepend</a> &mdash; Prepend bucket to brigade</li><li><a href="function.stream-context-create.html">stream_context_create</a> &mdash; 创建资源流上下文</li><li><a href="function.stream-context-get-default.html">stream_context_get_default</a> &mdash; Retrieve the default stream context</li><li><a href="function.stream-context-get-options.html">stream_context_get_options</a> &mdash; 获取资源流/数据包/上下文的参数</li><li><a href="function.stream-context-get-params.html">stream_context_get_params</a> &mdash; Retrieves parameters from a context</li><li><a href="function.stream-context-set-default.html">stream_context_set_default</a> &mdash; Set the default stream context</li><li><a href="function.stream-context-set-option.html">stream_context_set_option</a> &mdash; 对资源流、数据包或者上下文设置参数</li><li><a href="function.stream-context-set-params.html">stream_context_set_params</a> &mdash; Set parameters for a stream/wrapper/context</li><li><a href="function.stream-copy-to-stream.html">stream_copy_to_stream</a> &mdash; Copies data from one stream to another</li><li><a href="function.stream-filter-append.html">stream_filter_append</a> &mdash; Attach a filter to a stream</li><li><a href="function.stream-filter-prepend.html">stream_filter_prepend</a> &mdash; Attach a filter to a stream</li><li><a href="function.stream-filter-register.html">stream_filter_register</a> &mdash; Register a user defined stream filter</li><li><a href="function.stream-filter-remove.html">stream_filter_remove</a> &mdash; 从资源流里移除某个过滤器</li><li><a href="function.stream-get-contents.html">stream_get_contents</a> &mdash; 读取资源流到一个字符串</li><li><a href="function.stream-get-filters.html">stream_get_filters</a> &mdash; 获取已注册的数据流过滤器列表</li><li><a href="function.stream-get-line.html">stream_get_line</a> &mdash; 从资源流里读取一行直到给定的定界符</li><li><a href="function.stream-get-meta-data.html">stream_get_meta_data</a> &mdash; 从流或文件指针中获取 header/meta 数据</li><li><a href="function.stream-get-transports.html">stream_get_transports</a> &mdash; 获取已注册的套接字传输协议列表</li><li><a href="function.stream-get-wrappers.html">stream_get_wrappers</a> &mdash; 获取已注册的流类型</li><li><a href="function.stream-is-local.html">stream_is_local</a> &mdash; Checks if a stream is a local stream</li><li><a href="function.stream-isatty.html">stream_isatty</a> &mdash; Check if a stream is a TTY</li><li><a href="function.stream-notification-callback.html">stream_notification_callback</a> &mdash; A callback function for the notification context parameter</li><li><a href="function.stream-register-wrapper.html">stream_register_wrapper</a> &mdash; 别名 stream_wrapper_register</li><li><a href="function.stream-resolve-include-path.html">stream_resolve_include_path</a> &mdash; Resolve filename against the include path</li><li><a href="function.stream-select.html">stream_select</a> &mdash; Runs the equivalent of the select() system call on the given
   arrays of streams with a timeout specified by seconds and microseconds</li><li><a href="function.stream-set-blocking.html">stream_set_blocking</a> &mdash; 为资源流设置阻塞或者阻塞模式</li><li><a href="function.stream-set-chunk-size.html">stream_set_chunk_size</a> &mdash; 设置资源流区块大小</li><li><a href="function.stream-set-read-buffer.html">stream_set_read_buffer</a> &mdash; Set read file buffering on the given stream</li><li><a href="function.stream-set-timeout.html">stream_set_timeout</a> &mdash; Set timeout period on a stream</li><li><a href="function.stream-set-write-buffer.html">stream_set_write_buffer</a> &mdash; Sets write file buffering on the given stream</li><li><a href="function.stream-socket-accept.html">stream_socket_accept</a> &mdash; 接受由 stream_socket_server 创建的套接字连接</li><li><a href="function.stream-socket-client.html">stream_socket_client</a> &mdash; Open Internet or Unix domain socket connection</li><li><a href="function.stream-socket-enable-crypto.html">stream_socket_enable_crypto</a> &mdash; Turns encryption on/off on an already connected socket</li><li><a href="function.stream-socket-get-name.html">stream_socket_get_name</a> &mdash; 获取本地或者远程的套接字名称</li><li><a href="function.stream-socket-pair.html">stream_socket_pair</a> &mdash; 创建一对完全一样的网络套接字连接流</li><li><a href="function.stream-socket-recvfrom.html">stream_socket_recvfrom</a> &mdash; Receives data from a socket, connected or not</li><li><a href="function.stream-socket-sendto.html">stream_socket_sendto</a> &mdash; Sends a message to a socket, whether it is connected or not</li><li><a href="function.stream-socket-server.html">stream_socket_server</a> &mdash; 创建 Internet 或 Unix 域服务器套接字</li><li><a href="function.stream-socket-shutdown.html">stream_socket_shutdown</a> &mdash; Shutdown a full-duplex connection</li><li><a href="function.stream-supports-lock.html">stream_supports_lock</a> &mdash; Tells whether the stream supports locking</li><li><a href="function.stream-wrapper-register.html">stream_wrapper_register</a> &mdash; 注册一个用 PHP 类实现的 URL 封装协议</li><li><a href="function.stream-wrapper-restore.html">stream_wrapper_restore</a> &mdash; Restores a previously unregistered built-in wrapper</li><li><a href="function.stream-wrapper-unregister.html">stream_wrapper_unregister</a> &mdash; Unregister a URL wrapper</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="79222""></a>
  <div class="note">
   <strong class="user">marcus at synchromedia dot co dot uk</strong>
   <a href="#79222" class="date">15-Nov-2007 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I can't find any real documentation on the quoted-printable-encode stream filter, but I've gathered info from several places. It seems there are 4 options that can be passed in the param array as in my other note on this subject:<br />
<br />
line-length: integer, simply sets line length before a soft break is inserted<br />
line-break-chars: Which char or chars to consider as a line break - note that "\r\n" will only match CRLF, not CR or LF, so make sure it matches your content.<br />
binary: boolean, hex encodes all control chars, including spaces and line breaks, but leaves alphanumerics untouched<br />
force-encode-first: Forcibly hex-encodes the first char on each line, even if it's alphanumeric. This is useful for avoiding corruption in some incompetent mail servers, like Exchange.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70826""></a>
  <div class="note">
   <strong class="user">marcus at synchromedia dot co dot uk</strong>
   <a href="#70826" class="date">30-Oct-2006 10:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As this article says, there is no quoted_printable_encode function() in PHP: <a href="http://www.zend.com/manual/filters.convert.php" rel="nofollow" target="_blank">http://www.zend.com/manual/filters.convert.php</a><br />
<br />
However there is a stream filter for quoted printable encoding. Here's an example function that produces output suitable for email and doesn't explicitly use external files (though it might do for strings over 2Mb due to the nature of the temp stream type):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">quoted_printable_encode</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://temp/'</span><span class="keyword">, </span><span class="string">'r+'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$params </span><span class="keyword">= array(</span><span class="string">'line-length' </span><span class="keyword">=&gt; </span><span class="default">70</span><span class="keyword">, </span><span class="string">'line-break-chars' </span><span class="keyword">=&gt; </span><span class="string">"\r\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">stream_filter_append</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="string">'convert.quoted-printable-encode'</span><span class="keyword">, </span><span class="default">STREAM_FILTER_READ</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">rewind</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">stream_get_contents</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
}<br />
<br />
echo </span><span class="default">quoted_printable_encode</span><span class="keyword">(</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"hello there "</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">).</span><span class="string">" a=1\r\n"</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The filter needs to be restricted to STREAM_FILTER_READ because by default it will get filtered both going into and out of the stream, and will thus get encoded twice.<br />
<br />
It should be much faster than using a PHP implementation of the same thing, though note that this will only work in PHP 5.1+.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
