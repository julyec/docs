<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>计算字符串中全部字符都存在于指定字符集合中的第一段子串的长度</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.strrpos.html">? strrpos</a></li>
      <li style="float: right;"><a href="function.strstr.html">strstr ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.strings.html">字符串 函数</a></li>
    <li>计算字符串中全部字符都存在于指定字符集合中的第一段子串的长度</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.strspn" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">strspn</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">strspn</span> &mdash; <span class="dc-title">
   计算字符串中全部字符都存在于指定字符集合中的第一段子串的长度
  </span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.strspn-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>strspn</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$characters</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$offset</code><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">int</span><span class="type"></span></span> <code class="parameter">$length</code><span class="initializer"> = <strong><code>null</code></strong></span></span><br>): <span class="type">int</span></div>

  <p class="para rdfs-comment">
   返回 <code class="parameter">string</code> 中全部字符<em class="emphasis">仅</em>存在于 <code class="parameter">characters</code> 中的第一组连续字符(子字符串)的长度。
  </p>
  <p class="para">
   如果省略了 <code class="parameter">offset</code> 和 <code class="parameter">length</code> 参数，则检查整个 <code class="parameter">string</code>
   字符串；如果指定了这两个参数，则效果等同于调用 <code class="literal">strspn(substr($string, $offset, $length),
   $characters)</code>（更多信息，参见 <a href="function.substr.html" class="xref">substr</a> ）。
  </p>
  <p class="para">
   代码行：
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$var </span><span style="color: #007700">= </span><span style="color: #0000BB">strspn</span><span style="color: #007700">(</span><span style="color: #DD0000">"42 is the answer to the 128th question."</span><span style="color: #007700">, </span><span style="color: #DD0000">"1234567890"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <var class="varname">$var</var> 将被指派为 2，因为 &#039;42&#039; 是 <code class="parameter">string</code> 中第一段全部字符都存在于 &#039;1234567890&#039; 的连续字符。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.strspn-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       待检查的字符串。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">characters</code></dt>

     <dd>

      <p class="para">
       检查字符列表。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">offset</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">string</code> 的开始检查位置。
      </p>
      <p class="para">
       如果 <code class="parameter">offset</code> 被设置并且是非负的，<span class="function"><strong>strspn()</strong></span> 将从 <code class="parameter">string</code> 的第 <code class="parameter">offset</code> 个位置开始检查。例如，在字符串 &#039;<code class="literal">abcdef</code>&#039; 中，第 <code class="literal">0</code> 个位置的字符是 &#039;<code class="literal">a</code>&#039;，第二个位置的字符是 &#039;<code class="literal">c</code>&#039;，等等。
      </p>
      <p class="para">
       如果 <code class="parameter">offset</code> 被设置并且为负数，<span class="function"><strong>strspn()</strong></span> 将从 <code class="parameter">string</code> 的尾部倒数第 <code class="parameter">offset</code> 个位置开始检查 <code class="parameter">string</code>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">length</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">string</code> 中检查的长度。
      </p>
      <p class="para">
       如果 <code class="parameter">length</code> 被设置并且为非负数，那么将从起始位置开始，检查 <code class="parameter">string</code> 的 <code class="parameter">length</code> 个长度的字符。
      </p>
      <p class="para">
       如果 <code class="parameter">length</code> 被设置并且为负数，那么将从起始位置开始，直到从 <code class="parameter">string</code> 尾部开始第 <code class="parameter">length</code> 个位置，对 <code class="parameter">string</code> 进行检查。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.strspn-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回完全由 <code class="parameter">characters</code> 中的字符组成的 <code class="parameter">string</code>
   初始段的长度。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    当设置了 <code class="parameter">offset</code> 参数时，返回的长度从此为止开始计算，而不是从
    <code class="parameter">string</code> 的开头开始计算。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.strspn-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">length</code> 现在允许为 null。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.strspn-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>strspn()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">strspn</span><span style="color: #007700">(</span><span style="color: #DD0000">"foo"</span><span style="color: #007700">, </span><span style="color: #DD0000">"o"</span><span style="color: #007700">, </span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">2</span><span style="color: #007700">); </span><span style="color: #FF8000">// 打印: 2<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
int(0)
int(2)
int(1)
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.strspn-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数可安全用于二进制对象。</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.strspn-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.strcspn.html" class="function" rel="rdfs-seeAlso">strcspn()</a> - 获取不匹配遮罩的起始子字符串的长度</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125265""></a>
  <div class="note">
   <strong class="user">lincoln dot mahmud at gmail dot com</strong>
   <a href="#125265" class="date">13-Aug-2020 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Get Group match letter<br />
<br />
<span class="default">&lt;?php <br />
<br />
$s</span><span class="keyword">= </span><span class="string">'aaabbbcceeffaaeeeaaabbzmmm'</span><span class="keyword">;<br />
<br />
function </span><span class="default">groupby</span><span class="keyword">( </span><span class="default">$s </span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$a </span><span class="keyword">= [];<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$o </span><span class="keyword">= </span><span class="default">strspn</span><span class="keyword">( </span><span class="default">$s</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">] = [&nbsp; </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] =&gt; </span><span class="default">$o </span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">$o</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">groupby</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$a</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">groupby</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124395""></a>
  <div class="note">
   <strong class="user">ayaou dot mohammed at gmail dot com</strong>
   <a href="#124395" class="date">14-Nov-2019 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function doesn't&nbsp; work with non ASCII characters<br />
<br />
Exemple:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$subject </span><span class="keyword">= </span><span class="string">"Comment ?a va ma chérie"</span><span class="keyword">;<br />
</span><span class="default">$mask </span><span class="keyword">= </span><span class="string">"éè?à"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">,</span><span class="default">$mask</span><span class="keyword">); </span><span class="comment">// Echo 0<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
See, we expected&nbsp; 1 but 0 was the correct result</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122366""></a>
  <div class="note">
   <strong class="user">nino dot skopac at gmail dot com</strong>
   <a href="#122366" class="date">07-Feb-2018 06:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
strspon and preg_match seem to be equally fast for validating numbers:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$testValInvalid </span><span class="keyword">= </span><span class="string">'foobar123^^'</span><span class="keyword">;<br />
</span><span class="default">$testValValid </span><span class="keyword">= </span><span class="string">'12346'</span><span class="keyword">;<br />
</span><span class="default">$allowedChars </span><span class="keyword">= </span><span class="string">'1234567890'</span><span class="keyword">;<br />
<br />
</span><span class="default">$t1 </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">1000000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">assert</span><span class="keyword">(</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$testValInvalid</span><span class="keyword">, </span><span class="default">$allowedChars</span><span class="keyword">) != </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$testValInvalid</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">assert</span><span class="keyword">(</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$testValValid</span><span class="keyword">, </span><span class="default">$allowedChars</span><span class="keyword">) == </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$testValValid</span><span class="keyword">));<br />
}<br />
print </span><span class="string">'Time taken for strspon: ' </span><span class="keyword">. (</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">) - </span><span class="default">$t1</span><span class="keyword">);<br />
print </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="default">$t1 </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">1000000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">assert</span><span class="keyword">(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[0-9]+$/'</span><span class="keyword">, </span><span class="default">$testValInvalid</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">assert</span><span class="keyword">(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[0-9]+$/'</span><span class="keyword">, </span><span class="default">$testValValid</span><span class="keyword">));<br />
}<br />
<br />
print </span><span class="string">'Time taken for preg_match: ' </span><span class="keyword">. (</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">) - </span><span class="default">$t1</span><span class="keyword">);<br />
print </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="comment">/**<br />
nino-mcb:hosp_web ninoskopac$ php test.php<br />
Time taken for strspon: 3.24165391922<br />
Time taken for preg_match: 3.1820080280304<br />
nino-mcb:hosp_web ninoskopac$ php test.php<br />
Time taken for strspon: 3.1806418895721<br />
Time taken for preg_match: 3.2244551181793<br />
&nbsp;*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108922""></a>
  <div class="note">
   <strong class="user">bob at example dot com</strong>
   <a href="#108922" class="date">05-Jun-2012 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Quick way to check if a string consists entirely of characters within the mask is to compare strspn with strlen eg:
<br />

<br />
<span class="default">&lt;?php
<br />
$path </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PATH_INFO'</span><span class="keyword">];
<br />
if (</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">) == </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//PATH_INFO is empty
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102190""></a>
  <div class="note">
   <strong class="user">mrsohailkhan at gmail dot com</strong>
   <a href="#102190" class="date">01-Feb-2011 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
very dificult to get from the definition directly, while i search for that,i came to know that
<br />

<br />
strspn() will tell you the length of a string consisting entirely of the set of characters in accept set. That is, it starts walking down str until it finds a character that is not in the set (that is, a character that is not to be accepted), and returns the length of the string so far. 
<br />

<br />
and 
<br />

<br />
strcspn() works much the same way, except that it walks down str until it finds a character in the reject set (that is, a character that is to be rejected.) It then returns the length of the string so far.
<br />

<br />
<span class="default">&lt;?php
<br />
$acceptSet </span><span class="keyword">= </span><span class="string">"aeiou"</span><span class="keyword">;
<br />
</span><span class="default">$rejectSet&nbsp; </span><span class="keyword">= </span><span class="string">"y"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$str1 </span><span class="keyword">=</span><span class="string">"a banana"</span><span class="keyword">;
<br />
</span><span class="default">$str2 </span><span class="keyword">=</span><span class="string">"the bolivian navy on manuvers in the south pacific"</span><span class="keyword">;
<br />

<br />
echo </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$acceptSet</span><span class="keyword">);</span><span class="comment">// $n == 1, just "a"
<br />

<br />
</span><span class="keyword">echo </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strcspn</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$rejectSet</span><span class="keyword">);</span><span class="comment">// n = 16, "the bolivian nav"
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
hope this example will help in understanding the concept of strspn() and strcspn().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101133""></a>
  <div class="note">
   <strong class="user">AT-HE (at_he.hotmail)</strong>
   <a href="#101133" class="date">28-Nov-2010 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can use this function with strlen to check illegal characters, string lenght must be the same than strspn (characters from my string contained in another)<br />
<br />
<span class="default">&lt;?php<br />
<br />
$digits</span><span class="keyword">=</span><span class="string">'0123456789'</span><span class="keyword">;<br />
<br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$phone</span><span class="keyword">) != </span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$phone</span><span class="keyword">,</span><span class="default">$digits</span><span class="keyword">))<br />
&nbsp;echo </span><span class="string">"illegal characters"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89362""></a>
  <div class="note">
   <strong class="user">Dmitry Mazur</strong>
   <a href="#89362" class="date">04-Mar-2009 10:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The second parameter is a set of allowed characters.<br />
strspn will return an zero-based index of a first non-allowed character.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84980""></a>
  <div class="note">
   <strong class="user">barry dot balkowski at gmail dot com</strong>
   <a href="#84980" class="date">08-Aug-2008 02:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It took me some time to understand the way this function works...<br />
I've compiled my own explanation with my own words that is more understandable for me personally than the official one or those that can be found in different tutorials on the web.<br />
Perhaps, it will save someone several minutes...<br />
<br />
<span class="default">&lt;?php <br />
strspn</span><span class="keyword">(</span><span class="default">string $haystack</span><span class="keyword">, </span><span class="default">string $char_list </span><span class="keyword">[, </span><span class="default">int $start </span><span class="keyword">[, </span><span class="default">int $length</span><span class="keyword">]])<br />
</span><span class="default">?&gt;<br />
</span><br />
The way it works:<br />
&nbsp;-&nbsp;&nbsp; searches for a segment of $haystack that consists entirely from supplied through the second argument chars <br />
&nbsp;-&nbsp;&nbsp; $haystack must start from one of the chars supplied through $char_list, otherwise the function will find nothing<br />
&nbsp;-&nbsp;&nbsp; as soon as the function encounters a char that was not mentioned in $chars it understands that the segment is over and stops (it doesn't search for the second, third and so on segments)<br />
&nbsp;-&nbsp;&nbsp; finally, it measures the segment's length and return it (i.e. length)<br />
<br />
In other words it finds a span (only the first one) in the string that consists entirely form chars supplied in $chars_list and returns its length</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78200""></a>
  <div class="note">
   <strong class="user">B Crawford</strong>
   <a href="#78200" class="date">02-Oct-2007 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is significantly faster for checking illegal characters than the equivalent preg_match() method.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
