<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>返回规范化的绝对路径名</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.realpath-cache-size.html">? realpath_cache_size</a></li>
      <li style="float: right;"><a href="function.rename.html">rename ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">文件系统函数</a></li>
    <li>返回规范化的绝对路径名</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.realpath" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">realpath</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">realpath</span> &mdash; <span class="dc-title">返回规范化的绝对路径名</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.realpath-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>realpath</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>realpath()</strong></span> 扩展所有符号连接，并处理输入
   <code class="parameter">path</code> 中的 <code class="literal">/./</code>、<code class="literal">/../</code> 和多余的
   <code class="literal">/</code>，并返回规范化的绝对路径名。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.realpath-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">path</code></dt>

     <dd>

      <p class="para">
       要处理的路径。
       <blockquote class="note"><p><strong class="note">Note</strong>: 
        <p class="para">
         虽然必须提供路径，但该值可以是一个空字符串。
         在这种情况下，该值将被解释为当前目录。
        </p>
       </p></blockquote>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.realpath-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回规范化的绝对路径名。返回的路径中没有符号连接（symbolic link）、<code class="literal">/./</code> 或 <code class="literal">/../</code> 成分。
   例如 <code class="literal">\</code> 和 <code class="literal">/</code> 这样的尾随分隔符也将被删除。
  </p>
  <p class="para">
   <span class="function"><strong>realpath()</strong></span> 失败时返回 <strong><code>false</code></strong>，例如文件不存在。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    当前运行的脚本必须对要处理的路径中的每层目录都具有可执行权限，否则
    <span class="function"><strong>realpath()</strong></span> 将返回 <strong><code>false</code></strong>。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    对于不区分大小写的文件系统，<span class="function"><strong>realpath()</strong></span> 不一定会规范字符大小写。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    <span class="function"><strong>realpath()</strong></span> 函数不适用于 Phar 内的文件，因为该路径是虚拟路径，而不是真实路径。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    在 Windows 上，目录的结点和符号链接仅扩展一级。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">
因为 PHP 的整数类型是有符号整型而且很多平台使用 32 位整型，对 2GB
以上的文件，一些文件系统函数可能返回无法预期的结果。</span></p></blockquote>
 </div>


 <div class="refsect1 examples" id="refsect1-function.realpath-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="example-4562">
    <p><strong>Example #1 <span class="function"><strong>realpath()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />chdir</span><span style="color: #007700">(</span><span style="color: #DD0000">'/var/www/'</span><span style="color: #007700">);<br />echo </span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'./../../etc/passwd'</span><span style="color: #007700">) . </span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /><br />echo </span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'/tmp/'</span><span style="color: #007700">) . </span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
/etc/passwd
/tmp
</pre></div>
    </div>
   </div>
   <div class="example" id="example-4564">
    <p><strong>Example #2 Windows 上的 <span class="function"><strong>realpath()</strong></span></strong></p>
    <div class="example-contents"><p>
     在 Windows 上，<span class="function"><strong>realpath()</strong></span> 会将 unix 风格的路径改成 Windows 风格。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'/windows/system32'</span><span style="color: #007700">), </span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /><br />echo </span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'C:\Program Files\\'</span><span style="color: #007700">), </span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上示例会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
C:\WINDOWS\System32
C:\Program Files
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.realpath-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.basename.html" class="function" rel="rdfs-seeAlso">basename()</a> - 返回路径中的文件名部分</span></li>
    <li class="member"><span class="function"><a href="function.dirname.html" class="function" rel="rdfs-seeAlso">dirname()</a> - 返回路径中的目录部分</span></li>
    <li class="member"><span class="function"><a href="function.pathinfo.html" class="function" rel="rdfs-seeAlso">pathinfo()</a> - 返回文件路径的信息</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="128080""></a>
  <div class="note">
   <strong class="user">belisoful at icloud dot com</strong>
   <a href="#128080" class="date">04-Jan-2023 06:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sven Arduwie answer is not tested and does not replicate the behavior of realpath but is a close solution.<br />
<br />
This has been unit tested to be as close to realpath as possible but without the path having to actually exist in the system.<br />
<br />
This takes relative paths and realizes them properly based on actual current working directory, but everything can be virtual. eg.&nbsp; "../someVirtualDir/./virtualFile.jpg"<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">virtualpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">): </span><span class="default">string<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">([</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">], </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$relative </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$len </span><span class="keyword">|| (</span><span class="default">$len </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$path</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] == </span><span class="string">'.'</span><span class="keyword">) || </span><span class="default">$relative </span><span class="keyword">!== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">getcwd</span><span class="keyword">() . </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$path</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">), </span><span class="string">'strlen'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes </span><span class="keyword">= [];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$parts </span><span class="keyword">as </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'.' </span><span class="keyword">== </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'..' </span><span class="keyword">== </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes</span><span class="keyword">[] = </span><span class="default">$part</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="126932""></a>
  <div class="note">
   <strong class="user">Enzo dot Barbaguelatta at alma dot cl</strong>
   <a href="#126932" class="date">16-Mar-2022 06:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be noticed that, one of the reasons of realtpath retuning false can be if the path does not exist, or it has permission issues, or even if security modules of your operating system (let's say, SELinux for example) avoids you checking the path.<br />
<br />
If you're like me and you had a not very good time checking why realpath retuns false, please check these points first.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124254""></a>
  <div class="note">
   <strong class="user">moreau dot marc dot web at gmail dot com</strong>
   <a href="#124254" class="date">01-Oct-2019 07:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">namespace </span><span class="default">MockingMagician\Organic\Helper</span><span class="keyword">;<br />
<br />
class </span><span class="default">Path<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * There is a method that deal with Sven Arduwie proposal https://www.php.net/manual/en/function.realpath.php#84012<br />
&nbsp;&nbsp; &nbsp; * And runeimp at gmail dot com proposal https://www.php.net/manual/en/function.realpath.php#112367<br />
&nbsp;&nbsp; &nbsp; * @param string $path<br />
&nbsp;&nbsp; &nbsp; * @return string<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">getAbsolute</span><span class="keyword">(</span><span class="default">string $path</span><span class="keyword">): </span><span class="default">string<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Cleaning path regarding OS<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">mb_ereg_replace</span><span class="keyword">(</span><span class="string">'\\\\|/'</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="string">'msr'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Check if path start with a separator (UNIX)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startWithSeparator </span><span class="keyword">= </span><span class="default">$path</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] === </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Check if start with drive letter<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[a-z]:/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startWithLetterDir </span><span class="keyword">= isset(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) ? </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] : </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Get and filter empty sub paths<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subPaths </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">), </span><span class="string">'mb_strlen'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes </span><span class="keyword">= [];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$subPaths </span><span class="keyword">as </span><span class="default">$subPath</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'.' </span><span class="keyword">=== </span><span class="default">$subPath</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if $startWithSeparator is false<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // and $startWithLetterDir<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // and (absolutes is empty or all previous values are ..)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // save absolute cause that's a relative and we can't deal with that and just forget that we want go up<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="string">'..' </span><span class="keyword">=== </span><span class="default">$subPath<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">&amp;&amp; !</span><span class="default">$startWithSeparator<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">&amp;&amp; !</span><span class="default">$startWithLetterDir<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">&amp;&amp; empty(</span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">$absolutes</span><span class="keyword">, function (</span><span class="default">$value</span><span class="keyword">) { return !(</span><span class="string">'..' </span><span class="keyword">=== </span><span class="default">$value</span><span class="keyword">); }))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes</span><span class="keyword">[] = </span><span class="default">$subPath</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'..' </span><span class="keyword">=== </span><span class="default">$subPath</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes</span><span class="keyword">[] = </span><span class="default">$subPath</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((</span><span class="default">$startWithSeparator </span><span class="keyword">? </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">: </span><span class="default">$startWithLetterDir</span><span class="keyword">) ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startWithLetterDir</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">: </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">).</span><span class="default">implode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Examples<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('/one/two/../two/./three/../../two');&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt;&nbsp; &nbsp; /one/two<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('../one/two/../two/./three/../../two');&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt;&nbsp; &nbsp; ../one/two<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('../.././../one/two/../two/./three/../../two');&nbsp; =&gt;&nbsp; &nbsp; ../../../one/two<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('../././../one/two/../two/./three/../../two');&nbsp;&nbsp; =&gt;&nbsp; &nbsp; ../../one/two<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('/../one/two/../two/./three/../../two');&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; =&gt;&nbsp; &nbsp; /one/two<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('/../../one/two/../two/./three/../../two');&nbsp; &nbsp; &nbsp; =&gt;&nbsp; &nbsp; /one/two<br />
&nbsp;&nbsp; &nbsp; * echo Path::getAbsolute('c:\.\..\one\two\..\two\.\three\..\..\two');&nbsp; &nbsp;&nbsp; =&gt;&nbsp; &nbsp; c:/one/two<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; */<br />
</span><span class="keyword">}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123783""></a>
  <div class="note">
   <strong class="user">plamen at dragiyski dot org</strong>
   <a href="#123783" class="date">16-Apr-2019 02:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
realpath() is just a system/library call to actual realpath() function supported by OS. It does not work on a path as a string, but also resolves symlinks. The resulting path might significantly differs from the input even when absolute path is given. No function in this notes resolves that.<br />
<br />
The suggestion on the realpath man page is to look for an existing parent directory. Here is an example:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">resolvePath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">!== </span><span class="string">'/'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$search </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$search </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">, function(</span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$part </span><span class="keyword">!== </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; });<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$append </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$search</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$match </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_unshift</span><span class="keyword">(</span><span class="default">$append</span><span class="keyword">, </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$match </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">= </span><span class="default">getcwd</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$append</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">.= </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$append</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$match</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
The result will retrieve absolute path for non-existing relative path. Even if a path does not exists, there should be existing directory somewhere, for which the realpath could be obtained. If this is not within the relative path (i.e. even current working directory does not exists), getcwd() will retrieve absolute path, so some absolute path is returned (although in that case the PHP process could have huge problems).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121577""></a>
  <div class="note">
   <strong class="user">https://stackoverflow.com/users/1397947/</strong>
   <a href="#121577" class="date">30-Aug-2017 06:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should probably be expressly noted that tilde expansion is not performed by realpath.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118440""></a>
  <div class="note">
   <strong class="user">eion at robbmob dot com</strong>
   <a href="#118440" class="date">06-Dec-2015 10:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware that realpath() doesn't work with hidden Windows UNC paths, eg&nbsp; \\servername\share$\folder\blah.txt but other PHP file-functions can access that file fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117144""></a>
  <div class="note">
   <strong class="user">Vincent Par</strong>
   <a href="#117144" class="date">21-Apr-2015 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware of relative symbolic links like this one (ext4 file system on Ubuntu) :<br />
<br />
&nbsp;&nbsp;&nbsp; vincent@vincent:~/Bureau/dirscan$ readlink sandbox/roulant/voiture/cabriolet/ln-loop-relative<br />
&nbsp;&nbsp;&nbsp; ../..<br />
<br />
In this case, realpath may return false :<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="string">'sandbox/roulant/voiture/cabriolet/ln-loop-relative'</span><span class="keyword">));<br />
</span><span class="comment">// =&gt; string(44) "/home/vincent/Bureau/dirscan/sandbox/roulant"<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="string">'sandbox/roulant/voiture/cabriolet/ln-loop-relative/moto'</span><span class="keyword">));<br />
</span><span class="comment">// =&gt; bool(false)<br />
</span><span class="default">?&gt;<br />
</span><br />
But you can fix it by clearing the realpath cache, this way :<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="string">'sandbox/roulant/voiture/cabriolet/ln-loop-relative'</span><span class="keyword">));<br />
</span><span class="default">clearstatcache</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="string">'sandbox/roulant/voiture/cabriolet/ln-loop-relative/moto'</span><span class="keyword">));<br />
</span><span class="comment">// =&gt; string(49) "/home/vincent/Bureau/dirscan/sandbox/roulant/moto"<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112724""></a>
  <div class="note">
   <strong class="user">Leonard Challis</strong>
   <a href="#112724" class="date">17-Jul-2013 07:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using realpath (and similar functions) remember that PHP will take in to account open_basedir restrictions. So, if you do something like:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// test.php in httpdocs folder<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">'/../application'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
where your open_basedir setting is set to the httpdocs folder and tmp, this will return false. You must set it to the level above (or off) for this to work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112367""></a>
  <div class="note">
   <strong class="user">runeimp at gmail dot com</strong>
   <a href="#112367" class="date">07-Jun-2013 11:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Needed a method to normalize a virtual path that could handle .. references that go beyond the initial folder reference. So I created the following.<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">normalizePath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= array();</span><span class="comment">// Array to build a new path from the good parts<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);</span><span class="comment">// Replace backslashes with forwardslashes<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\/+/'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);</span><span class="comment">// Combine multiple slashes into a single slash<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$segments </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);</span><span class="comment">// Collect path segments<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;</span><span class="comment">// Initialize testing variable<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$segments </span><span class="keyword">as </span><span class="default">$segment</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$segment </span><span class="keyword">!= </span><span class="string">'.'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$test </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$parts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if(</span><span class="default">$segment </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$test </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$test</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$test </span><span class="keyword">== </span><span class="string">'..' </span><span class="keyword">|| </span><span class="default">$test </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$test</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$parts</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Will convert /path/to/test/.././..//..///..///../one/two/../three/filename<br />
to ../../one/three/filename</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108879""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#108879" class="date">31-May-2012 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: If you use this to check if a file exists, it's path will be cached, and returns true even if the file is removed (use file_exists instead).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106207""></a>
  <div class="note">
   <strong class="user">php at keith tyler dot com</strong>
   <a href="#106207" class="date">18-Oct-2011 12:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that under Windows, a slash-rooted path will resolve on the local drive, and *not* necessarily C:\.<br />
<br />
For example:<br />
<br />
M:\&gt;php -r "print realpath('/AUTOEXEC.BAT');"<br />
[prints nothing, because there is no M:\AUTOEXEC.BAT]<br />
<br />
But:<br />
<br />
M:\&gt;C:<br />
C:\&gt;php -r "print realpath('/AUTOEXEC.BAT');"<br />
C:\AUTOEXEC.BAT<br />
<br />
Same script, different response depending on current drive.<br />
<br />
I'm inclined to argue that this function *should* use the value of %SystemDrive% as the "slash root" base.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105876""></a>
  <div class="note">
   <strong class="user">imagiro</strong>
   <a href="#105876" class="date">21-Sep-2011 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a small and handy method to calculate the relative path from $from to $to. Note: On Windows it does not work when $from and $to are on different drives.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">relativePath</span><span class="keyword">(</span><span class="default">$from</span><span class="keyword">, </span><span class="default">$to</span><span class="keyword">, </span><span class="default">$ps </span><span class="keyword">= </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$arFrom </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$ps</span><span class="keyword">, </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$from</span><span class="keyword">, </span><span class="default">$ps</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$arTo </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$ps</span><span class="keyword">, </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">$ps</span><span class="keyword">));<br />
&nbsp; while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$arFrom</span><span class="keyword">) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arTo</span><span class="keyword">) &amp;&amp; (</span><span class="default">$arFrom</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] == </span><span class="default">$arTo</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$arFrom</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$arTo</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arFrom</span><span class="keyword">) * </span><span class="default">3</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">.</span><span class="default">$ps</span><span class="keyword">).</span><span class="default">implode</span><span class="keyword">(</span><span class="default">$ps</span><span class="keyword">, </span><span class="default">$arTo</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98372""></a>
  <div class="note">
   <strong class="user">Jrg Wagner</strong>
   <a href="#98372" class="date">11-Jun-2010 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please be aware that this function does NOT always strip a trailing slash!:<br />
<br />
LINUX (tested with PHP 5.2.11):<br />
---<br />
realpath('.')<br />
: string = "/myhttpdfolder" <br />
realpath('./')<br />
: string = "/myhttpdfolder" <br />
realpath('fileadmin')<br />
: string = "/myhttpdfolder/fileadmin" <br />
realpath('fileadmin/')<br />
: string = "/myhttpdfolder/fileadmin" <br />
<br />
WINDOWS (tested with PHP 5.2.5):<br />
---<br />
realpath('.')<br />
: string = "C:\\myhttpdfolder" <br />
realpath('./')<br />
: string = "C:\\myhttpdfolder\\" <br />
realpath('fileadmin')<br />
: string = "C:\\myhttpdfolder\\fileadmin" <br />
realpath('fileadmin/')<br />
: string = "C:\\myhttpdfolder\\fileadmin\\"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84012""></a>
  <div class="note">
   <strong class="user">Sven Arduwie</strong>
   <a href="#84012" class="date">23-Jun-2008 03:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Because realpath() does not work on files that do not<br />
exist, I wrote a function that does.<br />
It replaces (consecutive) occurences of / and \\ with<br />
whatever is in DIRECTORY_SEPARATOR, and processes /. and /.. fine.<br />
Paths returned by get_absolute_path() contain no<br />
(back)slash at position 0 (beginning of the string) or<br />
position -1 (ending)<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_absolute_path</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">), </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">), </span><span class="string">'strlen'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$parts </span><span class="keyword">as </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'.' </span><span class="keyword">== </span><span class="default">$part</span><span class="keyword">) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'..' </span><span class="keyword">== </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes</span><span class="keyword">[] = </span><span class="default">$part</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
A test:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; var_dump</span><span class="keyword">(</span><span class="default">get_absolute_path</span><span class="keyword">(</span><span class="string">'this/is/../a/./test/.///is'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span>Returns: string(14) "this/a/test/is" <br />
<br />
As you can so, it also produces Yoda-speak. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71334""></a>
  <div class="note">
   <strong class="user">David Beck</strong>
   <a href="#71334" class="date">22-Nov-2006 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a function to canonicalize a URL containing relative paths. Ran into the problem when pulling links from a remote page.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">canonicalize</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$address</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$keys </span><span class="keyword">AS </span><span class="default">$keypos </span><span class="keyword">=&gt; </span><span class="default">$key</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_splice</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">, </span><span class="default">$key </span><span class="keyword">- (</span><span class="default">$keypos </span><span class="keyword">* </span><span class="default">2 </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$address</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'./'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$address</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a href="http://www.example.com/something/../else" rel="nofollow" target="_blank">http://www.example.com/something/../else</a>'</span><span class="keyword">;<br />
echo </span><span class="default">canonicalize</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">); </span><span class="comment">//<a href="http://www.example.com/else" rel="nofollow" target="_blank">http://www.example.com/else</a><br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53668""></a>
  <div class="note">
   <strong class="user">Lars Scheithauer &lt;l dot scheithauer at gmx dot de&gt;</strong>
   <a href="#53668" class="date">08-Jun-2005 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is also nice to test for security-breaches. You can forbid the script to access files below a certain directory to prevent "../../../etc/shadow" and similar attacks:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// declare the basic directory for security reasons<br />
// Please do NOT attach a "/"-suffix !<br />
</span><span class="default">$basedir </span><span class="keyword">= </span><span class="string">'/var/www/cgi-bin/scriptfolder'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// compare the entered path with the basedir<br />
</span><span class="default">$path_parts </span><span class="keyword">= </span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'file_to_get'</span><span class="keyword">]);<br />
if (</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$path_parts</span><span class="keyword">[</span><span class="string">'dirname'</span><span class="keyword">]) != </span><span class="default">$basedir</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* appropriate action against crack-attempt*/<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">die (</span><span class="string">'coding good - h4x1ng bad!'</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The url "script.php?file_to_get=../../../etc/shadow" will now result in an error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48361""></a>
  <div class="note">
   <strong class="user">pulstar at ig dot com dot br</strong>
   <a href="#48361" class="date">20-Dec-2004 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes you may need to refer to the absolute path of a file in your website instead of a relative path, but the realpath() function returns the path relative to the server's filesystem, not a path relative to your website root directory. <br />
<br />
For example, realpath() may return something like this:<br />
<br />
/home/yoursite/public_html/dir1/file.ext<br />
<br />
You can't use this in an HTML document, because the web server will not find the file. To do so, you can use:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">htmlpath</span><span class="keyword">(</span><span class="default">$relative_path</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$realpath</span><span class="keyword">=</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$relative_path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$htmlpath</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">],</span><span class="string">''</span><span class="keyword">,</span><span class="default">$realpath</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$htmlpath</span><span class="keyword">;<br />
}<br />
<br />
echo </span><span class="string">'&lt;img src="'</span><span class="keyword">,</span><span class="default">htmlpath</span><span class="keyword">(</span><span class="string">'../../relative/path/to/file.ext'</span><span class="keyword">),</span><span class="string">'" border=1&gt;'</span><span class="keyword">; <br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
It will return something like:<br />
<br />
&lt;img src="/dir1/relative/path/to/file.ext" border=1&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
