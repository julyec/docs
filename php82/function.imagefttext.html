<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>使用 FreeType 2 字体将文本写入图像</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imageftbbox.html">? imageftbbox</a></li>
      <li style="float: right;"><a href="function.imagegammacorrect.html">imagegammacorrect ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD 和图像处理 函数</a></li>
    <li>使用 FreeType 2 字体将文本写入图像</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imagefttext" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagefttext</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.7, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imagefttext</span> &mdash; <span class="dc-title">使用 FreeType 2 字体将文本写入图像</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imagefttext-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imagefttext</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="class.gdimage.html" class="type GdImage">GdImage</a></span> <code class="parameter">$image</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">float</span> <code class="parameter">$size</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">float</span> <code class="parameter">$angle</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$x</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$y</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$color</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$font_filename</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$text</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = []</span></span><br>): <span class="type"><span class="type">array</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    在 PHP 8.0.0 之前，<span class="function"><strong>imagefttext()</strong></span> 是 <span class="function"><a href="function.imagettftext.html" class="function">imagettftext()</a></span> 的扩展变体，它还支持 <code class="parameter">options</code>。
    自 PHP 8.0.0 起，<span class="function"><a href="function.imagettftext.html" class="function">imagettftext()</a></span> 是 <span class="function"><strong>imagefttext()</strong></span> 的别名。
   </p>
  </p></blockquote>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imagefttext-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    <dt>

<code class="parameter">image</code></dt>
<dd>
<p class="para">由图象创建函数(例如<span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>)返回的 
<span class="classname"><a href="class.gdimage.html" class="classname">GdImage</a></span> 对象。</p></dd>

    
     <dt>
<code class="parameter">size</code></dt>

     <dd>

      <p class="para">
       字体的尺寸，单位：点（磅）。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">angle</code></dt>

     <dd>

      <p class="para"> 
       以度为单位的角度，0 度表示从左到右阅读文本。较高的值表示逆时针旋转。例如，值为
       90 将导致从下到上阅读文本。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">x</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">x</code> 和 <code class="parameter">y</code> 给出的坐标将定义第一个字符的基点（大致是字符的左下角）。 这与
       <span class="function"><a href="function.imagestring.html" class="function">imagestring()</a></span> 不同，其中 <code class="parameter">x</code> 和 <code class="parameter">y</code>
       定义第一个字符的左上角。例如，"左上角"是 0, 0。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">y</code></dt>

     <dd>

      <p class="para">
       y 坐标。设置字体基线的位置，而不是字符的最底部。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">color</code></dt>

     <dd>

      <p class="para">
       文本所需颜色的索引，请参阅 <span class="function"><a href="function.imagecolorexact.html" class="function">imagecolorexact()</a></span>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">font_filename</code></dt>

     <dd>

      <p class="para">
       希望使用的 TrueType 字体的路径。
      </p>
      <p class="para">
       根据 PHP 使用的 GD 库版本，<em class="emphasis">当 <code class="parameter">font_filename</code> 不以 <code class="literal">/</code>
       开头时，将追加 <code class="literal">.ttf</code></em> 到文件名末尾，库将尝试沿着库定义的字体路径搜索该文件名。
      </p>
      <p class="para">
       在许多情况下，字体与使用的脚本位于同一目录中，以下技巧将缓解任何包含问题。
       <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// 设置 GD 的环境变量<br /></span><span style="color: #0000BB">putenv</span><span style="color: #007700">(</span><span style="color: #DD0000">'GDFONTPATH=' </span><span style="color: #007700">. </span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">// Name the font to be used (note the lack of the .ttf extension)<br /></span><span style="color: #0000BB">$font </span><span style="color: #007700">= </span><span style="color: #DD0000">'SomeFont'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
       </div>

      </p>
     </dd>

    
    
     <dt>
<code class="parameter">text</code></dt>

     <dd>

      <p class="para">
       要插入到图像中的文本。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       <table class="doctable table">
       <caption><strong><code class="parameter">options</code> 可能的数组索引</strong></caption>
        
         <thead>
          <tr>
           <th>键</th>
           <th>类型</th>
           <th>含义</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td><code class="literal">linespacing</code></td>
           <td><span class="type">float</span></td>
           <td>定义绘制行距</td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imagefttext-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   这个函数返回数组，定义了盒子的四个点，从左下角开始逆时针移动：
   <table class="doctable informaltable">
    
     <tbody class="tbody">
      <tr>
       <td>0</td>
       <td>左下 x 坐标</td>
      </tr>

      <tr>
       <td>1</td>
       <td>左下 y 坐标</td>
      </tr>

      <tr>
       <td>2</td>
       <td>右下 x 坐标</td>
      </tr>

      <tr>
       <td>3</td>
       <td>右下 x 坐标</td>
      </tr>

      <tr>
       <td>4</td>
       <td>右上 x 坐标</td>
      </tr>

      <tr>
       <td>5</td>
       <td>右上 x 坐标</td>
      </tr>

      <tr>
       <td>6</td>
       <td>左上 x 坐标</td>
      </tr>

      <tr>
       <td>7</td>
       <td>左上 y 坐标</td>
      </tr>

     </tbody>
    
   </table>

  </p>
  <p class="para">
   失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.imagefttext-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
 <td>8.0.0</td>
 <td>
  <code class="parameter">image</code> 现在需要 <span class="classname"><a href="class.gdimage.html" class="classname">GdImage</a></span> 实例；之前需要有效的 <code class="literal">gd</code> <span class="type">resource</span>。
 </td>
</tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.imagefttext-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="example-5512">
    <p><strong>Example #1 <span class="function"><strong>imagefttext()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// Create a 300x100 image<br /></span><span style="color: #0000BB">$im </span><span style="color: #007700">= </span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">300</span><span style="color: #007700">, </span><span style="color: #0000BB">100</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$red </span><span style="color: #007700">= </span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">, </span><span style="color: #0000BB">0xFF</span><span style="color: #007700">, </span><span style="color: #0000BB">0x00</span><span style="color: #007700">, </span><span style="color: #0000BB">0x00</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$black </span><span style="color: #007700">= </span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">, </span><span style="color: #0000BB">0x00</span><span style="color: #007700">, </span><span style="color: #0000BB">0x00</span><span style="color: #007700">, </span><span style="color: #0000BB">0x00</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Make the background red<br /></span><span style="color: #0000BB">imagefilledrectangle</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">299</span><span style="color: #007700">, </span><span style="color: #0000BB">99</span><span style="color: #007700">, </span><span style="color: #0000BB">$red</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Path to our ttf font file<br /></span><span style="color: #0000BB">$font_file </span><span style="color: #007700">= </span><span style="color: #DD0000">'./arial.ttf'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Draw the text 'PHP Manual' using font size 13<br /></span><span style="color: #0000BB">imagefttext</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">, </span><span style="color: #0000BB">13</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">, </span><span style="color: #0000BB">105</span><span style="color: #007700">, </span><span style="color: #0000BB">55</span><span style="color: #007700">, </span><span style="color: #0000BB">$black</span><span style="color: #007700">, </span><span style="color: #0000BB">$font_file</span><span style="color: #007700">, </span><span style="color: #DD0000">'PHP Manual'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Output image to the browser<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type: image/png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.imagefttext-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数仅在
PHP 编译时加入 freetype 支持时有效（<strong class="option configure">--with-freetype-dir=DIR</strong>）。</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.imagefttext-seealso">
  <h3 class="title">参见</h3>
  <ul class="simplelist">
   <li class="member"><span class="function"><a href="function.imageftbbox.html" class="function" rel="rdfs-seeAlso">imageftbbox()</a> - 通过 freetype2 使用字体给出文本的边界框</span></li>
   <li class="member"><span class="function"><a href="function.imagettftext.html" class="function" rel="rdfs-seeAlso">imagettftext()</a> - 用 TrueType 字体向图像写入文本</span></li>
  </ul>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="98295""></a>
  <div class="note">
   <strong class="user">php@davehirschD0TK0MM</strong>
   <a href="#98295" class="date">07-Jun-2010 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm not sure if this is a PHP issue or an GD issue, but after upgrading to PHP 5.3.2, text written at an angle has become top-justified (so "N" and "n" have the same top, but the bottom of the "N" is lower than the bottom of the "n".&nbsp; I've written a kludgy work-around, which writes the text to a non-rotated temporary image, then copies the temporary image, rotated onto the main image.&nbsp; The kludginess is to get around the fact that I can't seem to extract the font info, particularly the distance between the baseline and the very bottom (I've hard-coded it as 30% of the font size)<br />
I hope the bug can be fixed (if it is indeed a bug) or that others can improve this code:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Function that draws rotated text by creating a temporary image and rotating it, since rotated text appears to be busted<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">imageTextRotated</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$size</span><span class="keyword">, </span><span class="default">$angle</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$inColor</span><span class="keyword">, </span><span class="default">$fontfile</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$info</span><span class="keyword">=array()) {<br />
</span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp; Force some demo text that contains risers and descenders:<br />
//&nbsp; &nbsp; &nbsp; &nbsp; $text = "Nlfbacejygq!";<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bbox </span><span class="keyword">= </span><span class="default">imageftbbox</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$fontfile</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$info</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dropdown </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">*</span><span class="default">0.3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xsize </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] - </span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ysize </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] - </span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmpImage </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$xsize</span><span class="keyword">*</span><span class="default">1.25</span><span class="keyword">, </span><span class="default">$ysize</span><span class="keyword">*</span><span class="default">1.25</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// need the extra space to accommodate risers and descenders<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$transparent </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">154</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$transparent</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"Color allocate failed"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolortransparent</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">$transparent</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$ysize</span><span class="keyword">, </span><span class="default">$transparent</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"Fill failed"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$inColor</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorexact</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$color </span><span class="keyword">== -</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">]); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$color</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"Color allocate 2 failed"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newbbox </span><span class="keyword">= </span><span class="default">imagefttext</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">$size</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$ysize</span><span class="keyword">*</span><span class="default">1.0</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">, </span><span class="default">$fontfile</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$info</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmpImage </span><span class="keyword">= </span><span class="default">imagerotate</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">$angle</span><span class="keyword">, </span><span class="default">$transparent</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newWidth </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newHt </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecopymerge</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$tmpImage</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">-</span><span class="default">$newWidth</span><span class="keyword">+</span><span class="default">$dropdown</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">-</span><span class="default">$newHt</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$newWidth</span><span class="keyword">, </span><span class="default">$newHt</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp; Highlight the desired starting point (baseline) with a green dot:<br />
//&nbsp; &nbsp; &nbsp; &nbsp; $green = imagecolorallocate($image, 0, 251, 0);<br />
//&nbsp; &nbsp; &nbsp; &nbsp; imagefilledellipse($image, $x, $y, 10, 10, $green);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$tmpImage</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
-Dave</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93593""></a>
  <div class="note">
   <strong class="user">KeepSake at crimebloc dot com</strong>
   <a href="#93593" class="date">17-Sep-2009 09:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For a design project I am required to have spacing between characters; since imagefttext does not support this feature I have created a function which does support this. <br />
<br />
The arguments are identical to imagefttext, accept that (array)$extrainfo now accepts the 'character_spacing' spacing parameter. The return values are as expected, and include the image boundaries of the entire string including the character spacing.<br />
<br />
The downside is that $angle rotates each letter instead of rotating the entire word (could be seen as a feature on its own).<br />
<br />
I hope this is of some use to someone.<br />
- KeepSake<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Required header (assuming we use png images)<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Create a basic image with a dark background.<br />
</span><span class="default">$image </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">300</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">21</span><span class="keyword">, </span><span class="default">21</span><span class="keyword">, </span><span class="default">21</span><span class="keyword">));<br />
<br />
</span><span class="comment">// Function call, arguments are the same as imagefttext, expect that (array)$extrainfo takes a new paramenter called character_spacing.<br />
</span><span class="default">$imageBox </span><span class="keyword">= </span><span class="default">imagefttext2</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">), </span><span class="string">'tahomabold.ttf'</span><span class="keyword">, </span><span class="string">'The quick brown fox...'</span><span class="keyword">, array(</span><span class="string">'character_spacing' </span><span class="keyword">=&gt; </span><span class="default">5</span><span class="keyword">));<br />
<br />
</span><span class="comment">// Output the file, and clear the resources<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
<br />
function </span><span class="default">imagefttext2</span><span class="keyword">(</span><span class="default">$imageResource</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">$text_angle</span><span class="keyword">, </span><span class="default">$start_x</span><span class="keyword">, </span><span class="default">$start_y</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">, </span><span class="default">$font_file</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$extra_info </span><span class="keyword">= array()) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$extra_info</span><span class="keyword">[</span><span class="string">'character_spacing'</span><span class="keyword">] == </span><span class="default">NULL </span><span class="keyword">|| !</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$extra_info</span><span class="keyword">[</span><span class="string">'character_spacing'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$extra_info</span><span class="keyword">[</span><span class="string">'character_spacing'</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastX </span><span class="keyword">= </span><span class="default">$start_x </span><span class="keyword">- </span><span class="default">$extra_info</span><span class="keyword">[</span><span class="string">'character_spacing'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) as </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$coordinates </span><span class="keyword">= </span><span class="default">imagefttext</span><span class="keyword">(</span><span class="default">$imageResource</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">$text_angle</span><span class="keyword">, </span><span class="default">$lastX </span><span class="keyword">+ </span><span class="default">$extra_info</span><span class="keyword">[</span><span class="string">'character_spacing'</span><span class="keyword">], </span><span class="default">$start_y</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">, </span><span class="default">$font_file</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">, </span><span class="default">$extra_info</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastX </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Return the newly generated image box coordinates:<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return array(</span><span class="default">$start_x</span><span class="keyword">, </span><span class="default">$start_y</span><span class="keyword">, </span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">], </span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">], </span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">], </span><span class="default">$start_x</span><span class="keyword">, </span><span class="default">$coordinates</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">]);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79389""></a>
  <div class="note">
   <strong class="user">d underscore brown x at hotmail dot</strong>
   <a href="#79389" class="date">24-Nov-2007 10:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
realpath(".")<br />
realpath(getenv("SCRIPT_FILENAME"));<br />
<br />
could be different.&nbsp; This helped when setting GDFONTPATH.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74207""></a>
  <div class="note">
   <strong class="user">darren at badpun dot co dot uk</strong>
   <a href="#74207" class="date">29-Mar-2007 01:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had trouble working out how to accurately represent fonts in point sizes when constructing charts that had a user-customisable output DPI (basically, the user could specify the size of the chart in mm - or any other physical measure - and the DPI to create arbitrarily-sized charts to work properly in real printed documents).<br />
<br />
GD1 was OK as it used pixels for font rendering, but GD2 uses points, which only makes any sense if you know the DPI that it assumes when rendering text on the image surface. I have not been able to find this anywhere in this documentation but have examined the GD2 source code and it appears to assume a DPI of 96 internally. However, this can easily be customised in the GD2 source so it cannot be assumed that all PHP interpreters out there have a GD2 compiled using 96dpi internally.<br />
<br />
If it does, and you are using it to construct images whose target DPI is not 96, you can calculate the point size to supply to imageftbox() and imagefttext() like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/* 100mm x 100mm image */<br />
</span><span class="default">$imageWidth </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
</span><span class="default">$imageHeight </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
<br />
</span><span class="comment">/* 300 dpi image, therefore image is 1181 x 1181 pixels */<br />
</span><span class="default">$imageDPI </span><span class="keyword">= </span><span class="default">300</span><span class="keyword">;<br />
<br />
</span><span class="comment">/* unless we do this, text will be about 3 times too small */<br />
</span><span class="default">$realFontSize </span><span class="keyword">= (</span><span class="default">$fontPt </span><span class="keyword">* </span><span class="default">$targetDPI</span><span class="keyword">) / </span><span class="default">96</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71035""></a>
  <div class="note">
   <strong class="user">cory at lavacube dot com</strong>
   <a href="#71035" class="date">09-Nov-2006 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since this function is not documented, I felt it was best that I shed some light on the extrainfo parameter.<br />
<br />
You can see the full documentation at the GD reference manual:<br />
<a href="http://www.boutell.com/gd/manual2.0.33.html#gdImageStringFTEx" rel="nofollow" target="_blank">http://www.boutell.com/gd/manual2.0.33.html#gdImageStringFTEx</a><br />
<br />
Basically it accepts an array containing the following options as keys and an associated value:<br />
(int) flags [more info in the GD reference manual]<br />
(double/float) linespacing<br />
(int) charmap<br />
(int) hdpi<br />
(int) vdpi<br />
(string) xshow<br />
(string) fontpath<br />
<br />
My C/C++ is not very good but this is the best I can explain. Read the documentation for more information. :-)<br />
<br />
A very simple example of usage would be:<br />
<br />
<span class="default">&lt;?php<br />
<br />
imagefttext</span><span class="keyword">( </span><span class="default">$img_pointer</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">, [-</span><span class="default">insertsomecolour</span><span class="keyword">-], </span><span class="string">'/path/to/font.ttf'</span><span class="keyword">, </span><span class="string">"THIS IS A TEST\nTHIS IS LINE 2\nTHIS IS LINE3"</span><span class="keyword">, array(</span><span class="string">'lineheight'</span><span class="keyword">=&gt;</span><span class="default">2.0</span><span class="keyword">) );<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62106""></a>
  <div class="note">
   
   <a href="#62106" class="date">20-Feb-2006 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using php 5.1.2 on a winxp machine. I was&nbsp; getting into the TrueType fonts and wanted to see which ones would look best incorporated into web images. So I created the following script that prints out samples of all the TrueType fonts found in my C:\Windows\Fonts directory. The script takes only one request parameter - 'fsize'. It stands for font-size and lets you see each font in any size you wish -- I limited it to values between 5 and 48. Hope this helps someone other than me :)<br />
<br />
I apologize in advance if any of my code is not the prettiest-written php code even seen -- I have only been coding in php for the past week (I'm a perl-guy usually).<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">list(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$maxwidth</span><span class="keyword">) = array(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fsize </span><span class="keyword">= (int)</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'fsize'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fsize </span><span class="keyword">&lt; </span><span class="default">5 </span><span class="keyword">or </span><span class="default">$fsize </span><span class="keyword">&gt; </span><span class="default">48</span><span class="keyword">) </span><span class="default">$fsize </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// don't know how wide or tall the font samples will be.<br />
&nbsp;&nbsp;&nbsp; // create a huge image for now, we'll copy it smaller<br />
&nbsp;&nbsp;&nbsp; // later when we know how large the image needs to be.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">1000</span><span class="keyword">, </span><span class="default">20000</span><span class="keyword">) or die(</span><span class="string">'could not create!'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$clr_white </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$clr_black </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$font_path </span><span class="keyword">= </span><span class="string">"C:/Windows/Fonts/"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$font_path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// we're only dealing with TTY fonts here.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">), -</span><span class="default">4</span><span class="keyword">) != </span><span class="string">'.ttf'</span><span class="keyword">) continue;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="string">"Sample text for '</span><span class="default">$file</span><span class="string">'"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bbox </span><span class="keyword">= </span><span class="default">imagettfbbox</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fsize</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="string">"</span><span class="keyword">{</span><span class="default">$font_path</span><span class="keyword">}{</span><span class="default">$file</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">, </span><span class="default">$str<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ww </span><span class="keyword">= </span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] - </span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hh </span><span class="keyword">= </span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] - </span><span class="default">$bbox</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagettftext</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im</span><span class="keyword">, </span><span class="default">$fsize</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$clr_black</span><span class="keyword">, </span><span class="string">"</span><span class="keyword">{</span><span class="default">$font_path</span><span class="keyword">}{</span><span class="default">$file</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">, </span><span class="default">$str<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">+= </span><span class="default">$hh </span><span class="keyword">+ </span><span class="default">20</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$ww </span><span class="keyword">&gt; </span><span class="default">$maxwidth</span><span class="keyword">) </span><span class="default">$maxwidth </span><span class="keyword">= </span><span class="default">$ww</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// ok, now we can chop off the extra space from the<br />
&nbsp;&nbsp;&nbsp; // 1000 x 20000 image.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$im2 </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">$maxwidth </span><span class="keyword">+ </span><span class="default">20</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagecopyresized</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im2</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$maxwidth </span><span class="keyword">+ </span><span class="default">20</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$maxwidth </span><span class="keyword">+ </span><span class="default">20</span><span class="keyword">, </span><span class="default">$y<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im2</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59001""></a>
  <div class="note">
   <strong class="user">vsazel at atlas dot cz</strong>
   <a href="#59001" class="date">23-Nov-2005 09:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to get the best result in monochrome font rendering, change render_mode to FT_LOAD_RENDER. It's the last parameter of FT_Load_Glyph() function (in gdft.c).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54080""></a>
  <div class="note">
   <strong class="user">dnf at seznam dot cz</strong>
   <a href="#54080" class="date">23-Jun-2005 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For negative image you must add one line after the $grayColor computation:<br />
<br />
$grayColor =&nbsp; ~ $grayColor &amp; 0x7FFFFFF;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53333""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#53333" class="date">29-May-2005 03:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is very simular to imageffttext(), you may find the information provided on its manual page helpful:<br />
<br />
<a href="http://php.net/imagettftext" rel="nofollow" target="_blank">http://php.net/imagettftext</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49420""></a>
  <div class="note">
   <strong class="user">MagicalTux at FF dot st</strong>
   <a href="#49420" class="date">27-Jan-2005 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When compiling PHP with FreeType 2 support, you'll probably have some problems if - for example - you use debian and didn't compile freetype2 yourself...<br />
If configure fails after saying "If configure fails, try --with-xpm-dir..." you most likely have FreeType1 installed, but not freetype2 ...<br />
<br />
Do this as root :<br />
apt-get install libfreetype6-dev<br />
<br />
It took me some time to find out that apt-get install freetype2 is actually installing freetype1 ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47984""></a>
  <div class="note">
   <strong class="user">kagaku at gmail dot com</strong>
   <a href="#47984" class="date">07-Dec-2004 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found myself in need of an align right function and found one on the imagepstext manual page. I can't imagine I'm the only person who's needed to use this, so here's a slightly modified version that works with imagefttext:<br />
<br />
&lt;?<br />
&nbsp; function align_right($string, $fontfile, $imgwidth, $fontsize){<br />
&nbsp;&nbsp;&nbsp; $spacing = 0;<br />
&nbsp;&nbsp;&nbsp; $line = array("linespacing" =&gt; $spacing);<br />
&nbsp;&nbsp;&nbsp; list($lx,$ly,$rx,$ry) = imageftbbox($fontsize,0,$fontfile,$string,$line);<br />
&nbsp;&nbsp;&nbsp; $textwidth = $rx - $lx;<br />
&nbsp;&nbsp;&nbsp; $imw = ($imgwidth-10-$textwidth);<br />
&nbsp;&nbsp;&nbsp; return $imw;<br />
&nbsp; }<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39329""></a>
  <div class="note">
   <strong class="user">eshenk at comcast dot net</strong>
   <a href="#39329" class="date">24-Jan-2004 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a bit of code to gather all the .ttf files in the directory with this script, and randomize them to write text on a header image for my site. The only catch is the font files have to be named 1.ttf, 2.ttf etc etc.<br />
<br />
<span class="default">&lt;?php<br />
<br />
srand</span><span class="keyword">((double)</span><span class="default">microtime</span><span class="keyword">()*</span><span class="default">1234567</span><span class="keyword">); </span><span class="comment">// Start the random gizmo<br />
</span><span class="default">$image </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">exec</span><span class="keyword">(</span><span class="string">'ls *.jpg | wc -l'</span><span class="keyword">)) . </span><span class="string">".jpg"</span><span class="keyword">); </span><span class="comment">// Get a background<br />
</span><span class="default">$font </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">exec</span><span class="keyword">(</span><span class="string">'ls *.ttf | wc -l'</span><span class="keyword">)) . </span><span class="string">".ttf"</span><span class="keyword">; </span><span class="comment">// Get a font<br />
</span><span class="default">$textcolor </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); </span><span class="comment">// Set text color<br />
<br />
</span><span class="default">$text1 </span><span class="keyword">= </span><span class="string">"shenko.homedns.org"</span><span class="keyword">; </span><span class="comment">// Here is our text<br />
<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">$textcolor</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$text1</span><span class="keyword">); </span><span class="comment">// Write the text with a font<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">); </span><span class="comment">// Its a JPEG<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">90</span><span class="keyword">); </span><span class="comment">// Zap it to the browser<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); </span><span class="comment">// Memory Freeupage<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35868""></a>
  <div class="note">
   <strong class="user">sebastiand at gmx dot de</strong>
   <a href="#35868" class="date">17-Sep-2003 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After spending the evening with some work on automatically generated images, I had the idea to switch of anti-aliasing (looking, if some font would look better that way), which turned out not to be quite so easy.<br />
<br />
Actually you have to use the negative of the desired color to switch of antialising. I include the corresponding line from my code (line split up):<br />
<br />
// USE NEGATIVE OF DESIRED COLOR TO SWITCH OF ANTI-ALIASING<br />
ImageFTText ($neuesBild,$fontsize,$fontangle,$TextPosX,$TextPosY,<br />
-$custom_fg,$fonttype,$text,array());</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27068""></a>
  <div class="note">
   <strong class="user">jwilliam at kcr dot uky dot edu</strong>
   <a href="#27068" class="date">21-Nov-2002 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks for the script!&nbsp; I modified it to show several fonts that I was wanting to use.&nbsp; I am using GD-2.0.7, FreeType-2.1.3(text rotation fix,among others), and PHP-4.2.3 and had to include the array information to get it to work.<br />
<br />
Code change follows:<br />
$fontfile="/usr/local/fonts/ttf/bookantbd.ttf";<br />
// Waterfall of point sizes to see what Freetype 2's autohinting looks like:<br />
//<br />
for($i=4;$i&lt;=12;$i++){<br />
&nbsp; ImageFtText($image,$i,0,10,(280+$i*14),$forecolor,$fontfile, bookantbd . $i . ". " . $string, array("linespacing" =&gt; 1.0));<br />
}<br />
<br />
John</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24149""></a>
  <div class="note">
   <strong class="user">ben at tNOSPAManjNOSPAMo dot cnospamordots dot om</strong>
   <a href="#24149" class="date">08-Aug-2002 12:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're interested in turning off FreeType hinting, search for the following line in the gd source (gdft.c):<br />
&nbsp;&nbsp; &nbsp;&nbsp; err = FT_Load_Glyph (face, glyph_index, FT_LOAD_DEFAULT);<br />
and replace it with<br />
&nbsp;&nbsp; &nbsp;&nbsp; err = FT_Load_Glyph (face, glyph_index, FT_LOAD_NO_HINTING);<br />
<br />
Recompile GD, and vo?la: beauteous antialiasing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
