<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>获取历史</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.readline-info.html">? readline_info</a></li>
      <li style="float: right;"><a href="function.readline-on-new-line.html">readline_on_new_line ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.readline.html">Readline 函数</a></li>
    <li>获取历史</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.readline-list-history" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">readline_list_history</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">readline_list_history</span> &mdash; <span class="dc-title">获取历史</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.readline-list-history-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>readline_list_history</strong></span>(): <span class="type">array</span></div>

  <p class="para rdfs-comment">
   获取完整命令行历史。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.readline-list-history-parameters">
  <h3 class="title">参数</h3>
  <p class="para">此函数没有参数。</p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.readline-list-history-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回完整命令行历史的数组。元素的索引为整数，从零开始。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120340""></a>
  <div class="note">
   <strong class="user">info () gaj ! design</strong>
   <a href="#120340" class="date">16-Dec-2016 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just noticed that all readline functions are available with my php.exe (PHP 7, Cygwin) except for this one. It would be nice to have it so duplicate lines can be screened.<br />
<br />
So to emulate it, I keep a working copy of the history in an array (yeah, extra code/data, but there are ways to keep the history from getting too large).<br />
<br />
Loading is like:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; readline_read_history</span><span class="keyword">(</span><span class="default">HISTFILE</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hist </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">HISTFILE</span><span class="keyword">,</span><span class="default">FILE_IGNORE_NEW_LINES</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$hist</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Adding is like:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">,</span><span class="default">$hist</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hist</span><span class="keyword">[] = </span><span class="default">$line</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">readline_add_history</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
(One may want to just check the last entry being the same.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102100""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#102100" class="date">26-Jan-2011 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note this function is only available when PHP is compiled with libreadline, not if it is compiled with libedit.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'readline_list_history'</span><span class="keyword">)) {<br />
&nbsp; </span><span class="default">$history </span><span class="keyword">= </span><span class="default">readline_list_history</span><span class="keyword">();<br />
&nbsp; </span><span class="comment">// ...<br />
</span><span class="keyword">} else {<br />
&nbsp; echo </span><span class="string">'Not supported by the compiled library.'</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
