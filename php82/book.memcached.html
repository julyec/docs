<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Memcached</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.memcache-debug.html">? memcache_debug</a></li>
      <li style="float: right;"><a href="intro.memcached.html">简介 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="refs.remote.other.html">其它服务</a></li>
    <li>Memcached</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="book.memcached" class="book">
 
 <h1 class="title">Memcached</h1>
 

 

 







 







 







 






 






 






 







<ul class="chunklist chunklist_book"><li><a href="intro.memcached.html">简介</a></li><li><a href="memcached.setup.html">安装/配置</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="memcached.requirements.html">需求</a></li><li><a href="memcached.installation.html">安装</a></li><li><a href="memcached.configuration.html">运行时配置</a></li><li><a href="memcached.resources.html">资源类型</a></li></ul></li><li><a href="memcached.constants.html">预定义常量</a></li><li><a href="memcached.expiration.html">超时时间</a></li><li><a href="memcached.callbacks.html">回调</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="memcached.callbacks.result.html">结果回调</a></li><li><a href="memcached.callbacks.read-through.html">通读缓存回调</a></li></ul></li><li><a href="memcached.sessions.html">Sessions支持</a></li><li><a href="class.memcached.html">Memcached</a> &mdash; Memcached 类<ul class="chunklist chunklist_book chunklist_children"><li><a href="memcached.add.html">Memcached::add</a> &mdash; 向新 key 添加元素</li><li><a href="memcached.addbykey.html">Memcached::addByKey</a> &mdash; 在特定服务器上向新 key 添加元素</li><li><a href="memcached.addserver.html">Memcached::addServer</a> &mdash; 向服务器池增加服务器</li><li><a href="memcached.addservers.html">Memcached::addServers</a> &mdash; 向服务器池中增加多台服务器</li><li><a href="memcached.append.html">Memcached::append</a> &mdash; 向已存在元素追加数据</li><li><a href="memcached.appendbykey.html">Memcached::appendByKey</a> &mdash; 向指定服务器上已存在元素追加数据</li><li><a href="memcached.cas.html">Memcached::cas</a> &mdash; 比较并交换值</li><li><a href="memcached.casbykey.html">Memcached::casByKey</a> &mdash; 在指定服务器上比较并交换值</li><li><a href="memcached.construct.html">Memcached::__construct</a> &mdash; 创建 Memcached 实例</li><li><a href="memcached.decrement.html">Memcached::decrement</a> &mdash; 减小数值元素的值</li><li><a href="memcached.decrementbykey.html">Memcached::decrementByKey</a> &mdash; Decrement numeric item's value, stored on a specific server</li><li><a href="memcached.delete.html">Memcached::delete</a> &mdash; 删除元素</li><li><a href="memcached.deletebykey.html">Memcached::deleteByKey</a> &mdash; 从指定的服务器删除元素</li><li><a href="memcached.deletemulti.html">Memcached::deleteMulti</a> &mdash; Delete multiple items</li><li><a href="memcached.deletemultibykey.html">Memcached::deleteMultiByKey</a> &mdash; Delete multiple items from a specific server</li><li><a href="memcached.fetch.html">Memcached::fetch</a> &mdash; 读取下一个结果</li><li><a href="memcached.fetchall.html">Memcached::fetchAll</a> &mdash; 读取所有剩余结果</li><li><a href="memcached.flush.html">Memcached::flush</a> &mdash; 作废缓存中的所有元素</li><li><a href="memcached.get.html">Memcached::get</a> &mdash; 检索元素</li><li><a href="memcached.getallkeys.html">Memcached::getAllKeys</a> &mdash; Gets the keys stored on all the servers</li><li><a href="memcached.getbykey.html">Memcached::getByKey</a> &mdash; 从特定的服务器检索元素</li><li><a href="memcached.getdelayed.html">Memcached::getDelayed</a> &mdash; 请求多个元素</li><li><a href="memcached.getdelayedbykey.html">Memcached::getDelayedByKey</a> &mdash; 从指定的服务器上请求多个元素</li><li><a href="memcached.getmulti.html">Memcached::getMulti</a> &mdash; 检索多个元素</li><li><a href="memcached.getmultibykey.html">Memcached::getMultiByKey</a> &mdash; 从特定服务器检索多个元素</li><li><a href="memcached.getoption.html">Memcached::getOption</a> &mdash; 获取Memcached的选项值</li><li><a href="memcached.getresultcode.html">Memcached::getResultCode</a> &mdash; 返回最后一次操作的结果代码</li><li><a href="memcached.getresultmessage.html">Memcached::getResultMessage</a> &mdash; 返回最后一次操作的结果描述消息</li><li><a href="memcached.getserverbykey.html">Memcached::getServerByKey</a> &mdash; 获取一个 key 所映射的服务器信息</li><li><a href="memcached.getserverlist.html">Memcached::getServerList</a> &mdash; 获取服务器池中的服务器列表</li><li><a href="memcached.getstats.html">Memcached::getStats</a> &mdash; 获取服务器池的统计信息</li><li><a href="memcached.getversion.html">Memcached::getVersion</a> &mdash; 获取服务器池中所有服务器的版本信息</li><li><a href="memcached.increment.html">Memcached::increment</a> &mdash; 增加数值元素的值</li><li><a href="memcached.incrementbykey.html">Memcached::incrementByKey</a> &mdash; Increment numeric item's value, stored on a specific server</li><li><a href="memcached.ispersistent.html">Memcached::isPersistent</a> &mdash; Check if a persitent connection to memcache is being used</li><li><a href="memcached.ispristine.html">Memcached::isPristine</a> &mdash; Check if the instance was recently created</li><li><a href="memcached.prepend.html">Memcached::prepend</a> &mdash; 向一个已存在的元素前面追加数据</li><li><a href="memcached.prependbykey.html">Memcached::prependByKey</a> &mdash; 在指定服务器上追加数据到已存在的元素</li><li><a href="memcached.quit.html">Memcached::quit</a> &mdash; 关闭所有打开的链接</li><li><a href="memcached.replace.html">Memcached::replace</a> &mdash; 替换已存在 key 下的元素</li><li><a href="memcached.replacebykey.html">Memcached::replaceByKey</a> &mdash; 在指定服务器上，替换已存在 key 下的元素</li><li><a href="memcached.resetserverlist.html">Memcached::resetServerList</a> &mdash; Clears all servers from the server list</li><li><a href="memcached.set.html">Memcached::set</a> &mdash; 存储一个元素</li><li><a href="memcached.setbykey.html">Memcached::setByKey</a> &mdash; 将元素存储到指定的服务器上</li><li><a href="memcached.setmulti.html">Memcached::setMulti</a> &mdash; 存储多个元素</li><li><a href="memcached.setmultibykey.html">Memcached::setMultiByKey</a> &mdash; 在指定服务器存储多个元素</li><li><a href="memcached.setoption.html">Memcached::setOption</a> &mdash; 设置一个 memcached 选项</li><li><a href="memcached.setoptions.html">Memcached::setOptions</a> &mdash; Set Memcached options</li><li><a href="memcached.setsaslauthdata.html">Memcached::setSaslAuthData</a> &mdash; Set the credentials to use for authentication</li><li><a href="memcached.touch.html">Memcached::touch</a> &mdash; Set a new expiration on an item</li><li><a href="memcached.touchbykey.html">Memcached::touchByKey</a> &mdash; Set a new expiration on an item on a specific server</li></ul></li><li><a href="class.memcachedexception.html">MemcachedException</a> &mdash; MemcachedException类</li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125576""></a>
  <div class="note">
   <strong class="user">Moradnejad</strong>
   <a href="#125576" class="date">07-Dec-2020 12:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
## Installing Memcached on Ubuntu<br />
<br />
To install Memcached on Ubuntu, go to terminal and type the following commands ?<br />
<br />
$sudo apt-get update<br />
$sudo apt-get install memcached<br />
<br />
## Confirming Memcached Installation<br />
<br />
To confirm if Memcached is installed or not, you need to run the command given below. This command shows that Memcached is running on the default port 11211.<br />
<br />
$ps aux | grep memcached<br />
<br />
To run Memcached server on a different port, execute the command given below. This command starts the server on the TCP port 11111 and listens on the UDP port 11111 as a daemon process.<br />
<br />
$memcached -p 11111 -U 11111 -u user -d<br />
<br />
You can run multiple instances of Memcached server through a single installation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115667""></a>
  <div class="note">
   <strong class="user">gabriel dot maybrun at demandmedia dot com</strong>
   <a href="#115667" class="date">04-Sep-2014 11:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
GOTCHA: Recently I was tasked with moving from PECL memcache to PECL memcached and ran into a major problem -- memcache and memcached serialize data differently, meaning that data written with one library can't necessarily be read with the other library.<br />
<br />
For example, If you write an object or an array with memcache, it's interpreted as an integer by memcached.&nbsp; If you write it with memcached, it's interpreted as a string by memcache.<br />
<br />
tl;dr - You can't safely switch between memcache and memcached without a either a cache flush or isolated cache environments.<br />
<br />
<span class="default">&lt;?php<br />
$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">;<br />
</span><span class="default">$memcacheD </span><span class="keyword">= new </span><span class="default">Memcached</span><span class="keyword">;<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">);<br />
</span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">addServers</span><span class="keyword">(</span><span class="default">$servers</span><span class="keyword">);<br />
<br />
</span><span class="default">$checks </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">123</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">4542.32</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'a string'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">true</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; array(</span><span class="default">123</span><span class="keyword">, </span><span class="string">'string'</span><span class="keyword">),<br />
&nbsp;&nbsp;&nbsp; (object)array(</span><span class="string">'key1' </span><span class="keyword">=&gt; </span><span class="string">'value1'</span><span class="keyword">),<br />
);<br />
foreach (</span><span class="default">$checks </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Checking WRITE with Memcache\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">'cachetest' </span><span class="keyword">. </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$valD </span><span class="keyword">= </span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$val </span><span class="keyword">!== </span><span class="default">$valD</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Not compatible!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">compact</span><span class="keyword">(</span><span class="string">'val'</span><span class="keyword">, </span><span class="string">'valD'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"Checking WRITE with MemcacheD\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">'cachetest' </span><span class="keyword">. </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$valD </span><span class="keyword">= </span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$val </span><span class="keyword">!== </span><span class="default">$valD</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Not compatible!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">compact</span><span class="keyword">(</span><span class="string">'val'</span><span class="keyword">, </span><span class="string">'valD'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110988""></a>
  <div class="note">
   <strong class="user">davidt</strong>
   <a href="#110988" class="date">03-Jan-2013 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The module also supports SASL authentication, it just isn't documented sadly. You'll need to run the following code:<br />
<br />
<span class="default">&lt;?php<br />
$m </span><span class="keyword">= new </span><span class="default">Memcached</span><span class="keyword">();<br />
</span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">setOption</span><span class="keyword">(</span><span class="default">Memcached</span><span class="keyword">::</span><span class="default">OPT_BINARY_PROTOCOL</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">setSaslAuthData</span><span class="keyword">(</span><span class="string">"user-1"</span><span class="keyword">, </span><span class="string">"pass"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You need to enable the "memcached.use_sasl = 1" ini option for memcached in the php.ini file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104099""></a>
  <div class="note">
   <strong class="user">joelhy</strong>
   <a href="#104099" class="date">22-May-2011 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those confuse about the memcached extension and the memcache extension, the short story is that both of them are clients of memcached server, and the memcached extension offer more features than the memcache extension.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
