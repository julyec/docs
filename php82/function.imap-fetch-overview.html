<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>Read an overview of the information in the headers of the given message</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imap-expunge.html">? imap_expunge</a></li>
      <li style="float: right;"><a href="function.imap-fetchbody.html">imap_fetchbody ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.imap.html">IMAP 函数</a></li>
    <li>Read an overview of the information in the headers of the given message</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imap-fetch-overview" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imap_fetch_overview</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imap_fetch_overview</span> &mdash; <span class="dc-title">Read an overview of the information in the headers of the given message</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imap-fetch-overview-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imap_fetch_overview</strong></span>(<span class="methodparam"><span class="type"><a href="class.imap-connection.html" class="type IMAP\Connection">IMAP\Connection</a></span> <code class="parameter">$imap</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$sequence</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = 0</span></span>): <span class="type"><span class="type">array</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   This function fetches mail headers for the given
   <code class="parameter">sequence</code> and returns an overview of their
   contents.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imap-fetch-overview-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    <dt>

<code class="parameter">imap</code></dt>
<dd>
<p class="para"><span class="classname"><a href="class.imap-connection.html" class="classname">IMAP\Connection</a></span> 实例。</p></dd>

    
     <dt>
<code class="parameter">sequence</code></dt>

     <dd>

      <p class="para">
       A message sequence description. You can enumerate desired messages
       with the <code class="literal">X,Y</code> syntax, or retrieve all messages 
       within an interval with the <code class="literal">X:Y</code> syntax
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">sequence</code> will contain a sequence of message
       indices or UIDs, if this parameter is set to 
       <strong><code>FT_UID</code></strong>. 
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imap-fetch-overview-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an array of objects describing one message header each.
   The object will only define a property if it exists. The possible
   properties are:
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <code class="literal">subject</code> - the messages subject
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">from</code> - who sent it
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">to</code> - recipient
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">date</code> - when was it sent
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">message_id</code> - Message-ID
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">references</code> - is a reference to this message id
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">in_reply_to</code> - is a reply to this message id
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">size</code> - size in bytes
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">uid</code> - UID the message has in the mailbox
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">msgno</code> - message sequence number in the mailbox
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">recent</code> - this message is flagged as recent
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">flagged</code> -  this message is flagged
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">answered</code> -  this message is flagged as answered
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">deleted</code> -  this message is flagged for deletion
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">seen</code> -  this message is flagged as already read
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">draft</code> -  this message is flagged as being a draft
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="literal">udate</code> -  the UNIX timestamp of the arrival date
     </span>
    </li>
   </ul>
   The function returns <strong><code>false</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.imap-fetch-overview-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
 <td>8.1.0</td>
 <td>
  现在 <code class="parameter">imap</code> 参数接受 <span class="classname"><a href="class.imap-connection.html" class="classname">IMAP\Connection</a></span>
  实例，之前接受有效的 <code class="literal">imap</code> <a href="language.types.resource.html" class="link">资源(resource)</a>。
 </td>
</tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.imap-fetch-overview-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Example #1 <span class="function"><strong>imap_fetch_overview()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mbox </span><span style="color: #007700">= </span><span style="color: #0000BB">imap_open</span><span style="color: #007700">(</span><span style="color: #DD0000">"{imap.example.org:143}INBOX"</span><span style="color: #007700">, </span><span style="color: #DD0000">"username"</span><span style="color: #007700">, </span><span style="color: #DD0000">"password"</span><span style="color: #007700">)<br />     or die(</span><span style="color: #DD0000">"can't connect: " </span><span style="color: #007700">. </span><span style="color: #0000BB">imap_last_error</span><span style="color: #007700">());<br /><br /></span><span style="color: #0000BB">$MC </span><span style="color: #007700">= </span><span style="color: #0000BB">imap_check</span><span style="color: #007700">(</span><span style="color: #0000BB">$mbox</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Fetch an overview for all messages in INBOX<br /></span><span style="color: #0000BB">$result </span><span style="color: #007700">= </span><span style="color: #0000BB">imap_fetch_overview</span><span style="color: #007700">(</span><span style="color: #0000BB">$mbox</span><span style="color: #007700">,</span><span style="color: #DD0000">"1:</span><span style="color: #007700">{</span><span style="color: #0000BB">$MC</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Nmsgs</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br />foreach (</span><span style="color: #0000BB">$result </span><span style="color: #007700">as </span><span style="color: #0000BB">$overview</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">"#</span><span style="color: #007700">{</span><span style="color: #0000BB">$overview</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">msgno</span><span style="color: #007700">}</span><span style="color: #DD0000"> (</span><span style="color: #007700">{</span><span style="color: #0000BB">$overview</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">date</span><span style="color: #007700">}</span><span style="color: #DD0000">) - From: </span><span style="color: #007700">{</span><span style="color: #0000BB">$overview</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">from</span><span style="color: #007700">}</span><span style="color: #DD0000"><br />    </span><span style="color: #007700">{</span><span style="color: #0000BB">$overview</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">subject</span><span style="color: #007700">}</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">imap_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$mbox</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imap-fetch-overview-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imap-fetchheader.html" class="function" rel="rdfs-seeAlso">imap_fetchheader()</a> - Returns header for a message</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125687""></a>
  <div class="note">
   <strong class="user">damien at dipisoft dot com</strong>
   <a href="#125687" class="date">17-Jan-2021 12:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is not documented but I just found out that with the FT_UID flag you can use "-1" in sequence as the last identifier. Example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">[...]<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">, </span><span class="string">"</span><span class="default">$first_uid</span><span class="string">:-1"</span><span class="keyword">, </span><span class="default">FT_UID</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; [...]<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120646""></a>
  <div class="note">
   <strong class="user">vijayakumard01 at gmail dot com</strong>
   <a href="#120646" class="date">15-Feb-2017 12:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While using fetch overview it displays only single mail. i need to display mail with replied and forward and all. how its possible?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120521""></a>
  <div class="note">
   <strong class="user">undernetangel at gmail dot com</strong>
   <a href="#120521" class="date">25-Jan-2017 10:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a typo in the manual. The correct return value for arrival time is:&nbsp; udate not update.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118113""></a>
  <div class="note">
   <strong class="user">Ap.Muthu</strong>
   <a href="#118113" class="date">06-Oct-2015 11:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The use of the $range parameter is explained in the example at: <a href="http://www.phpdig.net/ref/rn31re596.html" rel="nofollow" target="_blank">http://www.phpdig.net/ref/rn31re596.html</a><br />
<br />
<span class="default">&lt;?php<br />
$imap </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{localhost}INBOX"</span><span class="keyword">,</span><span class="string">"graeme"</span><span class="keyword">,</span><span class="string">"inferno"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// fetch message information for message 2<br />
// and messages 4 to 6<br />
</span><span class="default">$info </span><span class="keyword">= </span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">, </span><span class="string">"2,4:6"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;table border=1&gt;<br />
&lt;tr&gt;&lt;th&gt;Read&lt;/th&gt;&lt;th&gt;From&lt;/th&gt;&lt;th&gt;Date&lt;/th&gt;&lt;th&gt;Subject&lt;/th&gt;&lt;/tr&gt;<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// loop through the array<br />
</span><span class="keyword">foreach (</span><span class="default">$info </span><span class="keyword">as </span><span class="default">$msg</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// display the seen property nicely<br />
&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">seen </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$read </span><span class="keyword">= </span><span class="string">"Yes"</span><span class="keyword">;<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$read </span><span class="keyword">= </span><span class="string">"No"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// print other message information<br />
&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;td&gt;%s&lt;/td&gt;"</span><span class="keyword">, </span><span class="default">$read</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;td&gt;%s&lt;/td&gt;"</span><span class="keyword">, </span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">from</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;td&gt;%s&lt;/td&gt;"</span><span class="keyword">, </span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;td&gt;%s&lt;/td&gt;"</span><span class="keyword">, </span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">subject</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116727""></a>
  <div class="note">
   <strong class="user">Nitrogen</strong>
   <a href="#116727" class="date">20-Feb-2015 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Judging from the comments here, it appears like people are forgetting the basics to already-available PHP sorting functions. Use usort(); and the tiniest custom function ever to compare them all.<br />
<br />
Change the arguments to imap_fetch_overview to your own, obviously.<br />
<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$imap_stream</span><span class="keyword">, </span><span class="string">'1:10'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="default">usort</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, function(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) {<br />
&nbsp; return(</span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">udate</span><span class="keyword">-</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">udate</span><span class="keyword">);<br />
});<br />
</span><span class="default">?&gt;<br />
</span><br />
This usort function will look at each overview and order them in the exact latest to oldest message order as determined by the "udate" value for each message. This works. I'm using it. They're sorted in the exact order they appear in my actual inbox. Why obfuscate it any more?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114119""></a>
  <div class="note">
   <strong class="user">jeff at newscloud dot com</strong>
   <a href="#114119" class="date">13-Jan-2014 03:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The Remote class here (https://github.com/newscloud/mail_filter/blob/master/app/protected/models/Remote.php) has a lot of examples of processing mailbox folders with imap-fetch-overview:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;open($account_id,$this-&gt;path_inbox);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $recent_messages = @imap_search($this-&gt;stream, 'SINCE "'.date("j F Y",$tstamp).'"',SE_UID); // 30 November 2013<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ($recent_messages===false) continue; // to do - continue into next account<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $result = imap_fetch_overview($this-&gt;stream, implode(',',array_slice($recent_messages,0,$message_limit)),FT_UID);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; foreach ($result as $item) {&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg = $this-&gt;parseHeader($item);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113937""></a>
  <div class="note">
   <strong class="user">rueda dot raul at gmail dot com</strong>
   <a href="#113937" class="date">18-Dec-2013 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
English:<br />
I've found that for some messages, this function and also function imap_headerinfo(), can't decode the message_id information and returns an ID like "&lt;xxxxxxxxx@unknownmsgid&gt;" <br />
<br />
In these cases, I use the following to get the correct messageid:<br />
<br />
$header=imap_rfc822_parse_headers(imap_fetchheader($mbox,$msgno))<br />
<br />
Spanish:<br />
Con algunos mensajes, esta funcion, al igual que la funcion imap_headerinfo(), no pueden decodificar correctamente la información del ID de mensaje y devuelven un ID como este "&lt;xxxxxxxxx@unknownmsgid&gt;" <br />
<br />
En esos casos, uso lo siguiente para obtener el ID de mensaje correcto:<br />
<br />
$header=imap_rfc822_parse_headers(imap_fetchheader($mbox,$msgno))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110444""></a>
  <div class="note">
   <strong class="user">info at djdb dot be</strong>
   <a href="#110444" class="date">23-Oct-2012 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you lost a mail use this
<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">READallUnreadmail</span><span class="keyword">(){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$headers </span><span class="keyword">= </span><span class="default">imap_check</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">msgbox</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastnr </span><span class="keyword">= </span><span class="default">$headers</span><span class="keyword">-&gt;</span><span class="default">Nmsgs</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$mails</span><span class="keyword">=</span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">msgbox</span><span class="keyword">,</span><span class="string">"1:"</span><span class="keyword">.</span><span class="default">$lastnr</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$mails</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (++</span><span class="default">$key</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">&amp;&amp;</span><span class="default">$header</span><span class="keyword">= </span><span class="default">imap_header</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">msgbox</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">Unseen</span><span class="keyword">==</span><span class="string">'U'</span><span class="keyword">||</span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">Recent</span><span class="keyword">==</span><span class="string">'R'</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br&gt;"</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">msgno</span><span class="keyword">.</span><span class="string">" - "</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">.</span><span class="string">" - "</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">subject</span><span class="keyword">.</span><span class="string">"\n&lt;br&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"IREAD"</span><span class="keyword">.</span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">Msgno</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//$this-&gt;getattachmentof($header-&gt;Msgno);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103316""></a>
  <div class="note">
   <strong class="user">thinice at gmail dot com</strong>
   <a href="#103316" class="date">06-Apr-2011 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hopefully someone will find this a jumpstarter for a sortable, paginated list:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">public function </span><span class="default">listMessages</span><span class="keyword">(</span><span class="default">$nStart</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$nCnt</span><span class="keyword">=</span><span class="default">10</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">loaded</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">NULL</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if ((</span><span class="default">$nStart</span><span class="keyword">+</span><span class="default">$nCnt</span><span class="keyword">) &gt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getNum</span><span class="keyword">()) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nCnt </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getNum</span><span class="keyword">()-</span><span class="default">$nStart</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aMsgs </span><span class="keyword">= </span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rCon</span><span class="keyword">, (</span><span class="default">$nStart</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">).</span><span class="string">':'</span><span class="keyword">.(</span><span class="default">$nStart</span><span class="keyword">+</span><span class="default">$nCnt</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aRet </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$aMsgs</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$aMsgs </span><span class="keyword">as </span><span class="default">$msg</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aRet</span><span class="keyword">[</span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">udate</span><span class="keyword">] = </span><span class="default">$msg</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">krsort</span><span class="keyword">(</span><span class="default">$aRet</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$aRet</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91636""></a>
  <div class="note">
   <strong class="user">will</strong>
   <a href="#91636" class="date">20-Jun-2009 09:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This seems to retrieve incomplete values for headers, instead of getting the entire value, it gets the first. for example, this is a valid To: header
<br />

<br />
To: foo1@example.com,foo2@example.com
<br />
&nbsp;&nbsp; &nbsp; foo3@example.com
<br />

<br />
but imap_fetch_overview will only return:
<br />
foo1@example.com</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88235""></a>
  <div class="note">
   <strong class="user">dognose</strong>
   <a href="#88235" class="date">16-Jan-2009 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
That's right: <br />
<br />
calling imap_fetch_overview() once is faster, than calling it<br />
in a loop.<br />
<br />
But if you want to get a "day sorted" list, you need to call it in a loop, cause if you enter a "string" of UIDs, they are always sorted by UID, not by the order you entered it.<br />
<br />
Heres a little example how to get a date-sorted list:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*Sort all msgs by Arrival Date. Newest = 0, oldest = Array Count*/<br />
/*returns an array, containing the UIDs of messages*/<br />
</span><span class="default">$SortedArray </span><span class="keyword">= </span><span class="default">imap_sort</span><span class="keyword">(</span><span class="default">$Handle</span><span class="keyword">,</span><span class="default">SORTARRIVAL</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">SE_UID</span><span class="keyword">);<br />
<br />
For (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$Start</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt; </span><span class="default">$Start </span><span class="keyword">+ </span><span class="default">$Limit</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">/*Read UID from Sorted Array*/<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$UID </span><span class="keyword">= </span><span class="default">$SortedArray</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">/*Get Detailed MSG Infos*/<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Overview </span><span class="keyword">= </span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$Handle</span><span class="keyword">, </span><span class="default">$UID</span><span class="keyword">, </span><span class="default">FT_UID</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; [...]<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74002""></a>
  <div class="note">
   <strong class="user">xhack at web dot de</strong>
   <a href="#74002" class="date">20-Mar-2007 07:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you want a sortet list of mails, but you get always the same order? your c-client seems to cause this. i realized this with linux libc6-2.3.6 and php-5.2.0<br />
<br />
try this little code:<br />
<br />
# here you try to sort by your criteria<br />
$sort=@imap_sort($mbox,SORTDATE,1,SE_UID); <br />
&nbsp; <br />
# here the order of the messages to fetch should be recognised, but it isn't<br />
<br />
$tmp=@imap_fetch_overview($mbox,implode(',',$sort),FT_UID);<br />
# so try to work around simply:<br />
for($i=0;$i&lt;count($tmp);$i++)<br />
{ $liste[$i]=$tmp[array_search($tmp[$i]-&gt;uid,$sort)]; }<br />
<br />
so now you can use the sort by date, address, and so on.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73891""></a>
  <div class="note">
   <strong class="user">raja at aonic dot net</strong>
   <a href="#73891" class="date">14-Mar-2007 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function to get messages from IMAP and sort them for pagination.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Return array of IMAP messages for pagination<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp;&nbsp; int&nbsp; &nbsp;&nbsp; $page&nbsp; &nbsp; &nbsp;&nbsp; page number to get<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp;&nbsp; int&nbsp; &nbsp;&nbsp; $per_page&nbsp;&nbsp; number of results per page<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp;&nbsp; array&nbsp;&nbsp; $sort&nbsp; &nbsp; &nbsp;&nbsp; array('subject', 'asc') etc<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @return&nbsp; mixed&nbsp;&nbsp; array containing imap_fetch_overview, pages, and total rows if successful, false if an error occurred<br />
&nbsp;&nbsp; &nbsp; * @author&nbsp; Raja K<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">listMessages</span><span class="keyword">(</span><span class="default">$page </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">, </span><span class="default">$per_page </span><span class="keyword">= </span><span class="default">25</span><span class="keyword">, </span><span class="default">$sort </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$limit </span><span class="keyword">= (</span><span class="default">$per_page </span><span class="keyword">* </span><span class="default">$page</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$start </span><span class="keyword">= (</span><span class="default">$limit </span><span class="keyword">- </span><span class="default">$per_page</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$start </span><span class="keyword">= (</span><span class="default">$start </span><span class="keyword">&lt; </span><span class="default">1</span><span class="keyword">) ? </span><span class="default">1 </span><span class="keyword">: </span><span class="default">$start</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$limit </span><span class="keyword">= ((</span><span class="default">$limit </span><span class="keyword">- </span><span class="default">$start</span><span class="keyword">) != (</span><span class="default">$per_page</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)) ? (</span><span class="default">$start </span><span class="keyword">+ (</span><span class="default">$per_page</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)) : </span><span class="default">$limit</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">imap_check</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_imap_stream</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$limit </span><span class="keyword">= (</span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">Nmsgs </span><span class="keyword">&lt; </span><span class="default">$limit</span><span class="keyword">) ? </span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">Nmsgs </span><span class="keyword">: </span><span class="default">$limit</span><span class="keyword">;<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">true </span><span class="keyword">=== </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$sort</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sorting </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'direction' </span><span class="keyword">=&gt; array(&nbsp;&nbsp; </span><span class="string">'asc' </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'desc' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">),<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'by'&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; array(&nbsp;&nbsp; </span><span class="string">'date' </span><span class="keyword">=&gt; </span><span class="default">SORTDATE</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'arrival' </span><span class="keyword">=&gt; </span><span class="default">SORTARRIVAL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'from' </span><span class="keyword">=&gt; </span><span class="default">SORTFROM</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'subject' </span><span class="keyword">=&gt; </span><span class="default">SORTSUBJECT</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'size' </span><span class="keyword">=&gt; </span><span class="default">SORTSIZE</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$by </span><span class="keyword">= (</span><span class="default">true </span><span class="keyword">=== </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$by </span><span class="keyword">= </span><span class="default">$sorting</span><span class="keyword">[</span><span class="string">'by'</span><span class="keyword">][</span><span class="default">$sort</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]])) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ? </span><span class="default">$by <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">: </span><span class="default">$sorting</span><span class="keyword">[</span><span class="string">'by'</span><span class="keyword">][</span><span class="string">'date'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$direction </span><span class="keyword">= (</span><span class="default">true </span><span class="keyword">=== </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$direction </span><span class="keyword">= </span><span class="default">$sorting</span><span class="keyword">[</span><span class="string">'direction'</span><span class="keyword">][</span><span class="default">$sort</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]])) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ? </span><span class="default">$direction <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">: </span><span class="default">$sorting</span><span class="keyword">[</span><span class="string">'direction'</span><span class="keyword">][</span><span class="string">'desc'</span><span class="keyword">];<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sorted </span><span class="keyword">= </span><span class="default">imap_sort</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_imap_stream</span><span class="keyword">, </span><span class="default">$by</span><span class="keyword">, </span><span class="default">$direction</span><span class="keyword">);<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msgs </span><span class="keyword">= </span><span class="default">array_chunk</span><span class="keyword">(</span><span class="default">$sorted</span><span class="keyword">, </span><span class="default">$per_page</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msgs </span><span class="keyword">= </span><span class="default">$msgs</span><span class="keyword">[</span><span class="default">$page</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msgs </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">, </span><span class="default">$limit</span><span class="keyword">); </span><span class="comment">//just to keep it consistent<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_imap_stream</span><span class="keyword">, </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$msgs</span><span class="keyword">, </span><span class="string">','</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">false </span><span class="keyword">=== </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//sorting!<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">true </span><span class="keyword">=== </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$sorted</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp_result </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$r</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp_result</span><span class="keyword">[</span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">msgno</span><span class="keyword">] = </span><span class="default">$r</span><span class="keyword">;<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$msgs </span><span class="keyword">as </span><span class="default">$msgno</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">$tmp_result</span><span class="keyword">[</span><span class="default">$msgno</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= array(</span><span class="string">'res' </span><span class="keyword">=&gt; </span><span class="default">$result</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'start' </span><span class="keyword">=&gt; </span><span class="default">$start</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'limit' </span><span class="keyword">=&gt; </span><span class="default">$limit</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'sorting' </span><span class="keyword">=&gt; array(</span><span class="string">'by' </span><span class="keyword">=&gt; </span><span class="default">$sort</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="string">'direction' </span><span class="keyword">=&gt; </span><span class="default">$sort</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'total' </span><span class="keyword">=&gt; </span><span class="default">imap_num_msg</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_imap_stream</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'pages'</span><span class="keyword">] = </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$return</span><span class="keyword">[</span><span class="string">'total'</span><span class="keyword">] / </span><span class="default">$per_page</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41435""></a>
  <div class="note">
   <strong class="user">Group-Office Developer</strong>
   <a href="#41435" class="date">09-Apr-2004 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About the sequence sorting again.<br />
I've found that there's a significant speed improvement by preparing the sequence and then fetch them at once with large mailboxes. On small mailboxes wyou will not notice a speed difference.<br />
<br />
But then there's the sorting problem. I've spent all night fiuring out how to do this myself. I found the solution!<br />
<br />
Prepare an array of messages with imap_sort. Create a second array that maps the message numbers to the actuall place in the fetched array.<br />
You know it will be in numeric order so you can make an array map with the sort() function sorting it from high to low.<br />
Then you can proces the array fetched with imap_fetch_overview with the array_map and you will have them sorted. If you need an example look in the Group-Office code classes/imap.class.inc in a version later then 2.04.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38268""></a>
  <div class="note">
   <strong class="user">mails at slueoend dot ch</strong>
   <a href="#38268" class="date">14-Dec-2003 04:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Not that this function and all other imap_fetch*-functions will download the whole message and not just the header information.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33631""></a>
  <div class="note">
   <strong class="user">se at designlinks dot net</strong>
   <a href="#33631" class="date">02-Jul-2003 06:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To further explain 'warrenfalk's comment, the following sequences are exactly the same, and always returns messages with lowest UID to highest UID:<br />
<br />
1:5<br />
5:1<br />
1,2,3,4,5<br />
5,4,3,2,1<br />
3,2,5,1,4<br />
<br />
(always returned as 1,2,3,4,5)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25978""></a>
  <div class="note">
   <strong class="user">suurenbroekNoSpam at ov35 dot NoSpam dot nl</strong>
   <a href="#25978" class="date">14-Oct-2002 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that these object-variables only exist when they are actually in the mail.<br />
<br />
This means that if a mail has no subject, the property $val-&gt;subject will not exist.<br />
<br />
Calling $val-&gt;subject will generate an notice:<br />
Notice: Undefined property: subject in /home/html/inc/Mbox.php on line xxx<br />
<br />
Use this to check it:<br />
if (array_key_exists( "subject", get_object_vars($val)))<br />
&nbsp;&nbsp; $subj=$val-&gt;subject; <br />
else<br />
&nbsp;&nbsp; $subj="";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19358""></a>
  <div class="note">
   <strong class="user">trionon at mail dot ru</strong>
   <a href="#19358" class="date">25-Feb-2002 10:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This performance hint is useful if you need to print the result of imap_sort():<br />
<br />
It's faster to prepare large string with UIDs and then to call imap_fetchoverview once than calling imap_fetchoverview in a loop.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="16721""></a>
  <div class="note">
   <strong class="user">steve at stevenchalker dot net</strong>
   <a href="#16721" class="date">09-Nov-2001 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think if you go like a list, you can list your "hotmail" messages.
<br />
<span class="default">&lt;?php
<br />
$mbox</span><span class="keyword">=</span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{imap.server.com}"</span><span class="keyword">,</span><span class="string">"user"</span><span class="keyword">,</span><span class="string">"pass"</span><span class="keyword">);
<br />
</span><span class="default">$MC</span><span class="keyword">=</span><span class="default">imap_check</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">);
<br />
</span><span class="default">$MN</span><span class="keyword">=</span><span class="default">$MC</span><span class="keyword">-&gt;</span><span class="default">Nmsgs</span><span class="keyword">;
<br />
</span><span class="default">$overview</span><span class="keyword">=</span><span class="default">imap_fetch_overview</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">,</span><span class="string">"1:</span><span class="default">$MN</span><span class="string">"</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);
<br />
</span><span class="default">$size</span><span class="keyword">=</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$overview</span><span class="keyword">);
<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$size</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">--){
<br />
</span><span class="default">$val</span><span class="keyword">=</span><span class="default">$overview</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];
<br />
</span><span class="default">$msg</span><span class="keyword">=</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">msgno</span><span class="keyword">;
<br />
</span><span class="default">$from</span><span class="keyword">=</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">from</span><span class="keyword">;
<br />
</span><span class="default">$date</span><span class="keyword">=</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">;
<br />
</span><span class="default">$subj</span><span class="keyword">=</span><span class="default">$val</span><span class="keyword">-&gt;</span><span class="default">subject</span><span class="keyword">;
<br />
echo </span><span class="string">"#</span><span class="default">$msg</span><span class="string">: From:'</span><span class="default">$from</span><span class="string">' Date:'</span><span class="default">$date</span><span class="string">' Subject:'</span><span class="default">$subj</span><span class="string">'&lt;BR&gt;"</span><span class="keyword">;
<br />
</span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
