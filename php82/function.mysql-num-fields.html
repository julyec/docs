<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=UTF-8">
  <title>取得结果中字段的数量</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mysql-list-tables.html">? mysql_list_tables</a></li>
      <li style="float: right;"><a href="function.mysql-num-rows.html">mysql_num_rows ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mysql.html">MySQL 函数</a></li>
    <li>取得结果中字段的数量</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mysql-num-fields" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_num_fields</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_num_fields</span> &mdash; <span class="dc-title">取得结果中字段的数量</span></p>

 </div>

 <div id="function.mysql-num-fields-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">本扩展自 PHP 5.5.0
起已废弃，并在自 PHP 7.0.0 开始被移除。应使用 <a href="book.mysqli.html" class="link">MySQLi</a>
或 <a href="ref.pdo-mysql.html" class="link">PDO_MySQL</a> 扩展来替换之。参见 <a href="mysqlinfo.api.choosing.html" class="link">MySQL：选择 API</a> 
指南来获取更多信息。用以替代本函数的有：</p>
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli-result.field-count.html" class="function">mysqli_num_fields()</a></span></li>
    <li class="member"><span class="methodname"><a href="pdostatement.columncount.html" class="methodname">PDOStatement::columnCount()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-num-fields-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mysql_num_fields</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>): <span class="type"><span class="type">int</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   从查询中检索字段的数量。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-num-fields-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    <dt>

<code class="parameter">result</code></dt>
<dd>
<p class="para"><span class="type">resource</span>
型的结果集。此结果集来自对 <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>
的调用。</p></dd>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-num-fields-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns the number of fields in the result set <span class="type">resource</span> on
   success 或者在失败时返回 <strong><code>false</code></strong>.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.mysql-num-fields-examples">
  <h3 class="title">示例</h3>
  <p class="para">
   <div class="example" id="example-3576">
    <p><strong>Example #1 <span class="function"><strong>mysql_num_fields()</strong></span> 示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$result </span><span style="color: #007700">= </span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT id,email FROM people WHERE id = '42'"</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$result</span><span style="color: #007700">) {<br />    echo </span><span style="color: #DD0000">'Could not run query: ' </span><span style="color: #007700">. </span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />    exit;<br />}<br /><br /></span><span style="color: #FF8000">/* returns 2 because id,email === two fields */<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">mysql_num_fields</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-num-fields-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    为了向下兼容，可以使用下列已废弃的别名：
    <span class="function"><strong>mysql_numfields()</strong></span>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-num-fields-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-select-db.html" class="function" rel="rdfs-seeAlso">mysql_select_db()</a> - 选择 MySQL 数据库</span></li>
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - 发送一条 MySQL 查询</span></li>
    <li class="member"><span class="function"><a href="function.mysql-fetch-field.html" class="function" rel="rdfs-seeAlso">mysql_fetch_field()</a> - 从结果集中取得列信息并作为对象返回</span></li>
    <li class="member"><span class="function"><a href="function.mysql-num-rows.html" class="function" rel="rdfs-seeAlso">mysql_num_rows()</a> - 获取结果中行数</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="74216""></a>
  <div class="note">
   <strong class="user">php at jezusisheer dot nl</strong>
   <a href="#74216" class="date">29-Mar-2007 11:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that, if you want to get the amount of columns of a table and you're using the "SHOW COLUMNS FROM $table" query, you will have to use mysql_num_rows() instead of mysql_num_fields() on the result. This becomes logical when thinking about it, because the SHOW COLUMNS query returns a result with six columns (Field, Type, Null, Key, Default and Extra) and with a single row for every column found. If you'd count the number of fields, you'd always get 6. If you count the number of rows, you'll get the amount of columns found.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33224""></a>
  <div class="note">
   <strong class="user">tharkey at tharkey dot net</strong>
   <a href="#33224" class="date">19-Jun-2003 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use it without a requete, just to list the fields :<br />
<br />
$liste_champs = mysql_list_fields ( $Base, $Table, $connexion);<br />
<br />
for ($i=0; $i &lt; mysql_num_fields ($l_champs); $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo ( mysql_field_name ($l_champs, $i) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo (' / ');<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25664""></a>
  <div class="note">
   <strong class="user">apass AT passmoore DOT com</strong>
   <a href="#25664" class="date">01-Oct-2002 03:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Adding to the last comment: you can dynamically loop through any number of&nbsp; columns AND rows like so-<br />
<br />
$query="your SQL";<br />
$result=mysql_query($query) or die("Query ($query) sucks!");<br />
$fields=mysql_num_fields($result);<br />
<br />
echo "&lt;table&gt;\n&lt;tr&gt;";<br />
for ($i=0; $i &lt; mysql_num_fields($result); $i++) //Table Header<br />
{ print "&lt;th&gt;".mysql_field_name($result, $i)."&lt;/th&gt;"; }<br />
echo "&lt;/tr&gt;\n";<br />
while ($row = mysql_fetch_row($result)) { //Table body<br />
echo "&lt;tr&gt;";<br />
&nbsp;&nbsp;&nbsp; for ($f=0; $f &lt; $fields; $f++) {<br />
&nbsp;&nbsp;&nbsp; echo "&lt;td&gt;$row[$f]&lt;/td&gt;"; }<br />
echo "&lt;/tr&gt;\n";}<br />
echo "&lt;/table&gt;&lt;p&gt;";<br />
<br />
This has been tested.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15620""></a>
  <div class="note">
   <strong class="user">matt at iwdt dot net</strong>
   <a href="#15620" class="date">23-Sep-2001 06:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
here's one way to print out a row of &lt;th&gt; tags from a table
<br />
NOTE: i didn't test this
<br />

<br />
$result = mysql_query("select * from table");
<br />

<br />
for ($i = 0; $i &lt; mysql_num_fields($result); $i++) {
<br />
&nbsp;&nbsp;&nbsp; print "&lt;th&gt;".mysql_field_name($result, $i)."&lt;/th&gt;\n";
<br />
}
<br />

<br />
post a comment if there's an error</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="10283""></a>
  <div class="note">
   <strong class="user">bwark at stanford dot edu</strong>
   <a href="#10283" class="date">24-Dec-2000 02:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you just want the number of fields in a table, you can do something like this:
<br />

<br />
<span class="default">&lt;?php
<br />
$db_id </span><span class="keyword">= </span><span class="default">mysql_connet</span><span class="keyword">();
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"DESCRIBE [tableName], </span><span class="default">$db_id</span><span class="string">);
<br />

<br />
</span><span class="default">$numFields</span><span class="string"> = mysql_num_rows(</span><span class="default">$result</span><span class="string">);
<br />
?&gt;
<br />

<br />
Because "</span><span class="default">DESCRIBE</span><span class="string">" returns one row for each field in the table (at least in MySQL), this will work.</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
