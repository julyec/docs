import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as i,c,b as n,d as t,w as e,e as s,a as l}from"./app-5f6cf456.js";const u={},r=n("h1",{id:"testing",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#testing","aria-hidden":"true"},"#"),s(" Testing")],-1),d={class:"table-of-contents"},k=l(`<p>The Excel facade can be used to swap the importer to a fake.</p><h2 id="testing-imports" tabindex="-1"><a class="header-anchor" href="#testing-imports" aria-hidden="true">#</a> Testing imports</h2><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token doc-comment comment">/**
* <span class="token keyword">@test</span>
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">user_can_import_users</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">fake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">actingAs</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">givenUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/import/xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertImported</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;diskName&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertImported</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;diskName&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">UsersImport</span> <span class="token variable">$import</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// When passing the callback as 2nd param, the disk will be the default disk.</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertImported</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">UsersImport</span> <span class="token variable">$import</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="testing-queuing-imports" tabindex="-1"><a class="header-anchor" href="#testing-queuing-imports" aria-hidden="true">#</a> Testing queuing imports</h2><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token doc-comment comment">/**
* <span class="token keyword">@test</span>
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">user_can_queue_the_users_import</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">fake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">actingAs</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">givenUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/queue/xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertQueued</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;diskName&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertQueued</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;diskName&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">UsersImport</span> <span class="token variable">$import</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// When passing the callback as 2nd param, the disk will be the default disk.</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertQueued</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token class-name type-declaration">UsersImport</span> <span class="token variable">$import</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="testing-imports-with-dynamic-file-name-path" tabindex="-1"><a class="header-anchor" href="#testing-imports-with-dynamic-file-name-path" aria-hidden="true">#</a> Testing imports with dynamic file name/path</h2><p>If you have dynamic naming for files or paths, you can use a regular expression to represent those while testing:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token doc-comment comment">/**
* <span class="token keyword">@test</span>
*/</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">user_can_import_users</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">fake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">actingAs</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">givenUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/users/import/xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Tells the mock to use regular expressions</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">matchByRegex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// For a given dynamic named file &#39;dynamic_1234_filename.xlsx&#39;</span>
    <span class="token class-name static-context">Excel</span><span class="token operator">::</span><span class="token function">assertImported</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/\\w{7}_\\d{4}\\_\\w{8}\\.xlsx/&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;diskName&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Please note that your expression must match only one file/path. If more than one match is found, the test will fail.</p>`,9);function m(v,g){const a=o("router-link");return i(),c("div",null,[r,n("nav",d,[n("ul",null,[n("li",null,[t(a,{to:"#testing-imports"},{default:e(()=>[s("Testing imports")]),_:1})]),n("li",null,[t(a,{to:"#testing-queuing-imports"},{default:e(()=>[s("Testing queuing imports")]),_:1})]),n("li",null,[t(a,{to:"#testing-imports-with-dynamic-file-name-path"},{default:e(()=>[s("Testing imports with dynamic file name/path")]),_:1})])])]),k])}const f=p(u,[["render",m],["__file","testing.html.vue"]]);export{f as default};
