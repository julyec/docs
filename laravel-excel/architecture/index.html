<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <script type="text/javascript" async="" src="/laravel-excel/iconify-icon@1.js" data-loaded="true"></script><meta name="keywords" content="php,go,python,c++,nsis"><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?800fce94596cf587cd6a0e80314e5360";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><title>Lifecycle | Laravel Excel</title><meta name="description" content="Supercharged Excel exports and imports in Laravel">
    <style>
      html {
        background: #fff;
      }

      html[data-theme="dark"] {
        background: #1d1e1f;
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/laravel-excel/assets/style-ff433376.css" as="style"><link rel="stylesheet" href="/laravel-excel/assets/style-ff433376.css">
    <link rel="modulepreload" href="/laravel-excel/assets/app-edc8bdf9.js"><link rel="modulepreload" href="/laravel-excel/assets/index.html-9e32e0eb.js"><link rel="modulepreload" href="/laravel-excel/assets/index.html-bd1351f2.js"><link rel="modulepreload" href="/laravel-excel/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/laravel-excel/assets/index.html-a1bf5020.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/concerns.html-97ce25fe.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/objects.html-fd2feb20.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/charts.html-569dd7a4.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/collection.html-fe5be9dc.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/column-formatting.html-1b9d54df.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/concerns.html-095fd36f.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/drawings.html-07259a5d.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/export-formats.html-698a451a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/exportables.html-82a9fd93.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/extending.html-c6811f27.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/from-generator.html-932e57bc.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/from-query.html-cd818978.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/from-view.html-44185a15.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/mapping.html-dcc34da8.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/multiple-sheets.html-12fe0468.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/queued.html-20760e0c.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-5de42d82.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/settings.html-464adb20.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/store.html-c4c77cbe.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/testing.html-e84d7b11.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/contributing.html-f28fe297.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/installation.html-6c9e46f3.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/license.html-f6a2666a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-82b12643.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/support.html-0fa6c1e7.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/upgrade.html-1dcc4a9d.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/basics.html-59f4b736.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/batch-inserts.html-bd256c11.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/chunk-reading.html-ca6dfade.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/collection.html-74760de9.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/concerns.html-93833135.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/custom-csv-settings.html-4182da10.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/custom-formatting-values.html-d470a94a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/extending.html-b52ccff6.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/heading-row.html-2d7b97ae.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/import-formats.html-132bd576.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/importables.html-e812e86a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/mapped-cells.html-1527c5e1.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/model.html-5777d810.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/multiple-sheets.html-009bfc92.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/progress-bar.html-397a326a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/queued.html-6ebc3ca2.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-697113e4.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/testing.html-ab853f88.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/validation.html-afb26e48.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/404.html-fce79bde.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-8048da3d.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-6af0b259.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-0341c66f.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-c4c647eb.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-aa7de2dc.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-4f74a2f0.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/concerns.html-730c9dac.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/objects.html-5496711f.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/charts.html-6e8d3ad3.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/collection.html-6604f0d4.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/column-formatting.html-e419acdb.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/concerns.html-15aad653.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/drawings.html-8b9521cc.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/export-formats.html-bccd076b.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/exportables.html-7f06cc8e.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/extending.html-55911805.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/from-generator.html-406f3c72.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/from-query.html-138e7a44.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/from-view.html-d7d26587.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/mapping.html-02f9f1ce.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/multiple-sheets.html-11072441.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/queued.html-bfaa5f97.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-fa016417.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/settings.html-d643fb40.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/store.html-f22817ef.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/testing.html-9f84de83.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/contributing.html-dc000d62.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/installation.html-1ad3c675.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/license.html-2764f59e.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-09ef149d.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/support.html-619c7efc.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/upgrade.html-102de305.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/basics.html-5218ad58.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/batch-inserts.html-98c0e391.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/chunk-reading.html-5377be03.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/collection.html-d64336f0.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/concerns.html-cfa5dcf7.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/custom-csv-settings.html-e275b250.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/custom-formatting-values.html-fd69adb3.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/extending.html-10598bcd.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/heading-row.html-1ba4cf15.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/import-formats.html-1bd64641.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/importables.html-b82ef2c9.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/mapped-cells.html-be3249f3.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/model.html-0f5fbfbd.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/multiple-sheets.html-261e113a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/progress-bar.html-d777510a.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/queued.html-7b29879e.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-d2f7e648.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/testing.html-1485fa84.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/validation.html-d5bbfdeb.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/404.html-22671266.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-c821709d.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-30e69f10.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-729dc7e9.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-559ea4b0.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/index.html-7758711f.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/mermaid.core-ca4a9ea7.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/VuePlayground-3295e419.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/photoswipe.esm-1464cdb9.js" as="script"><link rel="prefetch" href="/laravel-excel/assets/pageview-4b091336.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/laravel-excel/"><!----><!----><span class="vp-site-name">Laravel Excel</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="getting-started" class="vp-link nav-link nav-link" href="/laravel-excel/getting-started/"><!---->getting-started<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="architecture" class="vp-link nav-link active nav-link active" href="/laravel-excel/architecture/"><!---->architecture<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="exports" class="vp-link nav-link nav-link" href="/laravel-excel/exports/"><!---->exports<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="imports" class="vp-link nav-link nav-link" href="/laravel-excel/imports/"><!---->imports<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><!----><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">architecture</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Lifecycle" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/laravel-excel/architecture/"><!---->Lifecycle<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="Introduction" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#introduction"><!---->Introduction<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Exports Lifecycle Overview" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#exports-lifecycle-overview"><!---->Exports Lifecycle Overview<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="Export Object" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#export-object"><!---->Export Object<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Passing on the Export object" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#passing-on-the-export-object"><!---->Passing on the Export object<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Handling the Export object" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#handling-the-export-object"><!---->Handling the Export object<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Passing on to PhpSpreadsheet" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#passing-on-to-phpspreadsheet"><!---->Passing on to PhpSpreadsheet<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Creating a Response" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#creating-a-response"><!---->Creating a Response<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Imports Lifecycle Overview" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#imports-lifecycle-overview"><!---->Imports Lifecycle Overview<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="Import Object" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#import-object"><!---->Import Object<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Passing on the Import object" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#passing-on-the-import-object"><!---->Passing on the Import object<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Handling the Import object" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/laravel-excel/architecture/#handling-the-import-object"><!---->Handling the Import object<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a aria-label="Import &amp; Export Objects" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/laravel-excel/architecture/objects.html"><!---->Import &amp; Export Objects<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="Concerns" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/laravel-excel/architecture/concerns.html"><!---->Concerns<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Lifecycle</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Moments</span></span><span property="author" content="Moments"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-01-05T04:32:58.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 6 min</span><meta property="timeRequired" content="PT6M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/laravel-excel/#introduction">Introduction</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/laravel-excel/#exports-lifecycle-overview">Exports Lifecycle Overview</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#export-object">Export Object</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#passing-on-the-export-object">Passing on the Export object</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#handling-the-export-object">Handling the Export object</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#passing-on-to-phpspreadsheet">Passing on to PhpSpreadsheet</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#creating-a-response">Creating a Response</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/laravel-excel/#imports-lifecycle-overview">Imports Lifecycle Overview</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#import-object">Import Object</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#passing-on-the-import-object">Passing on the Import object</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/laravel-excel/#handling-the-import-object">Handling the Import object</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="lifecycle" tabindex="-1"><a class="header-anchor" href="#lifecycle" aria-hidden="true">#</a> Lifecycle</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/laravel-excel/architecture/#introduction" class="router-link-active router-link-exact-active">Introduction</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#exports-lifecycle-overview" class="router-link-active router-link-exact-active">Exports Lifecycle Overview</a><ul><li><a aria-current="page" href="/laravel-excel/architecture/#export-object" class="router-link-active router-link-exact-active">Export Object</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#passing-on-the-export-object" class="router-link-active router-link-exact-active">Passing on the Export object</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#handling-the-export-object" class="router-link-active router-link-exact-active">Handling the Export object</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#passing-on-to-phpspreadsheet" class="router-link-active router-link-exact-active">Passing on to PhpSpreadsheet</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#creating-a-response" class="router-link-active router-link-exact-active">Creating a Response</a></li></ul></li><li><a aria-current="page" href="/laravel-excel/architecture/#imports-lifecycle-overview" class="router-link-active router-link-exact-active">Imports Lifecycle Overview</a><ul><li><a aria-current="page" href="/laravel-excel/architecture/#import-object" class="router-link-active router-link-exact-active">Import Object</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#passing-on-the-import-object" class="router-link-active router-link-exact-active">Passing on the Import object</a></li><li><a aria-current="page" href="/laravel-excel/architecture/#handling-the-import-object" class="router-link-active router-link-exact-active">Handling the Import object</a></li></ul></li></ul></nav><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>When using a package in your application, it&#39;s good to understand how the package functions behind the scenes. Understanding the behind-the-scenes will make you feel more comfortable and confident using the maximum potential of the tool.</p><p>The goal of this page is to give you a high-level overview of how Laravel Excel works.</p><h2 id="exports-lifecycle-overview" tabindex="-1"><a class="header-anchor" href="#exports-lifecycle-overview" aria-hidden="true">#</a> Exports Lifecycle Overview</h2><p>This section will try to give you an overview of how the export works behind the scenes.</p><h3 id="export-object" tabindex="-1"><a class="header-anchor" href="#export-object" aria-hidden="true">#</a> Export Object</h3><p>Everything starts with the <code>Export</code> object. This object <strong>encapsulates</strong> your entire export logic. It both configures and handles the export logic.</p><p>A simple example of an export object is:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Exports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>FromCollection</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UsersExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromCollection</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you want to read more about export objects, go to the architecture page of <a href="/3.1/architecture/objects.html" target="_blank" rel="noopener noreferrer">export objects<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="passing-on-the-export-object" tabindex="-1"><a class="header-anchor" href="#passing-on-the-export-object" aria-hidden="true">#</a> Passing on the Export object</h3><p>Next the Export object will be passed on to the Laravel Excel package. The main entry point for this is the <code>Maatwebsite/Excel/Excel</code> class. This class can be called in multiple ways.</p><h4 id="facade" tabindex="-1"><a class="header-anchor" href="#facade" aria-hidden="true">#</a> Facade</h4><p>The easiest way to work with the <code>Excel</code> class is to use the <code>Maatwebsite\Excel\Facades\Excel</code> facade. If you use <a href="https://laravel.com/docs/packages#package-discovery" target="_blank" rel="noopener noreferrer">auto-discovery<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, you can use the alias <code>\Excel</code> directly instead of using the fully qualified namespace.</p><h4 id="dependency-injection" tabindex="-1"><a class="header-anchor" href="#dependency-injection" aria-hidden="true">#</a> Dependency injection</h4><p>You can inject the <code>Maatwebsite/Excel/Excel</code> manager class into your class, either via constructor injection or method injection in case of a controller.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Exports<span class="token punctuation">\</span>UsersExport</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Excel</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ExportController</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$excel</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Excel</span> <span class="token variable">$excel</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">excel</span> <span class="token operator">=</span> <span class="token variable">$excel</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">exportViaConstructorInjection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">excel</span><span class="token operator">-&gt;</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersExport</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;users.xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">exportViaMethodInjection</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Excel</span> <span class="token variable">$excel</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$excel</span><span class="token operator">-&gt;</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersExport</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;users.xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="contract" tabindex="-1"><a class="header-anchor" href="#contract" aria-hidden="true">#</a> Contract</h4><p>You can also use the <code>Maatwebsite\Excel\Exporter</code> interface to decouple more from the concrete Excel manager implementation. The contract offers the same methods as the <code>Excel</code> class. It will make it easier to e.g. stub out the Exporter in your unit tests. The <code>Exporter</code> contract can be either injected via the constructor or a method in a controller.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Exports<span class="token punctuation">\</span>UsersExport</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Exporter</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ExportsController</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$exporter</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Exporter</span> <span class="token variable">$exporter</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">exporter</span> <span class="token operator">=</span> <span class="token variable">$exporter</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">exporter</span><span class="token operator">-&gt;</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersExport</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;users.xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="container-binding" tabindex="-1"><a class="header-anchor" href="#container-binding" aria-hidden="true">#</a> Container binding</h4><p>If you want to bind the <code>Maatwebsite\Excel\Excel</code> manager to your own class via a container binding, you can use the <code>excel</code> container binding.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token operator">-&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token class-name static-context">YourCustomExporter</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">YourCustomExporter</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">app</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;excel&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="exportable-trait" tabindex="-1"><a class="header-anchor" href="#exportable-trait" aria-hidden="true">#</a> Exportable trait</h4><p>If you prefer a sprinkle of magic, you can use the <code>Maatwebsite\Excel\Concerns\Exportable</code> trait in your <code>Export</code> object. This trait will expose a couple of methods that will make it possible to directly export an <code>Export</code> object.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Exports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>FromCollection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>Exportable</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UsersExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromCollection</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Exportable</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can now download the export without the need for the <code>facade</code> or <code>Excel</code> manager.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersExport</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;users.xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Read more about the exportable trait in the <a href="/3.1/exports/exportables.html" target="_blank" rel="noopener noreferrer">exportables<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> docs.</p><h3 id="handling-the-export-object" tabindex="-1"><a class="header-anchor" href="#handling-the-export-object" aria-hidden="true">#</a> Handling the Export object</h3><h4 id="writer-type-detection" tabindex="-1"><a class="header-anchor" href="#writer-type-detection" aria-hidden="true">#</a> Writer type detection</h4><p>After using one of the above methods to pass on the <code>Export</code> object to the <code>Excel</code> manager, it will try to figure out what export it needs to be generated to. This will be either based on the extension of the file, the explicitly passed writer type. You can find the extension to writer type mapping in the <code>excel.php</code> config, in the <code>extension_detector</code> section. In case no writer type can be detected, a <code>Maatwebsite\Excel\Exceptions\NoTypeDetectedException</code> exception is thrown and the export process will be stopped.</p><h4 id="starting-the-writing-process" tabindex="-1"><a class="header-anchor" href="#starting-the-writing-process" aria-hidden="true">#</a> Starting the Writing process</h4><p>The <code>Excel</code> manager will then delegate the handling to the <code>Maatwebsite\Excel\Writer</code>. The first action of the <code>Writer</code> is to register the event listeners that are registered. Next it will create a new <code>PhpOffice\PhpSpreadsheet\Spreadsheet</code> instance that we will use to convert our <code>Export</code> object to.</p><p>The first event raised is the <code>BeforeExport</code> event. This is raised just after the <code>Spreadsheet</code> instance is created and allows early access to it.</p><h4 id="multiple-sheets" tabindex="-1"><a class="header-anchor" href="#multiple-sheets" aria-hidden="true">#</a> Multiple sheets</h4><p>Next the <code>Writer</code> will determine if multiple sheets are configured, by checking for the <code>Maatwebsite\Excel\Concerns\WithMultipleSheets</code> concern.</p><p>Then it will delegate the further handling of each sheet to the <code>Maatwebsite\Excel\Sheet</code> class.</p><h4 id="processing-the-sheets" tabindex="-1"><a class="header-anchor" href="#processing-the-sheets" aria-hidden="true">#</a> Processing the sheets</h4><p>In the <code>Sheet</code> class, the most heavy lifting happens. It first will create a <code>PhpOffice\PhpSpreadsheet\Worksheet\Worksheet</code> instance. Then it will raise the <code>BeforeSheet</code> event which allows you to hook into the moment just before the sheet handling starts.</p><p>Then it will determine what kind of export we are dealing with: <code>FromQuery</code>, <code>FromArray</code>, <code>FromCollection</code> or <code>FromView</code>. Based on that it will start the connected export process.</p><ul><li><code>FromView</code> will pass on the rendered <code>Blade</code> view to PhpSpreadsheet&#39;s <code>Html</code> Reader. That Reader will turn the table html into Excel cells. It also handles some inline styles (color and background color) and col/rowspans.</li><li>The <strong>Query</strong> passed with the <code>FromQuery</code> will automatically be chunked and each chunk will be appended to the Sheet. The chunking is done to limit the amount of Eloquent objects it needs to keep in memory. It greatly reduces memory usage.</li><li>The entire array of Collection will directly be appended to the Sheet.</li></ul><p>When the <code>Sheet</code> starts appending records, it will first call the <code>map()</code> method if the <code>WithMapping</code> concern is used. This allows the <code>Export</code> object to format the data before it is inserted.</p><p>Then it will handle column formatting (<code>WithColumnFormatting</code> concern) and cell autosizing (<code>ShouldAutoSize</code>).</p><p>To close off the Sheet processing, it will raise a <code>AfterSheet</code> event.</p><h3 id="passing-on-to-phpspreadsheet" tabindex="-1"><a class="header-anchor" href="#passing-on-to-phpspreadsheet" aria-hidden="true">#</a> Passing on to PhpSpreadsheet</h3><p>After the sheets are processed, the writing process will start. The writing process is started by raising the <code>BeforeWriting</code> event; this allows you to hook into the process of writing. Next we will create a new <code>PhpSpreadsheet Writer</code> based on the writer type that was determined. Then it will save it to a temporary file and return that filepath to the <code>Excel</code> manager.</p><h3 id="creating-a-response" tabindex="-1"><a class="header-anchor" href="#creating-a-response" aria-hidden="true">#</a> Creating a Response</h3><p>The <code>Excel</code> manager basically has 2 types of responses, it either starts the <strong>download</strong> process or it will <strong>store</strong> the file to disk.</p><h4 id="download-the-file" tabindex="-1"><a class="header-anchor" href="#download-the-file" aria-hidden="true">#</a> Download the file</h4><p>We will take the temporary file that was returned by the <code>Writer</code> and use Laravel&#39;s <code>ResponseFactory</code> to create a <code>Symfony\Component\HttpFoundation\BinaryFileResponse</code>. When returning this response in your controller, it will start a download.</p><h4 id="storing-the-file" tabindex="-1"><a class="header-anchor" href="#storing-the-file" aria-hidden="true">#</a> Storing the file</h4><p>The storing of the file will be handled by Laravel&#39;s <code>Filesystem</code>. By default the file will be stored on your <code>default</code> disk, but you can also pass a custom disk via the <code>Excel::store()</code> method.</p><h2 id="imports-lifecycle-overview" tabindex="-1"><a class="header-anchor" href="#imports-lifecycle-overview" aria-hidden="true">#</a> Imports Lifecycle Overview</h2><p>This section will try to give you an overview of how the import works behind the scenes.</p><h3 id="import-object" tabindex="-1"><a class="header-anchor" href="#import-object" aria-hidden="true">#</a> Import Object</h3><p>Everything starts with the <code>Import</code> object. This object <strong>encapsulates</strong> your entire import logic. It both configures and handles the import logic.</p><p>A simple example of an import object is:</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>ToCollection</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">ToCollection</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">collection</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Collection</span> <span class="token variable">$rows</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$rows</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&#39;name&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you want to read more about imports objects, go to the architecture page of <a href="/3.1/architecture/objects.html" target="_blank" rel="noopener noreferrer">imports objects<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="passing-on-the-import-object" tabindex="-1"><a class="header-anchor" href="#passing-on-the-import-object" aria-hidden="true">#</a> Passing on the Import object</h3><p>Next the Import object will be passed on to the Laravel Excel package. The main entry point for this is the <code>Maatwebsite/Excel/Excel</code> class. This class can be called in the same way as outlined in the Export lifecycle.</p><h4 id="contract-1" tabindex="-1"><a class="header-anchor" href="#contract-1" aria-hidden="true">#</a> Contract</h4><p>You can also use the <code>Maatwebsite\Excel\Importer</code> interface to decouple more from the concrete Excel manager implementation. The contract offers the same methods as the <code>Excel</code> class. It will make it easier to e.g. stub out the Importer in your unit tests. The <code>Importer</code> contract can be either injected via the constructor or the method of a controller.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Imports<span class="token punctuation">\</span>UsersImport</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Importer</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ImportsController</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$importer</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Importer</span> <span class="token variable">$importer</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">importer</span> <span class="token operator">=</span> <span class="token variable">$importer</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">import</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">importer</span><span class="token operator">-&gt;</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersImport</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;users.xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="importable-trait" tabindex="-1"><a class="header-anchor" href="#importable-trait" aria-hidden="true">#</a> Importable trait</h4><p>If you prefer a sprinkle of magic, you can use the <code>Maatwebsite\Excel\Concerns\Importable</code> trait in your <code>Import</code> object. This trait will expose a couple of methods that will make it possible to directly import an <code>Import</code> object.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>ToCollection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Maatwebsite<span class="token punctuation">\</span>Excel<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>Importable</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">ToCollection</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Importable</span><span class="token punctuation">;</span>

    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can now import without the need for the <code>facade</code> or <code>Excel</code> manager.</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersImport</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;users.xlsx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Read more about the importable trait in the <a href="/3.1/imports/importables.html" target="_blank" rel="noopener noreferrer">importables<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> docs.</p><h3 id="handling-the-import-object" tabindex="-1"><a class="header-anchor" href="#handling-the-import-object" aria-hidden="true">#</a> Handling the Import object</h3><h4 id="reader-type-detection" tabindex="-1"><a class="header-anchor" href="#reader-type-detection" aria-hidden="true">#</a> Reader type detection</h4><p>After using one of the above methods to pass on the <code>Import</code> object to the <code>Excel</code> manager, it will try to figure out what reader type it is . This will be either based on the extension of the file or the explicitly passed reader type. You can find the extension to reader type mapping in the <code>excel.php</code> config, in the <code>extension_detector</code> section. In case no reader type can be detected, a <code>Maatwebsite\Excel\Exceptions\NoTypeDetectedException</code> exception is thrown and the import process will be stopped.</p><h4 id="starting-the-reading-process" tabindex="-1"><a class="header-anchor" href="#starting-the-reading-process" aria-hidden="true">#</a> Starting the Reading process</h4><p>The <code>Excel</code> manager will then delegate the handling to the <code>Maatwebsite\Excel\Reader</code>. The first action of the <code>Reader</code> is to register the event listeners that are registered. It will copy the file from Laravel&#39;s <code>Filesystem</code> to the local filesystem, so PhpSpreadsheet can read it. Next it will create a PhpSpreadsheet <code>Reader</code> based on the reader type that was given and load the file into a <code>PhpOffice\PhpSpreadsheet\Spreadsheet</code> instance.</p><p>Next it will create a new <code>PhpOffice\PhpSpreadsheet\Spreadsheet</code> instance that we will use to read our <code>Import</code> object from.</p><p>The first event that is raised, is the <code>BeforeImport</code> event. This is raised just after the <code>Spreadsheet</code> instance is loaded and allows early access to it.</p><h4 id="multiple-sheets-1" tabindex="-1"><a class="header-anchor" href="#multiple-sheets-1" aria-hidden="true">#</a> Multiple sheets</h4><p>Next we will determine if we are dealing with multiple sheets. This is done based on the <code>WithMultipleSheets</code> concern.</p><h4 id="processing-the-sheets-1" tabindex="-1"><a class="header-anchor" href="#processing-the-sheets-1" aria-hidden="true">#</a> Processing the sheets</h4><p>Then each Sheet gets processed. This process gets started off by raising the <code>BeforeSheet</code> event. Then it will either import it to a Collection, an array or handle each row as an Eloquent model.</p><ul><li>When using <code>ToModel</code>, each returned model will be persisted via Eloquent. When using this in combination with <code>WithBatchInserts</code>, it will defer the persistence till the batch is complete and then insert them as one batch in the database.</li><li>When using <code>ToCollection</code> or <code>ToArray</code>, the entire dataset will be passed to the Import method and the user can determine itself how to use it.</li></ul><p>The sheet handling is ended by raising the <code>AfterSheet</code> event.</p></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">Last update: </span><!----></div><div class="contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: 554676262@qq.com">Moments</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a aria-label="Import &amp; Export Objects" class="vp-link nav-link next nav-link next" href="/laravel-excel/architecture/objects.html"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Import &amp; Export Objects<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><div class="vp-copyright">Copyright © 2024 Moments</div></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/laravel-excel/assets/app-edc8bdf9.js" defer></script>
  </body>
</html>
